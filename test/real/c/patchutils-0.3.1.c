/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 211 "/usr/lib/gcc/i486-linux-gnu/4.4.3/include/stddef.h"
typedef unsigned int size_t;
#line 56 "/usr/include/bits/types.h"
typedef long long __quad_t;
#line 141 "/usr/include/bits/types.h"
typedef long __off_t;
#line 142 "/usr/include/bits/types.h"
typedef __quad_t __off64_t;
#line 143 "/usr/include/bits/types.h"
typedef int __pid_t;
#line 180 "/usr/include/bits/types.h"
typedef int __ssize_t;
#line 45 "/usr/include/stdio.h"
struct _IO_FILE;
#line 49 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 180 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 186 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 271 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 110 "/usr/include/sys/types.h"
typedef __ssize_t ssize_t;
#line 133 "/usr/include/time.h"
struct tm {
   int tm_sec ;
   int tm_min ;
   int tm_hour ;
   int tm_mday ;
   int tm_mon ;
   int tm_year ;
   int tm_wday ;
   int tm_yday ;
   int tm_isdst ;
   long tm_gmtoff ;
   char const   *tm_zone ;
};
#line 40 "/usr/lib/gcc/i486-linux-gnu/4.4.3/include/stdarg.h"
typedef __builtin_va_list __gnuc_va_list;
#line 80 "/usr/include/stdio.h"
typedef __gnuc_va_list va_list;
#line 100 "/usr/include/sys/types.h"
typedef __pid_t pid_t;
#line 51 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.h"
struct patlist;
#line 122 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
struct patlist {
   struct patlist *next ;
   char *pattern ;
};
#line 83 "/usr/include/wchar.h"
union __anonunion___value_4 {
   unsigned int __wch ;
   char __wchb[4] ;
};
#line 83 "/usr/include/wchar.h"
struct __anonstruct___mbstate_t_3 {
   int __count ;
   union __anonunion___value_4 __value ;
};
#line 83 "/usr/include/wchar.h"
typedef struct __anonstruct___mbstate_t_3 __mbstate_t;
#line 22 "/usr/include/_G_config.h"
struct __anonstruct__G_fpos_t_5 {
   __off_t __pos ;
   __mbstate_t __state ;
};
#line 22 "/usr/include/_G_config.h"
typedef struct __anonstruct__G_fpos_t_5 _G_fpos_t;
#line 91 "/usr/include/stdio.h"
typedef _G_fpos_t fpos_t;
#line 94 "./src/getopt.h"
struct option {
   char const   *name ;
   int has_arg ;
   int *flag ;
   int val ;
};
#line 62 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
enum __anonenum_mode_54 {
    mode_inter = 0,
    mode_combine = 1,
    mode_flip = 2
} ;
#line 69 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
struct file_list {
   char *file ;
   long pos ;
   struct file_list *next ;
   struct file_list *tail ;
};
#line 76 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
struct lines {
   char *line ;
   size_t length ;
   unsigned long n ;
   struct lines *next ;
   struct lines *prev ;
};
#line 84 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
struct lines_info {
   char *unline ;
   unsigned long first_offset ;
   unsigned long min_context ;
   struct lines *head ;
   struct lines *tail ;
};
#line 845 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
union __anonunion_55 {
   int __in ;
   int __i ;
};
#line 1308 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
struct offset {
   unsigned long line ;
   long offset ;
};
#line 52 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
struct file_info {
   char const   *orig_file ;
   char const   *new_file ;
   int info_written ;
   int info_pending ;
};
#line 60 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
struct hunk {
   fpos_t filepos ;
   struct file_info *info ;
   unsigned long line_in_diff ;
   unsigned long num_lines ;
   unsigned long orig_offset ;
   unsigned long orig_count ;
   unsigned long new_offset ;
   unsigned long new_count ;
   struct hunk *next ;
   int discard_offset ;
};
#line 45 "/usr/include/regex.h"
typedef unsigned long reg_syntax_t;
#line 367 "/usr/include/regex.h"
struct re_pattern_buffer {
   unsigned char *buffer ;
   unsigned long allocated ;
   unsigned long used ;
   reg_syntax_t syntax ;
   char *fastmap ;
   unsigned char *translate ;
   size_t re_nsub ;
   unsigned int can_be_null : 1 ;
   unsigned int regs_allocated : 2 ;
   unsigned int fastmap_accurate : 1 ;
   unsigned int no_sub : 1 ;
   unsigned int not_bol : 1 ;
   unsigned int not_eol : 1 ;
   unsigned int newline_anchor : 1 ;
};
#line 433 "/usr/include/regex.h"
typedef struct re_pattern_buffer regex_t;
#line 436 "/usr/include/regex.h"
typedef int regoff_t;
#line 462 "/usr/include/regex.h"
struct __anonstruct_regmatch_t_18 {
   regoff_t rm_so ;
   regoff_t rm_eo ;
};
#line 462 "/usr/include/regex.h"
typedef struct __anonstruct_regmatch_t_18 regmatch_t;
#line 47 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
struct range {
   struct range *next ;
   unsigned long start ;
   unsigned long end ;
};
#line 53
enum line_numbering {
    None = 0,
    Before = 1,
    After = 2
} ;
#line 59
enum __anonenum_output_matching_30 {
    output_none = 0,
    output_hunk = 1,
    output_file = 2
} ;
#line 74
enum __anonenum_mode_31 {
    mode_filter = 0,
    mode_list = 1,
    mode_grep = 2
} ;
#line 74
enum __anonenum_mode_31___0 {
    mode_filter___0 = 0,
    mode_list___0 = 1,
    mode_grep___0 = 2
} ;
#line 62 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
enum __anonenum_mode_54___0 {
    mode_inter___0 = 0,
    mode_combine___0 = 1,
    mode_flip___0 = 2
} ;
#line 845 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
union __anonunion_55___0 {
   int __in ;
   int __i ;
};
/* compiler builtin: 
   int __builtin_va_arg_pack(void) ;  */
#line 43 "/usr/include/bits/errno.h"
extern  __attribute__((__nothrow__)) int *__errno_location(void)  __attribute__((__const__)) ;
#line 32 "/usr/include/error.h"
__inline extern void ( /* format attribute */ __attribute__((__artificial__, __always_inline__)) error)(int __status ,
                                                                                                        int __errnum ,
                                                                                                        char const   *__format 
                                                                                                        , ...) ;
#line 35
__inline extern void ( /* format attribute */ __attribute__((__artificial__, __always_inline__)) error_at_line)(int __status ,
                                                                                                                int __errnum ,
                                                                                                                char const   *__fname ,
                                                                                                                unsigned int __line ,
                                                                                                                char const   *__format 
                                                                                                                , ...) ;
#line 25 "/usr/include/bits/error.h"
extern void ( /* format attribute */  __error_alias)(int __status , int __errnum ,
                                                     char const   *__format  , ...)  __asm__("error")  ;
#line 37 "/usr/include/bits/error.h"
__inline extern void ( /* format attribute */ __attribute__((__artificial__, __always_inline__)) error)(int __status ,
                                                                                                        int __errnum ,
                                                                                                        char const   *__format 
                                                                                                        , ...) 
{ 


  {
  {
  {
#line 43
  __error_alias(__status, __errnum, __format, __builtin_va_arg_pack());
  }
  }
#line 44
  return;
}
}
#line 47
extern void ( /* format attribute */  __error_at_line_alias)(int __status , int __errnum ,
                                                             char const   *__fname ,
                                                             unsigned int __line ,
                                                             char const   *__format 
                                                             , ...)  __asm__("error_at_line")  ;
#line 64 "/usr/include/bits/error.h"
__inline extern void ( /* format attribute */ __attribute__((__artificial__, __always_inline__)) error_at_line)(int __status ,
                                                                                                                int __errnum ,
                                                                                                                char const   *__fname ,
                                                                                                                unsigned int __line ,
                                                                                                                char const   *__format 
                                                                                                                , ...) 
{ 


  {
  {
  {
#line 72
  __error_at_line_alias(__status, __errnum, __fname, __line, __format, __builtin_va_arg_pack());
  }
  }
#line 74
  return;
}
}
#line 145 "/usr/include/stdio.h"
extern struct _IO_FILE *stdin ;
#line 146
extern struct _IO_FILE *stdout ;
#line 214
extern int fclose(FILE *__stream ) ;
#line 219
extern int fflush(FILE *__stream ) ;
#line 283
extern  __attribute__((__nothrow__)) FILE *fdopen(int __fd , char const   *__modes ) ;
#line 339
extern int printf(char const   * __restrict  __format  , ...) ;
#line 513
extern int fgetc(FILE *__stream ) ;
#line 555
extern int fputc(int __c , FILE *__stream ) ;
#line 562
extern int putchar(int __c ) ;
#line 651
extern __ssize_t getline(char ** __restrict  __lineptr , size_t * __restrict  __n ,
                         FILE * __restrict  __stream ) ;
#line 668
extern int puts(char const   *__s ) ;
#line 688
extern size_t fwrite(void const   * __restrict  __ptr , size_t __size , size_t __n ,
                     FILE * __restrict  __s ) ;
#line 732
extern void rewind(FILE *__stream ) ;
#line 801
extern  __attribute__((__nothrow__)) int feof(FILE *__stream ) ;
#line 831
extern  __attribute__((__nothrow__)) int fileno(FILE *__stream ) ;
#line 184 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) long ( __attribute__((__nonnull__(1))) strtol)(char const   * __restrict  __nptr ,
                                                                                    char ** __restrict  __endptr ,
                                                                                    int __base ) ;
#line 188
extern  __attribute__((__nothrow__)) unsigned long ( __attribute__((__nonnull__(1))) strtoul)(char const   * __restrict  __nptr ,
                                                                                              char ** __restrict  __endptr ,
                                                                                              int __base ) ;
#line 488
extern  __attribute__((__nothrow__)) void free(void *__ptr ) ;
#line 543
extern  __attribute__((__nothrow__, __noreturn__)) void exit(int __status ) ;
#line 43 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2))) memcpy)(void * __restrict  __dest ,
                                                                                       void const   * __restrict  __src ,
                                                                                       size_t __n ) ;
#line 64
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1))) memset)(void *__s ,
                                                                                     int __c ,
                                                                                     size_t __n ) ;
#line 142
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2))) strcmp)(char const   *__s1 ,
                                                                                     char const   *__s2 )  __attribute__((__pure__)) ;
#line 145
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2))) strncmp)(char const   *__s1 ,
                                                                                      char const   *__s2 ,
                                                                                      size_t __n )  __attribute__((__pure__)) ;
#line 233
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1))) strchr)(char const   *__s ,
                                                                                     int __c )  __attribute__((__pure__)) ;
#line 260
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1))) strrchr)(char const   *__s ,
                                                                                      int __c )  __attribute__((__pure__)) ;
#line 282
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1,2))) strcspn)(char const   *__s ,
                                                                                         char const   *__reject )  __attribute__((__pure__)) ;
#line 286
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1,2))) strspn)(char const   *__s ,
                                                                                        char const   *__accept )  __attribute__((__pure__)) ;
#line 340
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2))) strstr)(char const   *__haystack ,
                                                                                       char const   *__needle )  __attribute__((__pure__)) ;
#line 397
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1))) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 350 "/usr/include/unistd.h"
extern int close(int __fd ) ;
#line 414
extern  __attribute__((__nothrow__)) int pipe(int *__pipedes ) ;
#line 529
extern  __attribute__((__nothrow__)) int dup2(int __fd , int __fd2 ) ;
#line 773
extern  __attribute__((__nothrow__)) __pid_t fork(void) ;
#line 207 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) char *strptime(char const   * __restrict  __s ,
                                                    char const   * __restrict  __fmt ,
                                                    struct tm *__tp ) ;
#line 23 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.h"
int num_pathname_components(char const   *x ) ;
#line 32
char *best_name(int n , char **names ) ;
#line 37
char const   *stripped(char const   *name , int num_components ) ;
#line 39
unsigned long calculate_num_lines(char const   *atatline , char which ) ;
#line 40
unsigned long orig_num_lines(char const   *atatline ) ;
#line 41
unsigned long new_num_lines(char const   *atatline ) ;
#line 42
int read_atatline(char const   *atatline , unsigned long *orig_offset , unsigned long *orig_count ,
                  unsigned long *new_offset , unsigned long *new_count ) ;
#line 49
FILE *convert_to_context(FILE *f , char const   *mode___3 , int seekable ) ;
#line 50
FILE *convert_to_unified(FILE *f , char const   *mode___3 , int seekable ) ;
#line 53
int read_timestamp(char const   *timestamp , struct tm *result , long *zone ) ;
#line 57
char *filename_from_header(char const   *header ) ;
#line 35 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.h"
void *xmalloc(size_t size ) ;
#line 38
char *xstrdup(char const   *s ) ;
#line 40
char *xstrndup(char const   *s , size_t const   n ) ;
#line 44
FILE *xtmpfile(void) ;
#line 47 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
int num_pathname_components(char const   *x ) 
{ 
  int num ;
  char *tmp ;

  {
#line 49
  num = 0;
  {
  {
#line 50
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 50
    tmp = strchr(x, '/');
    }
#line 50
    x = (char const   *)tmp;
    }
#line 50
    if (! ((unsigned long )x != (unsigned long )((void *)0))) {
#line 50
      goto while_break;
    }
    {
    {
#line 51
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 51
      if (! ((int const   )*x == 47)) {
#line 51
        goto while_break___0;
      }
#line 52
      x ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 53
    num ++;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 55
  return (num);
}
}
#line 66 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
char *best_name(int n , char **names ) 
{ 
  int *pathname_components ;
  int *basename_length ;
  int *is_dev_null ;
  int best_pn ;
  int best_bn ;
  int best_n ;
  int best ;
  int i ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  char *p ;
  size_t tmp___4 ;
  int len ;
  size_t tmp___5 ;
  char *__cil_tmp20 ;

  {
  {
#line 71
  best = 0;
  {
#line 74
  tmp = xmalloc((size_t )(sizeof(int *) * (unsigned long )n));
  }
#line 74
  pathname_components = (int *)tmp;
  {
#line 75
  tmp___0 = xmalloc((size_t )(sizeof(int *) * (unsigned long )n));
  }
#line 75
  basename_length = (int *)tmp___0;
  {
#line 76
  tmp___1 = xmalloc((size_t )(sizeof(int *) * (unsigned long )n));
  }
#line 76
  is_dev_null = (int *)tmp___1;
#line 78
  best_pn = -1;
#line 79
  i = 0;
  }
  {
  {
#line 79
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 79
    if (! (i < n)) {
#line 79
      goto while_break;
    }
    {
    {
#line 80
    tmp___2 = strcmp((char const   *)*(names + i), "/dev/null");
    }
    }
#line 80
    if (tmp___2) {
#line 80
      tmp___3 = 0;
    } else {
#line 80
      tmp___3 = 1;
    }
#line 80
    *(is_dev_null + i) = tmp___3;
#line 81
    if (*(is_dev_null + i)) {
#line 82
      goto __Cont;
    }
    {
    {
#line 84
    *(pathname_components + i) = num_pathname_components((char const   *)*(names + i));
    }
    }
#line 85
    if (best_pn == -1) {
#line 87
      best_pn = *(pathname_components + i);
    } else
#line 85
    if (*(pathname_components + i) < best_pn) {
#line 87
      best_pn = *(pathname_components + i);
    }
    __Cont: /* CIL Label */ 
#line 79
    i ++;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 90
  best_bn = -1;
#line 91
  i = 0;
  {
  {
#line 91
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 91
    if (! (i < n)) {
#line 91
      goto while_break___0;
    }
#line 94
    if (*(is_dev_null + i)) {
#line 95
      goto __Cont___0;
    }
#line 97
    if (*(pathname_components + i) != best_pn) {
#line 98
      goto __Cont___0;
    }
    {
    {
#line 100
    p = strrchr((char const   *)*(names + i), '/');
    }
    }
#line 101
    if (p) {
#line 102
      p ++;
    } else {
#line 104
      p = *(names + i);
    }
    {
    {
#line 106
    tmp___4 = strlen((char const   *)p);
    }
#line 106
    *(basename_length + i) = (int )tmp___4;
    }
#line 107
    if (best_bn == -1) {
#line 109
      best_bn = *(basename_length + i);
    } else
#line 107
    if (*(basename_length + i) < best_bn) {
#line 109
      best_bn = *(basename_length + i);
    }
    __Cont___0: /* CIL Label */ 
#line 91
    i ++;
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 112
  best_n = -1;
#line 113
  i = 0;
  {
  {
#line 113
  while (1) {
    while_continue___4: /* CIL Label */ ;
    while_continue___1: /* CIL Label */ ;
#line 113
    if (! (i < n)) {
#line 113
      goto while_break___1;
    }
#line 116
    if (*(is_dev_null + i)) {
#line 117
      goto __Cont___1;
    }
#line 119
    if (*(basename_length + i) != best_bn) {
#line 120
      goto __Cont___1;
    }
    {
    {
#line 122
    tmp___5 = strlen((char const   *)*(names + i));
    }
#line 122
    len = (int )tmp___5;
    }
#line 123
    if (best_n == -1) {
#line 125
      best_n = len;
#line 126
      best = i;
    } else
#line 123
    if (len < best_n) {
#line 125
      best_n = len;
#line 126
      best = i;
    }
    __Cont___1: /* CIL Label */ 
#line 113
    i ++;
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  {
  {
#line 130
  free((void *)pathname_components);
  }
  {
#line 131
  free((void *)basename_length);
  }
  {
#line 132
  free((void *)is_dev_null);
  }
  }
#line 133
  return (*(names + best));
}
}
#line 136 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
char const   *stripped(char const   *name , int num_components ) 
{ 
  char const   *basename___0 ;
  int i ;
  int tmp ;
  char *tmp___0 ;
  char *tmp___1 ;
  char const   *tmp___2 ;
  char *__cil_tmp9 ;

  {
  {
#line 139
  i = 0;
  {
#line 141
  tmp = strcmp(name, "/dev/null");
  }
  }
#line 141
  if (! tmp) {
#line 142
    return (name);
  }
  {
  {
#line 144
  tmp___0 = strrchr(name, '/');
  }
#line 144
  basename___0 = (char const   *)tmp___0;
  }
#line 145
  if (! basename___0) {
#line 146
    basename___0 = name;
  } else {
#line 147
    basename___0 ++;
  }
  {
  {
#line 148
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 148
    if (i < num_components) {
      {
      {
#line 148
      tmp___1 = strchr(name, '/');
      }
#line 148
      name = (char const   *)tmp___1;
      }
#line 148
      if (! ((unsigned long )name != (unsigned long )((void *)0))) {
#line 148
        goto while_break;
      }
    } else {
#line 148
      goto while_break;
    }
    {
    {
#line 150
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 150
      if (! ((int const   )*name == 47)) {
#line 150
        goto while_break___0;
      }
#line 151
      name ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 152
    i ++;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 154
  if (name) {
#line 154
    tmp___2 = name;
  } else {
#line 154
    tmp___2 = basename___0;
  }
#line 154
  return (tmp___2);
}
}
#line 157 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
unsigned long calculate_num_lines(char const   *atatline , char which ) 
{ 
  char *p ;
  char *tmp ;
  unsigned long tmp___0 ;

  {
  {
  {
#line 159
  tmp = strchr(atatline, (int )which);
  }
#line 159
  p = tmp;
  }
#line 160
  if (! p) {
#line 161
    return (1UL);
  }
  {
  {
#line 162
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 162
    if (*p) {
#line 162
      if ((int )*p != 44) {
#line 162
        if (! ((int )*p != 32)) {
#line 162
          goto while_break;
        }
      } else {
#line 162
        goto while_break;
      }
    } else {
#line 162
      goto while_break;
    }
#line 162
    p ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 163
  if (! *p) {
#line 164
    return (1UL);
  } else
#line 163
  if ((int )*p == 32) {
#line 164
    return (1UL);
  }
  {
  {
#line 165
  tmp___0 = strtoul((char const   */* __restrict  */)(p + 1), (char **/* __restrict  */)((void *)0),
                    10);
  }
  }
#line 165
  return (tmp___0);
}
}
#line 168 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
unsigned long orig_num_lines(char const   *atatline ) 
{ 
  unsigned long tmp ;

  {
  {
  {
#line 170
  tmp = calculate_num_lines(atatline, (char )'-');
  }
  }
#line 170
  return (tmp);
}
}
#line 173 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
unsigned long new_num_lines(char const   *atatline ) 
{ 
  unsigned long tmp ;

  {
  {
  {
#line 175
  tmp = calculate_num_lines(atatline, (char )'+');
  }
  }
#line 175
  return (tmp);
}
}
#line 179 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
int read_atatline(char const   *atatline , unsigned long *orig_offset , unsigned long *orig_count ,
                  unsigned long *new_offset , unsigned long *new_count ) 
{ 
  char *endptr ;
  unsigned long res ;
  char *p ;

  {
#line 189
  if (orig_offset) {
    {
    {
#line 190
    p = strchr(atatline, '-');
    }
    }
#line 191
    if (! p) {
#line 192
      return (1);
    }
    {
#line 193
    p ++;
    {
#line 194
    res = strtoul((char const   */* __restrict  */)p, (char **/* __restrict  */)(& endptr),
                  10);
    }
    }
#line 195
    if ((unsigned long )p == (unsigned long )endptr) {
#line 196
      return (1);
    }
#line 197
    *orig_offset = res;
  }
#line 200
  if (orig_count) {
    {
    {
#line 201
    *orig_count = orig_num_lines(atatline);
    }
    }
  }
#line 203
  if (new_offset) {
    {
    {
#line 204
    p = strchr(atatline, '+');
    }
    }
#line 205
    if (! p) {
#line 206
      return (1);
    }
    {
#line 207
    p ++;
    {
#line 208
    res = strtoul((char const   */* __restrict  */)p, (char **/* __restrict  */)(& endptr),
                  10);
    }
    }
#line 209
    if ((unsigned long )p == (unsigned long )endptr) {
#line 210
      return (1);
    }
#line 211
    *new_offset = res;
  }
#line 214
  if (new_count) {
    {
    {
#line 215
    *new_count = new_num_lines(atatline);
    }
    }
  }
#line 217
  return (0);
}
}
#line 220 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void copy_context_hunks(char **line , size_t *linelen , ssize_t *got , unsigned long *linenum___1 ) 
{ 
  unsigned long unchanged ;
  unsigned long line_start ;
  unsigned long line_end ;
  unsigned long line_count ;
  char *n ;
  char *end ;
  int i ;
  int first ;
  int tmp ;
  char const   *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  unsigned long tmp___3 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;

  {
  {
  {
#line 223
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 224
    unchanged = 0UL;
#line 229
    i = 0;
    {
    {
#line 229
    while (1) {
      while_continue___3: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 229
      if (! (i < 2)) {
#line 229
        goto while_break___0;
      }
      {
#line 230
      first = 1;
      {
#line 231
      *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                     (FILE */* __restrict  */)stdin);
      }
      }
#line 232
      if (*got == -1) {
#line 233
        return;
      }
#line 234
      (*linenum___1) ++;
#line 236
      if (! i) {
        {
        {
#line 236
        tmp = strncmp((char const   *)*line, "***************", (size_t )15);
        }
        }
#line 236
        if (! tmp) {
#line 241
          i --;
#line 242
          goto __Cont;
        }
      }
#line 245
      if (i) {
#line 245
        tmp___0 = "--- ";
      } else {
#line 245
        tmp___0 = "*** ";
      }
      {
      {
#line 245
      tmp___1 = strncmp((char const   *)*line, tmp___0, (size_t )4);
      }
      }
#line 245
      if (tmp___1) {
#line 246
        return;
      }
      do_line_counts: 
      {
#line 249
      n = *line + 4;
      {
#line 250
      line_start = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
      }
      }
#line 251
      if ((unsigned long )n == (unsigned long )end) {
#line 252
        return;
      }
#line 254
      if ((int )*end == 44) {
        {
#line 255
        n = end + 1;
        {
#line 256
        line_end = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
        }
        }
#line 257
        if ((unsigned long )n == (unsigned long )end) {
#line 258
          return;
        }
#line 260
        if (line_start > line_end) {
#line 261
          return;
        }
#line 263
        line_count = (line_end - line_start) + 1UL;
      } else {
#line 265
        line_end = line_start;
#line 266
        if (line_start) {
#line 266
          line_count = 1UL;
        } else {
#line 266
          line_count = 0UL;
        }
      }
      {
      {
#line 269
      fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      }
#line 271
      if (i) {
#line 271
        if (line_count == unchanged) {
#line 272
          goto while_break___0;
        }
      }
      {
      {
#line 274
      while (1) {
        while_continue___4: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 274
        tmp___3 = line_count;
#line 274
        line_count --;
#line 274
        if (! tmp___3) {
#line 274
          goto while_break___1;
        }
        {
        {
#line 275
        *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                       (FILE */* __restrict  */)stdin);
        }
        }
#line 276
        if (*got == -1) {
#line 277
          return;
        }
#line 278
        (*linenum___1) ++;
#line 280
        if (! i) {
#line 280
          if (first) {
            {
#line 281
            first = 0;
            {
#line 282
            tmp___2 = strncmp((char const   *)*line, "--- ", (size_t )4);
            }
            }
#line 282
            if (! tmp___2) {
#line 284
              i ++;
#line 285
              goto do_line_counts;
            }
          }
        }
        {
        {
#line 289
        fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1,
               (FILE */* __restrict  */)stdout);
        }
        }
#line 290
        if ((int )*(*line) == 32) {
#line 291
          unchanged ++;
        }
      }
      while_break___4: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
      __Cont: /* CIL Label */ 
#line 229
      i ++;
    }
    while_break___3: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
}
}
#line 297 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void convert_unified_hunks_to_context(char **line , size_t *linelen , unsigned long *linenum___1 ) 
{ 
  unsigned long orig_offset ;
  unsigned long orig_count ;
  unsigned long new_offset ;
  unsigned long new_count ;
  char **orig_line ;
  char **new_line ;
  char **orig_what ;
  char **new_what ;
  char **whats ;
  unsigned int n_whats ;
  unsigned long orig_linenum ;
  unsigned long new_linenum ;
  char const   *no_newline_str ;
  int tmp ;
  __ssize_t tmp___0 ;
  char *last_orig ;
  char *last_new ;
  char *misc ;
  char *what ;
  int newline ;
  int can_omit_from ;
  int can_omit_to ;
  unsigned long i ;
  int tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  void *tmp___4 ;
  void *tmp___5 ;
  void *tmp___6 ;
  int get_out ;
  __ssize_t tmp___7 ;
  unsigned long tmp___8 ;
  unsigned long tmp___9 ;
  void *tmp___10 ;
  unsigned int tmp___11 ;
  unsigned long tmp___12 ;
  void *tmp___13 ;
  unsigned int tmp___14 ;
  unsigned long tmp___15 ;
  size_t tmp___16 ;
  size_t tmp___17 ;
  char *l ;
  size_t tmp___18 ;
  char *l___0 ;
  size_t tmp___19 ;
  int tmp___20 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;

  {
  {
#line 300
  orig_count = 0UL;
#line 300
  new_count = 0UL;
#line 301
  orig_line = (char **)((void *)0);
#line 301
  new_line = (char **)((void *)0);
#line 302
  orig_what = (char **)((void *)0);
#line 302
  new_what = (char **)((void *)0);
#line 303
  whats = (char **)((void *)0);
#line 304
  n_whats = 0U;
#line 306
  no_newline_str = "\\ No newline at end of file\n";
  {
#line 308
  tmp = feof(stdin);
  }
  }
#line 308
  if (tmp) {
#line 309
    goto eof;
  }
  {
  {
#line 311
  tmp___0 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                    (FILE */* __restrict  */)stdin);
  }
  }
#line 311
  if (tmp___0 == -1) {
#line 312
    goto eof;
  }
#line 313
  (*linenum___1) ++;
  {
  {
#line 315
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
#line 316
    last_orig = (char *)((void *)0);
#line 317
    last_new = (char *)((void *)0);
#line 318
    misc = (char *)((void *)0);
#line 319
    what = (char *)((void *)0);
#line 320
    newline = 1;
#line 321
    can_omit_from = 1;
#line 321
    can_omit_to = 1;
    {
#line 324
    tmp___1 = read_atatline((char const   *)*line, & orig_offset, & orig_count, & new_offset,
                            & new_count);
    }
    }
#line 324
    if (tmp___1) {
#line 326
      return;
    }
    {
    {
#line 328
    misc = strchr((char const   *)(*line + 2), '@');
    }
#line 329
    misc += 2;
    {
#line 330
    misc = xstrdup((char const   *)misc);
    }
    {
#line 333
    tmp___2 = xmalloc((size_t )(sizeof(char *) * orig_count));
    }
#line 333
    orig_line = (char **)tmp___2;
    {
#line 334
    tmp___3 = xmalloc((size_t )(sizeof(char *) * new_count));
    }
#line 334
    new_line = (char **)tmp___3;
    {
#line 335
    tmp___4 = xmalloc((size_t )(sizeof(char *) * orig_count));
    }
#line 335
    orig_what = (char **)tmp___4;
    {
#line 336
    tmp___5 = xmalloc((size_t )(sizeof(char *) * new_count));
    }
#line 336
    new_what = (char **)tmp___5;
    {
#line 337
    tmp___6 = xmalloc((size_t )(sizeof(char *) * (orig_count + new_count)));
    }
#line 337
    whats = (char **)tmp___6;
#line 338
    new_linenum = 0UL;
#line 338
    orig_linenum = new_linenum;
    }
    {
    {
#line 339
    while (1) {
      while_continue___7: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 339
      if (! (orig_linenum < orig_count)) {
#line 339
        if (! (new_linenum < new_count)) {
#line 339
          if (! newline) {
#line 339
            goto while_break___0;
          }
        }
      }
      {
#line 341
      get_out = 0;
      {
#line 343
      tmp___7 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                        (FILE */* __restrict  */)stdin);
      }
      }
#line 343
      if (tmp___7 == -1) {
#line 345
        goto while_break___0;
      }
#line 346
      (*linenum___1) ++;
#line 348
      if (orig_linenum >= orig_count) {
#line 348
        if (new_linenum >= new_count) {
#line 348
          if ((int )*(*line) != 92) {
#line 351
            goto while_break___0;
          }
        }
      }
      {
#line 354
      if ((int )*(*line) == 32) {
#line 354
        goto case_32;
      }
#line 364
      if ((int )*(*line) == 45) {
#line 364
        goto case_45;
      }
#line 380
      if ((int )*(*line) == 43) {
#line 380
        goto case_43;
      }
#line 396
      if ((int )*(*line) == 92) {
#line 396
        goto case_92;
      }
#line 405
      goto switch_default;
      case_32: /* CIL Label */ 
      {
#line 355
      what = (char *)((void *)0);
#line 356
      *(orig_what + orig_linenum) = (char *)" ";
#line 357
      *(new_what + new_linenum) = (char *)" ";
      {
#line 358
      *(orig_line + orig_linenum) = xstrdup((char const   *)(*line + 1));
      }
      {
#line 359
      *(new_line + new_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 360
      tmp___8 = orig_linenum;
#line 360
      orig_linenum ++;
#line 360
      last_orig = *(orig_line + tmp___8);
#line 361
      tmp___9 = new_linenum;
#line 361
      new_linenum ++;
#line 361
      last_new = *(new_line + tmp___9);
      }
#line 362
      goto switch_break;
      case_45: /* CIL Label */ 
#line 365
      if (what) {
#line 366
        if ((int )*what != 45) {
#line 367
          *what = (char )'!';
        }
      } else {
        {
        {
#line 369
        tmp___10 = xmalloc((size_t )sizeof(char ));
        }
#line 369
        what = (char *)tmp___10;
#line 370
        *what = (char )'-';
#line 371
        tmp___11 = n_whats;
#line 371
        n_whats ++;
#line 371
        *(whats + tmp___11) = what;
        }
      }
      {
#line 373
      *(orig_what + orig_linenum) = what;
      {
#line 374
      *(orig_line + orig_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 375
      tmp___12 = orig_linenum;
#line 375
      orig_linenum ++;
#line 375
      last_orig = *(orig_line + tmp___12);
#line 376
      last_new = (char *)((void *)0);
#line 377
      can_omit_from = 0;
      }
#line 378
      goto switch_break;
      case_43: /* CIL Label */ 
#line 381
      if (what) {
#line 382
        if ((int )*what != 43) {
#line 383
          *what = (char )'!';
        }
      } else {
        {
        {
#line 385
        tmp___13 = xmalloc((size_t )sizeof(char ));
        }
#line 385
        what = (char *)tmp___13;
#line 386
        *what = (char )'+';
#line 387
        tmp___14 = n_whats;
#line 387
        n_whats ++;
#line 387
        *(whats + tmp___14) = what;
        }
      }
      {
#line 389
      *(new_what + new_linenum) = what;
      {
#line 390
      *(new_line + new_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 391
      last_orig = (char *)((void *)0);
#line 392
      tmp___15 = new_linenum;
#line 392
      new_linenum ++;
#line 392
      last_new = *(new_line + tmp___15);
#line 393
      can_omit_to = 0;
      }
#line 394
      goto switch_break;
      case_92: /* CIL Label */ 
#line 397
      if (last_orig) {
        {
        {
#line 398
        tmp___16 = strlen((char const   *)last_orig);
        }
#line 398
        *(last_orig + (tmp___16 - 1U)) = (char )'\000';
        }
      }
#line 399
      if (last_new) {
        {
        {
#line 400
        tmp___17 = strlen((char const   *)last_new);
        }
#line 400
        *(last_new + (tmp___17 - 1U)) = (char )'\000';
        }
      }
#line 401
      last_new = (char *)((void *)0);
#line 401
      last_orig = last_new;
#line 402
      newline = 0;
#line 403
      goto switch_break;
      switch_default: /* CIL Label */ 
#line 406
      get_out = 1;
      switch_break: /* CIL Label */ ;
      }
#line 409
      if (get_out) {
#line 410
        goto while_break___0;
      }
    }
    while_break___7: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 413
    if (orig_linenum < orig_count) {
      {
      {
#line 415
      error(1, 0, "Garbled input at line %lu", *linenum___1);
      }
      }
    } else
#line 413
    if (new_linenum < new_count) {
      {
      {
#line 415
      error(1, 0, "Garbled input at line %lu", *linenum___1);
      }
      }
    }
    {
    {
#line 418
    printf((char const   */* __restrict  */)"*** %lu", orig_offset);
    }
    }
#line 419
    if (orig_count) {
      {
      {
#line 420
      printf((char const   */* __restrict  */)",%lu", (orig_offset + orig_count) - 1UL);
      }
      }
    }
    {
    {
#line 422
    printf((char const   */* __restrict  */)" ****%s", misc);
    }
    }
#line 423
    if (! can_omit_from) {
#line 424
      i = 0UL;
      {
      {
#line 424
      while (1) {
        while_continue___8: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 424
        if (! (i < orig_count)) {
#line 424
          goto while_break___1;
        }
        {
#line 425
        l = *(orig_line + i);
        {
#line 426
        printf((char const   */* __restrict  */)"%c %s", (int )*(*(orig_what + i)),
               l);
        }
        {
#line 427
        tmp___18 = strlen((char const   *)l);
        }
        }
#line 427
        if ((int )*(l + (tmp___18 - 1U)) != 10) {
          {
          {
#line 428
          printf((char const   */* __restrict  */)"\n%s", no_newline_str);
          }
          }
        }
#line 424
        i ++;
      }
      while_break___8: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
    }
    {
    {
#line 431
    printf((char const   */* __restrict  */)"--- %lu", new_offset);
    }
    }
#line 432
    if (new_count) {
      {
      {
#line 433
      printf((char const   */* __restrict  */)",%lu", (new_offset + new_count) - 1UL);
      }
      }
    }
    {
    {
#line 435
    puts(" ----");
    }
    }
#line 436
    if (! can_omit_to) {
#line 437
      i = 0UL;
      {
      {
#line 437
      while (1) {
        while_continue___9: /* CIL Label */ ;
        while_continue___2: /* CIL Label */ ;
#line 437
        if (! (i < new_count)) {
#line 437
          goto while_break___2;
        }
        {
#line 438
        l___0 = *(new_line + i);
        {
#line 439
        printf((char const   */* __restrict  */)"%c %s", (int )*(*(new_what + i)),
               l___0);
        }
        {
#line 440
        tmp___19 = strlen((char const   *)l___0);
        }
        }
#line 440
        if ((int )*(l___0 + (tmp___19 - 1U)) != 10) {
          {
          {
#line 441
          printf((char const   */* __restrict  */)"\n%s", no_newline_str);
          }
          }
        }
#line 437
        i ++;
      }
      while_break___9: /* CIL Label */ ;
      }
      while_break___2: /* CIL Label */ ;
      }
    }
    eof: 
#line 445
    i = 0UL;
    {
    {
#line 445
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___3: /* CIL Label */ ;
#line 445
      if (! (i < orig_count)) {
#line 445
        goto while_break___3;
      }
      {
      {
#line 446
      free((void *)*(orig_line + i));
      }
#line 445
      i ++;
      }
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___3: /* CIL Label */ ;
    }
#line 448
    i = 0UL;
    {
    {
#line 448
    while (1) {
      while_continue___11: /* CIL Label */ ;
      while_continue___4: /* CIL Label */ ;
#line 448
      if (! (i < new_count)) {
#line 448
        goto while_break___4;
      }
      {
      {
#line 449
      free((void *)*(new_line + i));
      }
#line 448
      i ++;
      }
    }
    while_break___11: /* CIL Label */ ;
    }
    while_break___4: /* CIL Label */ ;
    }
#line 451
    i = 0UL;
    {
    {
#line 451
    while (1) {
      while_continue___12: /* CIL Label */ ;
      while_continue___5: /* CIL Label */ ;
#line 451
      if (! (i < (unsigned long )n_whats)) {
#line 451
        goto while_break___5;
      }
      {
      {
#line 452
      free((void *)*(whats + i));
      }
#line 451
      i ++;
      }
    }
    while_break___12: /* CIL Label */ ;
    }
    while_break___5: /* CIL Label */ ;
    }
    {
    {
#line 454
    free((void *)orig_line);
    }
    {
#line 455
    free((void *)new_line);
    }
    {
#line 456
    free((void *)orig_what);
    }
    {
#line 457
    free((void *)new_what);
    }
    {
#line 458
    free((void *)whats);
    }
    {
#line 459
    free((void *)misc);
    }
#line 460
    n_whats = 0U;
#line 460
    new_count = (unsigned long )n_whats;
#line 460
    orig_count = new_count;
#line 461
    new_line = (char **)((void *)0);
#line 461
    orig_line = new_line;
#line 462
    new_what = (char **)((void *)0);
#line 462
    orig_what = new_what;
#line 463
    whats = (char **)((void *)0);
#line 464
    misc = (char *)((void *)0);
    {
#line 466
    tmp___20 = feof(stdin);
    }
    }
#line 466
    if (tmp___20) {
#line 467
      return;
    }
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
}
}
#line 473 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void do_convert_to_context(void) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long linenum___1 ;
  ssize_t got ;
  __ssize_t tmp ;
  int is_context ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;

  {
  {
#line 475
  line = (char *)((void *)0);
#line 476
  linelen = (size_t )0;
#line 477
  linenum___1 = 0UL;
  {
#line 478
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)stdin);
  }
#line 478
  got = tmp;
  }
#line 480
  if (got == -1) {
#line 481
    return;
  }
#line 482
  linenum___1 ++;
  {
  {
#line 484
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 485
    is_context = 0;
    {
    {
#line 487
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 488
      tmp___0 = feof(stdin);
      }
      }
#line 488
      if (tmp___0) {
#line 489
        goto eof;
      }
      {
      {
#line 491
      tmp___1 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 491
      if (! tmp___1) {
#line 492
        is_context = 0;
#line 493
        goto while_break___0;
      }
      {
      {
#line 496
      tmp___2 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 496
      if (! tmp___2) {
#line 497
        is_context = 1;
#line 498
        goto while_break___0;
      }
      {
      {
#line 501
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 503
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 504
      if (got == -1) {
#line 505
        goto eof;
      }
#line 506
      linenum___1 ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 509
    if (is_context) {
      {
      {
#line 510
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 511
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 512
      if (got == -1) {
#line 513
        goto eof;
      }
      {
#line 514
      linenum___1 ++;
      {
#line 516
      tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 516
      if (tmp___3) {
#line 517
        goto __Cont;
      }
      {
      {
#line 519
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 520
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 521
      if (got == -1) {
#line 522
        goto eof;
      }
      {
#line 523
      linenum___1 ++;
      {
#line 525
      tmp___4 = strncmp((char const   *)line, "***************", (size_t )15);
      }
      }
#line 525
      if (tmp___4) {
#line 526
        goto __Cont;
      }
      {
      {
#line 528
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 529
      copy_context_hunks(& line, & linelen, & got, & linenum___1);
      }
      }
    } else {
      {
      {
#line 531
      printf((char const   */* __restrict  */)"*** %s", line + 4);
      }
      {
#line 532
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 533
      if (got == -1) {
#line 534
        goto eof;
      }
      {
#line 535
      linenum___1 ++;
      {
#line 537
      tmp___5 = strncmp((char const   *)line, "+++ ", (size_t )4);
      }
      }
#line 537
      if (tmp___5) {
#line 538
        goto __Cont;
      }
      {
      {
#line 540
      printf((char const   */* __restrict  */)"--- ");
      }
      {
#line 541
      fwrite((void const   */* __restrict  */)(line + 4), (size_t )got - 4U, (size_t )1,
             (FILE */* __restrict  */)stdout);
      }
      {
#line 542
      puts("***************");
      }
      {
#line 543
      convert_unified_hunks_to_context(& line, & linelen, & linenum___1);
      }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  eof: 
#line 549
  if (line) {
    {
    {
#line 550
    free((void *)line);
    }
    }
  }
#line 552
  return;
}
}
#line 555 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void copy_unified_hunks(char **line , size_t *linelen , ssize_t *got , unsigned long *linenum___1 ) 
{ 
  unsigned long orig_count ;
  unsigned long new_count ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;

  {
#line 558
  orig_count = 0UL;
#line 558
  new_count = 0UL;
  {
  {
#line 561
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 562
    tmp = feof(stdin);
    }
    }
#line 562
    if (tmp) {
#line 563
      return;
    }
    {
    {
#line 565
    *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                   (FILE */* __restrict  */)stdin);
    }
    }
#line 566
    if (*got == -1) {
#line 567
      return;
    }
#line 568
    (*linenum___1) ++;
#line 570
    if (! orig_count) {
#line 570
      if (! new_count) {
#line 570
        if ((int )*(*line) != 92) {
          {
          {
#line 571
          tmp___0 = strncmp((char const   *)*line, "@@ ", (size_t )3);
          }
          }
#line 571
          if (tmp___0) {
#line 572
            goto while_break;
          }
          {
          {
#line 574
          tmp___1 = read_atatline((char const   *)*line, & orig_offset, & orig_count,
                                  & new_offset, & new_count);
          }
          }
#line 574
          if (tmp___1) {
            {
            {
#line 576
            error(1, 0, "line %lu not understood: %s", *linenum___1, *line);
            }
            }
          }
          {
          {
#line 580
          fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
          }
#line 581
          goto __Cont;
        }
      }
    }
#line 584
    if (orig_count) {
#line 584
      if ((int )*(*line) != 43) {
#line 585
        orig_count --;
      }
    }
#line 586
    if (new_count) {
#line 586
      if ((int )*(*line) != 45) {
#line 587
        new_count --;
      }
    }
    {
    {
#line 589
    fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1, (FILE */* __restrict  */)stdout);
    }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 591
  return;
}
}
#line 593 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void convert_context_hunks_to_unified(char **line , size_t *linelen , unsigned long *linenum___1 ) 
{ 
  int happy ;
  size_t i ;
  char *misc ;
  unsigned long unchanged ;
  unsigned long line_start[2] ;
  unsigned long line_end ;
  unsigned long line_count[2] ;
  char *n ;
  char *end ;
  char **lines___1[2] ;
  size_t *linelengths[2] ;
  size_t n_lines[2] ;
  size_t at[2] ;
  ssize_t got ;
  int first ;
  unsigned long lnum ;
  int tmp ;
  __ssize_t tmp___0 ;
  char *m ;
  int tmp___1 ;
  int tmp___2 ;
  char const   *tmp___3 ;
  int tmp___4 ;
  char const   *tmp___5 ;
  void *tmp___6 ;
  void *tmp___7 ;
  int tmp___8 ;
  void *tmp___9 ;
  char *l[2] ;
  size_t llen[2] ;
  int tmp___10 ;
  void *__cil_tmp35 ;
  void *__cil_tmp36 ;
  void *__cil_tmp37 ;
  void *__cil_tmp38 ;
  void *__cil_tmp39 ;
  void *__cil_tmp40 ;
  void *__cil_tmp41 ;
  void *__cil_tmp42 ;
  char *__cil_tmp43 ;
  char *__cil_tmp44 ;
  char *__cil_tmp45 ;
  char *__cil_tmp46 ;
  char *__cil_tmp47 ;
  char *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;

  {
#line 596
  happy = 1;
  {
  {
#line 598
  while (1) {
    while_continue___7: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 598
    if (! happy) {
#line 598
      goto while_break;
    }
#line 600
    misc = (char *)((void *)0);
#line 601
    unchanged = 0UL;
#line 610
    n_lines[1] = (size_t )0;
#line 610
    n_lines[0] = n_lines[1];
#line 611
    linelengths[1] = (size_t *)((void *)0);
#line 611
    linelengths[0] = linelengths[1];
#line 612
    lines___1[1] = (char **)((void *)0);
#line 612
    lines___1[0] = lines___1[1];
#line 614
    i = (size_t )0;
    {
    {
#line 614
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 614
      if (! (i < 2U)) {
#line 614
        goto while_break___0;
      }
      {
#line 615
      first = 1;
      {
#line 618
      tmp = feof(stdin);
      }
      }
#line 618
      if (tmp) {
#line 619
        goto eof;
      }
      {
      {
#line 621
      tmp___0 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                        (FILE */* __restrict  */)stdin);
      }
      }
#line 621
      if (tmp___0 == -1) {
#line 622
        goto eof;
      }
#line 623
      (*linenum___1) ++;
#line 625
      if (! i) {
        {
        {
#line 625
        tmp___2 = strncmp((char const   *)*line, "***************", (size_t )15);
        }
        }
#line 625
        if (! tmp___2) {
          {
#line 626
          m = *line + 15;
          {
#line 627
          tmp___1 = strcmp((char const   *)m, "\n");
          }
          }
#line 627
          if (tmp___1) {
            {
            {
#line 628
            misc = xstrdup((char const   *)m);
            }
            }
          }
#line 629
          i --;
#line 630
          goto __Cont;
        }
      }
#line 633
      if (i) {
#line 633
        tmp___3 = "--- ";
      } else {
#line 633
        tmp___3 = "*** ";
      }
      {
      {
#line 633
      tmp___4 = strncmp((char const   *)*line, tmp___3, (size_t )4);
      }
      }
#line 633
      if (tmp___4) {
#line 634
        goto unhappy;
      }
      do_line_counts: 
      {
#line 637
      n = *line + 4;
      {
#line 638
      line_start[i] = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                              10);
      }
      }
#line 639
      if ((unsigned long )n == (unsigned long )end) {
#line 640
        goto unhappy;
      }
#line 642
      if ((int )*end == 44) {
        {
#line 643
        n = end + 1;
        {
#line 644
        line_end = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
        }
        }
#line 645
        if ((unsigned long )n == (unsigned long )end) {
#line 646
          goto unhappy;
        }
#line 648
        if (line_start[i] > line_end) {
#line 649
          goto unhappy;
        }
#line 651
        line_count[i] = (line_end - line_start[i]) + 1UL;
      } else {
#line 653
        line_end = line_start[i];
#line 654
        if (line_start[i]) {
#line 654
          line_count[i] = 1UL;
        } else {
#line 654
          line_count[i] = 0UL;
        }
      }
#line 657
      if (i) {
#line 657
        tmp___5 = "----";
      } else {
#line 657
        tmp___5 = "****";
      }
      {
      {
#line 657
      n = strstr((char const   *)n, tmp___5);
      }
      }
#line 658
      if (! misc) {
        {
        {
#line 659
        misc = xstrdup((char const   *)(n + 4));
        }
        }
      }
#line 661
      if (i) {
#line 661
        if (line_count[i] == unchanged) {
#line 662
          goto while_break___0;
        }
      }
      {
#line 664
      n_lines[i] = (size_t )line_count[i];
      {
#line 665
      tmp___6 = xmalloc((size_t )(sizeof(char *) * line_count[i]));
      }
#line 665
      lines___1[i] = (char **)tmp___6;
      {
#line 666
      tmp___7 = xmalloc((size_t )(sizeof(size_t ) * line_count[i]));
      }
#line 666
      linelengths[i] = (size_t *)tmp___7;
      {
#line 668
      memset((void *)lines___1[i], 0, (size_t )(sizeof(char *) * line_count[i]));
      }
#line 670
      lnum = 0UL;
      }
      {
      {
#line 670
      while (1) {
        while_continue___9: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 670
        if (! (lnum < line_count[i])) {
#line 670
          goto while_break___1;
        }
        {
        {
#line 671
        got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                      (FILE */* __restrict  */)stdin);
        }
        }
#line 672
        if (got == -1) {
#line 673
          goto eof;
        }
#line 674
        (*linenum___1) ++;
#line 676
        if (! i) {
#line 676
          if (first) {
            {
#line 677
            first = 0;
            {
#line 678
            tmp___8 = strncmp((char const   *)*line, "--- ", (size_t )4);
            }
            }
#line 678
            if (! tmp___8) {
#line 680
              n_lines[i] = (size_t )0;
#line 681
              i ++;
#line 682
              goto do_line_counts;
            }
          }
        }
        {
        {
#line 686
        tmp___9 = xmalloc((size_t )got + 1U);
        }
#line 686
        *(lines___1[i] + lnum) = (char *)tmp___9;
        {
#line 687
        memcpy((void */* __restrict  */)*(lines___1[i] + lnum), (void const   */* __restrict  */)*line,
               (size_t )got);
        }
#line 688
        *(*(lines___1[i] + lnum) + got) = (char )'\000';
#line 689
        *(linelengths[i] + lnum) = (size_t )got;
        }
#line 690
        if ((int )*(*line) == 32) {
#line 691
          unchanged ++;
        }
#line 670
        lnum ++;
      }
      while_break___9: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
      __Cont: /* CIL Label */ 
#line 614
      i ++;
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
    {
#line 695
    printf((char const   */* __restrict  */)"@@ -%lu", line_start[0]);
    }
    }
#line 696
    if (line_count[0] != 1UL) {
      {
      {
#line 697
      printf((char const   */* __restrict  */)",%lu", line_count[0]);
      }
      }
    }
    {
    {
#line 699
    printf((char const   */* __restrict  */)" +%lu", line_start[1]);
    }
    }
#line 700
    if (line_count[1] != 1UL) {
      {
      {
#line 701
      printf((char const   */* __restrict  */)",%lu", line_count[1]);
      }
      }
    }
    {
    {
#line 703
    printf((char const   */* __restrict  */)" @@%s", misc);
    }
#line 706
    at[1] = (size_t )0;
#line 706
    at[0] = at[1];
    }
    {
    {
#line 707
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
#line 707
      if (! (at[0] < n_lines[0])) {
#line 707
        if (! (at[1] < n_lines[1])) {
#line 707
          goto while_break___2;
        }
      }
#line 708
      l[0] = (char *)((void *)0);
#line 708
      l[1] = (char *)((void *)0);
#line 710
      if (lines___1[0]) {
#line 710
        if (at[0] < n_lines[0]) {
#line 711
          l[0] = *(lines___1[0] + at[0]);
#line 712
          llen[0] = *(linelengths[0] + at[0]);
        }
      }
#line 714
      if (lines___1[1]) {
#line 714
        if (at[1] < n_lines[1]) {
#line 715
          l[1] = *(lines___1[1] + at[1]);
#line 716
          llen[1] = *(linelengths[1] + at[1]);
        }
      }
#line 719
      if (l[0]) {
#line 719
        if ((int )*(l[0]) == 32) {
#line 719
          if (l[1]) {
#line 719
            if ((int )*(l[1]) == 32) {
              {
              {
#line 720
              fwrite((void const   */* __restrict  */)(l[0] + 1), llen[0] - 1U, (size_t )1,
                     (FILE */* __restrict  */)stdout);
              }
#line 721
              (at[0]) ++;
#line 722
              (at[1]) ++;
              }
            } else {
#line 719
              goto _L___12;
            }
          } else {
#line 719
            goto _L___12;
          }
        } else {
#line 719
          goto _L___12;
        }
      } else
      _L___12: /* CIL Label */ 
#line 723
      if (l[0]) {
#line 723
        if ((int )*(l[0]) == 32) {
#line 723
          if (! l[1]) {
            {
            {
#line 724
            fwrite((void const   */* __restrict  */)(l[0] + 1), llen[0] - 1U, (size_t )1,
                   (FILE */* __restrict  */)stdout);
            }
#line 725
            (at[0]) ++;
            }
          } else {
#line 723
            goto _L___9;
          }
        } else {
#line 723
          goto _L___9;
        }
      } else
      _L___9: /* CIL Label */ 
#line 726
      if (l[0]) {
#line 726
        if ((int )*(l[0]) == 45) {
          {
          {
#line 727
          putchar('-');
          }
          {
#line 728
          fwrite((void const   */* __restrict  */)(l[0] + 2), llen[0] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 729
          (at[0]) ++;
          }
        } else {
#line 726
          goto _L___7;
        }
      } else
      _L___7: /* CIL Label */ 
#line 730
      if (l[1]) {
#line 730
        if ((int )*(l[1]) == 43) {
          {
          {
#line 731
          putchar('+');
          }
          {
#line 732
          fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 733
          (at[1]) ++;
          }
        } else {
#line 730
          goto _L___6;
        }
      } else
      _L___6: /* CIL Label */ 
#line 734
      if (l[0]) {
#line 734
        if ((int )*(l[0]) == 33) {
#line 734
          if (l[1]) {
#line 734
            if ((int )*(l[1]) == 33) {
              {
              {
#line 736
              while (1) {
                while_continue___11: /* CIL Label */ ;
                while_continue___3: /* CIL Label */ ;
#line 736
                if (at[0] < n_lines[0]) {
#line 736
                  if (! ((int )*(*(lines___1[0] + at[0])) == 33)) {
#line 736
                    goto while_break___3;
                  }
                } else {
#line 736
                  goto while_break___3;
                }
                {
                {
#line 738
                putchar('-');
                }
                {
#line 739
                fwrite((void const   */* __restrict  */)(*(lines___1[0] + at[0]) + 2),
                       *(linelengths[0] + at[0]) - 2U, (size_t )1, (FILE */* __restrict  */)stdout);
                }
#line 742
                (at[0]) ++;
                }
              }
              while_break___11: /* CIL Label */ ;
              }
              while_break___3: /* CIL Label */ ;
              }
              {
              {
#line 744
              while (1) {
                while_continue___12: /* CIL Label */ ;
                while_continue___4: /* CIL Label */ ;
#line 744
                if (at[1] < n_lines[1]) {
#line 744
                  if (! ((int )*(*(lines___1[1] + at[1])) == 33)) {
#line 744
                    goto while_break___4;
                  }
                } else {
#line 744
                  goto while_break___4;
                }
                {
                {
#line 746
                putchar('+');
                }
                {
#line 747
                fwrite((void const   */* __restrict  */)(*(lines___1[1] + at[1]) + 2),
                       *(linelengths[1] + at[1]) - 2U, (size_t )1, (FILE */* __restrict  */)stdout);
                }
#line 750
                (at[1]) ++;
                }
              }
              while_break___12: /* CIL Label */ ;
              }
              while_break___4: /* CIL Label */ ;
              }
            } else {
#line 734
              goto _L___5;
            }
          } else {
#line 734
            goto _L___5;
          }
        } else {
#line 734
          goto _L___5;
        }
      } else
      _L___5: /* CIL Label */ 
#line 752
      if (l[0]) {
#line 752
        if ((int )*(l[0]) == 33) {
          {
          {
#line 753
          putchar('-');
          }
          {
#line 754
          fwrite((void const   */* __restrict  */)(l[0] + 2), llen[0] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 755
          (at[0]) ++;
          }
        } else {
#line 752
          goto _L___2;
        }
      } else
      _L___2: /* CIL Label */ 
#line 756
      if (l[1]) {
#line 756
        if ((int )*(l[1]) == 33) {
          {
          {
#line 757
          putchar('+');
          }
          {
#line 758
          fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 759
          (at[1]) ++;
          }
        } else {
#line 756
          goto _L___1;
        }
      } else
      _L___1: /* CIL Label */ 
#line 760
      if (l[0]) {
#line 760
        if ((int )*(l[0]) == 92) {
          {
          {
#line 761
          fwrite((void const   */* __restrict  */)l[0], llen[0], (size_t )1, (FILE */* __restrict  */)stdout);
          }
          {
#line 762
          putchar('\n');
          }
#line 763
          (at[0]) ++;
          }
        } else {
#line 760
          goto _L___0;
        }
      } else
      _L___0: /* CIL Label */ 
#line 764
      if (l[1]) {
#line 764
        if ((int )*(l[1]) == 92) {
          {
          {
#line 765
          fwrite((void const   */* __restrict  */)l[1], llen[1], (size_t )1, (FILE */* __restrict  */)stdout);
          }
          {
#line 766
          putchar('\n');
          }
#line 767
          (at[1]) ++;
          }
        } else {
#line 764
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 768
      if (! l[0]) {
        {
        {
#line 769
        putchar((int )*(l[1]));
        }
        {
#line 770
        fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
               (FILE */* __restrict  */)stdout);
        }
#line 771
        (at[1]) ++;
        }
      } else {
        {
        {
#line 773
        printf((char const   */* __restrict  */)"Don\'t know how to handle this:\n1: %s2: %s",
               l[0], l[1]);
        }
        {
#line 775
        exit(1);
        }
        }
      }
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
    eof: 
    {
    {
#line 780
    free((void *)misc);
    }
#line 781
    i = (size_t )0;
    }
    {
    {
#line 781
    while (1) {
      while_continue___13: /* CIL Label */ ;
      while_continue___5: /* CIL Label */ ;
#line 781
      if (! (i < n_lines[0])) {
#line 781
        goto while_break___5;
      }
      {
      {
#line 782
      free((void *)*(lines___1[0] + i));
      }
#line 781
      i ++;
      }
    }
    while_break___13: /* CIL Label */ ;
    }
    while_break___5: /* CIL Label */ ;
    }
#line 783
    i = (size_t )0;
    {
    {
#line 783
    while (1) {
      while_continue___14: /* CIL Label */ ;
      while_continue___6: /* CIL Label */ ;
#line 783
      if (! (i < n_lines[1])) {
#line 783
        goto while_break___6;
      }
      {
      {
#line 784
      free((void *)*(lines___1[1] + i));
      }
#line 783
      i ++;
      }
    }
    while_break___14: /* CIL Label */ ;
    }
    while_break___6: /* CIL Label */ ;
    }
    {
    {
#line 785
    free((void *)lines___1[0]);
    }
    {
#line 786
    free((void *)linelengths[0]);
    }
    {
#line 787
    free((void *)lines___1[1]);
    }
    {
#line 788
    free((void *)linelengths[1]);
    }
    {
#line 790
    tmp___10 = feof(stdin);
    }
    }
#line 790
    if (tmp___10) {
#line 791
      return;
    }
#line 793
    goto while_continue;
    unhappy: 
#line 796
    happy = 0;
#line 797
    goto eof;
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 799
  return;
}
}
#line 803 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void do_convert_to_unified(void) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long linenum___1 ;
  ssize_t got ;
  __ssize_t tmp ;
  int is_context ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;

  {
  {
#line 805
  line = (char *)((void *)0);
#line 806
  linelen = (size_t )0;
#line 807
  linenum___1 = 0UL;
  {
#line 808
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)stdin);
  }
#line 808
  got = tmp;
  }
#line 810
  if (got == -1) {
#line 811
    return;
  }
#line 812
  linenum___1 ++;
  {
  {
#line 814
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 815
    is_context = 0;
    {
    {
#line 817
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 818
      tmp___0 = feof(stdin);
      }
      }
#line 818
      if (tmp___0) {
#line 819
        goto eof;
      }
      {
      {
#line 821
      tmp___1 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 821
      if (! tmp___1) {
#line 822
        is_context = 0;
#line 823
        goto while_break___0;
      }
      {
      {
#line 826
      tmp___2 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 826
      if (! tmp___2) {
#line 827
        is_context = 1;
#line 828
        goto while_break___0;
      }
      {
      {
#line 831
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 833
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 834
      if (got == -1) {
#line 835
        goto eof;
      }
#line 836
      linenum___1 ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 839
    if (is_context) {
      {
      {
#line 840
      printf((char const   */* __restrict  */)"--- %s", line + 4);
      }
      {
#line 841
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 842
      if (got == -1) {
#line 843
        goto eof;
      }
      {
#line 844
      linenum___1 ++;
      {
#line 846
      tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 846
      if (tmp___3) {
#line 847
        goto __Cont;
      }
      {
      {
#line 849
      printf((char const   */* __restrict  */)"+++ ");
      }
      {
#line 850
      fwrite((void const   */* __restrict  */)(line + 4), (size_t )got - 4U, (size_t )1,
             (FILE */* __restrict  */)stdout);
      }
      {
#line 851
      convert_context_hunks_to_unified(& line, & linelen, & linenum___1);
      }
      }
    } else {
      {
      {
#line 854
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 855
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 856
      if (got == -1) {
#line 857
        goto eof;
      }
      {
#line 858
      linenum___1 ++;
      {
#line 860
      tmp___4 = strncmp((char const   *)line, "+++ ", (size_t )4);
      }
      }
#line 860
      if (tmp___4) {
#line 861
        goto __Cont;
      }
      {
      {
#line 863
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 864
      copy_unified_hunks(& line, & linelen, & got, & linenum___1);
      }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  eof: 
#line 869
  if (line) {
    {
    {
#line 870
    free((void *)line);
    }
    }
  }
#line 872
  return;
}
}
#line 875 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static FILE *do_convert(FILE *f , char const   *mode___3 , int seekable , void (*fn)(void) ) 
{ 
  int fildes[2] ;
  int fd ;
  int tmp ;
  FILE *ret ;
  char *tmp___0 ;
  char *tmp___1 ;
  int *tmp___2 ;
  int tmp___3 ;
  __pid_t tmp___4 ;
  int *tmp___5 ;
  FILE *tmp___6 ;
  FILE *tmp___7 ;
  int c ;
  int tmp___8 ;
  int tmp___9 ;
  char *tmp___10 ;
  char *tmp___11 ;
  int *tmp___12 ;
  int tmp___13 ;
  __pid_t tmp___14 ;
  int *tmp___15 ;
  FILE *tmp___16 ;
  char *tmp___17 ;
  char *tmp___18 ;
  void *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;

  {
  {
  {
#line 879
  tmp = fileno(f);
  }
#line 879
  fd = tmp;
  {
#line 882
  fflush((FILE *)((void *)0));
  }
  {
#line 883
  tmp___18 = strchr(mode___3, 'r');
  }
  }
#line 883
  if (tmp___18) {
    {
    {
#line 884
    tmp___0 = strchr(mode___3, 'w');
    }
    }
#line 884
    if (tmp___0) {
#line 886
      return ((FILE *)((void *)0));
    } else {
      {
      {
#line 884
      tmp___1 = strchr(mode___3, '+');
      }
      }
#line 884
      if (tmp___1) {
#line 886
        return ((FILE *)((void *)0));
      }
    }
    {
    {
#line 892
    tmp___3 = pipe((int *)(fildes));
    }
    }
#line 892
    if (tmp___3) {
      {
      {
#line 893
      tmp___2 = __errno_location();
      }
      {
#line 893
      error(1, *tmp___2, "pipe failed");
      }
      }
    }
    {
    {
#line 895
    tmp___4 = fork();
    }
    }
    {
#line 896
    if (tmp___4 == -1) {
#line 896
      goto case_neg_1;
    }
#line 921
    if (tmp___4 == 0) {
#line 921
      goto case_0;
    }
#line 899
    goto switch_default;
    case_neg_1: /* CIL Label */ 
    {
    {
#line 897
    tmp___5 = __errno_location();
    }
    {
#line 897
    error(1, *tmp___5, "fork failed");
    }
    }
    switch_default: /* CIL Label */ 
    {
    {
#line 901
    close(fildes[1]);
    }
    {
#line 902
    ret = fdopen(fildes[0], mode___3);
    }
    }
#line 904
    if (seekable) {
      {
      {
#line 905
      tmp___7 = xtmpfile();
      }
#line 905
      tmp___6 = tmp___7;
      }
      {
      {
#line 906
      while (1) {
        while_continue___0: /* CIL Label */ ;
        while_continue: /* CIL Label */ ;
        {
        {
#line 906
        tmp___9 = feof(ret);
        }
        }
#line 906
        if (tmp___9) {
#line 906
          goto while_break;
        }
        {
        {
#line 907
        tmp___8 = fgetc(ret);
        }
#line 907
        c = tmp___8;
        }
#line 909
        if (c == -1) {
#line 910
          goto while_break;
        }
        {
        {
#line 912
        fputc(c, tmp___6);
        }
        }
      }
      while_break___0: /* CIL Label */ ;
      }
      while_break: /* CIL Label */ ;
      }
      {
      {
#line 915
      rewind(tmp___6);
      }
      }
#line 916
      return (tmp___6);
    }
#line 919
    return (ret);
    case_0: /* CIL Label */ 
    {
    {
#line 932
    close(fildes[0]);
    }
    }
#line 934
    if (fd != 0) {
      {
      {
#line 935
      dup2(fd, 0);
      }
      {
#line 936
      fclose(f);
      }
      }
    }
#line 939
    if (fildes[1] != 1) {
      {
      {
#line 940
      dup2(fildes[1], 1);
      }
      }
    }
    {
    {
#line 942
    (*fn)();
    }
    {
#line 943
    exit(0);
    }
    }
    switch_break: /* CIL Label */ ;
    }
  } else {
    {
    {
#line 946
    tmp___17 = strchr(mode___3, 'w');
    }
    }
#line 946
    if (tmp___17) {
      {
      {
#line 947
      tmp___10 = strchr(mode___3, 'r');
      }
      }
#line 947
      if (tmp___10) {
#line 949
        return ((FILE *)((void *)0));
      } else {
        {
        {
#line 947
        tmp___11 = strchr(mode___3, '+');
        }
        }
#line 947
        if (tmp___11) {
#line 949
          return ((FILE *)((void *)0));
        }
      }
      {
      {
#line 954
      tmp___13 = pipe((int *)(fildes));
      }
      }
#line 954
      if (tmp___13) {
        {
        {
#line 955
        tmp___12 = __errno_location();
        }
        {
#line 955
        error(1, *tmp___12, "pipe failed");
        }
        }
      }
      {
      {
#line 957
      tmp___14 = fork();
      }
      }
      {
#line 958
      if (tmp___14 == -1) {
#line 958
        goto case_neg_1___0;
      }
#line 966
      if (tmp___14 == 0) {
#line 966
        goto case_0___0;
      }
#line 961
      goto switch_default___0;
      case_neg_1___0: /* CIL Label */ 
      {
      {
#line 959
      tmp___15 = __errno_location();
      }
      {
#line 959
      error(1, *tmp___15, "fork failed");
      }
      }
      switch_default___0: /* CIL Label */ 
      {
      {
#line 963
      close(fildes[1]);
      }
      {
#line 964
      tmp___16 = fdopen(fildes[1], mode___3);
      }
      }
#line 964
      return (tmp___16);
      case_0___0: /* CIL Label */ 
      {
      {
#line 974
      close(fildes[0]);
      }
      }
#line 976
      if (fildes[0] != 0) {
        {
        {
#line 977
        dup2(fildes[0], 0);
        }
        }
      }
#line 979
      if (fd != 1) {
        {
        {
#line 980
        dup2(fd, 1);
        }
        {
#line 981
        fclose(f);
        }
        }
      }
      {
      {
#line 984
      (*fn)();
      }
      {
#line 985
      exit(0);
      }
      }
      switch_break___0: /* CIL Label */ ;
      }
    }
  }
#line 989
  return ((FILE *)((void *)0));
}
}
#line 992 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
FILE *convert_to_context(FILE *f , char const   *mode___3 , int seekable ) 
{ 
  FILE *tmp ;

  {
  {
  {
#line 994
  tmp = do_convert(f, mode___3, seekable, & do_convert_to_context);
  }
  }
#line 994
  return (tmp);
}
}
#line 997 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
FILE *convert_to_unified(FILE *f , char const   *mode___3 , int seekable ) 
{ 
  FILE *tmp ;

  {
  {
  {
#line 999
  tmp = do_convert(f, mode___3, seekable, & do_convert_to_unified);
  }
  }
#line 999
  return (tmp);
}
}
#line 1002 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static int read_timezone(char const   *tz ) 
{ 
  int zone ;
  char *endptr ;
  size_t tmp ;
  long tmp___0 ;
  char *__cil_tmp6 ;

  {
  {
#line 1005
  zone = -1;
  {
#line 1008
  tmp = strspn(tz, " ");
  }
#line 1008
  tz += tmp;
  {
#line 1009
  tmp___0 = strtol((char const   */* __restrict  */)tz, (char **/* __restrict  */)(& endptr),
                   10);
  }
#line 1009
  zone = (int )tmp___0;
  }
#line 1010
  if ((unsigned long )tz == (unsigned long )endptr) {
#line 1011
    zone = -1;
  }
#line 1013
  return (zone);
}
}
#line 1016 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
int read_timestamp(char const   *timestamp , struct tm *result , long *zone ) 
{ 
  char *end ;
  struct tm tm_t ;
  long zone_t ;
  size_t tmp ;
  size_t tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;

  {
#line 1023
  if (! result) {
#line 1024
    result = & tm_t;
  }
#line 1025
  if (! zone) {
#line 1026
    zone = & zone_t;
  }
  {
  {
#line 1028
  tmp = strspn(timestamp, " \t");
  }
#line 1028
  timestamp += tmp;
  {
#line 1031
  end = strptime((char const   */* __restrict  */)timestamp, (char const   */* __restrict  */)"%Y-%m-%d %H:%M:%S",
                 result);
  }
  }
#line 1032
  if (end) {
#line 1034
    if ((int )*end == 46) {
      {
#line 1035
      end ++;
      {
#line 1036
      tmp___0 = strspn((char const   *)end, "0123456789");
      }
#line 1036
      end += tmp___0;
      }
    }
    {
    {
#line 1039
    tmp___1 = read_timezone((char const   *)end);
    }
#line 1039
    *zone = (long )tmp___1;
    }
  } else {
    {
    {
#line 1042
    end = strptime((char const   */* __restrict  */)timestamp, (char const   */* __restrict  */)"%a %b %e %T %Y",
                   result);
    }
    }
#line 1042
    if (end) {
      {
      {
#line 1043
      tmp___2 = read_timezone((char const   *)end);
      }
#line 1043
      *zone = (long )tmp___2;
      }
    } else {
      {
      {
#line 1044
      end = strptime((char const   */* __restrict  */)timestamp, (char const   */* __restrict  */)"%b %Y %H:%M:%S",
                     result);
      }
      }
#line 1044
      if (end) {
        {
        {
#line 1046
        tmp___3 = read_timezone((char const   *)end);
        }
#line 1046
        *zone = (long )tmp___3;
        }
      } else {
#line 1048
        return (1);
      }
    }
  }
#line 1051
  return (0);
}
}
#line 1054 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
char *filename_from_header(char const   *header ) 
{ 
  int first_space ;
  size_t tmp ;
  int h ;
  int i ;
  size_t tmp___0 ;
  int tmp___1 ;
  size_t tmp___2 ;
  char *tmp___3 ;
  char *__cil_tmp10 ;
  char *__cil_tmp11 ;
  char *__cil_tmp12 ;

  {
  {
  {
#line 1057
  tmp = strcspn(header, " \t\n");
  }
#line 1057
  first_space = (int )tmp;
#line 1058
  h = first_space;
  }
  {
  {
#line 1059
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1059
    if (! ((int const   )*(header + h) == 32)) {
#line 1059
      goto while_break;
    }
    {
    {
#line 1061
    tmp___0 = strspn(header + h, " \t");
    }
#line 1061
    i = (int )tmp___0;
    }
#line 1062
    if (! *(header + (h + i))) {
#line 1063
      goto while_break;
    }
    {
    {
#line 1064
    tmp___1 = read_timestamp((header + h) + i, (struct tm *)((void *)0), (long *)((void *)0));
    }
    }
#line 1064
    if (! tmp___1) {
#line 1065
      goto while_break;
    }
    {
#line 1066
    h += i + 1;
    {
#line 1067
    tmp___2 = strcspn(header + h, " \t\n");
    }
#line 1067
    h = (int )((size_t )h + tmp___2);
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1070
  if ((int const   )*(header + h) == 10) {
#line 1070
    if (h > first_space) {
#line 1073
      h = first_space;
    }
  }
  {
  {
#line 1075
  tmp___3 = xstrndup(header, (size_t const   )h);
  }
  }
#line 1075
  return (tmp___3);
}
}
/* compiler builtin: 
   void __builtin_va_arg(__builtin_va_list  , unsigned long  , void * ) ;  */
/* compiler builtin: 
   void __builtin_va_start(__builtin_va_list  ) ;  */
/* compiler builtin: 
   void __builtin_va_end(__builtin_va_list  ) ;  */
#line 65 "/usr/include/fnmatch.h"
extern int fnmatch(char const   *__pattern , char const   *__name , int __flags ) ;
#line 172 "/usr/include/stdio.h"
extern FILE *tmpfile(void) ;
#line 249
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 604
extern char *fgets(char * __restrict  __s , int __n , FILE * __restrict  __stream ) ;
#line 682
extern size_t fread(void * __restrict  __ptr , size_t __size , size_t __n , FILE * __restrict  __stream ) ;
#line 722
extern int fseek(FILE *__stream , long __off , int __whence ) ;
#line 803
extern  __attribute__((__nothrow__)) int ferror(FILE *__stream ) ;
#line 819
extern void perror(char const   *__s ) ;
#line 471 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *malloc(size_t __size )  __attribute__((__malloc__)) ;
#line 485
extern  __attribute__((__nothrow__)) void *( __attribute__((__warn_unused_result__)) realloc)(void *__ptr ,
                                                                                              size_t __size ) ;
#line 566
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1))) getenv)(char const   *__name ) ;
#line 615
extern int ( __attribute__((__nonnull__(1))) mkstemp)(char *__template ) ;
#line 127 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2))) strcpy)(char * __restrict  __dest ,
                                                                                       char const   * __restrict  __src ) ;
#line 130
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2))) strncpy)(char * __restrict  __dest ,
                                                                                        char const   * __restrict  __src ,
                                                                                        size_t __n ) ;
#line 526 "/usr/include/unistd.h"
extern  __attribute__((__nothrow__)) int dup(int __fd ) ;
#line 573
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1))) execvp)(char const   *__file ,
                                                                                   char * const  *__argv ) ;
#line 139 "/usr/include/sys/wait.h"
extern __pid_t waitpid(__pid_t __pid , int *__stat_loc , int __options ) ;
#line 36 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.h"
void *xrealloc(void *ptr , size_t size ) ;
#line 42
int xmkstemp(char *pattern ) ;
#line 46
FILE *xopen(char const   *name , char const   *mode___3 ) ;
#line 47
FILE *xopen_seekable(char const   *name , char const   *mode___3 ) ;
#line 48
FILE *xopen_unzip(char const   *name , char const   *mode___3 ) ;
#line 49
FILE *xpipe(char const   *cmd , pid_t *pid , char const   *mode___3  , ...) ;
#line 54
void patlist_add(struct patlist **dst , char const   *s ) ;
#line 56
void patlist_add_file(struct patlist **dst , char const   *fn ) ;
#line 59
int patlist_match(struct patlist *list , char const   *s ) ;
#line 62
void patlist_free(struct patlist **list ) ;
#line 64
char *progname ;
#line 65
void set_progname(char const   *s ) ;
#line 52 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
void *xmalloc(size_t size ) 
{ 
  void *res ;
  void *tmp ;
  int *tmp___0 ;
  char *__cil_tmp5 ;

  {
  {
  {
#line 54
  tmp = malloc(size);
  }
#line 54
  res = tmp;
  }
#line 55
  if (! res) {
    {
    {
#line 56
    tmp___0 = __errno_location();
    }
    {
#line 56
    error(1, *tmp___0, "malloc");
    }
    }
  }
#line 57
  return (res);
}
}
#line 60 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
void *xrealloc(void *ptr , size_t size ) 
{ 
  void *res ;
  void *tmp ;
  int *tmp___0 ;
  char *__cil_tmp6 ;

  {
  {
  {
#line 62
  tmp = realloc(ptr, size);
  }
#line 62
  res = tmp;
  }
#line 63
  if (! res) {
    {
    {
#line 64
    tmp___0 = __errno_location();
    }
    {
#line 64
    error(1, *tmp___0, "realloc");
    }
    }
  }
#line 65
  return (res);
}
}
#line 69 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
char *xstrdup(char const   *s ) 
{ 
  size_t len ;
  size_t tmp ;
  char *result ;
  void *tmp___0 ;

  {
  {
  {
#line 71
  tmp = strlen(s);
  }
#line 71
  len = tmp + 1U;
  {
#line 72
  tmp___0 = xmalloc(len);
  }
#line 72
  result = (char *)tmp___0;
  {
#line 73
  memcpy((void */* __restrict  */)result, (void const   */* __restrict  */)s, len);
  }
  }
#line 74
  return (result);
}
}
#line 78 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
char *xstrndup(char const   *s , size_t const   n ) 
{ 
  char *result ;
  void *tmp ;

  {
  {
  {
#line 81
  tmp = xmalloc((size_t )(n + 1U));
  }
#line 81
  result = (char *)tmp;
  {
#line 82
  strncpy((char */* __restrict  */)result, (char const   */* __restrict  */)s, (size_t )n);
  }
#line 83
  *(result + n) = (char )'\000';
  }
#line 84
  return (result);
}
}
#line 87 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
int xmkstemp(char *pattern ) 
{ 
  int fd ;
  int tmp ;
  int *tmp___0 ;
  char *__cil_tmp5 ;

  {
  {
  {
#line 89
  tmp = mkstemp(pattern);
  }
#line 89
  fd = tmp;
  }
#line 90
  if (fd < 0) {
    {
    {
#line 91
    tmp___0 = __errno_location();
    }
    {
#line 91
    error(1, *tmp___0, "mkstemp: %s", pattern);
    }
    }
  }
#line 92
  return (fd);
}
}
#line 95 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
FILE *xtmpfile(void) 
{ 
  FILE *ret ;
  char *tmpfname ;
  char *tmpdir ;
  char *tmp ;
  size_t tmpdirlen ;
  int fd ;
  FILE *tmp___0 ;
  int tmp___1 ;
  void *tmp___2 ;
  int *tmp___3 ;
  char *__cil_tmp11 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;

  {
  {
  {
#line 99
  tmp = getenv("TMPDIR");
  }
#line 99
  tmpdir = tmp;
  }
#line 103
  if ((unsigned long )tmpdir == (unsigned long )((void *)0)) {
    {
    {
#line 104
    tmp___0 = tmpfile();
    }
    }
#line 104
    return (tmp___0);
  } else {
    {
    {
#line 103
    tmp___1 = strcmp((char const   *)tmpdir, "/tmp");
    }
    }
#line 103
    if (! tmp___1) {
      {
      {
#line 104
      tmp___0 = tmpfile();
      }
      }
#line 104
      return (tmp___0);
    }
  }
  {
  {
#line 106
  tmpdirlen = strlen((char const   *)tmpdir);
  }
  {
#line 107
  tmp___2 = xmalloc(tmpdirlen + 8U);
  }
#line 107
  tmpfname = (char *)tmp___2;
  {
#line 108
  strcpy((char */* __restrict  */)tmpfname, (char const   */* __restrict  */)tmpdir);
  }
  {
#line 109
  strcpy((char */* __restrict  */)(tmpfname + tmpdirlen), (char const   */* __restrict  */)"/XXXXXX");
  }
  {
#line 110
  fd = mkstemp(tmpfname);
  }
  {
#line 111
  ret = fdopen(fd, "w+b");
  }
  }
#line 112
  if ((unsigned long )ret == (unsigned long )((void *)0)) {
    {
    {
#line 113
    tmp___3 = __errno_location();
    }
    {
#line 113
    error(1, *tmp___3, "fdopen");
    }
    }
  }
#line 114
  return (ret);
}
}
#line 127 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
void patlist_add(struct patlist **dst , char const   *s ) 
{ 
  struct patlist *item ;
  void *tmp ;

  {
  {
  {
#line 129
  tmp = xmalloc((size_t )sizeof(*item));
  }
#line 129
  item = (struct patlist *)tmp;
  {
#line 130
  item->pattern = xstrdup(s);
  }
#line 131
  item->next = *dst;
#line 132
  *dst = item;
  }
#line 133
  return;
}
}
#line 135 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
void patlist_add_file(struct patlist **dst , char const   *fn ) 
{ 
  FILE *fd ;
  char buf[4096] ;
  size_t len ;
  char *tmp ;
  void *__cil_tmp7 ;
  char *__cil_tmp8 ;

  {
  {
  {
#line 141
  fd = fopen((char const   */* __restrict  */)fn, (char const   */* __restrict  */)"r");
  }
  }
#line 142
  if ((unsigned long )((void *)0) == (unsigned long )fd) {
#line 143
    return;
  }
  {
  {
#line 145
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 145
    tmp = fgets((char */* __restrict  */)(buf), (int )sizeof(buf), (FILE */* __restrict  */)fd);
    }
    }
#line 145
    if (! tmp) {
#line 145
      goto while_break;
    }
    {
    {
#line 146
    len = strlen((char const   *)(buf));
    }
    }
#line 147
    if (len <= 1U) {
#line 148
      goto while_continue;
    }
#line 150
    if (10 == (int )buf[len - 1U]) {
#line 151
      buf[len - 1U] = (char )'\000';
    }
    {
    {
#line 152
    patlist_add(dst, (char const   *)(buf));
    }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 154
  fclose(fd);
  }
  }
#line 155
  return;
}
}
#line 157 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
int patlist_match(struct patlist *list , char const   *s ) 
{ 
  int tmp ;

  {
  {
  {
#line 159
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 159
    if (! list) {
#line 159
      goto while_break;
    }
    {
    {
#line 160
    tmp = fnmatch((char const   *)list->pattern, s, 0);
    }
    }
#line 160
    if (! tmp) {
#line 161
      return (1);
    }
#line 162
    list = list->next;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 164
  return (0);
}
}
#line 167 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
void patlist_free(struct patlist **list ) 
{ 
  struct patlist *l ;
  struct patlist *next ;

  {
#line 170
  l = *list;
  {
  {
#line 170
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 170
    if (! l) {
#line 170
      goto while_break;
    }
    {
#line 171
    next = l->next;
    {
#line 172
    free((void *)l->pattern);
    }
    {
#line 173
    free((void *)l);
    }
#line 170
    l = next;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 175
  *list = (struct patlist *)((void *)0);
#line 176
  return;
}
}
#line 179 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
FILE *xopen(char const   *name , char const   *mode___3 ) 
{ 
  FILE *f ;

  {
  {
  {
#line 183
  f = fopen((char const   */* __restrict  */)name, (char const   */* __restrict  */)mode___3);
  }
  }
#line 184
  if (! f) {
    {
    {
#line 185
    perror(name);
    }
    {
#line 186
    exit(1);
    }
    }
  }
#line 188
  return (f);
}
}
#line 191 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
FILE *xopen_seekable(char const   *name , char const   *mode___3 ) 
{ 
  FILE *f ;
  FILE *tmp ;
  size_t buflen ;
  char *buffer ;
  void *tmp___0 ;
  FILE *tmp___1 ;
  FILE *tmp___2 ;
  size_t count ;
  size_t tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
  {
  {
#line 194
  tmp = xopen(name, mode___3);
  }
#line 194
  f = tmp;
  {
#line 196
  tmp___5 = fseek(f, 0L, 0);
  }
  }
#line 196
  if (tmp___5 != 0) {
    {
#line 197
    buflen = (size_t )65536;
    {
#line 198
    tmp___0 = xmalloc(buflen);
    }
#line 198
    buffer = (char *)tmp___0;
    {
#line 199
    tmp___2 = xtmpfile();
    }
#line 199
    tmp___1 = tmp___2;
    }
    {
    {
#line 201
    while (1) {
      while_continue___0: /* CIL Label */ ;
      while_continue: /* CIL Label */ ;
      {
      {
#line 201
      tmp___4 = feof(f);
      }
      }
#line 201
      if (tmp___4) {
#line 201
        goto while_break;
      }
      {
      {
#line 202
      tmp___3 = fread((void */* __restrict  */)buffer, (size_t )1, buflen, (FILE */* __restrict  */)f);
      }
#line 202
      count = tmp___3;
      }
#line 203
      if (count < 1U) {
#line 204
        goto while_break;
      }
      {
      {
#line 205
      fwrite((void const   */* __restrict  */)buffer, count, (size_t )1, (FILE */* __restrict  */)tmp___1);
      }
      }
    }
    while_break___0: /* CIL Label */ ;
    }
    while_break: /* CIL Label */ ;
    }
    {
    {
#line 208
    free((void *)buffer);
    }
    {
#line 209
    fclose(f);
    }
#line 211
    f = tmp___1;
    {
#line 212
    fseek(f, 0L, 0);
    }
    }
  }
#line 215
  return (f);
}
}
#line 219 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
FILE *xopen_unzip(char const   *name , char const   *mode___3 ) 
{ 
  char *p ;
  char *zprog ;
  FILE *fi ;
  FILE *fo ;
  size_t buflen ;
  char *buffer ;
  pid_t pid ;
  int tmp ;
  int tmp___0 ;
  FILE *tmp___1 ;
  void *tmp___2 ;
  size_t count ;
  size_t tmp___3 ;
  int tmp___4 ;
  int *tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;
  char *__cil_tmp25 ;

  {
  {
#line 221
  zprog = (char *)((void *)0);
#line 223
  buflen = (size_t )65536;
  {
#line 227
  p = strrchr(name, '.');
  }
  }
#line 228
  if ((unsigned long )p != (unsigned long )((void *)0)) {
    {
    {
#line 229
    tmp___0 = strcmp((char const   *)p, ".bz2");
    }
    }
#line 229
    if (tmp___0) {
      {
      {
#line 231
      tmp = strcmp((char const   *)p, ".gz");
      }
      }
#line 231
      if (! tmp) {
#line 232
        zprog = (char *)"zcat";
      }
    } else {
#line 230
      zprog = (char *)"bzcat";
    }
  }
#line 234
  if ((unsigned long )zprog == (unsigned long )((void *)0)) {
    {
    {
#line 235
    tmp___1 = xopen_seekable(name, mode___3);
    }
    }
#line 235
    return (tmp___1);
  }
  {
  {
#line 237
  tmp___2 = xmalloc(buflen);
  }
#line 237
  buffer = (char *)tmp___2;
  {
#line 238
  fo = xtmpfile();
  }
  {
#line 239
  fi = xpipe((char const   *)zprog, & pid, "r", zprog, name, (void *)0);
  }
  }
  {
  {
#line 241
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 241
    tmp___7 = feof(fi);
    }
    }
#line 241
    if (tmp___7) {
#line 241
      goto while_break;
    }
    {
    {
#line 242
    tmp___3 = fread((void */* __restrict  */)buffer, (size_t )1, buflen, (FILE */* __restrict  */)fi);
    }
#line 242
    count = tmp___3;
    {
#line 243
    tmp___4 = ferror(fi);
    }
    }
#line 243
    if (tmp___4) {
      {
      {
#line 244
      perror(name);
      }
      {
#line 245
      exit(1);
      }
      }
    }
#line 247
    if (count < 1U) {
#line 248
      goto while_break;
    }
    {
    {
#line 250
    fwrite((void const   */* __restrict  */)buffer, count, (size_t )1, (FILE */* __restrict  */)fo);
    }
    {
#line 251
    tmp___6 = ferror(fo);
    }
    }
#line 251
    if (tmp___6) {
      {
      {
#line 252
      tmp___5 = __errno_location();
      }
      {
#line 252
      error(1, *tmp___5, "writing temp file");
      }
      }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 255
  free((void *)buffer);
  }
  {
#line 256
  fclose(fi);
  }
  {
#line 258
  waitpid(pid, (int *)((void *)0), 0);
  }
  {
#line 260
  fseek(fo, 0L, 0);
  }
  }
#line 262
  return (fo);
}
}
#line 266 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
FILE *xpipe(char const   *cmd , pid_t *pid , char const   *mode___3  , ...) 
{ 
  va_list ap ;
  int fildes[2] ;
  int child ;
  int nargs ;
  char *argv[128] ;
  char *arg ;
  FILE *res ;
  char *tmp ;
  int tmp___0 ;
  int *tmp___1 ;
  int *tmp___2 ;
  void *__cil_tmp15 ;
  void *__cil_tmp16 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;

  {
#line 271
  nargs = 0;
#line 275
  if (! mode___3) {
    {
    {
#line 276
    error(1, 0, "xpipe: bad mode: %s", mode___3);
    }
    }
  } else
#line 275
  if ((int const   )*mode___3 != 114) {
#line 275
    if ((int const   )*mode___3 != 119) {
      {
      {
#line 276
      error(1, 0, "xpipe: bad mode: %s", mode___3);
      }
      }
    }
  }
  {
  {
#line 278
  __builtin_va_start(ap, mode___3);
  }
  }
  {
  {
#line 279
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 280
    tmp = __builtin_va_arg(ap, char *);
    }
#line 280
    arg = tmp;
#line 281
    tmp___0 = nargs;
#line 281
    nargs ++;
#line 281
    argv[tmp___0] = arg;
    }
#line 282
    if (nargs >= 128) {
      {
      {
#line 283
      error(1, 0, "xpipe: too many args");
      }
      }
    }
#line 279
    if (! ((unsigned long )arg != (unsigned long )((void *)0))) {
#line 279
      goto while_break;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 285
  __builtin_va_end(ap);
  }
  {
#line 287
  fflush((FILE *)((void *)0));
  }
  {
#line 288
  pipe((int *)(fildes));
  }
  {
#line 289
  child = fork();
  }
  }
#line 290
  if (child == -1) {
    {
    {
#line 291
    perror("fork");
    }
    {
#line 292
    exit(1);
    }
    }
  }
#line 294
  if (child == 0) {
#line 295
    if ((int const   )*mode___3 == 114) {
      {
      {
#line 296
      close(fildes[0]);
      }
      {
#line 297
      close(1);
      }
      {
#line 298
      dup(fildes[1]);
      }
      {
#line 299
      close(fildes[1]);
      }
      }
    } else {
      {
      {
#line 301
      close(fildes[1]);
      }
      {
#line 302
      close(1);
      }
      {
#line 303
      dup(2);
      }
      {
#line 304
      close(0);
      }
      {
#line 305
      dup(fildes[0]);
      }
      {
#line 306
      close(fildes[0]);
      }
      }
    }
    {
    {
#line 308
    execvp(cmd, (char * const  *)(argv));
    }
    {
#line 310
    tmp___1 = __errno_location();
    }
    {
#line 310
    error(1, *tmp___1, "execvp");
    }
    }
  }
#line 312
  if ((unsigned long )pid != (unsigned long )((void *)0)) {
#line 313
    *pid = child;
  }
#line 315
  if ((int const   )*mode___3 == 114) {
    {
    {
#line 316
    close(fildes[1]);
    }
    {
#line 317
    res = fdopen(fildes[0], "r");
    }
    }
  } else {
    {
    {
#line 319
    close(fildes[0]);
    }
    {
#line 320
    res = fdopen(fildes[1], "w");
    }
    }
  }
#line 322
  if ((unsigned long )res == (unsigned long )((void *)0)) {
    {
    {
#line 323
    tmp___2 = __errno_location();
    }
    {
#line 323
    error(1, *tmp___2, "fdopen");
    }
    }
  }
#line 325
  return (res);
}
}
#line 372 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
char *progname  =    (char *)"(null)";
#line 373 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/util.c"
void set_progname(char const   *s ) 
{ 


  {
  {
  {
#line 375
  progname = xstrdup(s);
  }
  }
#line 376
  return;
}
}
/* compiler builtin: 
   void *__builtin_alloca(unsigned long  ) ;  */
#line 71 "/usr/include/assert.h"
extern  __attribute__((__nothrow__, __noreturn__)) void __assert_fail(char const   *__assertion ,
                                                                      char const   *__file ,
                                                                      unsigned int __line ,
                                                                      char const   *__function ) ;
#line 81 "/usr/include/ctype.h"
extern  __attribute__((__nothrow__)) unsigned short const   **__ctype_b_loc(void)  __attribute__((__const__)) ;
#line 147 "/usr/include/stdio.h"
extern struct _IO_FILE *stderr ;
#line 333
extern int fprintf(FILE * __restrict  __stream , char const   * __restrict  __format 
                   , ...) ;
#line 341
extern  __attribute__((__nothrow__)) int sprintf(char * __restrict  __s , char const   * __restrict  __format 
                                                 , ...) ;
#line 662
extern int fputs(char const   * __restrict  __s , FILE * __restrict  __stream ) ;
#line 727
extern long ftell(FILE *__stream ) ;
#line 771
extern int fgetpos(FILE * __restrict  __stream , fpos_t * __restrict  __pos ) ;
#line 776
extern int fsetpos(FILE *__stream , fpos_t const   *__pos ) ;
#line 67 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2))) memcmp)(void const   *__s1 ,
                                                                                     void const   *__s2 ,
                                                                                     size_t __n )  __attribute__((__pure__)) ;
#line 94
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1))) memchr)(void const   *__s ,
                                                                                     int __c ,
                                                                                     size_t __n )  __attribute__((__pure__)) ;
#line 842 "/usr/include/unistd.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1))) unlink)(char const   *__name ) ;
#line 47 "./src/getopt.h"
extern char *optarg ;
#line 61
extern int optind ;
#line 151
extern int getopt_long(int __argc , char * const  *__argv , char const   *__shortopts ,
                       struct option  const  *__longopts , int *__longind ) ;
#line 62 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static enum __anonenum_mode_54 mode  ;
#line 67 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int flipdiff_inplace  =    0;
#line 92 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int human_readable  =    1;
#line 93 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static char diff_opts[4]  ;
#line 94 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static unsigned int max_context_real  =    3U;
#line 94 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static unsigned int max_context  =    3U;
#line 95 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int context_specified  =    0;
#line 96 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int ignore_components  =    0;
#line 97 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int unzip  =    0;
#line 98 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int no_revert_omitted  =    0;
#line 99 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int debug  =    0;
#line 101 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct patlist *pat_drop_context  =    (struct patlist *)((void *)0);
#line 103 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct file_list *files_done  =    (struct file_list *)((void *)0);
#line 104 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct file_list *files_in_patch2  =    (struct file_list *)((void *)0);
#line 107 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int check_filename(char const   *fn ) 
{ 
  int tmp ;

  {
  {
  {
#line 110
  tmp = patlist_match(pat_drop_context, fn);
  }
  }
#line 110
  if (tmp) {
#line 111
    max_context = 0U;
  } else {
#line 113
    max_context = max_context_real;
  }
#line 115
  return (1);
}
}
#line 118 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void add_to_list(struct file_list **list , char const   *file , long pos ) 
{ 
  struct file_list *make ;
  void *tmp ;

  {
  {
  {
#line 122
  tmp = xmalloc((size_t )sizeof(*make));
  }
#line 122
  make = (struct file_list *)tmp;
#line 123
  make->next = (struct file_list *)((void *)0);
#line 124
  make->tail = (struct file_list *)((void *)0);
  {
#line 125
  make->file = xstrdup(file);
  }
#line 126
  make->pos = pos;
  }
#line 128
  if (*list) {
#line 129
    ((*list)->tail)->next = make;
#line 130
    (*list)->tail = make;
  } else {
#line 132
    make->tail = make;
#line 133
    *list = make;
  }
#line 135
  return;
}
}
#line 137 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static long file_in_list(struct file_list *list , char const   *file ) 
{ 
  char const   *tmp ;
  int tmp___0 ;

  {
  {
  {
#line 140
  file = stripped(file, ignore_components);
  }
  }
  {
  {
#line 141
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 141
    if (! list) {
#line 141
      goto while_break;
    }
    {
    {
#line 142
    tmp = stripped((char const   *)list->file, ignore_components);
    }
    {
#line 142
    tmp___0 = strcmp(tmp, file);
    }
    }
#line 142
    if (! tmp___0) {
#line 143
      return (list->pos);
    }
#line 144
    list = list->next;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 146
  return (-1L);
}
}
#line 149 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void free_list(struct file_list *list ) 
{ 
  struct file_list *next ;

  {
  {
  {
#line 153
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 153
    if (! list) {
#line 153
      goto while_break;
    }
    {
#line 154
    next = list->next;
    {
#line 155
    free((void *)list->file);
    }
    {
#line 156
    free((void *)list);
    }
#line 153
    list = next;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 158
  return;
}
}
#line 160 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void insert_line_before(struct lines_info *lines___1 , struct lines *at , struct lines *make ) 
{ 


  {
#line 164
  make->next = at;
#line 165
  make->prev = at->prev;
#line 166
  if (at->prev) {
#line 167
    (at->prev)->next = make;
  } else {
#line 169
    lines___1->head = make;
  }
#line 170
  at->prev = make;
#line 171
  return;
}
}
#line 174 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int add_line(struct lines_info *lines___1 , char const   *line , size_t length ,
                    unsigned long n ) 
{ 
  struct lines *make ;
  struct lines *at ;
  void *tmp ;
  void *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  char *__cil_tmp11 ;
  char *__cil_tmp12 ;

  {
  {
  {
#line 181
  tmp = xmalloc((size_t )sizeof(*make));
  }
#line 181
  make = (struct lines *)tmp;
#line 182
  make->n = n;
  {
#line 183
  tmp___0 = xmalloc(length + 1U);
  }
#line 183
  make->line = (char *)tmp___0;
  {
#line 184
  memcpy((void */* __restrict  */)make->line, (void const   */* __restrict  */)line,
         length);
  }
#line 185
  *(make->line + length) = (char )'\000';
#line 186
  make->length = length;
  }
#line 188
  if (! lines___1->tail) {
#line 190
    make->prev = (struct lines *)((void *)0);
#line 191
    make->next = (struct lines *)((void *)0);
#line 192
    lines___1->head = make;
#line 193
    lines___1->tail = make;
#line 194
    return (0);
  }
#line 196
  if ((lines___1->tail)->n < n) {
#line 198
    (lines___1->tail)->next = make;
#line 199
    make->next = (struct lines *)((void *)0);
#line 200
    make->prev = lines___1->tail;
#line 201
    lines___1->tail = make;
#line 202
    return (0);
  }
#line 205
  if (! lines___1->head) {
    {
    {
#line 206
    error(1, 0, "List corrupted: no head");
    }
    }
  }
#line 208
  at = lines___1->head;
  {
  {
#line 209
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 209
    if (! at) {
#line 209
      goto while_break;
    }
#line 210
    if (n < at->n) {
      {
      {
#line 211
      insert_line_before(lines___1, at, make);
      }
      }
#line 212
      return (0);
    }
#line 214
    if (n == at->n) {
      {
      {
#line 215
      free((void *)make->line);
      }
      {
#line 216
      free((void *)make);
      }
      }
#line 217
      if (at->length == length) {
        {
        {
#line 217
        tmp___1 = memcmp((void const   *)at->line, (void const   *)line, length);
        }
        }
#line 217
        if (! tmp___1) {
#line 220
          return (0);
        }
      }
#line 223
      if (at->length < length) {
#line 224
        return (-1);
      }
#line 225
      if (at->length > length) {
#line 226
        return (1);
      }
      {
      {
#line 227
      tmp___2 = memcmp((void const   *)at->line, (void const   *)line, length);
      }
      }
#line 227
      return (tmp___2);
    }
#line 229
    make->prev = at;
#line 230
    at = at->next;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 233
  if (! at) {
    {
    {
#line 234
    error(1, 0, "List corrupted: ordering");
    }
    }
  }
#line 236
  return (1);
}
}
#line 239 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void merge_lines(struct lines_info *lines1 , struct lines_info *lines2 ) 
{ 
  struct lines *at ;
  struct lines *at_prev ;
  struct lines *make ;
  struct lines *next ;

  {
#line 250
  if (lines2->first_offset < lines1->first_offset) {
#line 251
    lines1->first_offset = lines2->first_offset;
  }
#line 253
  if (! lines1->head) {
#line 255
    lines1->head = lines2->head;
#line 256
    return;
  }
#line 260
  at = lines1->head;
#line 261
  make = lines2->head;
  {
  {
#line 262
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 262
    if (! at) {
#line 262
      goto while_break;
    }
    {
    {
#line 263
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 263
      if (! make) {
#line 263
        goto while_break___0;
      }
#line 264
      if (make->n > at->n) {
#line 265
        goto while_break___0;
      }
#line 267
      if (make->n < at->n) {
        {
#line 268
        next = make->next;
        {
#line 270
        insert_line_before(lines1, at, make);
        }
#line 271
        make = next;
        }
#line 272
        goto while_continue___0;
      }
#line 275
      make = make->next;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 277
    at_prev = at;
#line 278
    at = at->next;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 282
  if (make) {
#line 283
    at_prev->next = make;
  }
#line 284
  return;
}
}
#line 286 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void free_lines(struct lines *list ) 
{ 
  struct lines *next ;

  {
  {
  {
#line 290
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 290
    if (! list) {
#line 290
      goto while_break;
    }
    {
#line 291
    next = list->next;
    {
#line 292
    free((void *)list->line);
    }
    {
#line 293
    free((void *)list);
    }
#line 290
    list = next;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 295
  return;
}
}
#line 297 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct lines *create_orig(FILE *f , struct lines_info *file , int reverted ,
                                 int *clash ) 
{ 
  unsigned long linenum___1 ;
  char *line ;
  char first_char ;
  size_t linelen ;
  int last_was_add ;
  long pos ;
  long tmp ;
  unsigned long min_context ;
  __ssize_t tmp___0 ;
  int tmp___1 ;
  unsigned long orig_lines ;
  unsigned long new_lines ;
  unsigned long newline ;
  int file_is_removed ;
  unsigned long context ;
  int leading_context ;
  char *p ;
  char *q ;
  int tmp___2 ;
  int tmp___3 ;
  ssize_t got ;
  unsigned long tmp___4 ;
  int tmp___5 ;
  struct lines *at ;
  struct lines *prev ;
  __ssize_t tmp___6 ;
  int tmp___7 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;

  {
  {
#line 302
  line = (char *)((void *)0);
#line 303
  linelen = (size_t )0;
  {
#line 305
  tmp = ftell(f);
  }
#line 305
  pos = tmp;
#line 306
  min_context = 3UL;
  }
  {
  {
#line 308
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 309
    tmp___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)f);
    }
    }
#line 309
    if (tmp___0 == -1) {
#line 310
      goto while_break;
    }
    {
    {
#line 308
    tmp___1 = strncmp((char const   *)line, "@@ ", (size_t )3);
    }
    }
#line 308
    if (! tmp___1) {
#line 308
      goto while_break;
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 313
  while (1) {
    while_continue___4: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
    {
    {
#line 313
    tmp___7 = feof(f);
    }
    }
#line 313
    if (tmp___7) {
#line 313
      goto while_break___0;
    }
    {
#line 316
    file_is_removed = 0;
    {
#line 321
    tmp___2 = strncmp((char const   *)line, "@@", (size_t )2);
    }
    }
#line 321
    if (tmp___2) {
      {
      {
#line 322
      fseek(f, pos, 0);
      }
      }
#line 323
      goto while_break___0;
    }
#line 326
    if (reverted) {
      {
      {
#line 327
      new_lines = orig_num_lines((char const   *)line);
      }
      {
#line 328
      orig_lines = new_num_lines((char const   *)line);
      }
      }
    } else {
      {
      {
#line 330
      orig_lines = orig_num_lines((char const   *)line);
      }
      {
#line 331
      new_lines = new_num_lines((char const   *)line);
      }
      }
    }
#line 334
    if (reverted) {
#line 334
      tmp___3 = '+';
    } else {
#line 334
      tmp___3 = '-';
    }
    {
    {
#line 334
    p = strchr((char const   *)line, tmp___3);
    }
    }
#line 335
    if (! p) {
#line 336
      goto while_break___0;
    }
    {
#line 338
    p ++;
    {
#line 339
    linenum___1 = strtoul((char const   */* __restrict  */)p, (char **/* __restrict  */)(& q),
                          10);
    }
    }
#line 340
    if ((unsigned long )p == (unsigned long )q) {
#line 341
      goto while_break___0;
    }
#line 342
    if (linenum___1 == 0UL) {
#line 343
      file_is_removed = 1;
#line 344
      file->first_offset = 0UL;
    } else
#line 345
    if (! file->first_offset) {
#line 345
      goto _L;
    } else
#line 345
    if (linenum___1 < file->first_offset) {
      _L: /* CIL Label */ 
#line 347
      file->first_offset = linenum___1;
#line 348
      if (! orig_lines) {
#line 349
        (file->first_offset) ++;
      }
    }
#line 354
    context = 0UL;
#line 355
    leading_context = 1;
#line 358
    last_was_add = 0;
#line 359
    newline = 1UL;
    {
    {
#line 360
    while (1) {
      while_continue___5: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 360
      if (! orig_lines) {
#line 360
        if (! new_lines) {
#line 360
          if (! newline) {
#line 360
            goto while_break___1;
          }
        }
      }
      {
      {
#line 362
      pos = ftell(f);
      }
      {
#line 363
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)f);
      }
      }
#line 364
      if (got == -1) {
#line 365
        goto while_break___1;
      }
#line 367
      if (! orig_lines) {
#line 367
        if (! new_lines) {
#line 367
          if ((int )*(line + 0) != 92) {
#line 369
            goto while_break___1;
          }
        }
      }
#line 371
      first_char = *(line + 0);
#line 372
      if (reverted) {
#line 373
        if ((int )first_char == 45) {
#line 374
          first_char = (char )'+';
        } else
#line 375
        if ((int )first_char == 43) {
#line 376
          first_char = (char )'-';
        }
      }
      {
#line 380
      if ((int )first_char == 32) {
#line 380
        goto case_32;
      }
#line 383
      if ((int )first_char == 45) {
#line 383
        goto case_45;
      }
#line 397
      if ((int )first_char == 43) {
#line 397
        goto case_43;
      }
#line 401
      if ((int )first_char == 92) {
#line 401
        goto case_92;
      }
#line 379
      goto switch_break;
      case_32: /* CIL Label */ 
#line 381
      if (leading_context) {
#line 381
        context ++;
      }
#line 382
      if (new_lines) {
#line 382
        new_lines --;
      }
      case_45: /* CIL Label */ 
#line 384
      leading_context = 0;
#line 385
      if (orig_lines) {
#line 385
        orig_lines --;
      }
#line 386
      if (! file_is_removed) {
        {
#line 387
        tmp___4 = linenum___1;
#line 387
        linenum___1 ++;
        {
#line 387
        tmp___5 = add_line(file, (char const   *)(line + 1), (size_t )got - 1U, tmp___4);
        }
        }
#line 387
        if (tmp___5) {
#line 387
          if (clash) {
#line 390
            (*clash) ++;
#line 391
            if (debug) {
              {
              {
#line 392
              printf((char const   */* __restrict  */)"clash at line %lu\n", linenum___1 - 1UL);
              }
              }
            }
          }
        }
      }
#line 396
      goto switch_break;
      case_43: /* CIL Label */ 
#line 398
      leading_context = 0;
#line 399
      if (new_lines) {
#line 399
        new_lines --;
      }
#line 400
      goto switch_break;
      case_92: /* CIL Label */ 
#line 402
      leading_context = 0;
#line 403
      newline = 0UL;
#line 404
      if (! file_is_removed) {
#line 404
        if (! last_was_add) {
#line 405
          prev = (struct lines *)((void *)0);
#line 406
          at = file->head;
          {
          {
#line 406
          while (1) {
            while_continue___6: /* CIL Label */ ;
            while_continue___2: /* CIL Label */ ;
#line 406
            if (! at) {
#line 406
              goto while_break___2;
            }
#line 407
            prev = at;
#line 406
            at = at->next;
          }
          while_break___6: /* CIL Label */ ;
          }
          while_break___2: /* CIL Label */ ;
          }
#line 408
          if (! prev) {
            {
            {
#line 409
            error(1, 0, "Garbled patch");
            }
            }
          }
#line 411
          if (prev->length >= 1U) {
#line 411
            if ((int )*(prev->line + (prev->length - 1U)) == 10) {
#line 413
              (prev->length) --;
            }
          }
        }
      }
#line 415
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
#line 418
      last_was_add = (int )*(line + 0) == 43;
    }
    while_break___5: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
#line 421
    if (! newline) {
      {
      {
#line 422
      pos = ftell(f);
      }
      {
#line 423
      tmp___6 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)f);
      }
      }
#line 423
      if (tmp___6 == -1) {
#line 424
        goto while_break___0;
      }
    }
#line 427
    if (context < min_context) {
#line 428
      min_context = context;
    }
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 431
  if (line) {
    {
    {
#line 432
    free((void *)line);
    }
    }
  }
#line 434
  file->min_context = min_context;
#line 435
  return (file->head);
}
}
#line 438 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void construct_unline(struct lines_info *file_info ) 
{ 
  char *un ;
  struct lines *at ;
  size_t i ;
  char *tmp ;
  void *tmp___0 ;
  size_t j ;
  size_t tmp___1 ;
  unsigned short const   **tmp___2 ;
  size_t tmp___3 ;
  int tmp___4 ;
  size_t maxlength ;
  size_t len ;
  size_t tmp___5 ;
  char *tmp___6 ;
  void *tmp___7 ;
  size_t tmp___8 ;

  {
#line 445
  if (file_info->unline) {
#line 447
    return;
  }
  {
  {
#line 449
  tmp___0 = xmalloc((size_t )7);
  }
#line 449
  tmp = (char *)tmp___0;
#line 449
  file_info->unline = tmp;
#line 449
  un = tmp;
#line 452
  i = (size_t )0;
#line 452
  at = file_info->head;
  }
  {
  {
#line 452
  while (1) {
    while_continue___5: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 452
    if (at) {
#line 452
      if (! (i < 5U)) {
#line 452
        goto while_break;
      }
    } else {
#line 452
      goto while_break;
    }
    {
    {
#line 453
    tmp___1 = strlen((char const   *)at->line);
    }
#line 453
    j = tmp___1 - 1U;
    }
#line 454
    if (i < j) {
#line 455
      j = i;
    }
    {
#line 456
    *(un + i) = (char )((int )*(at->line + j) + 1);
    {
#line 457
    tmp___2 = __ctype_b_loc();
    }
    }
#line 457
    if ((int const   )*(*tmp___2 + (int )*(un + i)) & 2) {
#line 458
      *(un + i) = (char )'!';
    }
#line 452
    i ++;
#line 452
    at = at->next;
  }
  while_break___5: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 460
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 460
    if (! (i < 5U)) {
#line 460
      goto while_break___0;
    }
#line 461
    *(un + i) = (char )'!';
#line 460
    i ++;
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 462
  tmp___3 = i;
#line 462
  i ++;
#line 462
  *(un + tmp___3) = (char )'\n';
#line 463
  *(un + i) = (char )'\000';
#line 465
  i = (size_t )4;
  {
  {
#line 465
  while (1) {
    while_continue___7: /* CIL Label */ ;
    while_continue___1: /* CIL Label */ ;
#line 465
    if (! (i > 0U)) {
#line 465
      goto while_break___1;
    }
#line 467
    at = file_info->head;
    {
    {
#line 467
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
#line 467
      if (! at) {
#line 467
        goto while_break___2;
      }
      {
      {
#line 468
      tmp___4 = strcmp((char const   *)at->line, (char const   *)un);
      }
      }
#line 468
      if (! tmp___4) {
#line 469
        goto while_break___2;
      }
#line 467
      at = at->next;
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
#line 471
    if (! at) {
#line 473
      goto while_break___1;
    }
#line 475
    *(un + i) = (char )'\n';
#line 476
    *(un + (i + 1U)) = (char )'\000';
#line 465
    i --;
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 479
  if (i == 0U) {
#line 481
    maxlength = (size_t )0;
#line 482
    at = file_info->head;
    {
    {
#line 482
    while (1) {
      while_continue___9: /* CIL Label */ ;
      while_continue___3: /* CIL Label */ ;
#line 482
      if (! at) {
#line 482
        goto while_break___3;
      }
      {
      {
#line 483
      tmp___5 = strlen((char const   *)at->line);
      }
#line 483
      len = tmp___5;
      }
#line 484
      if (len > maxlength) {
#line 485
        maxlength = len;
      }
#line 482
      at = at->next;
    }
    while_break___9: /* CIL Label */ ;
    }
    while_break___3: /* CIL Label */ ;
    }
    {
    {
#line 488
    free((void *)un);
    }
    {
#line 489
    tmp___7 = xmalloc(maxlength + 3U);
    }
#line 489
    tmp___6 = (char *)tmp___7;
#line 489
    file_info->unline = tmp___6;
#line 489
    un = tmp___6;
#line 490
    i = (size_t )0;
    }
    {
    {
#line 490
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___4: /* CIL Label */ ;
#line 490
      if (! (i < maxlength)) {
#line 490
        goto while_break___4;
      }
#line 491
      *(un + i) = (char )'!';
#line 490
      i ++;
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___4: /* CIL Label */ ;
    }
#line 492
    tmp___8 = i;
#line 492
    i ++;
#line 492
    *(un + tmp___8) = (char )'\n';
#line 493
    *(un + i) = (char )'\000';
  }
#line 495
  return;
}
}
#line 497 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int write_file(struct lines_info *file_info , int fd ) 
{ 
  unsigned long linenum___1 ;
  struct lines *at ;
  FILE *fout ;
  FILE *tmp ;
  unsigned long i ;
  unsigned long tmp___0 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;

  {
  {
  {
#line 502
  tmp = fdopen(fd, "w");
  }
#line 502
  fout = tmp;
  {
#line 504
  construct_unline(file_info);
  }
#line 505
  linenum___1 = 1UL;
  }
  {
  {
#line 505
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 505
    if (! (linenum___1 < file_info->first_offset)) {
#line 505
      goto while_break;
    }
    {
    {
#line 506
    fputs((char const   */* __restrict  */)file_info->unline, (FILE */* __restrict  */)fout);
    }
#line 505
    linenum___1 ++;
    }
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 508
  at = file_info->head;
  {
  {
#line 508
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 508
    if (! at) {
#line 508
      goto while_break___0;
    }
#line 509
    i = at->n - linenum___1;
    {
    {
#line 510
    while (1) {
      while_continue___4: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 510
      tmp___0 = i;
#line 510
      i --;
#line 510
      if (! tmp___0) {
#line 510
        goto while_break___1;
      }
      {
      {
#line 511
      fprintf((FILE */* __restrict  */)fout, (char const   */* __restrict  */)"%s",
              file_info->unline);
      }
#line 512
      linenum___1 ++;
      }
    }
    while_break___4: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
    {
    {
#line 514
    fwrite((void const   */* __restrict  */)at->line, at->length, (size_t )1, (FILE */* __restrict  */)fout);
    }
#line 515
    linenum___1 ++;
#line 508
    at = at->next;
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
  {
#line 517
  fclose(fout);
  }
  }
#line 518
  return (0);
}
}
#line 521 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int do_output_patch1_only(FILE *p1 , FILE *out , int not_reverted ) 
{ 
  char *line ;
  char *oldname ;
  char first_char ;
  size_t linelen ;
  ssize_t got ;
  long pos ;
  int *tmp ;
  __ssize_t tmp___0 ;
  int tmp___1 ;
  int *tmp___2 ;
  __ssize_t tmp___3 ;
  int tmp___4 ;
  int *tmp___5 ;
  unsigned long orig_lines ;
  unsigned long new_lines ;
  unsigned long newline ;
  char *d1 ;
  char *d2 ;
  char *p ;
  size_t h ;
  int tmp___6 ;
  size_t tmp___7 ;
  __ssize_t tmp___8 ;
  char *__cil_tmp27 ;
  char *__cil_tmp28 ;
  char *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;
  char *__cil_tmp40 ;
  char *__cil_tmp41 ;
  char *__cil_tmp42 ;
  char *__cil_tmp43 ;
  char *__cil_tmp44 ;

  {
  {
#line 531
  oldname = (char *)((void *)0);
#line 532
  linelen = (size_t )0;
  {
#line 533
  tmp___0 = getline((char **/* __restrict  */)(& oldname), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)p1);
  }
  }
#line 533
  if (tmp___0 < 0) {
    {
    {
#line 534
    tmp = __errno_location();
    }
    {
#line 534
    error(1, *tmp, "Bad patch #1");
    }
    }
  }
  {
  {
#line 536
  tmp___1 = strncmp((char const   *)oldname, "--- ", (size_t )4);
  }
  }
#line 536
  if (tmp___1) {
    {
    {
#line 537
    error(1, 0, "Bad patch #1");
    }
    }
  }
  {
#line 539
  line = (char *)((void *)0);
#line 540
  linelen = (size_t )0;
  {
#line 541
  tmp___3 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)p1);
  }
  }
#line 541
  if (tmp___3 < 0) {
    {
    {
#line 542
    tmp___2 = __errno_location();
    }
    {
#line 542
    error(1, *tmp___2, "Bad patch #1");
    }
    }
  }
  {
  {
#line 544
  tmp___4 = strncmp((char const   *)line, "+++ ", (size_t )4);
  }
  }
#line 544
  if (tmp___4) {
    {
    {
#line 545
    error(1, 0, "Bad patch #1");
    }
    }
  }
#line 547
  if (not_reverted) {
#line 549
    if (human_readable) {
#line 549
      if ((unsigned int )mode != 2U) {
        {
        {
#line 550
        fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"unchanged:\n");
        }
        }
      }
    }
    {
    {
#line 551
    fputs((char const   */* __restrict  */)oldname, (FILE */* __restrict  */)out);
    }
    {
#line 552
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    }
  } else
#line 553
  if (! no_revert_omitted) {
#line 554
    if (human_readable) {
      {
      {
#line 555
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"reverted:\n");
      }
      }
    }
    {
    {
#line 556
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"--- %s",
            line + 4);
    }
    {
#line 557
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"+++ %s",
            oldname + 4);
    }
    }
  }
  {
  {
#line 559
  free((void *)oldname);
  }
  {
#line 561
  pos = ftell(p1);
  }
  {
#line 562
  got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)p1);
  }
  }
#line 563
  if (got < 0) {
    {
    {
#line 564
    tmp___5 = __errno_location();
    }
    {
#line 564
    error(1, *tmp___5, "Bad patch #1");
    }
    }
  }
  {
  {
#line 566
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 573
    tmp___6 = strncmp((char const   *)line, "@@ ", (size_t )3);
    }
    }
#line 573
    if (tmp___6) {
      {
      {
#line 574
      fseek(p1, pos, 0);
      }
      }
#line 575
      goto while_break;
    }
    {
#line 578
    p = line + 3;
    {
#line 579
    h = strcspn((char const   *)p, " \t");
    }
    {
#line 580
    d1 = xstrndup((char const   *)p, (size_t const   )h);
    }
#line 581
    p += h;
    {
#line 582
    tmp___7 = strspn((char const   *)p, " \t");
    }
#line 582
    p += tmp___7;
    {
#line 583
    h = strcspn((char const   *)p, " \t");
    }
    {
#line 584
    d2 = xstrndup((char const   *)p, (size_t const   )h);
    }
    }
#line 585
    if (! *d1) {
      {
      {
#line 586
      error(1, 0, "Bad patch #1");
      }
      }
    } else
#line 585
    if (! *d2) {
      {
      {
#line 586
      error(1, 0, "Bad patch #1");
      }
      }
    }
#line 588
    if (not_reverted) {
      {
      {
#line 590
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
      }
      {
#line 591
      new_lines = orig_num_lines((char const   *)d1);
      }
      {
#line 592
      orig_lines = new_num_lines((char const   *)d2);
      }
      }
    } else {
#line 595
      if (! no_revert_omitted) {
        {
        {
#line 596
        fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"@@ -%s +%s @@\n",
                d2 + 1, d1 + 1);
        }
        }
      }
      {
      {
#line 598
      orig_lines = orig_num_lines((char const   *)d1);
      }
      {
#line 599
      new_lines = new_num_lines((char const   *)d2);
      }
      }
    }
    {
    {
#line 603
    free((void *)d1);
    }
    {
#line 604
    free((void *)d2);
    }
#line 606
    newline = 1UL;
    }
    {
    {
#line 607
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 607
      if (! orig_lines) {
#line 607
        if (! new_lines) {
#line 607
          if (! newline) {
#line 607
            goto while_break___0;
          }
        }
      }
      {
      {
#line 608
      pos = ftell(p1);
      }
      {
#line 609
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)p1);
      }
      }
#line 610
      if (got == -1) {
#line 611
        goto while_break___0;
      }
#line 613
      if (! orig_lines) {
#line 613
        if (! new_lines) {
#line 613
          if ((int )*(line + 0) != 92) {
#line 615
            goto while_break___0;
          }
        }
      }
#line 617
      first_char = *(line + 0);
#line 618
      if (not_reverted) {
#line 619
        if ((int )first_char == 43) {
#line 620
          first_char = (char )'-';
        } else
#line 621
        if ((int )first_char == 45) {
#line 622
          first_char = (char )'+';
        }
      }
      {
#line 626
      if ((int )first_char == 32) {
#line 626
        goto case_32;
      }
#line 632
      if ((int )first_char == 43) {
#line 632
        goto case_43;
      }
#line 640
      if ((int )first_char == 45) {
#line 640
        goto case_45;
      }
#line 648
      if ((int )first_char == 92) {
#line 648
        goto case_92;
      }
#line 625
      goto switch_break;
      case_32: /* CIL Label */ 
#line 627
      if (orig_lines) {
#line 627
        orig_lines --;
      }
#line 628
      if (new_lines) {
#line 628
        new_lines --;
      }
#line 629
      if (not_reverted) {
        {
        {
#line 630
        fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
        }
        }
      } else
#line 629
      if (! no_revert_omitted) {
        {
        {
#line 630
        fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
        }
        }
      }
#line 631
      goto switch_break;
      case_43: /* CIL Label */ 
#line 633
      if (new_lines) {
#line 633
        new_lines --;
      }
#line 634
      if (not_reverted) {
        {
        {
#line 635
        fputc('-', out);
        }
        {
#line 636
        fwrite((void const   */* __restrict  */)(line + 1), (size_t )got - 1U, (size_t )1,
               (FILE */* __restrict  */)out);
        }
        }
      } else
#line 634
      if (! no_revert_omitted) {
        {
        {
#line 635
        fputc('-', out);
        }
        {
#line 636
        fwrite((void const   */* __restrict  */)(line + 1), (size_t )got - 1U, (size_t )1,
               (FILE */* __restrict  */)out);
        }
        }
      }
#line 639
      goto switch_break;
      case_45: /* CIL Label */ 
#line 641
      if (orig_lines) {
#line 641
        orig_lines --;
      }
#line 642
      if (not_reverted) {
        {
        {
#line 643
        fputc('+', out);
        }
        {
#line 644
        fwrite((void const   */* __restrict  */)(line + 1), (size_t )got - 1U, (size_t )1,
               (FILE */* __restrict  */)out);
        }
        }
      } else
#line 642
      if (! no_revert_omitted) {
        {
        {
#line 643
        fputc('+', out);
        }
        {
#line 644
        fwrite((void const   */* __restrict  */)(line + 1), (size_t )got - 1U, (size_t )1,
               (FILE */* __restrict  */)out);
        }
        }
      }
#line 647
      goto switch_break;
      case_92: /* CIL Label */ 
#line 649
      newline = 0UL;
#line 650
      if (not_reverted) {
        {
        {
#line 651
        fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
        }
        }
      } else
#line 650
      if (! no_revert_omitted) {
        {
        {
#line 651
        fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
        }
        }
      }
#line 652
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 656
    if (! newline) {
      {
      {
#line 657
      pos = ftell(p1);
      }
      {
#line 658
      tmp___8 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)p1);
      }
      }
#line 658
      if (tmp___8 == -1) {
#line 659
        goto while_break;
      }
    }
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 663
  if (line) {
    {
    {
#line 664
    free((void *)line);
    }
    }
  }
#line 666
  return (0);
}
}
#line 669 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int output_patch1_only(FILE *p1 , FILE *out , int not_reverted ) 
{ 
  char const   *tmpdir ;
  unsigned int tmplen ;
  char tail1[20] ;
  char tail2[20] ;
  char *tmpp1 ;
  char *tmpp2 ;
  char options[100] ;
  int tmpp1fd ;
  int tmpp2fd ;
  long pos ;
  long start ;
  char *oldname ;
  char *newname ;
  size_t oldnamelen ;
  size_t newnamelen ;
  struct lines_info file_orig ;
  struct lines_info file_new ;
  pid_t child ;
  FILE *in ;
  int diff_is_empty ;
  unsigned int use_context ;
  int tmp ;
  char *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  int *tmp___3 ;
  __ssize_t tmp___4 ;
  int tmp___5 ;
  size_t tmp___6 ;
  int *tmp___7 ;
  __ssize_t tmp___8 ;
  int *tmp___9 ;
  int tmp___10 ;
  size_t tmp___11 ;
  int ch ;
  int tmp___12 ;
  int ch___0 ;
  int tmp___13 ;
  char *line ;
  size_t linelen ;
  ssize_t got ;
  __ssize_t tmp___14 ;
  void *__cil_tmp46 ;
  void *__cil_tmp47 ;
  void *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;

  {
#line 674
  tail1[0] = (char )'/';
#line 674
  tail1[1] = (char )'i';
#line 674
  tail1[2] = (char )'n';
#line 674
  tail1[3] = (char )'t';
#line 674
  tail1[4] = (char )'e';
#line 674
  tail1[5] = (char )'r';
#line 674
  tail1[6] = (char )'d';
#line 674
  tail1[7] = (char )'i';
#line 674
  tail1[8] = (char )'f';
#line 674
  tail1[9] = (char )'f';
#line 674
  tail1[10] = (char )'-';
#line 674
  tail1[11] = (char )'1';
#line 674
  tail1[12] = (char )'.';
#line 674
  tail1[13] = (char )'X';
#line 674
  tail1[14] = (char )'X';
#line 674
  tail1[15] = (char )'X';
#line 674
  tail1[16] = (char )'X';
#line 674
  tail1[17] = (char )'X';
#line 674
  tail1[18] = (char )'X';
#line 674
  tail1[19] = (char )'\000';
#line 675
  tail2[0] = (char )'/';
#line 675
  tail2[1] = (char )'i';
#line 675
  tail2[2] = (char )'n';
#line 675
  tail2[3] = (char )'t';
#line 675
  tail2[4] = (char )'e';
#line 675
  tail2[5] = (char )'r';
#line 675
  tail2[6] = (char )'d';
#line 675
  tail2[7] = (char )'i';
#line 675
  tail2[8] = (char )'f';
#line 675
  tail2[9] = (char )'f';
#line 675
  tail2[10] = (char )'-';
#line 675
  tail2[11] = (char )'2';
#line 675
  tail2[12] = (char )'.';
#line 675
  tail2[13] = (char )'X';
#line 675
  tail2[14] = (char )'X';
#line 675
  tail2[15] = (char )'X';
#line 675
  tail2[16] = (char )'X';
#line 675
  tail2[17] = (char )'X';
#line 675
  tail2[18] = (char )'X';
#line 675
  tail2[19] = (char )'\000';
#line 681
  oldname = (char *)((void *)0);
#line 681
  newname = (char *)((void *)0);
#line 682
  oldnamelen = (size_t )0;
#line 682
  newnamelen = (size_t )0;
#line 683
  file_orig.unline = (char *)((void *)0);
#line 683
  file_orig.first_offset = 0UL;
#line 683
  file_orig.min_context = 0UL;
#line 683
  file_orig.head = (struct lines *)((void *)0);
#line 683
  file_orig.tail = (struct lines *)((void *)0);
#line 684
  file_new.unline = (char *)((void *)0);
#line 684
  file_new.first_offset = 0UL;
#line 684
  file_new.min_context = 0UL;
#line 684
  file_new.head = (struct lines *)((void *)0);
#line 684
  file_new.tail = (struct lines *)((void *)0);
#line 687
  diff_is_empty = 1;
#line 688
  use_context = max_context;
#line 690
  if ((int )diff_opts[0] == 0) {
#line 690
    if (! context_specified) {
      {
      {
#line 691
      tmp = do_output_patch1_only(p1, out, not_reverted);
      }
      }
#line 691
      return (tmp);
    }
  }
  {
  {
#line 694
  tmp___0 = getenv("TMPDIR");
  }
#line 694
  tmpdir = (char const   *)tmp___0;
  }
#line 695
  if (! tmpdir) {
#line 696
    tmpdir = "/tmp";
  }
  {
  {
#line 698
  tmplen = strlen(tmpdir);
  }
  {
#line 699
  tmp___1 = __builtin_alloca((unsigned long )tmplen + sizeof(tail1));
  }
#line 699
  tmpp1 = (char *)tmp___1;
  {
#line 700
  memcpy((void */* __restrict  */)tmpp1, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 701
  memcpy((void */* __restrict  */)(tmpp1 + tmplen), (void const   */* __restrict  */)(tail1),
         (size_t )sizeof(tail1));
  }
  {
#line 702
  tmp___2 = __builtin_alloca((unsigned long )tmplen + sizeof(tail2));
  }
#line 702
  tmpp2 = (char *)tmp___2;
  {
#line 703
  memcpy((void */* __restrict  */)tmpp2, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 704
  memcpy((void */* __restrict  */)(tmpp2 + tmplen), (void const   */* __restrict  */)(tail2),
         (size_t )sizeof(tail2));
  }
  {
#line 706
  tmpp1fd = xmkstemp(tmpp1);
  }
  {
#line 707
  tmpp2fd = xmkstemp(tmpp2);
  }
  {
#line 709
  pos = ftell(p1);
  }
  }
  {
  {
#line 710
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 711
    if (oldname) {
      {
      {
#line 712
      free((void *)oldname);
      }
#line 713
      oldname = (char *)((void *)0);
#line 714
      oldnamelen = (size_t )0;
      }
    }
    {
    {
#line 716
    tmp___4 = getline((char **/* __restrict  */)(& oldname), (size_t */* __restrict  */)(& oldnamelen),
                      (FILE */* __restrict  */)p1);
    }
    }
#line 716
    if (tmp___4 < 0) {
      {
      {
#line 717
      tmp___3 = __errno_location();
      }
      {
#line 717
      error(1, *tmp___3, "Bad patch #1");
      }
      }
    }
    {
    {
#line 710
    tmp___5 = strncmp((char const   *)oldname, "--- ", (size_t )4);
    }
    }
#line 710
    if (! tmp___5) {
#line 710
      goto while_break;
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 720
  tmp___6 = strlen((char const   *)oldname);
  }
#line 720
  *(oldname + (tmp___6 - 1U)) = (char )'\000';
  {
#line 722
  tmp___8 = getline((char **/* __restrict  */)(& newname), (size_t */* __restrict  */)(& newnamelen),
                    (FILE */* __restrict  */)p1);
  }
  }
#line 722
  if (tmp___8 < 0) {
    {
    {
#line 723
    tmp___7 = __errno_location();
    }
    {
#line 723
    error(1, *tmp___7, "Bad patch #1");
    }
    }
  }
  {
  {
#line 724
  tmp___10 = strncmp((char const   *)newname, "+++ ", (size_t )4);
  }
  }
#line 724
  if (tmp___10) {
    {
    {
#line 725
    tmp___9 = __errno_location();
    }
    {
#line 725
    error(1, *tmp___9, "Bad patch #1");
    }
    }
  }
  {
  {
#line 726
  tmp___11 = strlen((char const   *)newname);
  }
#line 726
  *(newname + (tmp___11 - 1U)) = (char )'\000';
  {
#line 727
  start = ftell(p1);
  }
  {
#line 730
  fseek(p1, pos, 0);
  }
  {
#line 731
  create_orig(p1, & file_orig, ! not_reverted, (int *)((void *)0));
  }
  {
#line 732
  fseek(p1, pos, 0);
  }
  {
#line 733
  create_orig(p1, & file_new, not_reverted, (int *)((void *)0));
  }
  }
#line 736
  if (file_orig.min_context < (unsigned long )use_context) {
#line 737
    use_context = (unsigned int )file_orig.min_context;
  }
#line 739
  if (use_context == 3U) {
    {
    {
#line 740
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%su",
            diff_opts);
    }
    }
  } else {
    {
    {
#line 742
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%sU%d",
            diff_opts, use_context);
    }
    }
  }
  {
  {
#line 745
  write_file(& file_orig, tmpp1fd);
  }
#line 746
  file_new.unline = file_orig.unline;
  {
#line 747
  write_file(& file_new, tmpp2fd);
  }
  {
#line 748
  free_lines(file_orig.head);
  }
  {
#line 749
  free_lines(file_new.head);
  }
  {
#line 751
  fflush((FILE *)((void *)0));
  }
  {
#line 752
  in = xpipe("diff", & child, "r", "diff", options, tmpp1, tmpp2, (void *)0);
  }
  }
  {
  {
#line 755
  while (1) {
    while_continue___4: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
    {
    {
#line 756
    tmp___12 = fgetc(in);
    }
#line 756
    ch = tmp___12;
    }
#line 757
    if (ch == -1) {
#line 758
      goto while_break___0;
    } else
#line 757
    if (ch == 10) {
#line 758
      goto while_break___0;
    }
#line 759
    diff_is_empty = 0;
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
  {
#line 763
  while (1) {
    while_continue___5: /* CIL Label */ ;
    while_continue___1: /* CIL Label */ ;
    {
    {
#line 764
    tmp___13 = fgetc(in);
    }
#line 764
    ch___0 = tmp___13;
    }
#line 765
    if (ch___0 == -1) {
#line 766
      goto while_break___1;
    } else
#line 765
    if (ch___0 == 10) {
#line 766
      goto while_break___1;
    }
  }
  while_break___5: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 769
  if (! diff_is_empty) {
#line 770
    line = (char *)((void *)0);
#line 771
    linelen = (size_t )0;
#line 772
    if (not_reverted) {
      {
      {
#line 773
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"--- %s\n",
              oldname + 4);
      }
      {
#line 774
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"+++ %s\n",
              newname + 4);
      }
      }
    } else {
      {
      {
#line 776
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"--- %s\n",
              newname + 4);
      }
      {
#line 777
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"+++ %s\n",
              oldname + 4);
      }
      }
    }
    {
    {
#line 779
    while (1) {
      while_continue___6: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
      {
      {
#line 780
      tmp___14 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)in);
      }
#line 780
      got = tmp___14;
      }
#line 781
      if (got < 0) {
#line 782
        goto while_break___2;
      }
      {
      {
#line 783
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
      }
      }
    }
    while_break___6: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
  }
  {
  {
#line 787
  fclose(in);
  }
  {
#line 788
  waitpid(child, (int *)((void *)0), 0);
  }
  }
#line 789
  if (debug) {
    {
    {
#line 790
    printf((char const   */* __restrict  */)"reconstructed orig1=%s orig2=%s\n", tmpp1,
           tmpp2);
    }
    }
  } else {
    {
    {
#line 792
    unlink((char const   *)tmpp1);
    }
    {
#line 793
    unlink((char const   *)tmpp2);
    }
    }
  }
  {
  {
#line 795
  free((void *)oldname);
  }
  {
#line 796
  free((void *)newname);
  }
  }
#line 797
  return (0);
}
}
#line 800 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int apply_patch(FILE *patch , char const   *file , int reverted ) 
{ 
  unsigned long orig_lines ;
  unsigned long new_lines ;
  size_t linelen ;
  char *line ;
  pid_t child ;
  int status ;
  FILE *w ;
  char const   *tmp ;
  ssize_t got ;
  __ssize_t tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  union __anonunion_55 __constr_expr_0 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;

  {
#line 810
  if (reverted) {
#line 810
    tmp = "-Rsp0";
  } else {
#line 810
    tmp = "-sp0";
  }
  {
  {
#line 810
  w = xpipe("patch", & child, "w", "patch", tmp, (void *)0);
  }
  {
#line 813
  fprintf((FILE */* __restrict  */)w, (char const   */* __restrict  */)"--- %s\n+++ %s\n",
          file, file);
  }
#line 814
  line = (char *)((void *)0);
#line 815
  linelen = (size_t )0;
#line 816
  new_lines = 0UL;
#line 816
  orig_lines = new_lines;
  }
  {
  {
#line 817
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 818
    tmp___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)patch);
    }
#line 818
    got = tmp___0;
    }
#line 819
    if (got == -1) {
#line 820
      goto while_break;
    }
#line 823
    if (! orig_lines) {
#line 823
      if (! new_lines) {
        {
        {
#line 823
        tmp___1 = strncmp((char const   *)line, "--- ", (size_t )4);
        }
        }
#line 823
        if (! tmp___1) {
#line 824
          goto while_break;
        }
      }
    }
    {
    {
#line 826
    fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)w);
    }
    {
#line 828
    tmp___2 = strncmp((char const   *)line, "@@ ", (size_t )3);
    }
    }
#line 828
    if (! tmp___2) {
      {
      {
#line 829
      orig_lines = orig_num_lines((char const   *)line);
      }
      {
#line 830
      new_lines = new_num_lines((char const   *)line);
      }
      }
#line 831
      goto __Cont;
    }
#line 834
    if (orig_lines) {
#line 834
      if ((int )*(line + 0) != 43) {
#line 835
        orig_lines --;
      }
    }
#line 836
    if (new_lines) {
#line 836
      if ((int )*(line + 0) != 45) {
#line 837
        new_lines --;
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 839
  fclose(w);
  }
  {
#line 840
  waitpid(child, & status, 0);
  }
  }
#line 842
  if (line) {
    {
    {
#line 843
    free((void *)line);
    }
    }
  }
#line 845
  __constr_expr_0.__in = status;
#line 845
  return ((__constr_expr_0.__i & 65280) >> 8);
}
}
#line 848 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int trim_context(FILE *f , char const   *unline , FILE *out ) 
{ 
  char *line ;
  size_t linelen ;
  fpos_t pos ;
  unsigned long pre ;
  unsigned long pre_seen ;
  unsigned long post ;
  unsigned long strip_pre ;
  unsigned long strip_post ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  unsigned long orig_count ;
  unsigned long orig_orig_count ;
  unsigned long new_orig_count ;
  unsigned long new_count ;
  unsigned long orig_new_count ;
  unsigned long new_new_count ;
  unsigned long total_count ;
  __ssize_t tmp ;
  int tmp___0 ;
  __ssize_t tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  ssize_t got ;
  __ssize_t tmp___4 ;
  unsigned long tmp___5 ;
  char *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;
  char *__cil_tmp40 ;

  {
#line 856
  line = (char *)((void *)0);
  {
  {
#line 859
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
#line 861
    pre = 0UL;
#line 861
    pre_seen = 0UL;
#line 861
    post = 0UL;
#line 862
    strip_pre = 0UL;
#line 862
    strip_post = 0UL;
#line 866
    total_count = 0UL;
    {
#line 869
    tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)f);
    }
    }
#line 869
    if (tmp < 0) {
#line 870
      goto while_break;
    }
#line 872
    if ((int )*(line + 0) == 92) {
      {
      {
#line 874
      fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
      }
      }
#line 875
      goto __Cont;
    }
    {
    {
#line 878
    tmp___0 = read_atatline((char const   *)line, & orig_offset, & orig_count, & new_offset,
                            & new_count);
    }
    }
#line 878
    if (tmp___0) {
      {
      {
#line 880
      error(1, 0, "Line not understood: %s", line);
      }
      }
    }
    {
#line 883
    new_orig_count = orig_count;
#line 883
    orig_orig_count = new_orig_count;
#line 884
    new_new_count = new_count;
#line 884
    orig_new_count = new_new_count;
    {
#line 885
    fgetpos((FILE */* __restrict  */)f, (fpos_t */* __restrict  */)(& pos));
    }
    }
    {
    {
#line 886
    while (1) {
      while_continue___3: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 886
      if (! orig_count) {
#line 886
        if (! new_count) {
#line 886
          goto while_break___0;
        }
      }
      {
      {
#line 887
      tmp___1 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)f);
      }
      }
#line 887
      if (tmp___1 < 0) {
#line 888
        goto while_break___0;
      }
#line 890
      total_count ++;
      {
#line 892
      if ((int )*(line + 0) == 32) {
#line 892
        goto case_32;
      }
#line 906
      if ((int )*(line + 0) == 45) {
#line 906
        goto case_45;
      }
#line 913
      if ((int )*(line + 0) == 43) {
#line 913
        goto case_43;
      }
#line 891
      goto switch_break;
      case_32: /* CIL Label */ 
#line 893
      if (orig_count) {
#line 893
        orig_count --;
      }
#line 894
      if (new_count) {
#line 894
        new_count --;
      }
#line 895
      if (! pre_seen) {
        {
#line 896
        pre ++;
        {
#line 897
        tmp___2 = strcmp((char const   *)(line + 1), unline);
        }
        }
#line 897
        if (! tmp___2) {
#line 898
          strip_pre = pre;
        }
      } else {
#line 900
        post ++;
#line 901
        if (strip_post) {
#line 903
          strip_post ++;
        } else {
          {
          {
#line 901
          tmp___3 = strcmp((char const   *)(line + 1), unline);
          }
          }
#line 901
          if (! tmp___3) {
#line 903
            strip_post ++;
          }
        }
      }
#line 905
      goto switch_break;
      case_45: /* CIL Label */ 
#line 907
      if (orig_count) {
#line 907
        orig_count --;
      }
#line 908
      if (strip_post) {
#line 909
        goto split_hunk;
      }
#line 910
      pre_seen = 1UL;
#line 911
      post = 0UL;
#line 912
      goto switch_break;
      case_43: /* CIL Label */ 
#line 914
      if (new_count) {
#line 914
        new_count --;
      }
#line 915
      if (strip_post) {
#line 916
        goto split_hunk;
      }
#line 917
      pre_seen = 1UL;
#line 918
      post = 0UL;
#line 919
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
    }
    while_break___3: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 923
    pre -= strip_pre;
#line 924
    post -= strip_post;
#line 925
    if (pre > post) {
#line 926
      strip_pre += pre - post;
    }
#line 927
    orig_offset += strip_pre;
#line 928
    new_orig_count -= strip_pre + strip_post;
#line 929
    new_offset += strip_pre;
#line 930
    new_new_count -= strip_pre + strip_post;
#line 931
    if (orig_orig_count) {
#line 931
      if (! new_orig_count) {
#line 932
        orig_offset --;
      }
    }
#line 933
    if (orig_new_count) {
#line 933
      if (! new_new_count) {
#line 934
        new_offset --;
      }
    }
#line 936
    if (debug) {
      {
      {
#line 937
      printf((char const   */* __restrict  */)"Trim: %lu,%lu\n", strip_pre, strip_post);
      }
      }
    }
    {
    {
#line 939
    fsetpos(f, (fpos_t const   *)(& pos));
    }
    {
#line 940
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"@@ -%lu",
            orig_offset);
    }
    }
#line 941
    if (new_orig_count != 1UL) {
      {
      {
#line 942
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
              new_orig_count);
      }
      }
    }
    {
    {
#line 943
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" +%lu",
            new_offset);
    }
    }
#line 944
    if (new_new_count != 1UL) {
      {
      {
#line 945
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
              new_new_count);
      }
      }
    }
    {
    {
#line 946
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" @@\n");
    }
    }
    {
    {
#line 948
    while (1) {
      while_continue___4: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 948
      tmp___5 = total_count;
#line 948
      total_count --;
#line 948
      if (! tmp___5) {
#line 948
        goto while_break___1;
      }
      {
      {
#line 949
      tmp___4 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)f);
      }
#line 949
      got = tmp___4;
      }
#line 950
      if (! (got > 0)) {
        {
        {
#line 950
        __assert_fail("got > 0", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c",
                      950U, "trim_context");
        }
        }
      }
#line 952
      if (strip_pre) {
#line 953
        strip_pre --;
#line 954
        goto while_continue___1;
      }
#line 957
      if (total_count < strip_post) {
#line 958
        goto while_continue___1;
      }
      {
      {
#line 960
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
      }
      }
    }
    while_break___4: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 964
  free((void *)line);
  }
  }
#line 965
  return (0);
  split_hunk: 
  {
  {
#line 968
  error(0, 0, "hunk-splitting is required in this case, but is not yet implemented");
  }
  {
#line 969
  error(1, 0, "use the -U option to work around this");
  }
  }
#line 970
  return (0);
}
}
#line 973 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int output_delta(FILE *p1 , FILE *p2 , FILE *out ) 
{ 
  char const   *tmpdir ;
  char *tmp ;
  unsigned int tmplen ;
  char tail1[20] ;
  char tail2[20] ;
  char *tmpp1 ;
  char *tmpp2 ;
  int tmpp1fd ;
  int tmpp2fd ;
  struct lines_info file ;
  struct lines_info file2 ;
  char *oldname ;
  char *newname ;
  pid_t child ;
  FILE *in ;
  size_t namelen ;
  long pos1 ;
  long tmp___0 ;
  long pos2 ;
  long tmp___1 ;
  long pristine1 ;
  long pristine2 ;
  long start1 ;
  long start2 ;
  char options[100] ;
  int diff_is_empty ;
  void *tmp___2 ;
  void *tmp___3 ;
  int *tmp___4 ;
  __ssize_t tmp___5 ;
  int tmp___6 ;
  size_t tmp___7 ;
  int *tmp___8 ;
  __ssize_t tmp___9 ;
  int tmp___10 ;
  size_t tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int ch ;
  int tmp___14 ;
  int ch___0 ;
  int tmp___15 ;
  FILE *tmpdiff ;
  FILE *tmp___16 ;
  char *line ;
  size_t linelen ;
  ssize_t got ;
  __ssize_t tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  char *p ;
  char *q ;
  char c ;
  char d ;
  char const   *tmp___20 ;
  void *__cil_tmp59 ;
  void *__cil_tmp60 ;
  void *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;
  char *__cil_tmp76 ;
  char *__cil_tmp77 ;
  char *__cil_tmp78 ;
  char *__cil_tmp79 ;
  char *__cil_tmp80 ;
  char *__cil_tmp81 ;
  char *__cil_tmp82 ;
  char *__cil_tmp83 ;

  {
  {
  {
#line 976
  tmp = getenv("TMPDIR");
  }
#line 976
  tmpdir = (char const   *)tmp;
#line 978
  tail1[0] = (char )'/';
#line 978
  tail1[1] = (char )'i';
#line 978
  tail1[2] = (char )'n';
#line 978
  tail1[3] = (char )'t';
#line 978
  tail1[4] = (char )'e';
#line 978
  tail1[5] = (char )'r';
#line 978
  tail1[6] = (char )'d';
#line 978
  tail1[7] = (char )'i';
#line 978
  tail1[8] = (char )'f';
#line 978
  tail1[9] = (char )'f';
#line 978
  tail1[10] = (char )'-';
#line 978
  tail1[11] = (char )'1';
#line 978
  tail1[12] = (char )'.';
#line 978
  tail1[13] = (char )'X';
#line 978
  tail1[14] = (char )'X';
#line 978
  tail1[15] = (char )'X';
#line 978
  tail1[16] = (char )'X';
#line 978
  tail1[17] = (char )'X';
#line 978
  tail1[18] = (char )'X';
#line 978
  tail1[19] = (char )'\000';
#line 979
  tail2[0] = (char )'/';
#line 979
  tail2[1] = (char )'i';
#line 979
  tail2[2] = (char )'n';
#line 979
  tail2[3] = (char )'t';
#line 979
  tail2[4] = (char )'e';
#line 979
  tail2[5] = (char )'r';
#line 979
  tail2[6] = (char )'d';
#line 979
  tail2[7] = (char )'i';
#line 979
  tail2[8] = (char )'f';
#line 979
  tail2[9] = (char )'f';
#line 979
  tail2[10] = (char )'-';
#line 979
  tail2[11] = (char )'2';
#line 979
  tail2[12] = (char )'.';
#line 979
  tail2[13] = (char )'X';
#line 979
  tail2[14] = (char )'X';
#line 979
  tail2[15] = (char )'X';
#line 979
  tail2[16] = (char )'X';
#line 979
  tail2[17] = (char )'X';
#line 979
  tail2[18] = (char )'X';
#line 979
  tail2[19] = (char )'\000';
#line 982
  file.unline = (char *)((void *)0);
#line 982
  file.first_offset = 0UL;
#line 982
  file.min_context = 0UL;
#line 982
  file.head = (struct lines *)((void *)0);
#line 982
  file.tail = (struct lines *)((void *)0);
#line 983
  file2.unline = (char *)((void *)0);
#line 983
  file2.first_offset = 0UL;
#line 983
  file2.min_context = 0UL;
#line 983
  file2.head = (struct lines *)((void *)0);
#line 983
  file2.tail = (struct lines *)((void *)0);
#line 984
  oldname = (char *)((void *)0);
#line 984
  newname = (char *)((void *)0);
  {
#line 988
  tmp___0 = ftell(p1);
  }
#line 988
  pos1 = tmp___0;
  {
#line 988
  tmp___1 = ftell(p2);
  }
#line 988
  pos2 = tmp___1;
#line 992
  diff_is_empty = 1;
  {
#line 994
  pristine1 = ftell(p1);
  }
  {
#line 995
  pristine2 = ftell(p2);
  }
  }
#line 997
  if (! tmpdir) {
#line 998
    tmpdir = "/tmp";
  }
  {
  {
#line 1000
  tmplen = strlen(tmpdir);
  }
  {
#line 1001
  tmp___2 = __builtin_alloca((unsigned long )tmplen + sizeof(tail1));
  }
#line 1001
  tmpp1 = (char *)tmp___2;
  {
#line 1002
  memcpy((void */* __restrict  */)tmpp1, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 1003
  memcpy((void */* __restrict  */)(tmpp1 + tmplen), (void const   */* __restrict  */)(tail1),
         (size_t )sizeof(tail1));
  }
  {
#line 1004
  tmp___3 = __builtin_alloca((unsigned long )tmplen + sizeof(tail2));
  }
#line 1004
  tmpp2 = (char *)tmp___3;
  {
#line 1005
  memcpy((void */* __restrict  */)tmpp2, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 1006
  memcpy((void */* __restrict  */)(tmpp2 + tmplen), (void const   */* __restrict  */)(tail2),
         (size_t )sizeof(tail2));
  }
  }
#line 1008
  if (max_context == 3U) {
    {
    {
#line 1009
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%su",
            diff_opts);
    }
    }
  } else {
    {
    {
#line 1011
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%sU%d",
            diff_opts, max_context);
    }
    }
  }
  {
  {
#line 1013
  tmpp1fd = xmkstemp(tmpp1);
  }
  {
#line 1014
  tmpp2fd = xmkstemp(tmpp2);
  }
  }
  {
  {
#line 1016
  while (1) {
    while_continue___4: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1017
    if (oldname) {
      {
      {
#line 1018
      free((void *)oldname);
      }
#line 1019
      oldname = (char *)((void *)0);
      }
    }
    {
    {
#line 1021
    tmp___5 = getline((char **/* __restrict  */)(& oldname), (size_t */* __restrict  */)(& namelen),
                      (FILE */* __restrict  */)p1);
    }
    }
#line 1021
    if (tmp___5 < 0) {
      {
      {
#line 1022
      tmp___4 = __errno_location();
      }
      {
#line 1022
      error(1, *tmp___4, "Bad patch #1");
      }
      }
    }
    {
    {
#line 1016
    tmp___6 = strncmp((char const   *)oldname, "+++ ", (size_t )4);
    }
    }
#line 1016
    if (! tmp___6) {
#line 1016
      goto while_break;
    }
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1025
  tmp___7 = strlen((char const   *)oldname);
  }
#line 1025
  *(oldname + (tmp___7 - 1U)) = (char )'\000';
  }
  {
  {
#line 1027
  while (1) {
    while_continue___5: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 1028
    if (newname) {
      {
      {
#line 1029
      free((void *)newname);
      }
#line 1030
      newname = (char *)((void *)0);
      }
    }
    {
    {
#line 1032
    tmp___9 = getline((char **/* __restrict  */)(& newname), (size_t */* __restrict  */)(& namelen),
                      (FILE */* __restrict  */)p2);
    }
    }
#line 1032
    if (tmp___9 < 0) {
      {
      {
#line 1033
      tmp___8 = __errno_location();
      }
      {
#line 1033
      error(1, *tmp___8, "Bad patch #2");
      }
      }
    }
    {
    {
#line 1027
    tmp___10 = strncmp((char const   *)newname, "+++ ", (size_t )4);
    }
    }
#line 1027
    if (! tmp___10) {
#line 1027
      goto while_break___0;
    }
  }
  while_break___5: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
  {
#line 1036
  tmp___11 = strlen((char const   *)newname);
  }
#line 1036
  *(newname + (tmp___11 - 1U)) = (char )'\000';
  {
#line 1038
  start1 = ftell(p1);
  }
  {
#line 1039
  start2 = ftell(p2);
  }
  {
#line 1040
  fseek(p1, pos1, 0);
  }
  {
#line 1041
  fseek(p2, pos2, 0);
  }
  {
#line 1042
  create_orig(p2, & file, 0, (int *)((void *)0));
  }
  {
#line 1043
  fseek(p1, pos1, 0);
  }
  {
#line 1044
  fseek(p2, pos2, 0);
  }
  {
#line 1045
  create_orig(p1, & file2, (unsigned int )mode == 1U, (int *)((void *)0));
  }
  {
#line 1046
  merge_lines(& file, & file2);
  }
  {
#line 1047
  pos1 = ftell(p1);
  }
  {
#line 1050
  write_file(& file, tmpp1fd);
  }
  {
#line 1051
  write_file(& file, tmpp2fd);
  }
  {
#line 1052
  free_lines(file.head);
  }
  {
#line 1054
  fseek(p1, start1, 0);
  }
  {
#line 1055
  fseek(p2, start2, 0);
  }
  {
#line 1057
  tmp___12 = apply_patch(p1, (char const   *)tmpp1, (unsigned int )mode == 1U);
  }
  }
#line 1057
  if (tmp___12) {
    {
    {
#line 1058
    error(1, 0, "Error applying patch1 to reconstructed file");
    }
    }
  }
  {
  {
#line 1061
  tmp___13 = apply_patch(p2, (char const   *)tmpp2, 0);
  }
  }
#line 1061
  if (tmp___13) {
    {
    {
#line 1062
    error(1, 0, "Error applying patch2 to reconstructed file");
    }
    }
  }
  {
  {
#line 1065
  fseek(p1, pos1, 0);
  }
  {
#line 1067
  fflush((FILE *)((void *)0));
  }
  {
#line 1069
  in = xpipe("diff", & child, "r", "diff", options, tmpp1, tmpp2, (void *)0);
  }
  }
  {
  {
#line 1072
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue___1: /* CIL Label */ ;
    {
    {
#line 1073
    tmp___14 = fgetc(in);
    }
#line 1073
    ch = tmp___14;
    }
#line 1074
    if (ch == -1) {
#line 1075
      goto while_break___1;
    } else
#line 1074
    if (ch == 10) {
#line 1075
      goto while_break___1;
    }
#line 1076
    diff_is_empty = 0;
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  {
  {
#line 1080
  while (1) {
    while_continue___7: /* CIL Label */ ;
    while_continue___2: /* CIL Label */ ;
    {
    {
#line 1081
    tmp___15 = fgetc(in);
    }
#line 1081
    ch___0 = tmp___15;
    }
#line 1082
    if (ch___0 == -1) {
#line 1083
      goto while_break___2;
    } else
#line 1082
    if (ch___0 == 10) {
#line 1083
      goto while_break___2;
    }
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break___2: /* CIL Label */ ;
  }
#line 1086
  if (! diff_is_empty) {
    {
    {
#line 1090
    tmp___16 = xtmpfile();
    }
#line 1090
    tmpdiff = tmp___16;
#line 1091
    line = (char *)((void *)0);
    }
    {
    {
#line 1093
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___3: /* CIL Label */ ;
      {
      {
#line 1094
      tmp___17 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)in);
      }
#line 1094
      got = tmp___17;
      }
#line 1095
      if (got < 0) {
#line 1096
        goto while_break___3;
      }
      {
      {
#line 1097
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)tmpdiff);
      }
      }
#line 1098
      if ((int )*line != 32) {
        {
        {
#line 1098
        tmp___19 = strcmp((char const   *)(line + 1), (char const   *)file.unline);
        }
        }
#line 1098
        if (! tmp___19) {
          {
          {
#line 1105
          got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)in);
          }
          }
#line 1106
          if (got < 0) {
#line 1107
            goto __Cont;
          } else {
            {
            {
#line 1108
            tmp___18 = strncmp((char const   *)line, "@@ ", (size_t )3);
            }
            }
#line 1108
            if (tmp___18) {
              {
              {
#line 1113
              fclose(tmpdiff);
              }
              {
#line 1114
              free((void *)line);
              }
              }
#line 1115
              goto evasive_action;
            }
          }
          {
          {
#line 1117
          fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1,
                 (FILE */* __restrict  */)tmpdiff);
          }
          }
        }
      }
      __Cont: /* CIL Label */ ;
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___3: /* CIL Label */ ;
    }
    {
    {
#line 1120
    free((void *)line);
    }
    }
#line 1123
    if (human_readable) {
      {
#line 1125
      d = (char )'\000';
#line 1125
      c = d;
      {
#line 1126
      p = strchr((char const   *)(oldname + 4), '\t');
      }
      }
#line 1127
      if (p) {
#line 1128
        c = *p;
#line 1129
        *p = (char )'\000';
      }
      {
      {
#line 1131
      q = strchr((char const   *)(newname + 4), '\t');
      }
      }
#line 1132
      if (q) {
#line 1133
        d = *q;
#line 1134
        *q = (char )'\000';
      }
      {
      {
#line 1136
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"diff %s %s %s\n",
              options, oldname + 4, newname + 4);
      }
      }
#line 1138
      if (p) {
#line 1138
        *p = c;
      }
#line 1139
      if (q) {
#line 1139
        *q = d;
      }
    }
    {
    {
#line 1141
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"--- %s\n",
            oldname + 4);
    }
    {
#line 1142
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"+++ %s\n",
            newname + 4);
    }
    {
#line 1143
    rewind(tmpdiff);
    }
    {
#line 1144
    trim_context(tmpdiff, (char const   *)file.unline, out);
    }
    {
#line 1145
    fclose(tmpdiff);
    }
    }
  }
  {
  {
#line 1148
  fclose(in);
  }
  {
#line 1149
  waitpid(child, (int *)((void *)0), 0);
  }
  }
#line 1150
  if (debug) {
    {
    {
#line 1151
    printf((char const   */* __restrict  */)"reconstructed orig1=%s orig2=%s\n", tmpp1,
           tmpp2);
    }
    }
  } else {
    {
    {
#line 1153
    unlink((char const   *)tmpp1);
    }
    {
#line 1154
    unlink((char const   *)tmpp2);
    }
    }
  }
  {
  {
#line 1156
  free((void *)oldname);
  }
  {
#line 1157
  free((void *)newname);
  }
  }
#line 1158
  return (0);
  evasive_action: 
#line 1161
  if (debug) {
    {
    {
#line 1162
    printf((char const   */* __restrict  */)"reconstructed orig1=%s orig2=%s\n", tmpp1,
           tmpp2);
    }
    }
  } else {
    {
    {
#line 1164
    unlink((char const   *)tmpp1);
    }
    {
#line 1165
    unlink((char const   *)tmpp2);
    }
    }
  }
#line 1167
  if (human_readable) {
#line 1168
    if ((unsigned int )mode == 1U) {
#line 1168
      tmp___20 = "merge";
    } else {
#line 1168
      tmp___20 = "interdiff";
    }
    {
    {
#line 1168
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"%s impossible; taking evasive action\n",
            tmp___20);
    }
    }
  }
  {
  {
#line 1170
  fseek(p1, pristine1, 0);
  }
  {
#line 1171
  fseek(p2, pristine2, 0);
  }
  {
#line 1172
  output_patch1_only(p1, out, (unsigned int )mode == 1U);
  }
  {
#line 1173
  output_patch1_only(p2, out, 1);
  }
  }
#line 1174
  return (0);
}
}
#line 1177 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int copy_residue(FILE *p2 , FILE *out ) 
{ 
  struct file_list *at ;
  long tmp ;
  int tmp___0 ;
  char *__cil_tmp6 ;

  {
#line 1182
  at = files_in_patch2;
  {
  {
#line 1182
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1182
    if (! at) {
#line 1182
      goto while_break;
    }
    {
    {
#line 1184
    tmp = file_in_list(files_done, (char const   *)at->file);
    }
    }
#line 1184
    if (tmp != -1L) {
#line 1185
      goto __Cont;
    }
    {
    {
#line 1188
    tmp___0 = check_filename((char const   *)at->file);
    }
    }
#line 1188
    if (! tmp___0) {
#line 1189
      goto __Cont;
    }
    {
    {
#line 1191
    fseek(p2, at->pos, 0);
    }
    }
#line 1192
    if (human_readable) {
#line 1192
      if ((unsigned int )mode != 2U) {
        {
        {
#line 1193
        fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"only in patch2:\n");
        }
        }
      }
    }
    {
    {
#line 1195
    output_patch1_only(p2, out, 1);
    }
    }
    __Cont: /* CIL Label */ 
#line 1182
    at = at->next;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1198
  return (0);
}
}
#line 1201 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int index_patch2(FILE *p2 ) 
{ 
  char *line ;
  size_t linelen ;
  int is_context ;
  int file_is_empty ;
  unsigned long skip ;
  char *names[2] ;
  char *p ;
  char *end ;
  long pos ;
  long tmp ;
  __ssize_t tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  __ssize_t tmp___4 ;
  int tmp___5 ;
  __ssize_t tmp___6 ;
  int tmp___7 ;
  char *tmp___8 ;
  __ssize_t tmp___9 ;
  unsigned long tmp___10 ;
  int tmp___11 ;
  void *__cil_tmp24 ;
  char *__cil_tmp25 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;
  char *__cil_tmp28 ;
  char *__cil_tmp29 ;

  {
#line 1204
  line = (char *)((void *)0);
#line 1205
  linelen = (size_t )0;
#line 1206
  is_context = 0;
#line 1207
  file_is_empty = 1;
  {
  {
#line 1210
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1210
    tmp___11 = feof(p2);
    }
    }
#line 1210
    if (tmp___11) {
#line 1210
      goto while_break;
    }
    {
    {
#line 1214
    tmp = ftell(p2);
    }
#line 1214
    pos = tmp;
    {
#line 1216
    tmp___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p2);
    }
    }
#line 1216
    if (tmp___0 == -1) {
#line 1217
      goto while_break;
    }
    {
#line 1219
    file_is_empty = 0;
    {
#line 1221
    tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
    }
    }
#line 1221
    if (tmp___3) {
      {
      {
#line 1222
      tmp___1 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 1222
      if (tmp___1) {
#line 1222
        tmp___2 = 0;
      } else {
#line 1222
        tmp___2 = 1;
      }
#line 1222
      is_context = tmp___2;
#line 1223
      goto while_continue;
    }
#line 1226
    if (is_context) {
      {
      {
#line 1227
      error(1, 0, "I don\'t understand context diffs yet.");
      }
      }
    }
    {
    {
#line 1230
    names[0] = filename_from_header((char const   *)(line + 4));
    }
    {
#line 1232
    tmp___4 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p2);
    }
    }
#line 1232
    if (tmp___4 == -1) {
      {
      {
#line 1233
      free((void *)names[0]);
      }
      }
#line 1234
      goto while_break;
    }
    {
    {
#line 1237
    tmp___5 = strncmp((char const   *)line, "+++ ", (size_t )4);
    }
    }
#line 1237
    if (tmp___5) {
      {
      {
#line 1238
      free((void *)names[0]);
      }
      }
#line 1239
      goto while_continue;
    }
    {
    {
#line 1242
    names[1] = filename_from_header((char const   *)(line + 4));
    }
    {
#line 1244
    tmp___6 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p2);
    }
    }
#line 1244
    if (tmp___6 == -1) {
      {
      {
#line 1245
      free((void *)names[0]);
      }
      {
#line 1246
      free((void *)names[1]);
      }
      }
#line 1247
      goto while_break;
    }
    {
    {
#line 1250
    tmp___7 = strncmp((char const   *)line, "@@ ", (size_t )3);
    }
    }
#line 1250
    if (tmp___7) {
#line 1251
      goto try_next;
    }
    {
    {
#line 1253
    p = strchr((char const   *)(line + 3), '+');
    }
    }
#line 1254
    if (! p) {
#line 1255
      goto try_next;
    }
    {
    {
#line 1256
    p = strchr((char const   *)p, ',');
    }
    }
#line 1257
    if (p) {
      {
#line 1259
      p ++;
      {
#line 1260
      skip = strtoul((char const   */* __restrict  */)p, (char **/* __restrict  */)(& end),
                     10);
      }
      }
#line 1261
      if ((unsigned long )p == (unsigned long )end) {
#line 1262
        goto try_next;
      }
    } else {
#line 1265
      skip = 1UL;
    }
    {
    {
#line 1267
    tmp___8 = best_name(2, names);
    }
    {
#line 1267
    add_to_list(& files_in_patch2, (char const   *)tmp___8, pos);
    }
    }
    {
    {
#line 1269
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 1269
      tmp___10 = skip;
#line 1269
      skip --;
#line 1269
      if (! tmp___10) {
#line 1269
        goto while_break___0;
      }
      {
      {
#line 1270
      tmp___9 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)p2);
      }
      }
#line 1270
      if (tmp___9 == -1) {
#line 1271
        goto while_break___0;
      }
#line 1273
      if ((int )*(line + 0) == 45) {
#line 1275
        skip ++;
      }
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    try_next: 
    {
    {
#line 1279
    free((void *)names[0]);
    }
    {
#line 1280
    free((void *)names[1]);
    }
    }
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1283
  if (line) {
    {
    {
#line 1284
    free((void *)line);
    }
    }
  }
#line 1286
  if (file_is_empty) {
#line 1287
    return (0);
  } else
#line 1286
  if (files_in_patch2) {
#line 1287
    return (0);
  } else {
#line 1289
    return (1);
  }
}
}
#line 1313 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct offset *add_offset(unsigned long line , long offset , struct offset *offsets ,
                                 unsigned long *allocated , unsigned long *num_offsets ) 
{ 
  void *tmp ;
  char *__cil_tmp7 ;

  {
#line 1318
  if (*num_offsets == *allocated) {
    {
#line 1319
    *allocated *= 2UL;
    {
#line 1320
    tmp = xrealloc((void *)offsets, (size_t )(*allocated * sizeof(struct offset )));
    }
#line 1320
    offsets = (struct offset *)tmp;
    }
  }
#line 1323
  (offsets + *num_offsets)->line = line;
#line 1324
  (offsets + *num_offsets)->offset = offset;
#line 1325
  (*num_offsets) ++;
#line 1326
  if (debug) {
    {
    {
#line 1327
    printf((char const   */* __restrict  */)"%lu: %ld\n", line, offset);
    }
    }
  }
#line 1328
  return (offsets);
}
}
#line 1331 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int patch2_removes_line(unsigned long line , struct offset *offsets , unsigned long num_offsets ) 
{ 
  unsigned long i ;
  unsigned long this_line ;
  long this_offset ;
  char *__cil_tmp7 ;

  {
#line 1337
  i = 0UL;
  {
  {
#line 1337
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1337
    if (! (i < num_offsets)) {
#line 1337
      goto while_break;
    }
#line 1338
    this_line = (offsets + i)->line;
#line 1339
    this_offset = (offsets + i)->offset;
#line 1340
    if (this_line <= line) {
#line 1340
      if (this_offset < 0L) {
#line 1340
        if (this_line - (unsigned long )this_offset > line) {
#line 1343
          if (debug) {
            {
            {
#line 1344
            printf((char const   */* __restrict  */)"@%lu: removed (%ld)\n", line,
                   this_offset);
            }
            }
          }
#line 1346
          return (1);
        }
      }
    }
#line 1337
    i ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1350
  return (0);
}
}
#line 1353 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static long offset_at_line(unsigned long line , struct offset *offsets , unsigned long num_offsets ) 
{ 
  long offset ;
  unsigned long i ;
  unsigned long this_line ;
  long this_offset ;
  char *__cil_tmp8 ;

  {
#line 1358
  offset = 0L;
#line 1360
  i = 0UL;
  {
  {
#line 1360
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1360
    if (! (i < num_offsets)) {
#line 1360
      goto while_break;
    }
#line 1361
    this_line = (offsets + i)->line;
#line 1362
    this_offset = (offsets + i)->offset;
#line 1364
    if (this_line > line) {
#line 1365
      goto while_break;
    }
#line 1367
    offset += this_offset;
#line 1368
    if (this_line <= line) {
#line 1368
      if (this_offset < 0L) {
#line 1368
        if (this_line - (unsigned long )this_offset > line) {
#line 1371
          goto while_break;
        }
      }
    }
#line 1360
    i ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1374
  if (debug) {
    {
    {
#line 1375
    printf((char const   */* __restrict  */)"@%lu: %ld\n", line, offset);
    }
    }
  }
#line 1377
  return (offset);
}
}
#line 1380 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int insert_line(struct lines_info *lines___1 , char const   *line , size_t length ,
                       unsigned long n ) 
{ 
  struct lines *at ;
  int tmp ;
  char *__cil_tmp7 ;

  {
#line 1387
  at = lines___1->head;
  {
  {
#line 1387
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1387
    if (! at) {
#line 1387
      goto while_break;
    }
#line 1388
    if (n <= at->n) {
#line 1389
      goto while_break;
    }
#line 1387
    at = at->next;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1391
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 1391
    if (! at) {
#line 1391
      goto while_break___0;
    }
#line 1392
    (at->n) ++;
#line 1393
    at = at->next;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 1397
  if (debug) {
    {
    {
#line 1398
    printf((char const   */* __restrict  */)"Insert at %lu: %s", n, line);
    }
    }
  }
  {
  {
#line 1400
  tmp = add_line(lines___1, line, length, n);
  }
  }
#line 1400
  return (tmp);
}
}
#line 1403 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void remove_line(struct lines_info *lines___1 , char const   *line , unsigned long n ) 
{ 
  struct lines *at ;
  struct lines *kill___0 ;
  int tmp ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;

  {
#line 1407
  kill___0 = (struct lines *)((void *)0);
#line 1410
  at = lines___1->head;
  {
  {
#line 1410
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1410
    if (! at) {
#line 1410
      goto while_break;
    }
#line 1411
    if (n <= at->n) {
#line 1412
      goto while_break;
    }
#line 1410
    at = at->next;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1414
  if (at) {
#line 1414
    if (n == at->n) {
      {
#line 1415
      kill___0 = at;
      {
#line 1416
      tmp = strcmp((char const   *)at->line, line);
      }
      }
#line 1416
      if (tmp) {
#line 1416
        if (kill___0->prev) {
#line 1417
          kill___0 = kill___0->prev;
#line 1418
          if (debug) {
            {
            {
#line 1419
            printf((char const   */* __restrict  */)"Not removing from %lu: %s", n,
                   at->line);
            }
            }
          }
        }
      }
    }
  }
#line 1424
  at = kill___0;
  {
  {
#line 1425
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 1425
    if (! at) {
#line 1425
      goto while_break___0;
    }
#line 1426
    (at->n) --;
#line 1427
    at = at->next;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 1431
  if (debug) {
    {
    {
#line 1432
    printf((char const   */* __restrict  */)"Remove from %lu: %s", n, kill___0->line);
    }
    }
  }
#line 1434
  if (kill___0->prev) {
#line 1435
    (kill___0->prev)->next = kill___0->next;
  }
#line 1437
  if (kill___0->next) {
#line 1438
    (kill___0->next)->prev = kill___0->prev;
  }
#line 1440
  if ((unsigned long )lines___1->head == (unsigned long )kill___0) {
#line 1441
    lines___1->head = kill___0->next;
  }
#line 1443
  if ((unsigned long )lines___1->tail == (unsigned long )kill___0) {
#line 1444
    lines___1->tail = kill___0->prev;
  }
  {
  {
#line 1446
  free((void *)kill___0->line);
  }
  {
#line 1447
  free((void *)kill___0);
  }
  }
#line 1448
  return;
}
}
#line 1450 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int take_diff(char const   *f1 , char const   *f2 , char **headers , char const   *unline ,
                     FILE *out ) 
{ 
  char options[100] ;
  pid_t child ;
  int diff_is_empty ;
  FILE *in ;
  int ch ;
  int tmp ;
  int ch___0 ;
  int tmp___0 ;
  FILE *tmpdiff ;
  FILE *tmp___1 ;
  int ch___1 ;
  int tmp___2 ;
  int tmp___3 ;
  void *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;
  char *__cil_tmp25 ;

  {
#line 1456
  diff_is_empty = 1;
#line 1459
  if (max_context == 3U) {
    {
    {
#line 1460
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%su",
            diff_opts);
    }
    }
  } else {
    {
    {
#line 1462
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%sU%d",
            diff_opts, max_context);
    }
    }
  }
#line 1464
  if (debug) {
    {
    {
#line 1465
    printf((char const   */* __restrict  */)"+ diff %s %s %s\n", options, f1, f2);
    }
    }
  }
  {
  {
#line 1467
  in = xpipe("diff", & child, "r", "diff", options, f1, f2, (void *)0);
  }
  }
  {
  {
#line 1470
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1471
    tmp = fgetc(in);
    }
#line 1471
    ch = tmp;
    }
#line 1472
    if (ch == -1) {
#line 1473
      goto while_break;
    } else
#line 1472
    if (ch == 10) {
#line 1473
      goto while_break;
    }
#line 1474
    diff_is_empty = 0;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1478
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
    {
    {
#line 1479
    tmp___0 = fgetc(in);
    }
#line 1479
    ch___0 = tmp___0;
    }
#line 1480
    if (ch___0 == -1) {
#line 1481
      goto while_break___0;
    } else
#line 1480
    if (ch___0 == 10) {
#line 1481
      goto while_break___0;
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 1484
  if (! diff_is_empty) {
    {
    {
#line 1485
    tmp___1 = xtmpfile();
    }
#line 1485
    tmpdiff = tmp___1;
    }
    {
    {
#line 1486
    while (1) {
      while_continue___4: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
      {
      {
#line 1486
      tmp___3 = feof(in);
      }
      }
#line 1486
      if (tmp___3) {
#line 1486
        goto while_break___1;
      }
      {
      {
#line 1487
      tmp___2 = fgetc(in);
      }
#line 1487
      ch___1 = tmp___2;
      }
#line 1488
      if (ch___1 != -1) {
        {
        {
#line 1489
        fputc(ch___1, tmpdiff);
        }
        }
      }
    }
    while_break___4: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
    {
    {
#line 1491
    rewind(tmpdiff);
    }
    {
#line 1492
    fputs((char const   */* __restrict  */)*(headers + 0), (FILE */* __restrict  */)out);
    }
    {
#line 1493
    fputs((char const   */* __restrict  */)*(headers + 1), (FILE */* __restrict  */)out);
    }
    {
#line 1494
    trim_context(tmpdiff, unline, out);
    }
    {
#line 1495
    fclose(tmpdiff);
    }
    }
  }
  {
  {
#line 1498
  fclose(in);
  }
  {
#line 1499
  waitpid(child, (int *)((void *)0), 0);
  }
  }
#line 1500
  return (0);
}
}
#line 1503 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int flipdiff(FILE *p1 , FILE *p2 , FILE *flip1 , FILE *flip2 ) 
{ 
  char *line ;
  size_t linelen ;
  char tail1[19] ;
  char tail2[19] ;
  char tail3[19] ;
  char *tmpdir ;
  char *tmp ;
  char *header1[2] ;
  char *header2[2] ;
  unsigned int tmplen ;
  char *tmpp1 ;
  char *tmpp2 ;
  char *tmpp3 ;
  int tmpfd ;
  FILE *f ;
  fpos_t at1 ;
  fpos_t at2 ;
  struct lines_info intermediate ;
  struct offset *offsets ;
  unsigned long offset_alloc ;
  unsigned long num_offsets ;
  long this_offset ;
  unsigned long first_linenum ;
  unsigned long linenum___1 ;
  int saw_first_offset ;
  int clash ;
  unsigned long orig_lines ;
  unsigned long new_lines ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  char const   *tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  void *tmp___6 ;
  __ssize_t tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  ssize_t got ;
  int tmp___11 ;
  int tmp___12 ;
  ssize_t got___0 ;
  int tmp___13 ;
  int tmp___14 ;
  unsigned long at ;
  long tmp___15 ;
  int tmp___16 ;
  unsigned long at___0 ;
  long tmp___17 ;
  int tmp___18 ;
  void *__cil_tmp56 ;
  void *__cil_tmp57 ;
  void *__cil_tmp58 ;
  void *__cil_tmp59 ;
  void *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;

  {
  {
#line 1506
  line = (char *)((void *)0);
#line 1507
  linelen = (size_t )0;
#line 1508
  tail1[0] = (char )'/';
#line 1508
  tail1[1] = (char )'f';
#line 1508
  tail1[2] = (char )'l';
#line 1508
  tail1[3] = (char )'i';
#line 1508
  tail1[4] = (char )'p';
#line 1508
  tail1[5] = (char )'d';
#line 1508
  tail1[6] = (char )'i';
#line 1508
  tail1[7] = (char )'f';
#line 1508
  tail1[8] = (char )'f';
#line 1508
  tail1[9] = (char )'-';
#line 1508
  tail1[10] = (char )'1';
#line 1508
  tail1[11] = (char )'.';
#line 1508
  tail1[12] = (char )'X';
#line 1508
  tail1[13] = (char )'X';
#line 1508
  tail1[14] = (char )'X';
#line 1508
  tail1[15] = (char )'X';
#line 1508
  tail1[16] = (char )'X';
#line 1508
  tail1[17] = (char )'X';
#line 1508
  tail1[18] = (char )'\000';
#line 1509
  tail2[0] = (char )'/';
#line 1509
  tail2[1] = (char )'f';
#line 1509
  tail2[2] = (char )'l';
#line 1509
  tail2[3] = (char )'i';
#line 1509
  tail2[4] = (char )'p';
#line 1509
  tail2[5] = (char )'d';
#line 1509
  tail2[6] = (char )'i';
#line 1509
  tail2[7] = (char )'f';
#line 1509
  tail2[8] = (char )'f';
#line 1509
  tail2[9] = (char )'-';
#line 1509
  tail2[10] = (char )'2';
#line 1509
  tail2[11] = (char )'.';
#line 1509
  tail2[12] = (char )'X';
#line 1509
  tail2[13] = (char )'X';
#line 1509
  tail2[14] = (char )'X';
#line 1509
  tail2[15] = (char )'X';
#line 1509
  tail2[16] = (char )'X';
#line 1509
  tail2[17] = (char )'X';
#line 1509
  tail2[18] = (char )'\000';
#line 1510
  tail3[0] = (char )'/';
#line 1510
  tail3[1] = (char )'f';
#line 1510
  tail3[2] = (char )'l';
#line 1510
  tail3[3] = (char )'i';
#line 1510
  tail3[4] = (char )'p';
#line 1510
  tail3[5] = (char )'d';
#line 1510
  tail3[6] = (char )'i';
#line 1510
  tail3[7] = (char )'f';
#line 1510
  tail3[8] = (char )'f';
#line 1510
  tail3[9] = (char )'-';
#line 1510
  tail3[10] = (char )'3';
#line 1510
  tail3[11] = (char )'.';
#line 1510
  tail3[12] = (char )'X';
#line 1510
  tail3[13] = (char )'X';
#line 1510
  tail3[14] = (char )'X';
#line 1510
  tail3[15] = (char )'X';
#line 1510
  tail3[16] = (char )'X';
#line 1510
  tail3[17] = (char )'X';
#line 1510
  tail3[18] = (char )'\000';
  {
#line 1511
  tmp = getenv("TMPDIR");
  }
#line 1511
  tmpdir = tmp;
#line 1518
  intermediate.unline = (char *)((void *)0);
#line 1518
  intermediate.first_offset = 0UL;
#line 1518
  intermediate.min_context = 0UL;
#line 1518
  intermediate.head = (struct lines *)((void *)0);
#line 1518
  intermediate.tail = (struct lines *)((void *)0);
#line 1519
  offsets = (struct offset *)((void *)0);
#line 1520
  offset_alloc = 100UL;
#line 1521
  num_offsets = 0UL;
#line 1522
  this_offset = 0L;
#line 1523
  first_linenum = 0UL;
#line 1526
  clash = 0;
#line 1530
  header1[1] = (char *)((void *)0);
#line 1530
  header1[0] = header1[1];
#line 1531
  linelen = (size_t )0;
  {
#line 1532
  getline((char **/* __restrict  */)(& header1[0]), (size_t */* __restrict  */)(& linelen),
          (FILE */* __restrict  */)p1);
  }
#line 1533
  linelen = (size_t )0;
  {
#line 1534
  getline((char **/* __restrict  */)(& header1[1]), (size_t */* __restrict  */)(& linelen),
          (FILE */* __restrict  */)p1);
  }
#line 1536
  header2[1] = (char *)((void *)0);
#line 1536
  header2[0] = header2[1];
#line 1537
  linelen = (size_t )0;
  {
#line 1538
  getline((char **/* __restrict  */)(& header2[0]), (size_t */* __restrict  */)(& linelen),
          (FILE */* __restrict  */)p2);
  }
#line 1539
  linelen = (size_t )0;
  {
#line 1540
  getline((char **/* __restrict  */)(& header2[1]), (size_t */* __restrict  */)(& linelen),
          (FILE */* __restrict  */)p2);
  }
#line 1541
  linelen = (size_t )0;
  {
#line 1543
  fgetpos((FILE */* __restrict  */)p1, (fpos_t */* __restrict  */)(& at1));
  }
  {
#line 1544
  fgetpos((FILE */* __restrict  */)p2, (fpos_t */* __restrict  */)(& at2));
  }
  }
#line 1547
  if (! tmpdir) {
#line 1548
    tmpdir = (char *)"/tmp";
  }
  {
  {
#line 1550
  tmplen = strlen((char const   *)tmpdir);
  }
  {
#line 1551
  tmp___0 = __builtin_alloca((unsigned long )tmplen + sizeof(tail1));
  }
#line 1551
  tmpp1 = (char *)tmp___0;
  {
#line 1552
  memcpy((void */* __restrict  */)tmpp1, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 1553
  memcpy((void */* __restrict  */)(tmpp1 + tmplen), (void const   */* __restrict  */)(tail1),
         (size_t )sizeof(tail1));
  }
  {
#line 1555
  tmp___1 = __builtin_alloca((unsigned long )tmplen + sizeof(tail2));
  }
#line 1555
  tmpp2 = (char *)tmp___1;
  {
#line 1556
  memcpy((void */* __restrict  */)tmpp2, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 1557
  memcpy((void */* __restrict  */)(tmpp2 + tmplen), (void const   */* __restrict  */)(tail2),
         (size_t )sizeof(tail2));
  }
  {
#line 1559
  tmp___2 = __builtin_alloca((unsigned long )tmplen + sizeof(tail3));
  }
#line 1559
  tmpp3 = (char *)tmp___2;
  {
#line 1560
  memcpy((void */* __restrict  */)tmpp3, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 1561
  memcpy((void */* __restrict  */)(tmpp3 + tmplen), (void const   */* __restrict  */)(tail3),
         (size_t )sizeof(tail3));
  }
  {
#line 1564
  create_orig(p1, & intermediate, 1, (int *)((void *)0));
  }
  {
#line 1567
  create_orig(p2, & intermediate, 0, & clash);
  }
  }
#line 1571
  if (clash) {
#line 1572
    if (clash == 1) {
#line 1572
      tmp___3 = "";
    } else {
#line 1572
      tmp___3 = "s";
    }
    {
    {
#line 1572
    error(1, 0, "patches clashed in %d place%s - re-generate them first", clash, tmp___3);
    }
    }
  }
  {
  {
#line 1579
  tmpfd = xmkstemp(tmpp1);
  }
  {
#line 1580
  write_file(& intermediate, tmpfd);
  }
  {
#line 1581
  fsetpos(p1, (fpos_t const   *)(& at1));
  }
  {
#line 1582
  tmp___4 = apply_patch(p1, (char const   *)tmpp1, 1);
  }
  }
#line 1582
  if (tmp___4) {
    {
    {
#line 1583
    error(1, 0, "Error reconstructing original file");
    }
    }
  }
  {
  {
#line 1588
  tmpfd = xmkstemp(tmpp3);
  }
  {
#line 1589
  write_file(& intermediate, tmpfd);
  }
  {
#line 1590
  fsetpos(p2, (fpos_t const   *)(& at2));
  }
  {
#line 1591
  tmp___5 = apply_patch(p2, (char const   *)tmpp3, 0);
  }
  }
#line 1591
  if (tmp___5) {
    {
    {
#line 1592
    error(1, 0, "Error reconstructing final file");
    }
    }
  }
  {
  {
#line 1596
  fsetpos(p2, (fpos_t const   *)(& at2));
  }
  {
#line 1597
  tmp___6 = xmalloc((size_t )(offset_alloc * sizeof(struct offset )));
  }
#line 1597
  offsets = (struct offset *)tmp___6;
#line 1598
  new_lines = 0UL;
#line 1598
  orig_lines = new_lines;
  }
  {
  {
#line 1599
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1600
    tmp___7 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p2);
    }
    }
#line 1600
    if (tmp___7 == -1) {
#line 1601
      if (this_offset) {
        {
        {
#line 1602
        offsets = add_offset(first_linenum, this_offset, offsets, & offset_alloc,
                             & num_offsets);
        }
#line 1607
        this_offset = 0L;
        }
      }
#line 1609
      goto while_break;
    }
#line 1612
    if (! orig_lines) {
#line 1612
      if (! new_lines) {
#line 1612
        if (this_offset) {
          {
          {
#line 1613
          offsets = add_offset(first_linenum, this_offset, offsets, & offset_alloc,
                               & num_offsets);
          }
#line 1618
          this_offset = 0L;
          }
        }
      }
    }
#line 1621
    if (! orig_lines) {
#line 1621
      if (! new_lines) {
        {
        {
#line 1621
        tmp___8 = strncmp((char const   *)line, "@@ ", (size_t )3);
        }
        }
#line 1621
        if (tmp___8) {
#line 1622
          goto while_break;
        }
      }
    }
    {
    {
#line 1624
    tmp___10 = strncmp((char const   *)line, "@@ ", (size_t )3);
    }
    }
#line 1624
    if (! tmp___10) {
      {
      {
#line 1625
      tmp___9 = read_atatline((char const   *)line, & linenum___1, & orig_lines, (unsigned long *)((void *)0),
                              & new_lines);
      }
      }
#line 1625
      if (tmp___9) {
        {
        {
#line 1627
        error(1, 0, "line not understood: %s", line);
        }
        }
      }
#line 1630
      goto __Cont;
    }
#line 1633
    if (orig_lines) {
#line 1633
      if ((int )*(line + 0) != 43) {
#line 1634
        orig_lines --;
      }
    }
#line 1635
    if (new_lines) {
#line 1635
      if ((int )*(line + 0) != 45) {
#line 1636
        new_lines --;
      }
    }
    {
#line 1639
    if ((int )*(line + 0) == 32) {
#line 1639
      goto case_32;
    }
#line 1650
    if ((int )*(line + 0) == 45) {
#line 1650
      goto case_45;
    }
#line 1664
    if ((int )*(line + 0) == 43) {
#line 1664
      goto case_43;
    }
#line 1638
    goto switch_break;
    case_32: /* CIL Label */ 
#line 1640
    if (this_offset) {
      {
      {
#line 1641
      offsets = add_offset(first_linenum, this_offset, offsets, & offset_alloc, & num_offsets);
      }
#line 1646
      this_offset = 0L;
      }
    }
#line 1648
    goto switch_break;
    case_45: /* CIL Label */ 
#line 1651
    if (this_offset > 0L) {
      {
      {
#line 1652
      offsets = add_offset(first_linenum, this_offset, offsets, & offset_alloc, & num_offsets);
      }
#line 1657
      this_offset = 0L;
      }
    }
#line 1659
    if (this_offset == 0L) {
#line 1660
      first_linenum = linenum___1;
    }
#line 1661
    this_offset --;
#line 1662
    goto switch_break;
    case_43: /* CIL Label */ 
#line 1665
    if (this_offset < 0L) {
      {
      {
#line 1666
      offsets = add_offset(first_linenum, this_offset, offsets, & offset_alloc, & num_offsets);
      }
#line 1671
      this_offset = 0L;
      }
    }
#line 1673
    if (this_offset == 0L) {
#line 1674
      first_linenum = linenum___1;
    }
#line 1675
    this_offset ++;
#line 1676
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
#line 1679
    if ((int )*(line + 0) != 43) {
#line 1680
      linenum___1 ++;
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1686
  free_lines(intermediate.head);
  }
#line 1687
  intermediate.tail = (struct lines *)((void *)0);
#line 1687
  intermediate.head = intermediate.tail;
  {
#line 1688
  f = fopen((char const   */* __restrict  */)tmpp3, (char const   */* __restrict  */)"r");
  }
#line 1689
  linenum___1 = 0UL;
#line 1690
  saw_first_offset = 0;
  }
  {
  {
#line 1691
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
    {
    {
#line 1691
    tmp___12 = feof(f);
    }
    }
#line 1691
    if (tmp___12) {
#line 1691
      goto while_break___0;
    }
    {
#line 1693
    linenum___1 ++;
    {
#line 1694
    got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)f);
    }
    }
#line 1695
    if (got == -1) {
#line 1696
      goto while_break___0;
    }
    {
    {
#line 1697
    tmp___11 = strcmp((char const   *)line, (char const   *)intermediate.unline);
    }
    }
#line 1697
    if (! tmp___11) {
#line 1698
      if (! saw_first_offset) {
#line 1699
        intermediate.first_offset = linenum___1 + 1UL;
      }
#line 1700
      goto while_continue___0;
    }
#line 1703
    if (! saw_first_offset) {
#line 1704
      saw_first_offset = 1;
#line 1705
      intermediate.first_offset = linenum___1;
    }
    {
    {
#line 1708
    add_line(& intermediate, (char const   *)line, (size_t )got, linenum___1);
    }
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
  {
#line 1713
  fsetpos(p1, (fpos_t const   *)(& at1));
  }
#line 1714
  this_offset = 0L;
#line 1715
  new_lines = 0UL;
#line 1715
  orig_lines = new_lines;
  }
  {
  {
#line 1716
  while (1) {
    while_continue___4: /* CIL Label */ ;
    while_continue___1: /* CIL Label */ ;
    {
    {
#line 1718
    fgetpos((FILE */* __restrict  */)p1, (fpos_t */* __restrict  */)(& at1));
    }
    {
#line 1719
    got___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p1);
    }
    }
#line 1720
    if (got___0 == -1) {
#line 1721
      goto while_break___1;
    }
#line 1723
    if (! orig_lines) {
#line 1723
      if (! new_lines) {
        {
        {
#line 1723
        tmp___13 = strncmp((char const   *)line, "@@ ", (size_t )3);
        }
        }
#line 1723
        if (tmp___13) {
          {
          {
#line 1724
          fsetpos(p1, (fpos_t const   *)(& at1));
          }
          }
#line 1725
          goto while_break___1;
        }
      }
    }
#line 1728
    if (! orig_lines) {
#line 1728
      if (! new_lines) {
        {
        {
#line 1729
        tmp___14 = read_atatline((char const   *)line, (unsigned long *)((void *)0),
                                 & orig_lines, & linenum___1, & new_lines);
        }
        }
#line 1729
        if (tmp___14) {
          {
          {
#line 1731
          error(1, 0, "line not understood: %s", line);
          }
          }
        }
#line 1734
        goto __Cont___0;
      }
    }
#line 1740
    if (orig_lines) {
#line 1740
      if ((int )*(line + 0) != 43) {
#line 1741
        orig_lines --;
      }
    }
#line 1742
    if (new_lines) {
#line 1742
      if ((int )*(line + 0) != 45) {
#line 1743
        new_lines --;
      }
    }
#line 1745
    if ((int )*(line + 0) == 43) {
      {
      {
#line 1746
      tmp___16 = patch2_removes_line(linenum___1, offsets, num_offsets);
      }
      }
#line 1746
      if (! tmp___16) {
        {
#line 1748
        at = linenum___1;
        {
#line 1749
        tmp___15 = offset_at_line(linenum___1, offsets, num_offsets);
        }
#line 1749
        at += (unsigned long )tmp___15;
#line 1751
        at += (unsigned long )this_offset;
        {
#line 1752
        remove_line(& intermediate, (char const   *)(line + 1), at);
        }
#line 1753
        this_offset --;
        }
      }
    } else
#line 1755
    if ((int )*(line + 0) == 45) {
      {
      {
#line 1756
      tmp___18 = patch2_removes_line(linenum___1, offsets, num_offsets);
      }
      }
#line 1756
      if (! tmp___18) {
        {
#line 1758
        at___0 = linenum___1;
        {
#line 1759
        tmp___17 = offset_at_line(linenum___1, offsets, num_offsets);
        }
#line 1759
        at___0 += (unsigned long )tmp___17;
#line 1761
        at___0 += (unsigned long )this_offset;
        {
#line 1762
        insert_line(& intermediate, (char const   *)(line + 1), (size_t )got___0 - 1U,
                    at___0);
        }
        }
      }
#line 1765
      this_offset ++;
    }
#line 1768
    if ((int )*(line + 0) != 45) {
#line 1769
      linenum___1 ++;
    }
    __Cont___0: /* CIL Label */ ;
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  {
  {
#line 1772
  tmpfd = xmkstemp(tmpp2);
  }
  {
#line 1773
  write_file(& intermediate, tmpfd);
  }
  {
#line 1778
  take_diff((char const   *)tmpp1, (char const   *)tmpp2, (char **)(header2), (char const   *)intermediate.unline,
            flip1);
  }
  {
#line 1779
  take_diff((char const   *)tmpp2, (char const   *)tmpp3, (char **)(header1), (char const   *)intermediate.unline,
            flip2);
  }
  }
#line 1781
  if (line) {
    {
    {
#line 1782
    free((void *)line);
    }
    }
  }
#line 1783
  if (debug) {
    {
    {
#line 1784
    printf((char const   */* __restrict  */)"flipped\n");
    }
    }
  } else {
    {
    {
#line 1786
    unlink((char const   *)tmpp1);
    }
    {
#line 1787
    unlink((char const   *)tmpp2);
    }
    {
#line 1788
    unlink((char const   *)tmpp3);
    }
    }
  }
#line 1791
  return (0);
}
}
#line 1794 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int copy(FILE *from , FILE *to ) 
{ 
  int ch ;
  int tmp ;
  int tmp___0 ;

  {
  {
  {
#line 1797
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1797
    tmp___0 = feof(from);
    }
    }
#line 1797
    if (tmp___0) {
#line 1797
      goto while_break;
    }
    {
    {
#line 1798
    tmp = fgetc(from);
    }
#line 1798
    ch = tmp;
    }
#line 1799
    if (ch == -1) {
#line 1800
      goto while_break;
    }
    {
    {
#line 1801
    fputc(ch, to);
    }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1803
  return (0);
}
}
#line 1806 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int no_patch(char const   *f ) 
{ 
  char *__cil_tmp2 ;

  {
  {
  {
#line 1809
  error(0, 0, "%s doesn\'t contain a patch", f);
  }
  }
#line 1810
  return (0);
}
}
#line 1813 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int interdiff(FILE *p1 , FILE *p2 , char const   *patch1 , char const   *patch2 ) 
{ 
  char *line ;
  size_t linelen ;
  int is_context ;
  int patch_found ;
  int file_is_empty ;
  FILE *flip1 ;
  FILE *flip2 ;
  int tmp ;
  char *names[2] ;
  char *p ;
  long pos ;
  long start_pos ;
  long tmp___0 ;
  __ssize_t tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  __ssize_t tmp___5 ;
  int tmp___6 ;
  char *tmp___7 ;
  int tmp___8 ;
  FILE *tmp___9 ;
  int tmp___10 ;
  FILE *tmp___11 ;
  FILE *p1___0 ;
  FILE *tmp___12 ;
  FILE *p2___0 ;
  FILE *tmp___13 ;
  void *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;
  char *__cil_tmp40 ;

  {
#line 1816
  line = (char *)((void *)0);
#line 1817
  linelen = (size_t )0;
#line 1818
  is_context = 0;
#line 1819
  patch_found = 0;
#line 1820
  file_is_empty = 1;
#line 1821
  flip1 = (FILE *)((void *)0);
#line 1821
  flip2 = (FILE *)((void *)0);
#line 1823
  if ((unsigned int )mode == 2U) {
    {
    {
#line 1824
    flip1 = xtmpfile();
    }
    {
#line 1825
    flip2 = xtmpfile();
    }
    }
  }
  {
  {
#line 1828
  tmp = index_patch2(p2);
  }
  }
#line 1828
  if (tmp) {
    {
    {
#line 1829
    no_patch(patch2);
    }
    }
  }
  {
  {
#line 1832
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1832
    tmp___10 = feof(p1);
    }
    }
#line 1832
    if (tmp___10) {
#line 1832
      goto while_break;
    }
    {
    {
#line 1835
    tmp___0 = ftell(p1);
    }
#line 1835
    start_pos = tmp___0;
    }
#line 1837
    if (line) {
      {
      {
#line 1838
      free((void *)line);
      }
#line 1839
      line = (char *)((void *)0);
#line 1840
      linelen = (size_t )0;
      }
    }
    {
    {
#line 1843
    tmp___1 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p1);
    }
    }
#line 1843
    if (tmp___1 == -1) {
#line 1844
      goto while_break;
    }
    {
#line 1846
    file_is_empty = 0;
    {
#line 1848
    tmp___4 = strncmp((char const   *)line, "--- ", (size_t )4);
    }
    }
#line 1848
    if (tmp___4) {
      {
      {
#line 1849
      tmp___2 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 1849
      if (tmp___2) {
#line 1849
        tmp___3 = 0;
      } else {
#line 1849
        tmp___3 = 1;
      }
#line 1849
      is_context = tmp___3;
#line 1850
      goto while_continue;
    }
#line 1853
    if (is_context) {
      {
      {
#line 1854
      error(1, 0, "I don\'t understand context diffs yet.");
      }
      }
    }
    {
    {
#line 1857
    names[0] = filename_from_header((char const   *)(line + 4));
    }
    {
#line 1859
    tmp___5 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p1);
    }
    }
#line 1859
    if (tmp___5 == -1) {
#line 1860
      goto while_break;
    }
    {
    {
#line 1862
    tmp___6 = strncmp((char const   *)line, "+++ ", (size_t )4);
    }
    }
#line 1862
    if (tmp___6) {
#line 1863
      goto while_continue;
    }
    {
    {
#line 1865
    names[1] = filename_from_header((char const   *)(line + 4));
    }
    {
#line 1867
    tmp___7 = best_name(2, names);
    }
    {
#line 1867
    p = xstrdup((char const   *)tmp___7);
    }
    {
#line 1868
    free((void *)names[0]);
    }
    {
#line 1869
    free((void *)names[1]);
    }
#line 1870
    patch_found = 1;
    {
#line 1873
    tmp___8 = check_filename((char const   *)p);
    }
    }
#line 1873
    if (! tmp___8) {
      {
      {
#line 1874
      add_to_list(& files_done, (char const   *)p, 0L);
      }
      }
#line 1875
      goto while_continue;
    }
    {
    {
#line 1878
    fseek(p1, start_pos, 0);
    }
    {
#line 1879
    pos = file_in_list(files_in_patch2, (char const   *)p);
    }
    }
#line 1880
    if (pos == -1L) {
#line 1881
      if ((unsigned int )mode == 2U) {
#line 1881
        tmp___9 = flip2;
      } else {
#line 1881
        tmp___9 = stdout;
      }
      {
      {
#line 1881
      output_patch1_only(p1, tmp___9, (unsigned int )mode != 0U);
      }
      }
    } else {
      {
      {
#line 1885
      fseek(p2, pos, 0);
      }
      }
#line 1886
      if ((unsigned int )mode == 2U) {
        {
        {
#line 1887
        flipdiff(p1, p2, flip1, flip2);
        }
        }
      } else {
        {
        {
#line 1889
        output_delta(p1, p2, stdout);
        }
        }
      }
    }
    {
    {
#line 1892
    add_to_list(& files_done, (char const   *)p, 0L);
    }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1895
  if (! file_is_empty) {
#line 1895
    if (! patch_found) {
      {
      {
#line 1896
      no_patch(patch1);
      }
      }
    }
  }
#line 1898
  if ((unsigned int )mode == 2U) {
#line 1898
    tmp___11 = flip1;
  } else {
#line 1898
    tmp___11 = stdout;
  }
  {
  {
#line 1898
  copy_residue(p2, tmp___11);
  }
  }
#line 1900
  if ((unsigned int )mode == 2U) {
    {
    {
#line 1902
    rewind(flip1);
    }
    {
#line 1903
    rewind(flip2);
    }
    }
#line 1905
    if (flipdiff_inplace) {
      {
      {
#line 1906
      tmp___12 = xopen(patch1, "wb");
      }
#line 1906
      p1___0 = tmp___12;
      {
#line 1907
      tmp___13 = xopen(patch2, "wb");
      }
#line 1907
      p2___0 = tmp___13;
      {
#line 1909
      copy(flip1, p2___0);
      }
      {
#line 1910
      copy(flip2, p1___0);
      }
      }
    } else {
      {
      {
#line 1912
      copy(flip1, stdout);
      }
      {
#line 1913
      puts("\n=== 8< === cut here === 8< ===\n");
      }
      {
#line 1914
      copy(flip2, stdout);
      }
      }
    }
  }
#line 1918
  if (flip1) {
    {
    {
#line 1919
    fclose(flip1);
    }
    }
  }
#line 1920
  if (flip2) {
    {
    {
#line 1921
    fclose(flip2);
    }
    }
  }
  {
  {
#line 1922
  free_list(files_in_patch2);
  }
  {
#line 1923
  free_list(files_done);
  }
  }
#line 1924
  if (line) {
    {
    {
#line 1925
    free((void *)line);
    }
    }
  }
#line 1926
  return (0);
}
}
#line 1929
static  __attribute__((__noreturn__)) void syntax(int err ) ;
#line 1929 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void syntax(int err ) 
{ 
  char const   *syntax_str___2 ;
  struct _IO_FILE *tmp ;
  char *__cil_tmp4 ;

  {
#line 1932
  syntax_str___2 = "usage: %s [OPTIONS] patch1 patch2\n       %s --version|--help\nOPTIONS are:\n  -U N, --unified=N\n                  max lines of context to carry\n  -i, --ignore-case\n                  Consider upper- and lower-case to be the same\n  -w, --ignore-all-space\n                  ignore whitespace changes in patches\n  -b, --ignore-space-change\n                  ignore changes in the amount of whitespace\n  -B, --ignore-blank-lines\n                  ignore changes whose lines are all blank\n  -p N, --strip-match=N\n                  pathname components to ignore\n  -q, --quiet\n                  don\'t add rationale text\n  -d PAT, --drop-context=PAT\n                  drop context on matching files\n  -z, --decompress\n                  decompress .gz and .bz2 files\n  --interpolate   run as \'interdiff\'\n  --combine       run as \'combinediff\'\n  --flip          run as \'flipdiff\'\n  --no-revert-omitted\n                  (interdiff) When a patch from patch1 is not in patch2,\n                  don\'t revert it\n  --in-place      (flipdiff) Write the output to the original input\n                  files\n";
#line 1963
  if (err) {
#line 1963
    tmp = stderr;
  } else {
#line 1963
    tmp = stdout;
  }
  {
  {
#line 1963
  fprintf((FILE */* __restrict  */)tmp, (char const   */* __restrict  */)syntax_str___2,
          progname, progname);
  }
  {
#line 1964
  exit(err);
  }
  }
}
}
#line 1967 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void set_interdiff(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1971
  set_progname("interdiff");
  }
#line 1972
  mode = (enum __anonenum_mode_54 )0;
  }
#line 1973
  return;
}
}
#line 1975 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void set_combinediff(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1979
  set_progname("combinediff");
  }
#line 1980
  mode = (enum __anonenum_mode_54 )1;
  }
#line 1981
  return;
}
}
#line 1983 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void set_flipdiff(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1987
  set_progname("flipdiff");
  }
#line 1988
  mode = (enum __anonenum_mode_54 )2;
  }
#line 1989
  return;
}
}
#line 1991 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void get_mode_from_name(char const   *argv0 ) 
{ 
  char const   *p ;
  char *tmp ;
  char const   *tmp___0 ;
  char *tmp___1 ;
  char *tmp___2 ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;

  {
  {
  {
#line 1996
  tmp = strrchr(argv0, '/');
  }
#line 1996
  p = (char const   *)tmp;
#line 1997
  tmp___0 = p;
#line 1997
  p ++;
  }
#line 1997
  if (! tmp___0) {
#line 1998
    p = argv0;
  }
  {
  {
#line 1999
  tmp___2 = strstr(p, "combine");
  }
  }
#line 1999
  if (tmp___2) {
    {
    {
#line 2000
    set_combinediff();
    }
    }
  } else {
    {
    {
#line 2001
    tmp___1 = strstr(p, "flip");
    }
    }
#line 2001
    if (tmp___1) {
      {
      {
#line 2002
      set_flipdiff();
      }
      }
    } else {
      {
      {
#line 2004
      set_interdiff();
      }
      }
    }
  }
#line 2005
  return;
}
}
#line 2017
int main(int argc , char **argv ) ;
#line 2017 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct option long_options[18]  = 
#line 2017
  {      {"help", 0, (int *)0, 1072}, 
        {"version", 0, (int *)0, 1086}, 
        {"interpolate", 0, (int *)0, 1073}, 
        {"combine", 0, (int *)0, 1067}, 
        {"flip", 0, (int *)0, 1070}, 
        {"no-revert-omitted", 0, (int *)0, 1082}, 
        {"in-place", 0, (int *)0, 1105}, 
        {"debug", 0, (int *)0, 1068}, 
        {"strip-match", 1, (int *)0, 'p'}, 
        {"unified", 1, (int *)0, 'U'}, 
        {"drop-context", 1, (int *)0, 'd'}, 
        {"ignore-blank-lines", 0, (int *)0, 'B'}, 
        {"ignore-space-change", 0, (int *)0, 'b'}, 
        {"ignore-case", 0, (int *)0, 'i'}, 
        {"ignore-all-space", 0, (int *)0, 'w'}, 
        {"decompress", 0, (int *)0, 'z'}, 
        {"quiet", 0, (int *)0, 'q'}, 
        {(char const   *)0, 0, (int *)0, 0}};
#line 2007 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
int main(int argc , char **argv ) 
{ 
  FILE *p1 ;
  FILE *p2 ;
  int num_diff_opts ;
  int ret ;
  char *end ;
  int c ;
  int tmp ;
  unsigned long tmp___0 ;
  unsigned long tmp___1 ;
  int tmp___2 ;
  void *tmp___3 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;

  {
  {
#line 2011
  num_diff_opts = 0;
  {
#line 2014
  get_mode_from_name((char const   *)*(argv + 0));
  }
#line 2015
  diff_opts[0] = (char )'\000';
  }
  {
  {
#line 2016
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 2038
    tmp = getopt_long(argc, (char * const  *)argv, "BU:bd:hip:qwz", (struct option  const  *)(long_options),
                      (int *)((void *)0));
    }
#line 2038
    c = tmp;
    }
#line 2040
    if (c == -1) {
#line 2041
      goto while_break;
    }
    {
#line 2044
    if (c == 1086) {
#line 2044
      goto case_1086;
    }
#line 2048
    if (c == 1072) {
#line 2048
      goto case_1072;
    }
#line 2051
    if (c == 104) {
#line 2051
      goto case_104;
    }
#line 2053
    if (c == 85) {
#line 2053
      goto case_85;
    }
#line 2059
    if (c == 112) {
#line 2059
      goto case_112;
    }
#line 2064
    if (c == 113) {
#line 2064
      goto case_113;
    }
#line 2067
    if (c == 100) {
#line 2067
      goto case_100;
    }
#line 2070
    if (c == 122) {
#line 2070
      goto case_122;
    }
#line 2076
    if (c == 119) {
#line 2076
      goto case_119;
    }
#line 2076
    if (c == 105) {
#line 2076
      goto case_119;
    }
#line 2076
    if (c == 98) {
#line 2076
      goto case_119;
    }
#line 2076
    if (c == 66) {
#line 2076
      goto case_119;
    }
#line 2082
    if (c == 1073) {
#line 2082
      goto case_1073;
    }
#line 2085
    if (c == 1067) {
#line 2085
      goto case_1067;
    }
#line 2088
    if (c == 1070) {
#line 2088
      goto case_1070;
    }
#line 2091
    if (c == 1082) {
#line 2091
      goto case_1082;
    }
#line 2094
    if (c == 1105) {
#line 2094
      goto case_1105;
    }
#line 2099
    if (c == 1068) {
#line 2099
      goto case_1068;
    }
#line 2102
    goto switch_default;
    case_1086: /* CIL Label */ 
    {
    {
#line 2045
    printf((char const   */* __restrict  */)"%s - patchutils version %s\n", progname,
           "0.3.1");
    }
    {
#line 2047
    exit(0);
    }
    }
    case_1072: /* CIL Label */ 
    {
    {
#line 2049
    syntax(0);
    }
    }
#line 2050
    goto switch_break;
    case_104: /* CIL Label */ 
#line 2052
    goto switch_break;
    case_85: /* CIL Label */ 
    {
    {
#line 2054
    tmp___0 = strtoul((char const   */* __restrict  */)optarg, (char **/* __restrict  */)(& end),
                      0);
    }
#line 2054
    max_context_real = (unsigned int )tmp___0;
    }
#line 2055
    if ((unsigned long )optarg == (unsigned long )end) {
      {
      {
#line 2056
      syntax(1);
      }
      }
    }
#line 2057
    context_specified = 1;
#line 2058
    goto switch_break;
    case_112: /* CIL Label */ 
    {
    {
#line 2060
    tmp___1 = strtoul((char const   */* __restrict  */)optarg, (char **/* __restrict  */)(& end),
                      0);
    }
#line 2060
    ignore_components = (int )tmp___1;
    }
#line 2061
    if ((unsigned long )optarg == (unsigned long )end) {
      {
      {
#line 2062
      syntax(1);
      }
      }
    }
#line 2063
    goto switch_break;
    case_113: /* CIL Label */ 
#line 2065
    human_readable = 0;
#line 2066
    goto switch_break;
    case_100: /* CIL Label */ 
    {
    {
#line 2068
    patlist_add(& pat_drop_context, (char const   *)optarg);
    }
    }
#line 2069
    goto switch_break;
    case_122: /* CIL Label */ 
#line 2071
    unzip = 1;
#line 2072
    goto switch_break;
    case_119: /* CIL Label */ 
    case_105: /* CIL Label */ 
    case_98: /* CIL Label */ 
    case_66: /* CIL Label */ 
    {
    {
#line 2077
    tmp___3 = memchr((void const   *)(diff_opts), c, (size_t )num_diff_opts);
    }
    }
#line 2077
    if (! tmp___3) {
#line 2078
      tmp___2 = num_diff_opts;
#line 2078
      num_diff_opts ++;
#line 2078
      diff_opts[tmp___2] = (char )c;
#line 2079
      diff_opts[num_diff_opts] = (char )'\000';
    }
#line 2081
    goto switch_break;
    case_1073: /* CIL Label */ 
    {
    {
#line 2083
    set_interdiff();
    }
    }
#line 2084
    goto switch_break;
    case_1067: /* CIL Label */ 
    {
    {
#line 2086
    set_combinediff();
    }
    }
#line 2087
    goto switch_break;
    case_1070: /* CIL Label */ 
    {
    {
#line 2089
    set_flipdiff();
    }
    }
#line 2090
    goto switch_break;
    case_1082: /* CIL Label */ 
#line 2092
    no_revert_omitted = 1;
#line 2093
    goto switch_break;
    case_1105: /* CIL Label */ 
#line 2095
    if ((unsigned int )mode != 2U) {
      {
      {
#line 2096
      syntax(1);
      }
      }
    }
#line 2097
    flipdiff_inplace = 1;
#line 2098
    goto switch_break;
    case_1068: /* CIL Label */ 
#line 2100
    debug = 1;
#line 2101
    goto switch_break;
    switch_default: /* CIL Label */ 
    {
    {
#line 2103
    syntax(1);
    }
    }
    switch_break: /* CIL Label */ ;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 2107
  if (unzip) {
#line 2107
    if (flipdiff_inplace) {
      {
      {
#line 2108
      error(1, 0, "-z and --in-place are mutually exclusive.");
      }
      }
    }
  }
#line 2111
  if (optind + 2 != argc) {
    {
    {
#line 2112
    syntax(1);
    }
    }
  }
#line 2114
  if (unzip) {
    {
    {
#line 2115
    p1 = xopen_unzip((char const   *)*(argv + optind), "rb");
    }
    {
#line 2116
    p2 = xopen_unzip((char const   *)*(argv + (optind + 1)), "rb");
    }
    }
  } else {
    {
    {
#line 2118
    p1 = xopen((char const   *)*(argv + optind), "rbm");
    }
    {
#line 2119
    p2 = xopen((char const   *)*(argv + (optind + 1)), "rbm");
    }
    }
  }
  {
  {
#line 2122
  p1 = convert_to_unified(p1, "rb", 1);
  }
  {
#line 2123
  p2 = convert_to_unified(p2, "rb", 1);
  }
  {
#line 2125
  ret = interdiff(p1, p2, (char const   *)*(argv + optind), (char const   *)*(argv + (optind + 1)));
  }
  {
#line 2127
  fclose(p1);
  }
  {
#line 2128
  fclose(p2);
  }
  {
#line 2129
  patlist_free(& pat_drop_context);
  }
  }
#line 2130
  return (ret);
}
}
#line 220 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void copy_context_hunks___0(char **line , size_t *linelen , ssize_t *got ,
                                   unsigned long *linenum___1 ) 
{ 
  unsigned long unchanged ;
  unsigned long line_start ;
  unsigned long line_end ;
  unsigned long line_count ;
  char *n ;
  char *end ;
  int i ;
  int first ;
  int tmp ;
  char const   *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  unsigned long tmp___3 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;

  {
  {
  {
#line 223
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 224
    unchanged = 0UL;
#line 229
    i = 0;
    {
    {
#line 229
    while (1) {
      while_continue___3: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 229
      if (! (i < 2)) {
#line 229
        goto while_break___0;
      }
      {
#line 230
      first = 1;
      {
#line 231
      *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                     (FILE */* __restrict  */)stdin);
      }
      }
#line 232
      if (*got == -1) {
#line 233
        return;
      }
#line 234
      (*linenum___1) ++;
#line 236
      if (! i) {
        {
        {
#line 236
        tmp = strncmp((char const   *)*line, "***************", (size_t )15);
        }
        }
#line 236
        if (! tmp) {
#line 241
          i --;
#line 242
          goto __Cont;
        }
      }
#line 245
      if (i) {
#line 245
        tmp___0 = "--- ";
      } else {
#line 245
        tmp___0 = "*** ";
      }
      {
      {
#line 245
      tmp___1 = strncmp((char const   *)*line, tmp___0, (size_t )4);
      }
      }
#line 245
      if (tmp___1) {
#line 246
        return;
      }
      do_line_counts: 
      {
#line 249
      n = *line + 4;
      {
#line 250
      line_start = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
      }
      }
#line 251
      if ((unsigned long )n == (unsigned long )end) {
#line 252
        return;
      }
#line 254
      if ((int )*end == 44) {
        {
#line 255
        n = end + 1;
        {
#line 256
        line_end = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
        }
        }
#line 257
        if ((unsigned long )n == (unsigned long )end) {
#line 258
          return;
        }
#line 260
        if (line_start > line_end) {
#line 261
          return;
        }
#line 263
        line_count = (line_end - line_start) + 1UL;
      } else {
#line 265
        line_end = line_start;
#line 266
        if (line_start) {
#line 266
          line_count = 1UL;
        } else {
#line 266
          line_count = 0UL;
        }
      }
      {
      {
#line 269
      fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      }
#line 271
      if (i) {
#line 271
        if (line_count == unchanged) {
#line 272
          goto while_break___0;
        }
      }
      {
      {
#line 274
      while (1) {
        while_continue___4: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 274
        tmp___3 = line_count;
#line 274
        line_count --;
#line 274
        if (! tmp___3) {
#line 274
          goto while_break___1;
        }
        {
        {
#line 275
        *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                       (FILE */* __restrict  */)stdin);
        }
        }
#line 276
        if (*got == -1) {
#line 277
          return;
        }
#line 278
        (*linenum___1) ++;
#line 280
        if (! i) {
#line 280
          if (first) {
            {
#line 281
            first = 0;
            {
#line 282
            tmp___2 = strncmp((char const   *)*line, "--- ", (size_t )4);
            }
            }
#line 282
            if (! tmp___2) {
#line 284
              i ++;
#line 285
              goto do_line_counts;
            }
          }
        }
        {
        {
#line 289
        fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1,
               (FILE */* __restrict  */)stdout);
        }
        }
#line 290
        if ((int )*(*line) == 32) {
#line 291
          unchanged ++;
        }
      }
      while_break___4: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
      __Cont: /* CIL Label */ 
#line 229
      i ++;
    }
    while_break___3: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
}
}
#line 297 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void convert_unified_hunks_to_context___0(char **line , size_t *linelen , unsigned long *linenum___1 ) 
{ 
  unsigned long orig_offset ;
  unsigned long orig_count ;
  unsigned long new_offset ;
  unsigned long new_count ;
  char **orig_line ;
  char **new_line ;
  char **orig_what ;
  char **new_what ;
  char **whats ;
  unsigned int n_whats ;
  unsigned long orig_linenum ;
  unsigned long new_linenum ;
  char const   *no_newline_str ;
  int tmp ;
  __ssize_t tmp___0 ;
  char *last_orig ;
  char *last_new ;
  char *misc ;
  char *what ;
  int newline ;
  int can_omit_from ;
  int can_omit_to ;
  unsigned long i ;
  int tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  void *tmp___4 ;
  void *tmp___5 ;
  void *tmp___6 ;
  int get_out ;
  __ssize_t tmp___7 ;
  unsigned long tmp___8 ;
  unsigned long tmp___9 ;
  void *tmp___10 ;
  unsigned int tmp___11 ;
  unsigned long tmp___12 ;
  void *tmp___13 ;
  unsigned int tmp___14 ;
  unsigned long tmp___15 ;
  size_t tmp___16 ;
  size_t tmp___17 ;
  char *l ;
  size_t tmp___18 ;
  char *l___0 ;
  size_t tmp___19 ;
  int tmp___20 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;

  {
  {
#line 300
  orig_count = 0UL;
#line 300
  new_count = 0UL;
#line 301
  orig_line = (char **)((void *)0);
#line 301
  new_line = (char **)((void *)0);
#line 302
  orig_what = (char **)((void *)0);
#line 302
  new_what = (char **)((void *)0);
#line 303
  whats = (char **)((void *)0);
#line 304
  n_whats = 0U;
#line 306
  no_newline_str = "\\ No newline at end of file\n";
  {
#line 308
  tmp = feof(stdin);
  }
  }
#line 308
  if (tmp) {
#line 309
    goto eof;
  }
  {
  {
#line 311
  tmp___0 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                    (FILE */* __restrict  */)stdin);
  }
  }
#line 311
  if (tmp___0 == -1) {
#line 312
    goto eof;
  }
#line 313
  (*linenum___1) ++;
  {
  {
#line 315
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
#line 316
    last_orig = (char *)((void *)0);
#line 317
    last_new = (char *)((void *)0);
#line 318
    misc = (char *)((void *)0);
#line 319
    what = (char *)((void *)0);
#line 320
    newline = 1;
#line 321
    can_omit_from = 1;
#line 321
    can_omit_to = 1;
    {
#line 324
    tmp___1 = read_atatline((char const   *)*line, & orig_offset, & orig_count, & new_offset,
                            & new_count);
    }
    }
#line 324
    if (tmp___1) {
#line 326
      return;
    }
    {
    {
#line 328
    misc = strchr((char const   *)(*line + 2), '@');
    }
#line 329
    misc += 2;
    {
#line 330
    misc = xstrdup((char const   *)misc);
    }
    {
#line 333
    tmp___2 = xmalloc((size_t )(sizeof(char *) * orig_count));
    }
#line 333
    orig_line = (char **)tmp___2;
    {
#line 334
    tmp___3 = xmalloc((size_t )(sizeof(char *) * new_count));
    }
#line 334
    new_line = (char **)tmp___3;
    {
#line 335
    tmp___4 = xmalloc((size_t )(sizeof(char *) * orig_count));
    }
#line 335
    orig_what = (char **)tmp___4;
    {
#line 336
    tmp___5 = xmalloc((size_t )(sizeof(char *) * new_count));
    }
#line 336
    new_what = (char **)tmp___5;
    {
#line 337
    tmp___6 = xmalloc((size_t )(sizeof(char *) * (orig_count + new_count)));
    }
#line 337
    whats = (char **)tmp___6;
#line 338
    new_linenum = 0UL;
#line 338
    orig_linenum = new_linenum;
    }
    {
    {
#line 339
    while (1) {
      while_continue___7: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 339
      if (! (orig_linenum < orig_count)) {
#line 339
        if (! (new_linenum < new_count)) {
#line 339
          if (! newline) {
#line 339
            goto while_break___0;
          }
        }
      }
      {
#line 341
      get_out = 0;
      {
#line 343
      tmp___7 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                        (FILE */* __restrict  */)stdin);
      }
      }
#line 343
      if (tmp___7 == -1) {
#line 345
        goto while_break___0;
      }
#line 346
      (*linenum___1) ++;
#line 348
      if (orig_linenum >= orig_count) {
#line 348
        if (new_linenum >= new_count) {
#line 348
          if ((int )*(*line) != 92) {
#line 351
            goto while_break___0;
          }
        }
      }
      {
#line 354
      if ((int )*(*line) == 32) {
#line 354
        goto case_32;
      }
#line 364
      if ((int )*(*line) == 45) {
#line 364
        goto case_45;
      }
#line 380
      if ((int )*(*line) == 43) {
#line 380
        goto case_43;
      }
#line 396
      if ((int )*(*line) == 92) {
#line 396
        goto case_92;
      }
#line 405
      goto switch_default;
      case_32: /* CIL Label */ 
      {
#line 355
      what = (char *)((void *)0);
#line 356
      *(orig_what + orig_linenum) = (char *)" ";
#line 357
      *(new_what + new_linenum) = (char *)" ";
      {
#line 358
      *(orig_line + orig_linenum) = xstrdup((char const   *)(*line + 1));
      }
      {
#line 359
      *(new_line + new_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 360
      tmp___8 = orig_linenum;
#line 360
      orig_linenum ++;
#line 360
      last_orig = *(orig_line + tmp___8);
#line 361
      tmp___9 = new_linenum;
#line 361
      new_linenum ++;
#line 361
      last_new = *(new_line + tmp___9);
      }
#line 362
      goto switch_break;
      case_45: /* CIL Label */ 
#line 365
      if (what) {
#line 366
        if ((int )*what != 45) {
#line 367
          *what = (char )'!';
        }
      } else {
        {
        {
#line 369
        tmp___10 = xmalloc((size_t )sizeof(char ));
        }
#line 369
        what = (char *)tmp___10;
#line 370
        *what = (char )'-';
#line 371
        tmp___11 = n_whats;
#line 371
        n_whats ++;
#line 371
        *(whats + tmp___11) = what;
        }
      }
      {
#line 373
      *(orig_what + orig_linenum) = what;
      {
#line 374
      *(orig_line + orig_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 375
      tmp___12 = orig_linenum;
#line 375
      orig_linenum ++;
#line 375
      last_orig = *(orig_line + tmp___12);
#line 376
      last_new = (char *)((void *)0);
#line 377
      can_omit_from = 0;
      }
#line 378
      goto switch_break;
      case_43: /* CIL Label */ 
#line 381
      if (what) {
#line 382
        if ((int )*what != 43) {
#line 383
          *what = (char )'!';
        }
      } else {
        {
        {
#line 385
        tmp___13 = xmalloc((size_t )sizeof(char ));
        }
#line 385
        what = (char *)tmp___13;
#line 386
        *what = (char )'+';
#line 387
        tmp___14 = n_whats;
#line 387
        n_whats ++;
#line 387
        *(whats + tmp___14) = what;
        }
      }
      {
#line 389
      *(new_what + new_linenum) = what;
      {
#line 390
      *(new_line + new_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 391
      last_orig = (char *)((void *)0);
#line 392
      tmp___15 = new_linenum;
#line 392
      new_linenum ++;
#line 392
      last_new = *(new_line + tmp___15);
#line 393
      can_omit_to = 0;
      }
#line 394
      goto switch_break;
      case_92: /* CIL Label */ 
#line 397
      if (last_orig) {
        {
        {
#line 398
        tmp___16 = strlen((char const   *)last_orig);
        }
#line 398
        *(last_orig + (tmp___16 - 1U)) = (char )'\000';
        }
      }
#line 399
      if (last_new) {
        {
        {
#line 400
        tmp___17 = strlen((char const   *)last_new);
        }
#line 400
        *(last_new + (tmp___17 - 1U)) = (char )'\000';
        }
      }
#line 401
      last_new = (char *)((void *)0);
#line 401
      last_orig = last_new;
#line 402
      newline = 0;
#line 403
      goto switch_break;
      switch_default: /* CIL Label */ 
#line 406
      get_out = 1;
      switch_break: /* CIL Label */ ;
      }
#line 409
      if (get_out) {
#line 410
        goto while_break___0;
      }
    }
    while_break___7: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 413
    if (orig_linenum < orig_count) {
      {
      {
#line 415
      error(1, 0, "Garbled input at line %lu", *linenum___1);
      }
      }
    } else
#line 413
    if (new_linenum < new_count) {
      {
      {
#line 415
      error(1, 0, "Garbled input at line %lu", *linenum___1);
      }
      }
    }
    {
    {
#line 418
    printf((char const   */* __restrict  */)"*** %lu", orig_offset);
    }
    }
#line 419
    if (orig_count) {
      {
      {
#line 420
      printf((char const   */* __restrict  */)",%lu", (orig_offset + orig_count) - 1UL);
      }
      }
    }
    {
    {
#line 422
    printf((char const   */* __restrict  */)" ****%s", misc);
    }
    }
#line 423
    if (! can_omit_from) {
#line 424
      i = 0UL;
      {
      {
#line 424
      while (1) {
        while_continue___8: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 424
        if (! (i < orig_count)) {
#line 424
          goto while_break___1;
        }
        {
#line 425
        l = *(orig_line + i);
        {
#line 426
        printf((char const   */* __restrict  */)"%c %s", (int )*(*(orig_what + i)),
               l);
        }
        {
#line 427
        tmp___18 = strlen((char const   *)l);
        }
        }
#line 427
        if ((int )*(l + (tmp___18 - 1U)) != 10) {
          {
          {
#line 428
          printf((char const   */* __restrict  */)"\n%s", no_newline_str);
          }
          }
        }
#line 424
        i ++;
      }
      while_break___8: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
    }
    {
    {
#line 431
    printf((char const   */* __restrict  */)"--- %lu", new_offset);
    }
    }
#line 432
    if (new_count) {
      {
      {
#line 433
      printf((char const   */* __restrict  */)",%lu", (new_offset + new_count) - 1UL);
      }
      }
    }
    {
    {
#line 435
    puts(" ----");
    }
    }
#line 436
    if (! can_omit_to) {
#line 437
      i = 0UL;
      {
      {
#line 437
      while (1) {
        while_continue___9: /* CIL Label */ ;
        while_continue___2: /* CIL Label */ ;
#line 437
        if (! (i < new_count)) {
#line 437
          goto while_break___2;
        }
        {
#line 438
        l___0 = *(new_line + i);
        {
#line 439
        printf((char const   */* __restrict  */)"%c %s", (int )*(*(new_what + i)),
               l___0);
        }
        {
#line 440
        tmp___19 = strlen((char const   *)l___0);
        }
        }
#line 440
        if ((int )*(l___0 + (tmp___19 - 1U)) != 10) {
          {
          {
#line 441
          printf((char const   */* __restrict  */)"\n%s", no_newline_str);
          }
          }
        }
#line 437
        i ++;
      }
      while_break___9: /* CIL Label */ ;
      }
      while_break___2: /* CIL Label */ ;
      }
    }
    eof: 
#line 445
    i = 0UL;
    {
    {
#line 445
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___3: /* CIL Label */ ;
#line 445
      if (! (i < orig_count)) {
#line 445
        goto while_break___3;
      }
      {
      {
#line 446
      free((void *)*(orig_line + i));
      }
#line 445
      i ++;
      }
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___3: /* CIL Label */ ;
    }
#line 448
    i = 0UL;
    {
    {
#line 448
    while (1) {
      while_continue___11: /* CIL Label */ ;
      while_continue___4: /* CIL Label */ ;
#line 448
      if (! (i < new_count)) {
#line 448
        goto while_break___4;
      }
      {
      {
#line 449
      free((void *)*(new_line + i));
      }
#line 448
      i ++;
      }
    }
    while_break___11: /* CIL Label */ ;
    }
    while_break___4: /* CIL Label */ ;
    }
#line 451
    i = 0UL;
    {
    {
#line 451
    while (1) {
      while_continue___12: /* CIL Label */ ;
      while_continue___5: /* CIL Label */ ;
#line 451
      if (! (i < (unsigned long )n_whats)) {
#line 451
        goto while_break___5;
      }
      {
      {
#line 452
      free((void *)*(whats + i));
      }
#line 451
      i ++;
      }
    }
    while_break___12: /* CIL Label */ ;
    }
    while_break___5: /* CIL Label */ ;
    }
    {
    {
#line 454
    free((void *)orig_line);
    }
    {
#line 455
    free((void *)new_line);
    }
    {
#line 456
    free((void *)orig_what);
    }
    {
#line 457
    free((void *)new_what);
    }
    {
#line 458
    free((void *)whats);
    }
    {
#line 459
    free((void *)misc);
    }
#line 460
    n_whats = 0U;
#line 460
    new_count = (unsigned long )n_whats;
#line 460
    orig_count = new_count;
#line 461
    new_line = (char **)((void *)0);
#line 461
    orig_line = new_line;
#line 462
    new_what = (char **)((void *)0);
#line 462
    orig_what = new_what;
#line 463
    whats = (char **)((void *)0);
#line 464
    misc = (char *)((void *)0);
    {
#line 466
    tmp___20 = feof(stdin);
    }
    }
#line 466
    if (tmp___20) {
#line 467
      return;
    }
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
}
}
#line 473 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void do_convert_to_context___0(void) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long linenum___1 ;
  ssize_t got ;
  __ssize_t tmp ;
  int is_context ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;

  {
  {
#line 475
  line = (char *)((void *)0);
#line 476
  linelen = (size_t )0;
#line 477
  linenum___1 = 0UL;
  {
#line 478
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)stdin);
  }
#line 478
  got = tmp;
  }
#line 480
  if (got == -1) {
#line 481
    return;
  }
#line 482
  linenum___1 ++;
  {
  {
#line 484
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 485
    is_context = 0;
    {
    {
#line 487
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 488
      tmp___0 = feof(stdin);
      }
      }
#line 488
      if (tmp___0) {
#line 489
        goto eof;
      }
      {
      {
#line 491
      tmp___1 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 491
      if (! tmp___1) {
#line 492
        is_context = 0;
#line 493
        goto while_break___0;
      }
      {
      {
#line 496
      tmp___2 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 496
      if (! tmp___2) {
#line 497
        is_context = 1;
#line 498
        goto while_break___0;
      }
      {
      {
#line 501
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 503
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 504
      if (got == -1) {
#line 505
        goto eof;
      }
#line 506
      linenum___1 ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 509
    if (is_context) {
      {
      {
#line 510
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 511
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 512
      if (got == -1) {
#line 513
        goto eof;
      }
      {
#line 514
      linenum___1 ++;
      {
#line 516
      tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 516
      if (tmp___3) {
#line 517
        goto __Cont;
      }
      {
      {
#line 519
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 520
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 521
      if (got == -1) {
#line 522
        goto eof;
      }
      {
#line 523
      linenum___1 ++;
      {
#line 525
      tmp___4 = strncmp((char const   *)line, "***************", (size_t )15);
      }
      }
#line 525
      if (tmp___4) {
#line 526
        goto __Cont;
      }
      {
      {
#line 528
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 529
      copy_context_hunks___0(& line, & linelen, & got, & linenum___1);
      }
      }
    } else {
      {
      {
#line 531
      printf((char const   */* __restrict  */)"*** %s", line + 4);
      }
      {
#line 532
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 533
      if (got == -1) {
#line 534
        goto eof;
      }
      {
#line 535
      linenum___1 ++;
      {
#line 537
      tmp___5 = strncmp((char const   *)line, "+++ ", (size_t )4);
      }
      }
#line 537
      if (tmp___5) {
#line 538
        goto __Cont;
      }
      {
      {
#line 540
      printf((char const   */* __restrict  */)"--- ");
      }
      {
#line 541
      fwrite((void const   */* __restrict  */)(line + 4), (size_t )got - 4U, (size_t )1,
             (FILE */* __restrict  */)stdout);
      }
      {
#line 542
      puts("***************");
      }
      {
#line 543
      convert_unified_hunks_to_context___0(& line, & linelen, & linenum___1);
      }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  eof: 
#line 549
  if (line) {
    {
    {
#line 550
    free((void *)line);
    }
    }
  }
#line 552
  return;
}
}
#line 555 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void copy_unified_hunks___0(char **line , size_t *linelen , ssize_t *got ,
                                   unsigned long *linenum___1 ) 
{ 
  unsigned long orig_count ;
  unsigned long new_count ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;

  {
#line 558
  orig_count = 0UL;
#line 558
  new_count = 0UL;
  {
  {
#line 561
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 562
    tmp = feof(stdin);
    }
    }
#line 562
    if (tmp) {
#line 563
      return;
    }
    {
    {
#line 565
    *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                   (FILE */* __restrict  */)stdin);
    }
    }
#line 566
    if (*got == -1) {
#line 567
      return;
    }
#line 568
    (*linenum___1) ++;
#line 570
    if (! orig_count) {
#line 570
      if (! new_count) {
#line 570
        if ((int )*(*line) != 92) {
          {
          {
#line 571
          tmp___0 = strncmp((char const   *)*line, "@@ ", (size_t )3);
          }
          }
#line 571
          if (tmp___0) {
#line 572
            goto while_break;
          }
          {
          {
#line 574
          tmp___1 = read_atatline((char const   *)*line, & orig_offset, & orig_count,
                                  & new_offset, & new_count);
          }
          }
#line 574
          if (tmp___1) {
            {
            {
#line 576
            error(1, 0, "line %lu not understood: %s", *linenum___1, *line);
            }
            }
          }
          {
          {
#line 580
          fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
          }
#line 581
          goto __Cont;
        }
      }
    }
#line 584
    if (orig_count) {
#line 584
      if ((int )*(*line) != 43) {
#line 585
        orig_count --;
      }
    }
#line 586
    if (new_count) {
#line 586
      if ((int )*(*line) != 45) {
#line 587
        new_count --;
      }
    }
    {
    {
#line 589
    fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1, (FILE */* __restrict  */)stdout);
    }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 591
  return;
}
}
#line 593 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void convert_context_hunks_to_unified___0(char **line , size_t *linelen , unsigned long *linenum___1 ) 
{ 
  int happy ;
  size_t i ;
  char *misc ;
  unsigned long unchanged ;
  unsigned long line_start[2] ;
  unsigned long line_end ;
  unsigned long line_count[2] ;
  char *n ;
  char *end ;
  char **lines___1[2] ;
  size_t *linelengths[2] ;
  size_t n_lines[2] ;
  size_t at[2] ;
  ssize_t got ;
  int first ;
  unsigned long lnum ;
  int tmp ;
  __ssize_t tmp___0 ;
  char *m ;
  int tmp___1 ;
  int tmp___2 ;
  char const   *tmp___3 ;
  int tmp___4 ;
  char const   *tmp___5 ;
  void *tmp___6 ;
  void *tmp___7 ;
  int tmp___8 ;
  void *tmp___9 ;
  char *l[2] ;
  size_t llen[2] ;
  int tmp___10 ;
  void *__cil_tmp35 ;
  void *__cil_tmp36 ;
  void *__cil_tmp37 ;
  void *__cil_tmp38 ;
  void *__cil_tmp39 ;
  void *__cil_tmp40 ;
  void *__cil_tmp41 ;
  void *__cil_tmp42 ;
  char *__cil_tmp43 ;
  char *__cil_tmp44 ;
  char *__cil_tmp45 ;
  char *__cil_tmp46 ;
  char *__cil_tmp47 ;
  char *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;

  {
#line 596
  happy = 1;
  {
  {
#line 598
  while (1) {
    while_continue___7: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 598
    if (! happy) {
#line 598
      goto while_break;
    }
#line 600
    misc = (char *)((void *)0);
#line 601
    unchanged = 0UL;
#line 610
    n_lines[1] = (size_t )0;
#line 610
    n_lines[0] = n_lines[1];
#line 611
    linelengths[1] = (size_t *)((void *)0);
#line 611
    linelengths[0] = linelengths[1];
#line 612
    lines___1[1] = (char **)((void *)0);
#line 612
    lines___1[0] = lines___1[1];
#line 614
    i = (size_t )0;
    {
    {
#line 614
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 614
      if (! (i < 2U)) {
#line 614
        goto while_break___0;
      }
      {
#line 615
      first = 1;
      {
#line 618
      tmp = feof(stdin);
      }
      }
#line 618
      if (tmp) {
#line 619
        goto eof;
      }
      {
      {
#line 621
      tmp___0 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                        (FILE */* __restrict  */)stdin);
      }
      }
#line 621
      if (tmp___0 == -1) {
#line 622
        goto eof;
      }
#line 623
      (*linenum___1) ++;
#line 625
      if (! i) {
        {
        {
#line 625
        tmp___2 = strncmp((char const   *)*line, "***************", (size_t )15);
        }
        }
#line 625
        if (! tmp___2) {
          {
#line 626
          m = *line + 15;
          {
#line 627
          tmp___1 = strcmp((char const   *)m, "\n");
          }
          }
#line 627
          if (tmp___1) {
            {
            {
#line 628
            misc = xstrdup((char const   *)m);
            }
            }
          }
#line 629
          i --;
#line 630
          goto __Cont;
        }
      }
#line 633
      if (i) {
#line 633
        tmp___3 = "--- ";
      } else {
#line 633
        tmp___3 = "*** ";
      }
      {
      {
#line 633
      tmp___4 = strncmp((char const   *)*line, tmp___3, (size_t )4);
      }
      }
#line 633
      if (tmp___4) {
#line 634
        goto unhappy;
      }
      do_line_counts: 
      {
#line 637
      n = *line + 4;
      {
#line 638
      line_start[i] = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                              10);
      }
      }
#line 639
      if ((unsigned long )n == (unsigned long )end) {
#line 640
        goto unhappy;
      }
#line 642
      if ((int )*end == 44) {
        {
#line 643
        n = end + 1;
        {
#line 644
        line_end = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
        }
        }
#line 645
        if ((unsigned long )n == (unsigned long )end) {
#line 646
          goto unhappy;
        }
#line 648
        if (line_start[i] > line_end) {
#line 649
          goto unhappy;
        }
#line 651
        line_count[i] = (line_end - line_start[i]) + 1UL;
      } else {
#line 653
        line_end = line_start[i];
#line 654
        if (line_start[i]) {
#line 654
          line_count[i] = 1UL;
        } else {
#line 654
          line_count[i] = 0UL;
        }
      }
#line 657
      if (i) {
#line 657
        tmp___5 = "----";
      } else {
#line 657
        tmp___5 = "****";
      }
      {
      {
#line 657
      n = strstr((char const   *)n, tmp___5);
      }
      }
#line 658
      if (! misc) {
        {
        {
#line 659
        misc = xstrdup((char const   *)(n + 4));
        }
        }
      }
#line 661
      if (i) {
#line 661
        if (line_count[i] == unchanged) {
#line 662
          goto while_break___0;
        }
      }
      {
#line 664
      n_lines[i] = (size_t )line_count[i];
      {
#line 665
      tmp___6 = xmalloc((size_t )(sizeof(char *) * line_count[i]));
      }
#line 665
      lines___1[i] = (char **)tmp___6;
      {
#line 666
      tmp___7 = xmalloc((size_t )(sizeof(size_t ) * line_count[i]));
      }
#line 666
      linelengths[i] = (size_t *)tmp___7;
      {
#line 668
      memset((void *)lines___1[i], 0, (size_t )(sizeof(char *) * line_count[i]));
      }
#line 670
      lnum = 0UL;
      }
      {
      {
#line 670
      while (1) {
        while_continue___9: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 670
        if (! (lnum < line_count[i])) {
#line 670
          goto while_break___1;
        }
        {
        {
#line 671
        got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                      (FILE */* __restrict  */)stdin);
        }
        }
#line 672
        if (got == -1) {
#line 673
          goto eof;
        }
#line 674
        (*linenum___1) ++;
#line 676
        if (! i) {
#line 676
          if (first) {
            {
#line 677
            first = 0;
            {
#line 678
            tmp___8 = strncmp((char const   *)*line, "--- ", (size_t )4);
            }
            }
#line 678
            if (! tmp___8) {
#line 680
              n_lines[i] = (size_t )0;
#line 681
              i ++;
#line 682
              goto do_line_counts;
            }
          }
        }
        {
        {
#line 686
        tmp___9 = xmalloc((size_t )got + 1U);
        }
#line 686
        *(lines___1[i] + lnum) = (char *)tmp___9;
        {
#line 687
        memcpy((void */* __restrict  */)*(lines___1[i] + lnum), (void const   */* __restrict  */)*line,
               (size_t )got);
        }
#line 688
        *(*(lines___1[i] + lnum) + got) = (char )'\000';
#line 689
        *(linelengths[i] + lnum) = (size_t )got;
        }
#line 690
        if ((int )*(*line) == 32) {
#line 691
          unchanged ++;
        }
#line 670
        lnum ++;
      }
      while_break___9: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
      __Cont: /* CIL Label */ 
#line 614
      i ++;
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
    {
#line 695
    printf((char const   */* __restrict  */)"@@ -%lu", line_start[0]);
    }
    }
#line 696
    if (line_count[0] != 1UL) {
      {
      {
#line 697
      printf((char const   */* __restrict  */)",%lu", line_count[0]);
      }
      }
    }
    {
    {
#line 699
    printf((char const   */* __restrict  */)" +%lu", line_start[1]);
    }
    }
#line 700
    if (line_count[1] != 1UL) {
      {
      {
#line 701
      printf((char const   */* __restrict  */)",%lu", line_count[1]);
      }
      }
    }
    {
    {
#line 703
    printf((char const   */* __restrict  */)" @@%s", misc);
    }
#line 706
    at[1] = (size_t )0;
#line 706
    at[0] = at[1];
    }
    {
    {
#line 707
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
#line 707
      if (! (at[0] < n_lines[0])) {
#line 707
        if (! (at[1] < n_lines[1])) {
#line 707
          goto while_break___2;
        }
      }
#line 708
      l[0] = (char *)((void *)0);
#line 708
      l[1] = (char *)((void *)0);
#line 710
      if (lines___1[0]) {
#line 710
        if (at[0] < n_lines[0]) {
#line 711
          l[0] = *(lines___1[0] + at[0]);
#line 712
          llen[0] = *(linelengths[0] + at[0]);
        }
      }
#line 714
      if (lines___1[1]) {
#line 714
        if (at[1] < n_lines[1]) {
#line 715
          l[1] = *(lines___1[1] + at[1]);
#line 716
          llen[1] = *(linelengths[1] + at[1]);
        }
      }
#line 719
      if (l[0]) {
#line 719
        if ((int )*(l[0]) == 32) {
#line 719
          if (l[1]) {
#line 719
            if ((int )*(l[1]) == 32) {
              {
              {
#line 720
              fwrite((void const   */* __restrict  */)(l[0] + 1), llen[0] - 1U, (size_t )1,
                     (FILE */* __restrict  */)stdout);
              }
#line 721
              (at[0]) ++;
#line 722
              (at[1]) ++;
              }
            } else {
#line 719
              goto _L___12;
            }
          } else {
#line 719
            goto _L___12;
          }
        } else {
#line 719
          goto _L___12;
        }
      } else
      _L___12: /* CIL Label */ 
#line 723
      if (l[0]) {
#line 723
        if ((int )*(l[0]) == 32) {
#line 723
          if (! l[1]) {
            {
            {
#line 724
            fwrite((void const   */* __restrict  */)(l[0] + 1), llen[0] - 1U, (size_t )1,
                   (FILE */* __restrict  */)stdout);
            }
#line 725
            (at[0]) ++;
            }
          } else {
#line 723
            goto _L___9;
          }
        } else {
#line 723
          goto _L___9;
        }
      } else
      _L___9: /* CIL Label */ 
#line 726
      if (l[0]) {
#line 726
        if ((int )*(l[0]) == 45) {
          {
          {
#line 727
          putchar('-');
          }
          {
#line 728
          fwrite((void const   */* __restrict  */)(l[0] + 2), llen[0] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 729
          (at[0]) ++;
          }
        } else {
#line 726
          goto _L___7;
        }
      } else
      _L___7: /* CIL Label */ 
#line 730
      if (l[1]) {
#line 730
        if ((int )*(l[1]) == 43) {
          {
          {
#line 731
          putchar('+');
          }
          {
#line 732
          fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 733
          (at[1]) ++;
          }
        } else {
#line 730
          goto _L___6;
        }
      } else
      _L___6: /* CIL Label */ 
#line 734
      if (l[0]) {
#line 734
        if ((int )*(l[0]) == 33) {
#line 734
          if (l[1]) {
#line 734
            if ((int )*(l[1]) == 33) {
              {
              {
#line 736
              while (1) {
                while_continue___11: /* CIL Label */ ;
                while_continue___3: /* CIL Label */ ;
#line 736
                if (at[0] < n_lines[0]) {
#line 736
                  if (! ((int )*(*(lines___1[0] + at[0])) == 33)) {
#line 736
                    goto while_break___3;
                  }
                } else {
#line 736
                  goto while_break___3;
                }
                {
                {
#line 738
                putchar('-');
                }
                {
#line 739
                fwrite((void const   */* __restrict  */)(*(lines___1[0] + at[0]) + 2),
                       *(linelengths[0] + at[0]) - 2U, (size_t )1, (FILE */* __restrict  */)stdout);
                }
#line 742
                (at[0]) ++;
                }
              }
              while_break___11: /* CIL Label */ ;
              }
              while_break___3: /* CIL Label */ ;
              }
              {
              {
#line 744
              while (1) {
                while_continue___12: /* CIL Label */ ;
                while_continue___4: /* CIL Label */ ;
#line 744
                if (at[1] < n_lines[1]) {
#line 744
                  if (! ((int )*(*(lines___1[1] + at[1])) == 33)) {
#line 744
                    goto while_break___4;
                  }
                } else {
#line 744
                  goto while_break___4;
                }
                {
                {
#line 746
                putchar('+');
                }
                {
#line 747
                fwrite((void const   */* __restrict  */)(*(lines___1[1] + at[1]) + 2),
                       *(linelengths[1] + at[1]) - 2U, (size_t )1, (FILE */* __restrict  */)stdout);
                }
#line 750
                (at[1]) ++;
                }
              }
              while_break___12: /* CIL Label */ ;
              }
              while_break___4: /* CIL Label */ ;
              }
            } else {
#line 734
              goto _L___5;
            }
          } else {
#line 734
            goto _L___5;
          }
        } else {
#line 734
          goto _L___5;
        }
      } else
      _L___5: /* CIL Label */ 
#line 752
      if (l[0]) {
#line 752
        if ((int )*(l[0]) == 33) {
          {
          {
#line 753
          putchar('-');
          }
          {
#line 754
          fwrite((void const   */* __restrict  */)(l[0] + 2), llen[0] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 755
          (at[0]) ++;
          }
        } else {
#line 752
          goto _L___2;
        }
      } else
      _L___2: /* CIL Label */ 
#line 756
      if (l[1]) {
#line 756
        if ((int )*(l[1]) == 33) {
          {
          {
#line 757
          putchar('+');
          }
          {
#line 758
          fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 759
          (at[1]) ++;
          }
        } else {
#line 756
          goto _L___1;
        }
      } else
      _L___1: /* CIL Label */ 
#line 760
      if (l[0]) {
#line 760
        if ((int )*(l[0]) == 92) {
          {
          {
#line 761
          fwrite((void const   */* __restrict  */)l[0], llen[0], (size_t )1, (FILE */* __restrict  */)stdout);
          }
          {
#line 762
          putchar('\n');
          }
#line 763
          (at[0]) ++;
          }
        } else {
#line 760
          goto _L___0;
        }
      } else
      _L___0: /* CIL Label */ 
#line 764
      if (l[1]) {
#line 764
        if ((int )*(l[1]) == 92) {
          {
          {
#line 765
          fwrite((void const   */* __restrict  */)l[1], llen[1], (size_t )1, (FILE */* __restrict  */)stdout);
          }
          {
#line 766
          putchar('\n');
          }
#line 767
          (at[1]) ++;
          }
        } else {
#line 764
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 768
      if (! l[0]) {
        {
        {
#line 769
        putchar((int )*(l[1]));
        }
        {
#line 770
        fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
               (FILE */* __restrict  */)stdout);
        }
#line 771
        (at[1]) ++;
        }
      } else {
        {
        {
#line 773
        printf((char const   */* __restrict  */)"Don\'t know how to handle this:\n1: %s2: %s",
               l[0], l[1]);
        }
        {
#line 775
        exit(1);
        }
        }
      }
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
    eof: 
    {
    {
#line 780
    free((void *)misc);
    }
#line 781
    i = (size_t )0;
    }
    {
    {
#line 781
    while (1) {
      while_continue___13: /* CIL Label */ ;
      while_continue___5: /* CIL Label */ ;
#line 781
      if (! (i < n_lines[0])) {
#line 781
        goto while_break___5;
      }
      {
      {
#line 782
      free((void *)*(lines___1[0] + i));
      }
#line 781
      i ++;
      }
    }
    while_break___13: /* CIL Label */ ;
    }
    while_break___5: /* CIL Label */ ;
    }
#line 783
    i = (size_t )0;
    {
    {
#line 783
    while (1) {
      while_continue___14: /* CIL Label */ ;
      while_continue___6: /* CIL Label */ ;
#line 783
      if (! (i < n_lines[1])) {
#line 783
        goto while_break___6;
      }
      {
      {
#line 784
      free((void *)*(lines___1[1] + i));
      }
#line 783
      i ++;
      }
    }
    while_break___14: /* CIL Label */ ;
    }
    while_break___6: /* CIL Label */ ;
    }
    {
    {
#line 785
    free((void *)lines___1[0]);
    }
    {
#line 786
    free((void *)linelengths[0]);
    }
    {
#line 787
    free((void *)lines___1[1]);
    }
    {
#line 788
    free((void *)linelengths[1]);
    }
    {
#line 790
    tmp___10 = feof(stdin);
    }
    }
#line 790
    if (tmp___10) {
#line 791
      return;
    }
#line 793
    goto while_continue;
    unhappy: 
#line 796
    happy = 0;
#line 797
    goto eof;
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 799
  return;
}
}
#line 803 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void do_convert_to_unified___0(void) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long linenum___1 ;
  ssize_t got ;
  __ssize_t tmp ;
  int is_context ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;

  {
  {
#line 805
  line = (char *)((void *)0);
#line 806
  linelen = (size_t )0;
#line 807
  linenum___1 = 0UL;
  {
#line 808
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)stdin);
  }
#line 808
  got = tmp;
  }
#line 810
  if (got == -1) {
#line 811
    return;
  }
#line 812
  linenum___1 ++;
  {
  {
#line 814
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 815
    is_context = 0;
    {
    {
#line 817
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 818
      tmp___0 = feof(stdin);
      }
      }
#line 818
      if (tmp___0) {
#line 819
        goto eof;
      }
      {
      {
#line 821
      tmp___1 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 821
      if (! tmp___1) {
#line 822
        is_context = 0;
#line 823
        goto while_break___0;
      }
      {
      {
#line 826
      tmp___2 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 826
      if (! tmp___2) {
#line 827
        is_context = 1;
#line 828
        goto while_break___0;
      }
      {
      {
#line 831
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 833
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 834
      if (got == -1) {
#line 835
        goto eof;
      }
#line 836
      linenum___1 ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 839
    if (is_context) {
      {
      {
#line 840
      printf((char const   */* __restrict  */)"--- %s", line + 4);
      }
      {
#line 841
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 842
      if (got == -1) {
#line 843
        goto eof;
      }
      {
#line 844
      linenum___1 ++;
      {
#line 846
      tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 846
      if (tmp___3) {
#line 847
        goto __Cont;
      }
      {
      {
#line 849
      printf((char const   */* __restrict  */)"+++ ");
      }
      {
#line 850
      fwrite((void const   */* __restrict  */)(line + 4), (size_t )got - 4U, (size_t )1,
             (FILE */* __restrict  */)stdout);
      }
      {
#line 851
      convert_context_hunks_to_unified___0(& line, & linelen, & linenum___1);
      }
      }
    } else {
      {
      {
#line 854
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 855
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 856
      if (got == -1) {
#line 857
        goto eof;
      }
      {
#line 858
      linenum___1 ++;
      {
#line 860
      tmp___4 = strncmp((char const   *)line, "+++ ", (size_t )4);
      }
      }
#line 860
      if (tmp___4) {
#line 861
        goto __Cont;
      }
      {
      {
#line 863
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 864
      copy_unified_hunks___0(& line, & linelen, & got, & linenum___1);
      }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  eof: 
#line 869
  if (line) {
    {
    {
#line 870
    free((void *)line);
    }
    }
  }
#line 872
  return;
}
}
#line 875 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static FILE *do_convert___0(FILE *f , char const   *mode___3 , int seekable , void (*fn)(void) ) 
{ 
  int fildes[2] ;
  int fd ;
  int tmp ;
  FILE *ret ;
  char *tmp___0 ;
  char *tmp___1 ;
  int *tmp___2 ;
  int tmp___3 ;
  __pid_t tmp___4 ;
  int *tmp___5 ;
  FILE *tmp___6 ;
  FILE *tmp___7 ;
  int c ;
  int tmp___8 ;
  int tmp___9 ;
  char *tmp___10 ;
  char *tmp___11 ;
  int *tmp___12 ;
  int tmp___13 ;
  __pid_t tmp___14 ;
  int *tmp___15 ;
  FILE *tmp___16 ;
  char *tmp___17 ;
  char *tmp___18 ;
  void *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;

  {
  {
  {
#line 879
  tmp = fileno(f);
  }
#line 879
  fd = tmp;
  {
#line 882
  fflush((FILE *)((void *)0));
  }
  {
#line 883
  tmp___18 = strchr(mode___3, 'r');
  }
  }
#line 883
  if (tmp___18) {
    {
    {
#line 884
    tmp___0 = strchr(mode___3, 'w');
    }
    }
#line 884
    if (tmp___0) {
#line 886
      return ((FILE *)((void *)0));
    } else {
      {
      {
#line 884
      tmp___1 = strchr(mode___3, '+');
      }
      }
#line 884
      if (tmp___1) {
#line 886
        return ((FILE *)((void *)0));
      }
    }
    {
    {
#line 892
    tmp___3 = pipe((int *)(fildes));
    }
    }
#line 892
    if (tmp___3) {
      {
      {
#line 893
      tmp___2 = __errno_location();
      }
      {
#line 893
      error(1, *tmp___2, "pipe failed");
      }
      }
    }
    {
    {
#line 895
    tmp___4 = fork();
    }
    }
    {
#line 896
    if (tmp___4 == -1) {
#line 896
      goto case_neg_1;
    }
#line 921
    if (tmp___4 == 0) {
#line 921
      goto case_0;
    }
#line 899
    goto switch_default;
    case_neg_1: /* CIL Label */ 
    {
    {
#line 897
    tmp___5 = __errno_location();
    }
    {
#line 897
    error(1, *tmp___5, "fork failed");
    }
    }
    switch_default: /* CIL Label */ 
    {
    {
#line 901
    close(fildes[1]);
    }
    {
#line 902
    ret = fdopen(fildes[0], mode___3);
    }
    }
#line 904
    if (seekable) {
      {
      {
#line 905
      tmp___7 = xtmpfile();
      }
#line 905
      tmp___6 = tmp___7;
      }
      {
      {
#line 906
      while (1) {
        while_continue___0: /* CIL Label */ ;
        while_continue: /* CIL Label */ ;
        {
        {
#line 906
        tmp___9 = feof(ret);
        }
        }
#line 906
        if (tmp___9) {
#line 906
          goto while_break;
        }
        {
        {
#line 907
        tmp___8 = fgetc(ret);
        }
#line 907
        c = tmp___8;
        }
#line 909
        if (c == -1) {
#line 910
          goto while_break;
        }
        {
        {
#line 912
        fputc(c, tmp___6);
        }
        }
      }
      while_break___0: /* CIL Label */ ;
      }
      while_break: /* CIL Label */ ;
      }
      {
      {
#line 915
      rewind(tmp___6);
      }
      }
#line 916
      return (tmp___6);
    }
#line 919
    return (ret);
    case_0: /* CIL Label */ 
    {
    {
#line 932
    close(fildes[0]);
    }
    }
#line 934
    if (fd != 0) {
      {
      {
#line 935
      dup2(fd, 0);
      }
      {
#line 936
      fclose(f);
      }
      }
    }
#line 939
    if (fildes[1] != 1) {
      {
      {
#line 940
      dup2(fildes[1], 1);
      }
      }
    }
    {
    {
#line 942
    (*fn)();
    }
    {
#line 943
    exit(0);
    }
    }
    switch_break: /* CIL Label */ ;
    }
  } else {
    {
    {
#line 946
    tmp___17 = strchr(mode___3, 'w');
    }
    }
#line 946
    if (tmp___17) {
      {
      {
#line 947
      tmp___10 = strchr(mode___3, 'r');
      }
      }
#line 947
      if (tmp___10) {
#line 949
        return ((FILE *)((void *)0));
      } else {
        {
        {
#line 947
        tmp___11 = strchr(mode___3, '+');
        }
        }
#line 947
        if (tmp___11) {
#line 949
          return ((FILE *)((void *)0));
        }
      }
      {
      {
#line 954
      tmp___13 = pipe((int *)(fildes));
      }
      }
#line 954
      if (tmp___13) {
        {
        {
#line 955
        tmp___12 = __errno_location();
        }
        {
#line 955
        error(1, *tmp___12, "pipe failed");
        }
        }
      }
      {
      {
#line 957
      tmp___14 = fork();
      }
      }
      {
#line 958
      if (tmp___14 == -1) {
#line 958
        goto case_neg_1___0;
      }
#line 966
      if (tmp___14 == 0) {
#line 966
        goto case_0___0;
      }
#line 961
      goto switch_default___0;
      case_neg_1___0: /* CIL Label */ 
      {
      {
#line 959
      tmp___15 = __errno_location();
      }
      {
#line 959
      error(1, *tmp___15, "fork failed");
      }
      }
      switch_default___0: /* CIL Label */ 
      {
      {
#line 963
      close(fildes[1]);
      }
      {
#line 964
      tmp___16 = fdopen(fildes[1], mode___3);
      }
      }
#line 964
      return (tmp___16);
      case_0___0: /* CIL Label */ 
      {
      {
#line 974
      close(fildes[0]);
      }
      }
#line 976
      if (fildes[0] != 0) {
        {
        {
#line 977
        dup2(fildes[0], 0);
        }
        }
      }
#line 979
      if (fd != 1) {
        {
        {
#line 980
        dup2(fd, 1);
        }
        {
#line 981
        fclose(f);
        }
        }
      }
      {
      {
#line 984
      (*fn)();
      }
      {
#line 985
      exit(0);
      }
      }
      switch_break___0: /* CIL Label */ ;
      }
    }
  }
#line 989
  return ((FILE *)((void *)0));
}
}
#line 1002 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static int read_timezone___0(char const   *tz ) 
{ 
  int zone ;
  char *endptr ;
  size_t tmp ;
  long tmp___0 ;
  char *__cil_tmp6 ;

  {
  {
#line 1005
  zone = -1;
  {
#line 1008
  tmp = strspn(tz, " ");
  }
#line 1008
  tz += tmp;
  {
#line 1009
  tmp___0 = strtol((char const   */* __restrict  */)tz, (char **/* __restrict  */)(& endptr),
                   10);
  }
#line 1009
  zone = (int )tmp___0;
  }
#line 1010
  if ((unsigned long )tz == (unsigned long )endptr) {
#line 1011
    zone = -1;
  }
#line 1013
  return (zone);
}
}
#line 220 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void copy_context_hunks___1(char **line , size_t *linelen , ssize_t *got ,
                                   unsigned long *linenum___1 ) 
{ 
  unsigned long unchanged ;
  unsigned long line_start ;
  unsigned long line_end ;
  unsigned long line_count ;
  char *n ;
  char *end ;
  int i ;
  int first ;
  int tmp ;
  char const   *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  unsigned long tmp___3 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;

  {
  {
  {
#line 223
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 224
    unchanged = 0UL;
#line 229
    i = 0;
    {
    {
#line 229
    while (1) {
      while_continue___3: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 229
      if (! (i < 2)) {
#line 229
        goto while_break___0;
      }
      {
#line 230
      first = 1;
      {
#line 231
      *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                     (FILE */* __restrict  */)stdin);
      }
      }
#line 232
      if (*got == -1) {
#line 233
        return;
      }
#line 234
      (*linenum___1) ++;
#line 236
      if (! i) {
        {
        {
#line 236
        tmp = strncmp((char const   *)*line, "***************", (size_t )15);
        }
        }
#line 236
        if (! tmp) {
#line 241
          i --;
#line 242
          goto __Cont;
        }
      }
#line 245
      if (i) {
#line 245
        tmp___0 = "--- ";
      } else {
#line 245
        tmp___0 = "*** ";
      }
      {
      {
#line 245
      tmp___1 = strncmp((char const   *)*line, tmp___0, (size_t )4);
      }
      }
#line 245
      if (tmp___1) {
#line 246
        return;
      }
      do_line_counts: 
      {
#line 249
      n = *line + 4;
      {
#line 250
      line_start = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
      }
      }
#line 251
      if ((unsigned long )n == (unsigned long )end) {
#line 252
        return;
      }
#line 254
      if ((int )*end == 44) {
        {
#line 255
        n = end + 1;
        {
#line 256
        line_end = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
        }
        }
#line 257
        if ((unsigned long )n == (unsigned long )end) {
#line 258
          return;
        }
#line 260
        if (line_start > line_end) {
#line 261
          return;
        }
#line 263
        line_count = (line_end - line_start) + 1UL;
      } else {
#line 265
        line_end = line_start;
#line 266
        if (line_start) {
#line 266
          line_count = 1UL;
        } else {
#line 266
          line_count = 0UL;
        }
      }
      {
      {
#line 269
      fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      }
#line 271
      if (i) {
#line 271
        if (line_count == unchanged) {
#line 272
          goto while_break___0;
        }
      }
      {
      {
#line 274
      while (1) {
        while_continue___4: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 274
        tmp___3 = line_count;
#line 274
        line_count --;
#line 274
        if (! tmp___3) {
#line 274
          goto while_break___1;
        }
        {
        {
#line 275
        *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                       (FILE */* __restrict  */)stdin);
        }
        }
#line 276
        if (*got == -1) {
#line 277
          return;
        }
#line 278
        (*linenum___1) ++;
#line 280
        if (! i) {
#line 280
          if (first) {
            {
#line 281
            first = 0;
            {
#line 282
            tmp___2 = strncmp((char const   *)*line, "--- ", (size_t )4);
            }
            }
#line 282
            if (! tmp___2) {
#line 284
              i ++;
#line 285
              goto do_line_counts;
            }
          }
        }
        {
        {
#line 289
        fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1,
               (FILE */* __restrict  */)stdout);
        }
        }
#line 290
        if ((int )*(*line) == 32) {
#line 291
          unchanged ++;
        }
      }
      while_break___4: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
      __Cont: /* CIL Label */ 
#line 229
      i ++;
    }
    while_break___3: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
}
}
#line 297 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void convert_unified_hunks_to_context___1(char **line , size_t *linelen , unsigned long *linenum___1 ) 
{ 
  unsigned long orig_offset ;
  unsigned long orig_count ;
  unsigned long new_offset ;
  unsigned long new_count ;
  char **orig_line ;
  char **new_line ;
  char **orig_what ;
  char **new_what ;
  char **whats ;
  unsigned int n_whats ;
  unsigned long orig_linenum ;
  unsigned long new_linenum ;
  char const   *no_newline_str ;
  int tmp ;
  __ssize_t tmp___0 ;
  char *last_orig ;
  char *last_new ;
  char *misc ;
  char *what ;
  int newline ;
  int can_omit_from ;
  int can_omit_to ;
  unsigned long i ;
  int tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  void *tmp___4 ;
  void *tmp___5 ;
  void *tmp___6 ;
  int get_out ;
  __ssize_t tmp___7 ;
  unsigned long tmp___8 ;
  unsigned long tmp___9 ;
  void *tmp___10 ;
  unsigned int tmp___11 ;
  unsigned long tmp___12 ;
  void *tmp___13 ;
  unsigned int tmp___14 ;
  unsigned long tmp___15 ;
  size_t tmp___16 ;
  size_t tmp___17 ;
  char *l ;
  size_t tmp___18 ;
  char *l___0 ;
  size_t tmp___19 ;
  int tmp___20 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;

  {
  {
#line 300
  orig_count = 0UL;
#line 300
  new_count = 0UL;
#line 301
  orig_line = (char **)((void *)0);
#line 301
  new_line = (char **)((void *)0);
#line 302
  orig_what = (char **)((void *)0);
#line 302
  new_what = (char **)((void *)0);
#line 303
  whats = (char **)((void *)0);
#line 304
  n_whats = 0U;
#line 306
  no_newline_str = "\\ No newline at end of file\n";
  {
#line 308
  tmp = feof(stdin);
  }
  }
#line 308
  if (tmp) {
#line 309
    goto eof;
  }
  {
  {
#line 311
  tmp___0 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                    (FILE */* __restrict  */)stdin);
  }
  }
#line 311
  if (tmp___0 == -1) {
#line 312
    goto eof;
  }
#line 313
  (*linenum___1) ++;
  {
  {
#line 315
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
#line 316
    last_orig = (char *)((void *)0);
#line 317
    last_new = (char *)((void *)0);
#line 318
    misc = (char *)((void *)0);
#line 319
    what = (char *)((void *)0);
#line 320
    newline = 1;
#line 321
    can_omit_from = 1;
#line 321
    can_omit_to = 1;
    {
#line 324
    tmp___1 = read_atatline((char const   *)*line, & orig_offset, & orig_count, & new_offset,
                            & new_count);
    }
    }
#line 324
    if (tmp___1) {
#line 326
      return;
    }
    {
    {
#line 328
    misc = strchr((char const   *)(*line + 2), '@');
    }
#line 329
    misc += 2;
    {
#line 330
    misc = xstrdup((char const   *)misc);
    }
    {
#line 333
    tmp___2 = xmalloc((size_t )(sizeof(char *) * orig_count));
    }
#line 333
    orig_line = (char **)tmp___2;
    {
#line 334
    tmp___3 = xmalloc((size_t )(sizeof(char *) * new_count));
    }
#line 334
    new_line = (char **)tmp___3;
    {
#line 335
    tmp___4 = xmalloc((size_t )(sizeof(char *) * orig_count));
    }
#line 335
    orig_what = (char **)tmp___4;
    {
#line 336
    tmp___5 = xmalloc((size_t )(sizeof(char *) * new_count));
    }
#line 336
    new_what = (char **)tmp___5;
    {
#line 337
    tmp___6 = xmalloc((size_t )(sizeof(char *) * (orig_count + new_count)));
    }
#line 337
    whats = (char **)tmp___6;
#line 338
    new_linenum = 0UL;
#line 338
    orig_linenum = new_linenum;
    }
    {
    {
#line 339
    while (1) {
      while_continue___7: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 339
      if (! (orig_linenum < orig_count)) {
#line 339
        if (! (new_linenum < new_count)) {
#line 339
          if (! newline) {
#line 339
            goto while_break___0;
          }
        }
      }
      {
#line 341
      get_out = 0;
      {
#line 343
      tmp___7 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                        (FILE */* __restrict  */)stdin);
      }
      }
#line 343
      if (tmp___7 == -1) {
#line 345
        goto while_break___0;
      }
#line 346
      (*linenum___1) ++;
#line 348
      if (orig_linenum >= orig_count) {
#line 348
        if (new_linenum >= new_count) {
#line 348
          if ((int )*(*line) != 92) {
#line 351
            goto while_break___0;
          }
        }
      }
      {
#line 354
      if ((int )*(*line) == 32) {
#line 354
        goto case_32;
      }
#line 364
      if ((int )*(*line) == 45) {
#line 364
        goto case_45;
      }
#line 380
      if ((int )*(*line) == 43) {
#line 380
        goto case_43;
      }
#line 396
      if ((int )*(*line) == 92) {
#line 396
        goto case_92;
      }
#line 405
      goto switch_default;
      case_32: /* CIL Label */ 
      {
#line 355
      what = (char *)((void *)0);
#line 356
      *(orig_what + orig_linenum) = (char *)" ";
#line 357
      *(new_what + new_linenum) = (char *)" ";
      {
#line 358
      *(orig_line + orig_linenum) = xstrdup((char const   *)(*line + 1));
      }
      {
#line 359
      *(new_line + new_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 360
      tmp___8 = orig_linenum;
#line 360
      orig_linenum ++;
#line 360
      last_orig = *(orig_line + tmp___8);
#line 361
      tmp___9 = new_linenum;
#line 361
      new_linenum ++;
#line 361
      last_new = *(new_line + tmp___9);
      }
#line 362
      goto switch_break;
      case_45: /* CIL Label */ 
#line 365
      if (what) {
#line 366
        if ((int )*what != 45) {
#line 367
          *what = (char )'!';
        }
      } else {
        {
        {
#line 369
        tmp___10 = xmalloc((size_t )sizeof(char ));
        }
#line 369
        what = (char *)tmp___10;
#line 370
        *what = (char )'-';
#line 371
        tmp___11 = n_whats;
#line 371
        n_whats ++;
#line 371
        *(whats + tmp___11) = what;
        }
      }
      {
#line 373
      *(orig_what + orig_linenum) = what;
      {
#line 374
      *(orig_line + orig_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 375
      tmp___12 = orig_linenum;
#line 375
      orig_linenum ++;
#line 375
      last_orig = *(orig_line + tmp___12);
#line 376
      last_new = (char *)((void *)0);
#line 377
      can_omit_from = 0;
      }
#line 378
      goto switch_break;
      case_43: /* CIL Label */ 
#line 381
      if (what) {
#line 382
        if ((int )*what != 43) {
#line 383
          *what = (char )'!';
        }
      } else {
        {
        {
#line 385
        tmp___13 = xmalloc((size_t )sizeof(char ));
        }
#line 385
        what = (char *)tmp___13;
#line 386
        *what = (char )'+';
#line 387
        tmp___14 = n_whats;
#line 387
        n_whats ++;
#line 387
        *(whats + tmp___14) = what;
        }
      }
      {
#line 389
      *(new_what + new_linenum) = what;
      {
#line 390
      *(new_line + new_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 391
      last_orig = (char *)((void *)0);
#line 392
      tmp___15 = new_linenum;
#line 392
      new_linenum ++;
#line 392
      last_new = *(new_line + tmp___15);
#line 393
      can_omit_to = 0;
      }
#line 394
      goto switch_break;
      case_92: /* CIL Label */ 
#line 397
      if (last_orig) {
        {
        {
#line 398
        tmp___16 = strlen((char const   *)last_orig);
        }
#line 398
        *(last_orig + (tmp___16 - 1U)) = (char )'\000';
        }
      }
#line 399
      if (last_new) {
        {
        {
#line 400
        tmp___17 = strlen((char const   *)last_new);
        }
#line 400
        *(last_new + (tmp___17 - 1U)) = (char )'\000';
        }
      }
#line 401
      last_new = (char *)((void *)0);
#line 401
      last_orig = last_new;
#line 402
      newline = 0;
#line 403
      goto switch_break;
      switch_default: /* CIL Label */ 
#line 406
      get_out = 1;
      switch_break: /* CIL Label */ ;
      }
#line 409
      if (get_out) {
#line 410
        goto while_break___0;
      }
    }
    while_break___7: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 413
    if (orig_linenum < orig_count) {
      {
      {
#line 415
      error(1, 0, "Garbled input at line %lu", *linenum___1);
      }
      }
    } else
#line 413
    if (new_linenum < new_count) {
      {
      {
#line 415
      error(1, 0, "Garbled input at line %lu", *linenum___1);
      }
      }
    }
    {
    {
#line 418
    printf((char const   */* __restrict  */)"*** %lu", orig_offset);
    }
    }
#line 419
    if (orig_count) {
      {
      {
#line 420
      printf((char const   */* __restrict  */)",%lu", (orig_offset + orig_count) - 1UL);
      }
      }
    }
    {
    {
#line 422
    printf((char const   */* __restrict  */)" ****%s", misc);
    }
    }
#line 423
    if (! can_omit_from) {
#line 424
      i = 0UL;
      {
      {
#line 424
      while (1) {
        while_continue___8: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 424
        if (! (i < orig_count)) {
#line 424
          goto while_break___1;
        }
        {
#line 425
        l = *(orig_line + i);
        {
#line 426
        printf((char const   */* __restrict  */)"%c %s", (int )*(*(orig_what + i)),
               l);
        }
        {
#line 427
        tmp___18 = strlen((char const   *)l);
        }
        }
#line 427
        if ((int )*(l + (tmp___18 - 1U)) != 10) {
          {
          {
#line 428
          printf((char const   */* __restrict  */)"\n%s", no_newline_str);
          }
          }
        }
#line 424
        i ++;
      }
      while_break___8: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
    }
    {
    {
#line 431
    printf((char const   */* __restrict  */)"--- %lu", new_offset);
    }
    }
#line 432
    if (new_count) {
      {
      {
#line 433
      printf((char const   */* __restrict  */)",%lu", (new_offset + new_count) - 1UL);
      }
      }
    }
    {
    {
#line 435
    puts(" ----");
    }
    }
#line 436
    if (! can_omit_to) {
#line 437
      i = 0UL;
      {
      {
#line 437
      while (1) {
        while_continue___9: /* CIL Label */ ;
        while_continue___2: /* CIL Label */ ;
#line 437
        if (! (i < new_count)) {
#line 437
          goto while_break___2;
        }
        {
#line 438
        l___0 = *(new_line + i);
        {
#line 439
        printf((char const   */* __restrict  */)"%c %s", (int )*(*(new_what + i)),
               l___0);
        }
        {
#line 440
        tmp___19 = strlen((char const   *)l___0);
        }
        }
#line 440
        if ((int )*(l___0 + (tmp___19 - 1U)) != 10) {
          {
          {
#line 441
          printf((char const   */* __restrict  */)"\n%s", no_newline_str);
          }
          }
        }
#line 437
        i ++;
      }
      while_break___9: /* CIL Label */ ;
      }
      while_break___2: /* CIL Label */ ;
      }
    }
    eof: 
#line 445
    i = 0UL;
    {
    {
#line 445
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___3: /* CIL Label */ ;
#line 445
      if (! (i < orig_count)) {
#line 445
        goto while_break___3;
      }
      {
      {
#line 446
      free((void *)*(orig_line + i));
      }
#line 445
      i ++;
      }
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___3: /* CIL Label */ ;
    }
#line 448
    i = 0UL;
    {
    {
#line 448
    while (1) {
      while_continue___11: /* CIL Label */ ;
      while_continue___4: /* CIL Label */ ;
#line 448
      if (! (i < new_count)) {
#line 448
        goto while_break___4;
      }
      {
      {
#line 449
      free((void *)*(new_line + i));
      }
#line 448
      i ++;
      }
    }
    while_break___11: /* CIL Label */ ;
    }
    while_break___4: /* CIL Label */ ;
    }
#line 451
    i = 0UL;
    {
    {
#line 451
    while (1) {
      while_continue___12: /* CIL Label */ ;
      while_continue___5: /* CIL Label */ ;
#line 451
      if (! (i < (unsigned long )n_whats)) {
#line 451
        goto while_break___5;
      }
      {
      {
#line 452
      free((void *)*(whats + i));
      }
#line 451
      i ++;
      }
    }
    while_break___12: /* CIL Label */ ;
    }
    while_break___5: /* CIL Label */ ;
    }
    {
    {
#line 454
    free((void *)orig_line);
    }
    {
#line 455
    free((void *)new_line);
    }
    {
#line 456
    free((void *)orig_what);
    }
    {
#line 457
    free((void *)new_what);
    }
    {
#line 458
    free((void *)whats);
    }
    {
#line 459
    free((void *)misc);
    }
#line 460
    n_whats = 0U;
#line 460
    new_count = (unsigned long )n_whats;
#line 460
    orig_count = new_count;
#line 461
    new_line = (char **)((void *)0);
#line 461
    orig_line = new_line;
#line 462
    new_what = (char **)((void *)0);
#line 462
    orig_what = new_what;
#line 463
    whats = (char **)((void *)0);
#line 464
    misc = (char *)((void *)0);
    {
#line 466
    tmp___20 = feof(stdin);
    }
    }
#line 466
    if (tmp___20) {
#line 467
      return;
    }
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
}
}
#line 473 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void do_convert_to_context___1(void) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long linenum___1 ;
  ssize_t got ;
  __ssize_t tmp ;
  int is_context ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;

  {
  {
#line 475
  line = (char *)((void *)0);
#line 476
  linelen = (size_t )0;
#line 477
  linenum___1 = 0UL;
  {
#line 478
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)stdin);
  }
#line 478
  got = tmp;
  }
#line 480
  if (got == -1) {
#line 481
    return;
  }
#line 482
  linenum___1 ++;
  {
  {
#line 484
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 485
    is_context = 0;
    {
    {
#line 487
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 488
      tmp___0 = feof(stdin);
      }
      }
#line 488
      if (tmp___0) {
#line 489
        goto eof;
      }
      {
      {
#line 491
      tmp___1 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 491
      if (! tmp___1) {
#line 492
        is_context = 0;
#line 493
        goto while_break___0;
      }
      {
      {
#line 496
      tmp___2 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 496
      if (! tmp___2) {
#line 497
        is_context = 1;
#line 498
        goto while_break___0;
      }
      {
      {
#line 501
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 503
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 504
      if (got == -1) {
#line 505
        goto eof;
      }
#line 506
      linenum___1 ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 509
    if (is_context) {
      {
      {
#line 510
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 511
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 512
      if (got == -1) {
#line 513
        goto eof;
      }
      {
#line 514
      linenum___1 ++;
      {
#line 516
      tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 516
      if (tmp___3) {
#line 517
        goto __Cont;
      }
      {
      {
#line 519
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 520
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 521
      if (got == -1) {
#line 522
        goto eof;
      }
      {
#line 523
      linenum___1 ++;
      {
#line 525
      tmp___4 = strncmp((char const   *)line, "***************", (size_t )15);
      }
      }
#line 525
      if (tmp___4) {
#line 526
        goto __Cont;
      }
      {
      {
#line 528
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 529
      copy_context_hunks___1(& line, & linelen, & got, & linenum___1);
      }
      }
    } else {
      {
      {
#line 531
      printf((char const   */* __restrict  */)"*** %s", line + 4);
      }
      {
#line 532
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 533
      if (got == -1) {
#line 534
        goto eof;
      }
      {
#line 535
      linenum___1 ++;
      {
#line 537
      tmp___5 = strncmp((char const   *)line, "+++ ", (size_t )4);
      }
      }
#line 537
      if (tmp___5) {
#line 538
        goto __Cont;
      }
      {
      {
#line 540
      printf((char const   */* __restrict  */)"--- ");
      }
      {
#line 541
      fwrite((void const   */* __restrict  */)(line + 4), (size_t )got - 4U, (size_t )1,
             (FILE */* __restrict  */)stdout);
      }
      {
#line 542
      puts("***************");
      }
      {
#line 543
      convert_unified_hunks_to_context___1(& line, & linelen, & linenum___1);
      }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  eof: 
#line 549
  if (line) {
    {
    {
#line 550
    free((void *)line);
    }
    }
  }
#line 552
  return;
}
}
#line 555 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void copy_unified_hunks___1(char **line , size_t *linelen , ssize_t *got ,
                                   unsigned long *linenum___1 ) 
{ 
  unsigned long orig_count ;
  unsigned long new_count ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;

  {
#line 558
  orig_count = 0UL;
#line 558
  new_count = 0UL;
  {
  {
#line 561
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 562
    tmp = feof(stdin);
    }
    }
#line 562
    if (tmp) {
#line 563
      return;
    }
    {
    {
#line 565
    *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                   (FILE */* __restrict  */)stdin);
    }
    }
#line 566
    if (*got == -1) {
#line 567
      return;
    }
#line 568
    (*linenum___1) ++;
#line 570
    if (! orig_count) {
#line 570
      if (! new_count) {
#line 570
        if ((int )*(*line) != 92) {
          {
          {
#line 571
          tmp___0 = strncmp((char const   *)*line, "@@ ", (size_t )3);
          }
          }
#line 571
          if (tmp___0) {
#line 572
            goto while_break;
          }
          {
          {
#line 574
          tmp___1 = read_atatline((char const   *)*line, & orig_offset, & orig_count,
                                  & new_offset, & new_count);
          }
          }
#line 574
          if (tmp___1) {
            {
            {
#line 576
            error(1, 0, "line %lu not understood: %s", *linenum___1, *line);
            }
            }
          }
          {
          {
#line 580
          fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
          }
#line 581
          goto __Cont;
        }
      }
    }
#line 584
    if (orig_count) {
#line 584
      if ((int )*(*line) != 43) {
#line 585
        orig_count --;
      }
    }
#line 586
    if (new_count) {
#line 586
      if ((int )*(*line) != 45) {
#line 587
        new_count --;
      }
    }
    {
    {
#line 589
    fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1, (FILE */* __restrict  */)stdout);
    }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 591
  return;
}
}
#line 593 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void convert_context_hunks_to_unified___1(char **line , size_t *linelen , unsigned long *linenum___1 ) 
{ 
  int happy ;
  size_t i ;
  char *misc ;
  unsigned long unchanged ;
  unsigned long line_start[2] ;
  unsigned long line_end ;
  unsigned long line_count[2] ;
  char *n ;
  char *end ;
  char **lines___1[2] ;
  size_t *linelengths[2] ;
  size_t n_lines[2] ;
  size_t at[2] ;
  ssize_t got ;
  int first ;
  unsigned long lnum ;
  int tmp ;
  __ssize_t tmp___0 ;
  char *m ;
  int tmp___1 ;
  int tmp___2 ;
  char const   *tmp___3 ;
  int tmp___4 ;
  char const   *tmp___5 ;
  void *tmp___6 ;
  void *tmp___7 ;
  int tmp___8 ;
  void *tmp___9 ;
  char *l[2] ;
  size_t llen[2] ;
  int tmp___10 ;
  void *__cil_tmp35 ;
  void *__cil_tmp36 ;
  void *__cil_tmp37 ;
  void *__cil_tmp38 ;
  void *__cil_tmp39 ;
  void *__cil_tmp40 ;
  void *__cil_tmp41 ;
  void *__cil_tmp42 ;
  char *__cil_tmp43 ;
  char *__cil_tmp44 ;
  char *__cil_tmp45 ;
  char *__cil_tmp46 ;
  char *__cil_tmp47 ;
  char *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;

  {
#line 596
  happy = 1;
  {
  {
#line 598
  while (1) {
    while_continue___7: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 598
    if (! happy) {
#line 598
      goto while_break;
    }
#line 600
    misc = (char *)((void *)0);
#line 601
    unchanged = 0UL;
#line 610
    n_lines[1] = (size_t )0;
#line 610
    n_lines[0] = n_lines[1];
#line 611
    linelengths[1] = (size_t *)((void *)0);
#line 611
    linelengths[0] = linelengths[1];
#line 612
    lines___1[1] = (char **)((void *)0);
#line 612
    lines___1[0] = lines___1[1];
#line 614
    i = (size_t )0;
    {
    {
#line 614
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 614
      if (! (i < 2U)) {
#line 614
        goto while_break___0;
      }
      {
#line 615
      first = 1;
      {
#line 618
      tmp = feof(stdin);
      }
      }
#line 618
      if (tmp) {
#line 619
        goto eof;
      }
      {
      {
#line 621
      tmp___0 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                        (FILE */* __restrict  */)stdin);
      }
      }
#line 621
      if (tmp___0 == -1) {
#line 622
        goto eof;
      }
#line 623
      (*linenum___1) ++;
#line 625
      if (! i) {
        {
        {
#line 625
        tmp___2 = strncmp((char const   *)*line, "***************", (size_t )15);
        }
        }
#line 625
        if (! tmp___2) {
          {
#line 626
          m = *line + 15;
          {
#line 627
          tmp___1 = strcmp((char const   *)m, "\n");
          }
          }
#line 627
          if (tmp___1) {
            {
            {
#line 628
            misc = xstrdup((char const   *)m);
            }
            }
          }
#line 629
          i --;
#line 630
          goto __Cont;
        }
      }
#line 633
      if (i) {
#line 633
        tmp___3 = "--- ";
      } else {
#line 633
        tmp___3 = "*** ";
      }
      {
      {
#line 633
      tmp___4 = strncmp((char const   *)*line, tmp___3, (size_t )4);
      }
      }
#line 633
      if (tmp___4) {
#line 634
        goto unhappy;
      }
      do_line_counts: 
      {
#line 637
      n = *line + 4;
      {
#line 638
      line_start[i] = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                              10);
      }
      }
#line 639
      if ((unsigned long )n == (unsigned long )end) {
#line 640
        goto unhappy;
      }
#line 642
      if ((int )*end == 44) {
        {
#line 643
        n = end + 1;
        {
#line 644
        line_end = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
        }
        }
#line 645
        if ((unsigned long )n == (unsigned long )end) {
#line 646
          goto unhappy;
        }
#line 648
        if (line_start[i] > line_end) {
#line 649
          goto unhappy;
        }
#line 651
        line_count[i] = (line_end - line_start[i]) + 1UL;
      } else {
#line 653
        line_end = line_start[i];
#line 654
        if (line_start[i]) {
#line 654
          line_count[i] = 1UL;
        } else {
#line 654
          line_count[i] = 0UL;
        }
      }
#line 657
      if (i) {
#line 657
        tmp___5 = "----";
      } else {
#line 657
        tmp___5 = "****";
      }
      {
      {
#line 657
      n = strstr((char const   *)n, tmp___5);
      }
      }
#line 658
      if (! misc) {
        {
        {
#line 659
        misc = xstrdup((char const   *)(n + 4));
        }
        }
      }
#line 661
      if (i) {
#line 661
        if (line_count[i] == unchanged) {
#line 662
          goto while_break___0;
        }
      }
      {
#line 664
      n_lines[i] = (size_t )line_count[i];
      {
#line 665
      tmp___6 = xmalloc((size_t )(sizeof(char *) * line_count[i]));
      }
#line 665
      lines___1[i] = (char **)tmp___6;
      {
#line 666
      tmp___7 = xmalloc((size_t )(sizeof(size_t ) * line_count[i]));
      }
#line 666
      linelengths[i] = (size_t *)tmp___7;
      {
#line 668
      memset((void *)lines___1[i], 0, (size_t )(sizeof(char *) * line_count[i]));
      }
#line 670
      lnum = 0UL;
      }
      {
      {
#line 670
      while (1) {
        while_continue___9: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 670
        if (! (lnum < line_count[i])) {
#line 670
          goto while_break___1;
        }
        {
        {
#line 671
        got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                      (FILE */* __restrict  */)stdin);
        }
        }
#line 672
        if (got == -1) {
#line 673
          goto eof;
        }
#line 674
        (*linenum___1) ++;
#line 676
        if (! i) {
#line 676
          if (first) {
            {
#line 677
            first = 0;
            {
#line 678
            tmp___8 = strncmp((char const   *)*line, "--- ", (size_t )4);
            }
            }
#line 678
            if (! tmp___8) {
#line 680
              n_lines[i] = (size_t )0;
#line 681
              i ++;
#line 682
              goto do_line_counts;
            }
          }
        }
        {
        {
#line 686
        tmp___9 = xmalloc((size_t )got + 1U);
        }
#line 686
        *(lines___1[i] + lnum) = (char *)tmp___9;
        {
#line 687
        memcpy((void */* __restrict  */)*(lines___1[i] + lnum), (void const   */* __restrict  */)*line,
               (size_t )got);
        }
#line 688
        *(*(lines___1[i] + lnum) + got) = (char )'\000';
#line 689
        *(linelengths[i] + lnum) = (size_t )got;
        }
#line 690
        if ((int )*(*line) == 32) {
#line 691
          unchanged ++;
        }
#line 670
        lnum ++;
      }
      while_break___9: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
      __Cont: /* CIL Label */ 
#line 614
      i ++;
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
    {
#line 695
    printf((char const   */* __restrict  */)"@@ -%lu", line_start[0]);
    }
    }
#line 696
    if (line_count[0] != 1UL) {
      {
      {
#line 697
      printf((char const   */* __restrict  */)",%lu", line_count[0]);
      }
      }
    }
    {
    {
#line 699
    printf((char const   */* __restrict  */)" +%lu", line_start[1]);
    }
    }
#line 700
    if (line_count[1] != 1UL) {
      {
      {
#line 701
      printf((char const   */* __restrict  */)",%lu", line_count[1]);
      }
      }
    }
    {
    {
#line 703
    printf((char const   */* __restrict  */)" @@%s", misc);
    }
#line 706
    at[1] = (size_t )0;
#line 706
    at[0] = at[1];
    }
    {
    {
#line 707
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
#line 707
      if (! (at[0] < n_lines[0])) {
#line 707
        if (! (at[1] < n_lines[1])) {
#line 707
          goto while_break___2;
        }
      }
#line 708
      l[0] = (char *)((void *)0);
#line 708
      l[1] = (char *)((void *)0);
#line 710
      if (lines___1[0]) {
#line 710
        if (at[0] < n_lines[0]) {
#line 711
          l[0] = *(lines___1[0] + at[0]);
#line 712
          llen[0] = *(linelengths[0] + at[0]);
        }
      }
#line 714
      if (lines___1[1]) {
#line 714
        if (at[1] < n_lines[1]) {
#line 715
          l[1] = *(lines___1[1] + at[1]);
#line 716
          llen[1] = *(linelengths[1] + at[1]);
        }
      }
#line 719
      if (l[0]) {
#line 719
        if ((int )*(l[0]) == 32) {
#line 719
          if (l[1]) {
#line 719
            if ((int )*(l[1]) == 32) {
              {
              {
#line 720
              fwrite((void const   */* __restrict  */)(l[0] + 1), llen[0] - 1U, (size_t )1,
                     (FILE */* __restrict  */)stdout);
              }
#line 721
              (at[0]) ++;
#line 722
              (at[1]) ++;
              }
            } else {
#line 719
              goto _L___12;
            }
          } else {
#line 719
            goto _L___12;
          }
        } else {
#line 719
          goto _L___12;
        }
      } else
      _L___12: /* CIL Label */ 
#line 723
      if (l[0]) {
#line 723
        if ((int )*(l[0]) == 32) {
#line 723
          if (! l[1]) {
            {
            {
#line 724
            fwrite((void const   */* __restrict  */)(l[0] + 1), llen[0] - 1U, (size_t )1,
                   (FILE */* __restrict  */)stdout);
            }
#line 725
            (at[0]) ++;
            }
          } else {
#line 723
            goto _L___9;
          }
        } else {
#line 723
          goto _L___9;
        }
      } else
      _L___9: /* CIL Label */ 
#line 726
      if (l[0]) {
#line 726
        if ((int )*(l[0]) == 45) {
          {
          {
#line 727
          putchar('-');
          }
          {
#line 728
          fwrite((void const   */* __restrict  */)(l[0] + 2), llen[0] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 729
          (at[0]) ++;
          }
        } else {
#line 726
          goto _L___7;
        }
      } else
      _L___7: /* CIL Label */ 
#line 730
      if (l[1]) {
#line 730
        if ((int )*(l[1]) == 43) {
          {
          {
#line 731
          putchar('+');
          }
          {
#line 732
          fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 733
          (at[1]) ++;
          }
        } else {
#line 730
          goto _L___6;
        }
      } else
      _L___6: /* CIL Label */ 
#line 734
      if (l[0]) {
#line 734
        if ((int )*(l[0]) == 33) {
#line 734
          if (l[1]) {
#line 734
            if ((int )*(l[1]) == 33) {
              {
              {
#line 736
              while (1) {
                while_continue___11: /* CIL Label */ ;
                while_continue___3: /* CIL Label */ ;
#line 736
                if (at[0] < n_lines[0]) {
#line 736
                  if (! ((int )*(*(lines___1[0] + at[0])) == 33)) {
#line 736
                    goto while_break___3;
                  }
                } else {
#line 736
                  goto while_break___3;
                }
                {
                {
#line 738
                putchar('-');
                }
                {
#line 739
                fwrite((void const   */* __restrict  */)(*(lines___1[0] + at[0]) + 2),
                       *(linelengths[0] + at[0]) - 2U, (size_t )1, (FILE */* __restrict  */)stdout);
                }
#line 742
                (at[0]) ++;
                }
              }
              while_break___11: /* CIL Label */ ;
              }
              while_break___3: /* CIL Label */ ;
              }
              {
              {
#line 744
              while (1) {
                while_continue___12: /* CIL Label */ ;
                while_continue___4: /* CIL Label */ ;
#line 744
                if (at[1] < n_lines[1]) {
#line 744
                  if (! ((int )*(*(lines___1[1] + at[1])) == 33)) {
#line 744
                    goto while_break___4;
                  }
                } else {
#line 744
                  goto while_break___4;
                }
                {
                {
#line 746
                putchar('+');
                }
                {
#line 747
                fwrite((void const   */* __restrict  */)(*(lines___1[1] + at[1]) + 2),
                       *(linelengths[1] + at[1]) - 2U, (size_t )1, (FILE */* __restrict  */)stdout);
                }
#line 750
                (at[1]) ++;
                }
              }
              while_break___12: /* CIL Label */ ;
              }
              while_break___4: /* CIL Label */ ;
              }
            } else {
#line 734
              goto _L___5;
            }
          } else {
#line 734
            goto _L___5;
          }
        } else {
#line 734
          goto _L___5;
        }
      } else
      _L___5: /* CIL Label */ 
#line 752
      if (l[0]) {
#line 752
        if ((int )*(l[0]) == 33) {
          {
          {
#line 753
          putchar('-');
          }
          {
#line 754
          fwrite((void const   */* __restrict  */)(l[0] + 2), llen[0] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 755
          (at[0]) ++;
          }
        } else {
#line 752
          goto _L___2;
        }
      } else
      _L___2: /* CIL Label */ 
#line 756
      if (l[1]) {
#line 756
        if ((int )*(l[1]) == 33) {
          {
          {
#line 757
          putchar('+');
          }
          {
#line 758
          fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 759
          (at[1]) ++;
          }
        } else {
#line 756
          goto _L___1;
        }
      } else
      _L___1: /* CIL Label */ 
#line 760
      if (l[0]) {
#line 760
        if ((int )*(l[0]) == 92) {
          {
          {
#line 761
          fwrite((void const   */* __restrict  */)l[0], llen[0], (size_t )1, (FILE */* __restrict  */)stdout);
          }
          {
#line 762
          putchar('\n');
          }
#line 763
          (at[0]) ++;
          }
        } else {
#line 760
          goto _L___0;
        }
      } else
      _L___0: /* CIL Label */ 
#line 764
      if (l[1]) {
#line 764
        if ((int )*(l[1]) == 92) {
          {
          {
#line 765
          fwrite((void const   */* __restrict  */)l[1], llen[1], (size_t )1, (FILE */* __restrict  */)stdout);
          }
          {
#line 766
          putchar('\n');
          }
#line 767
          (at[1]) ++;
          }
        } else {
#line 764
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 768
      if (! l[0]) {
        {
        {
#line 769
        putchar((int )*(l[1]));
        }
        {
#line 770
        fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
               (FILE */* __restrict  */)stdout);
        }
#line 771
        (at[1]) ++;
        }
      } else {
        {
        {
#line 773
        printf((char const   */* __restrict  */)"Don\'t know how to handle this:\n1: %s2: %s",
               l[0], l[1]);
        }
        {
#line 775
        exit(1);
        }
        }
      }
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
    eof: 
    {
    {
#line 780
    free((void *)misc);
    }
#line 781
    i = (size_t )0;
    }
    {
    {
#line 781
    while (1) {
      while_continue___13: /* CIL Label */ ;
      while_continue___5: /* CIL Label */ ;
#line 781
      if (! (i < n_lines[0])) {
#line 781
        goto while_break___5;
      }
      {
      {
#line 782
      free((void *)*(lines___1[0] + i));
      }
#line 781
      i ++;
      }
    }
    while_break___13: /* CIL Label */ ;
    }
    while_break___5: /* CIL Label */ ;
    }
#line 783
    i = (size_t )0;
    {
    {
#line 783
    while (1) {
      while_continue___14: /* CIL Label */ ;
      while_continue___6: /* CIL Label */ ;
#line 783
      if (! (i < n_lines[1])) {
#line 783
        goto while_break___6;
      }
      {
      {
#line 784
      free((void *)*(lines___1[1] + i));
      }
#line 783
      i ++;
      }
    }
    while_break___14: /* CIL Label */ ;
    }
    while_break___6: /* CIL Label */ ;
    }
    {
    {
#line 785
    free((void *)lines___1[0]);
    }
    {
#line 786
    free((void *)linelengths[0]);
    }
    {
#line 787
    free((void *)lines___1[1]);
    }
    {
#line 788
    free((void *)linelengths[1]);
    }
    {
#line 790
    tmp___10 = feof(stdin);
    }
    }
#line 790
    if (tmp___10) {
#line 791
      return;
    }
#line 793
    goto while_continue;
    unhappy: 
#line 796
    happy = 0;
#line 797
    goto eof;
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 799
  return;
}
}
#line 803 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void do_convert_to_unified___1(void) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long linenum___1 ;
  ssize_t got ;
  __ssize_t tmp ;
  int is_context ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;

  {
  {
#line 805
  line = (char *)((void *)0);
#line 806
  linelen = (size_t )0;
#line 807
  linenum___1 = 0UL;
  {
#line 808
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)stdin);
  }
#line 808
  got = tmp;
  }
#line 810
  if (got == -1) {
#line 811
    return;
  }
#line 812
  linenum___1 ++;
  {
  {
#line 814
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 815
    is_context = 0;
    {
    {
#line 817
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 818
      tmp___0 = feof(stdin);
      }
      }
#line 818
      if (tmp___0) {
#line 819
        goto eof;
      }
      {
      {
#line 821
      tmp___1 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 821
      if (! tmp___1) {
#line 822
        is_context = 0;
#line 823
        goto while_break___0;
      }
      {
      {
#line 826
      tmp___2 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 826
      if (! tmp___2) {
#line 827
        is_context = 1;
#line 828
        goto while_break___0;
      }
      {
      {
#line 831
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 833
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 834
      if (got == -1) {
#line 835
        goto eof;
      }
#line 836
      linenum___1 ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 839
    if (is_context) {
      {
      {
#line 840
      printf((char const   */* __restrict  */)"--- %s", line + 4);
      }
      {
#line 841
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 842
      if (got == -1) {
#line 843
        goto eof;
      }
      {
#line 844
      linenum___1 ++;
      {
#line 846
      tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 846
      if (tmp___3) {
#line 847
        goto __Cont;
      }
      {
      {
#line 849
      printf((char const   */* __restrict  */)"+++ ");
      }
      {
#line 850
      fwrite((void const   */* __restrict  */)(line + 4), (size_t )got - 4U, (size_t )1,
             (FILE */* __restrict  */)stdout);
      }
      {
#line 851
      convert_context_hunks_to_unified___1(& line, & linelen, & linenum___1);
      }
      }
    } else {
      {
      {
#line 854
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 855
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 856
      if (got == -1) {
#line 857
        goto eof;
      }
      {
#line 858
      linenum___1 ++;
      {
#line 860
      tmp___4 = strncmp((char const   *)line, "+++ ", (size_t )4);
      }
      }
#line 860
      if (tmp___4) {
#line 861
        goto __Cont;
      }
      {
      {
#line 863
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 864
      copy_unified_hunks___1(& line, & linelen, & got, & linenum___1);
      }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  eof: 
#line 869
  if (line) {
    {
    {
#line 870
    free((void *)line);
    }
    }
  }
#line 872
  return;
}
}
#line 875 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static FILE *do_convert___1(FILE *f , char const   *mode___3 , int seekable , void (*fn)(void) ) 
{ 
  int fildes[2] ;
  int fd ;
  int tmp ;
  FILE *ret ;
  char *tmp___0 ;
  char *tmp___1 ;
  int *tmp___2 ;
  int tmp___3 ;
  __pid_t tmp___4 ;
  int *tmp___5 ;
  FILE *tmp___6 ;
  FILE *tmp___7 ;
  int c ;
  int tmp___8 ;
  int tmp___9 ;
  char *tmp___10 ;
  char *tmp___11 ;
  int *tmp___12 ;
  int tmp___13 ;
  __pid_t tmp___14 ;
  int *tmp___15 ;
  FILE *tmp___16 ;
  char *tmp___17 ;
  char *tmp___18 ;
  void *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;

  {
  {
  {
#line 879
  tmp = fileno(f);
  }
#line 879
  fd = tmp;
  {
#line 882
  fflush((FILE *)((void *)0));
  }
  {
#line 883
  tmp___18 = strchr(mode___3, 'r');
  }
  }
#line 883
  if (tmp___18) {
    {
    {
#line 884
    tmp___0 = strchr(mode___3, 'w');
    }
    }
#line 884
    if (tmp___0) {
#line 886
      return ((FILE *)((void *)0));
    } else {
      {
      {
#line 884
      tmp___1 = strchr(mode___3, '+');
      }
      }
#line 884
      if (tmp___1) {
#line 886
        return ((FILE *)((void *)0));
      }
    }
    {
    {
#line 892
    tmp___3 = pipe((int *)(fildes));
    }
    }
#line 892
    if (tmp___3) {
      {
      {
#line 893
      tmp___2 = __errno_location();
      }
      {
#line 893
      error(1, *tmp___2, "pipe failed");
      }
      }
    }
    {
    {
#line 895
    tmp___4 = fork();
    }
    }
    {
#line 896
    if (tmp___4 == -1) {
#line 896
      goto case_neg_1;
    }
#line 921
    if (tmp___4 == 0) {
#line 921
      goto case_0;
    }
#line 899
    goto switch_default;
    case_neg_1: /* CIL Label */ 
    {
    {
#line 897
    tmp___5 = __errno_location();
    }
    {
#line 897
    error(1, *tmp___5, "fork failed");
    }
    }
    switch_default: /* CIL Label */ 
    {
    {
#line 901
    close(fildes[1]);
    }
    {
#line 902
    ret = fdopen(fildes[0], mode___3);
    }
    }
#line 904
    if (seekable) {
      {
      {
#line 905
      tmp___7 = xtmpfile();
      }
#line 905
      tmp___6 = tmp___7;
      }
      {
      {
#line 906
      while (1) {
        while_continue___0: /* CIL Label */ ;
        while_continue: /* CIL Label */ ;
        {
        {
#line 906
        tmp___9 = feof(ret);
        }
        }
#line 906
        if (tmp___9) {
#line 906
          goto while_break;
        }
        {
        {
#line 907
        tmp___8 = fgetc(ret);
        }
#line 907
        c = tmp___8;
        }
#line 909
        if (c == -1) {
#line 910
          goto while_break;
        }
        {
        {
#line 912
        fputc(c, tmp___6);
        }
        }
      }
      while_break___0: /* CIL Label */ ;
      }
      while_break: /* CIL Label */ ;
      }
      {
      {
#line 915
      rewind(tmp___6);
      }
      }
#line 916
      return (tmp___6);
    }
#line 919
    return (ret);
    case_0: /* CIL Label */ 
    {
    {
#line 932
    close(fildes[0]);
    }
    }
#line 934
    if (fd != 0) {
      {
      {
#line 935
      dup2(fd, 0);
      }
      {
#line 936
      fclose(f);
      }
      }
    }
#line 939
    if (fildes[1] != 1) {
      {
      {
#line 940
      dup2(fildes[1], 1);
      }
      }
    }
    {
    {
#line 942
    (*fn)();
    }
    {
#line 943
    exit(0);
    }
    }
    switch_break: /* CIL Label */ ;
    }
  } else {
    {
    {
#line 946
    tmp___17 = strchr(mode___3, 'w');
    }
    }
#line 946
    if (tmp___17) {
      {
      {
#line 947
      tmp___10 = strchr(mode___3, 'r');
      }
      }
#line 947
      if (tmp___10) {
#line 949
        return ((FILE *)((void *)0));
      } else {
        {
        {
#line 947
        tmp___11 = strchr(mode___3, '+');
        }
        }
#line 947
        if (tmp___11) {
#line 949
          return ((FILE *)((void *)0));
        }
      }
      {
      {
#line 954
      tmp___13 = pipe((int *)(fildes));
      }
      }
#line 954
      if (tmp___13) {
        {
        {
#line 955
        tmp___12 = __errno_location();
        }
        {
#line 955
        error(1, *tmp___12, "pipe failed");
        }
        }
      }
      {
      {
#line 957
      tmp___14 = fork();
      }
      }
      {
#line 958
      if (tmp___14 == -1) {
#line 958
        goto case_neg_1___0;
      }
#line 966
      if (tmp___14 == 0) {
#line 966
        goto case_0___0;
      }
#line 961
      goto switch_default___0;
      case_neg_1___0: /* CIL Label */ 
      {
      {
#line 959
      tmp___15 = __errno_location();
      }
      {
#line 959
      error(1, *tmp___15, "fork failed");
      }
      }
      switch_default___0: /* CIL Label */ 
      {
      {
#line 963
      close(fildes[1]);
      }
      {
#line 964
      tmp___16 = fdopen(fildes[1], mode___3);
      }
      }
#line 964
      return (tmp___16);
      case_0___0: /* CIL Label */ 
      {
      {
#line 974
      close(fildes[0]);
      }
      }
#line 976
      if (fildes[0] != 0) {
        {
        {
#line 977
        dup2(fildes[0], 0);
        }
        }
      }
#line 979
      if (fd != 1) {
        {
        {
#line 980
        dup2(fd, 1);
        }
        {
#line 981
        fclose(f);
        }
        }
      }
      {
      {
#line 984
      (*fn)();
      }
      {
#line 985
      exit(0);
      }
      }
      switch_break___0: /* CIL Label */ ;
      }
    }
  }
#line 989
  return ((FILE *)((void *)0));
}
}
#line 1002 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static int read_timezone___1(char const   *tz ) 
{ 
  int zone ;
  char *endptr ;
  size_t tmp ;
  long tmp___0 ;
  char *__cil_tmp6 ;

  {
  {
#line 1005
  zone = -1;
  {
#line 1008
  tmp = strspn(tz, " ");
  }
#line 1008
  tz += tmp;
  {
#line 1009
  tmp___0 = strtol((char const   */* __restrict  */)tz, (char **/* __restrict  */)(& endptr),
                   10);
  }
#line 1009
  zone = (int )tmp___0;
  }
#line 1010
  if ((unsigned long )tz == (unsigned long )endptr) {
#line 1011
    zone = -1;
  }
#line 1013
  return (zone);
}
}
#line 288 "/usr/include/unistd.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1))) access)(char const   *__name ,
                                                                                   int __type ) ;
#line 558
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1))) execv)(char const   *__path ,
                                                                                  char * const  *__argv ) ;
#line 78 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static unsigned long copy_hunk(FILE *in , FILE *out , unsigned long orig_lines , unsigned long new_lines ) 
{ 
  int newline ;
  fpos_t pos ;
  char *line ;
  size_t linelen ;
  unsigned long count ;
  __ssize_t tmp ;

  {
#line 82
  newline = 1;
#line 84
  line = (char *)((void *)0);
#line 85
  linelen = (size_t )0;
#line 86
  count = 0UL;
  {
  {
#line 88
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 88
    if (! orig_lines) {
#line 88
      if (! new_lines) {
#line 88
        if (! newline) {
#line 88
          goto while_break;
        }
      }
    }
    {
    {
#line 89
    fgetpos((FILE */* __restrict  */)in, (fpos_t */* __restrict  */)(& pos));
    }
    {
#line 90
    tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)in);
    }
    }
#line 90
    if (tmp == -1) {
#line 91
      goto while_break;
    }
#line 93
    if (! orig_lines) {
#line 93
      if (! new_lines) {
#line 93
        if ((int )*(line + 0) != 92) {
#line 95
          goto while_break;
        }
      }
    }
    {
#line 97
    count ++;
    {
#line 99
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    }
    {
#line 101
    if ((int )*(line + 0) == 32) {
#line 101
      goto case_32;
    }
#line 103
    if ((int )*(line + 0) == 45) {
#line 103
      goto case_45;
    }
#line 106
    if ((int )*(line + 0) == 43) {
#line 106
      goto case_43;
    }
#line 109
    if ((int )*(line + 0) == 92) {
#line 109
      goto case_92;
    }
#line 100
    goto switch_break;
    case_32: /* CIL Label */ 
#line 102
    if (new_lines) {
#line 102
      new_lines --;
    }
    case_45: /* CIL Label */ 
#line 104
    if (orig_lines) {
#line 104
      orig_lines --;
    }
#line 105
    goto switch_break;
    case_43: /* CIL Label */ 
#line 107
    if (new_lines) {
#line 107
      new_lines --;
    }
#line 108
    goto switch_break;
    case_92: /* CIL Label */ 
#line 110
    newline = 0;
#line 111
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 115
  if (newline) {
    {
    {
#line 117
    fsetpos(in, (fpos_t const   *)(& pos));
    }
    }
  }
#line 119
  return (count);
}
}
#line 123 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static unsigned long adjust_offsets_and_copy(long *offset , FILE *in , FILE *out ) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long orig_offset ;
  unsigned long orig_lines ;
  unsigned long new_offset ;
  unsigned long new_lines ;
  unsigned long count ;
  char *trailing ;
  __ssize_t tmp ;
  __ssize_t tmp___0 ;
  __ssize_t tmp___1 ;
  int tmp___2 ;
  size_t tmp___3 ;
  int tmp___4 ;
  size_t tmp___5 ;
  size_t tmp___6 ;
  unsigned long tmp___7 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;
  char *__cil_tmp25 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;
  char *__cil_tmp28 ;
  char *__cil_tmp29 ;

  {
  {
#line 126
  line = (char *)((void *)0);
#line 127
  linelen = (size_t )0;
#line 129
  count = 0UL;
  {
#line 132
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)in);
  }
  }
#line 132
  if (tmp == -1) {
#line 133
    goto out;
  }
  {
#line 134
  count ++;
  {
#line 136
  tmp___2 = strncmp((char const   *)line, "--- ", (size_t )4);
  }
  }
#line 136
  if (! tmp___2) {
    {
    {
#line 139
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    {
#line 140
    tmp___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)in);
    }
    }
#line 140
    if (tmp___0 == -1) {
#line 141
      goto out;
    }
    {
#line 142
    count ++;
    {
#line 143
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    {
#line 144
    tmp___1 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)in);
    }
    }
#line 144
    if (tmp___1 == -1) {
#line 145
      goto out;
    }
#line 146
    count ++;
#line 149
    *offset = 0L;
  }
  {
  {
#line 152
  tmp___4 = read_atatline((char const   *)line, & orig_offset, & orig_lines, & new_offset,
                          & new_lines);
  }
  }
#line 152
  if (tmp___4) {
    {
    {
#line 154
    tmp___3 = strlen((char const   *)line);
    }
#line 154
    *(line + (tmp___3 - 1U)) = (char )'\000';
    {
#line 155
    error(1, 0, "Line not understood: %s", line);
    }
    }
  }
  {
  {
#line 159
  trailing = strchr((char const   *)line, '+');
  }
  {
#line 160
  tmp___5 = strcspn((char const   *)trailing, " \n");
  }
#line 160
  trailing += tmp___5;
  }
#line 161
  if ((int )*trailing == 32) {
#line 162
    trailing ++;
  }
  {
  {
#line 163
  tmp___6 = strspn((char const   *)trailing, "@");
  }
#line 163
  trailing += tmp___6;
  {
#line 166
  fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"@@ -%lu",
          orig_offset);
  }
  }
#line 167
  if (orig_lines != 1UL) {
    {
    {
#line 168
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
            orig_lines);
    }
    }
  }
  {
  {
#line 169
  fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" +%lu",
          new_offset + (unsigned long )*offset);
  }
  }
#line 170
  if (new_lines != 1UL) {
    {
    {
#line 171
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
            new_lines);
    }
    }
  }
  {
  {
#line 172
  fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" @@%s",
          trailing);
  }
  {
#line 173
  free((void *)line);
  }
  {
#line 176
  tmp___7 = copy_hunk(in, out, orig_lines, new_lines);
  }
#line 176
  count += tmp___7;
  }
  out: 
#line 179
  return (count);
}
}
#line 183 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static unsigned long copy_lines(FILE *in , FILE *out , unsigned long n ) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long count ;
  __ssize_t tmp ;
  unsigned long tmp___0 ;

  {
#line 185
  line = (char *)((void *)0);
#line 186
  linelen = (size_t )0;
#line 187
  count = 0UL;
  {
  {
#line 188
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 188
    tmp___0 = n;
#line 188
    n --;
#line 188
    if (! tmp___0) {
#line 188
      goto while_break;
    }
    {
    {
#line 189
    tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)in);
    }
    }
#line 189
    if (tmp == -1) {
#line 190
      goto while_break;
    }
    {
#line 191
    count ++;
    {
#line 192
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 194
  if (line) {
    {
    {
#line 195
    free((void *)line);
    }
    }
  }
#line 196
  return (count);
}
}
#line 201 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static void copy_trailing(struct hunk *hunk , FILE *in , FILE *out , unsigned long done ) 
{ 
  unsigned long todo ;
  unsigned long tmp ;

  {
#line 204
  if (hunk->next) {
#line 207
    if (done < (hunk->next)->line_in_diff - hunk->line_in_diff) {
#line 208
      todo = ((hunk->next)->line_in_diff - hunk->line_in_diff) - done;
#line 211
      if (todo > 1UL) {
        {
        {
#line 212
        copy_lines(in, out, todo - 1UL);
        }
        }
      }
    }
  } else {
    {
    {
#line 216
    while (1) {
      while_continue___0: /* CIL Label */ ;
      while_continue: /* CIL Label */ ;
      {
      {
#line 216
      tmp = copy_lines(in, out, 100UL);
      }
      }
#line 216
      if (! tmp) {
#line 216
        goto while_break;
      }
    }
    while_break___0: /* CIL Label */ ;
    }
    while_break: /* CIL Label */ ;
    }
  }
#line 219
  return;
}
}
#line 226 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static void copy_to(struct hunk *from , struct hunk *upto , long *line_offset , FILE *in ,
                    FILE *out , int is_first ) 
{ 
  unsigned long count ;

  {
#line 229
  if (! is_first) {
#line 229
    if (from) {
#line 229
      if (from->info) {
#line 229
        if (! (from->info)->info_written) {
#line 229
          if ((from->info)->info_pending) {
            {
            {
#line 231
            fputs((char const   */* __restrict  */)(from->info)->orig_file, (FILE */* __restrict  */)out);
            }
            {
#line 232
            fputs((char const   */* __restrict  */)(from->info)->new_file, (FILE */* __restrict  */)out);
            }
#line 233
            (from->info)->info_written = 1;
            }
          }
        }
      }
    }
  }
#line 236
  if (is_first) {
#line 236
    if (from) {
      {
      {
#line 238
      fseek(in, 0L, 0);
      }
      {
#line 239
      copy_lines(in, out, from->line_in_diff - 1UL);
      }
      }
    }
  }
  {
  {
#line 242
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 242
    if (from) {
#line 242
      if (! ((unsigned long )from != (unsigned long )upto)) {
#line 242
        goto while_break;
      }
    } else {
#line 242
      goto while_break;
    }
    {
    {
#line 244
    fsetpos(in, (fpos_t const   *)(& from->filepos));
    }
    {
#line 245
    count = adjust_offsets_and_copy(line_offset, in, out);
    }
    {
#line 246
    copy_trailing(from, in, out, count);
    }
#line 242
    from = from->next;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 248
  return;
}
}
#line 251 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static long added_hunk(char const   *meta , long offset , FILE *modify , FILE *t ,
                       unsigned long morig_count , unsigned long mnew_count ) 
{ 
  long this_offset ;
  char *line ;
  size_t linelen ;
  char *p ;
  char *tmp ;
  char *q ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  unsigned long orig_count ;
  unsigned long new_count ;
  FILE *newhunk ;
  FILE *tmp___0 ;
  int *tmp___1 ;
  size_t tmp___2 ;
  __ssize_t tmp___3 ;
  unsigned long tmp___4 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;
  char *__cil_tmp25 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;
  char *__cil_tmp28 ;
  char *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;

  {
  {
#line 254
  this_offset = 0L;
#line 255
  line = (char *)((void *)0);
#line 256
  linelen = (size_t )0;
  {
#line 257
  tmp = strchr(meta, '-');
  }
#line 257
  p = tmp;
#line 258
  orig_offset = 0UL;
#line 259
  orig_count = 0UL;
#line 259
  new_count = 0UL;
  {
#line 260
  tmp___0 = xtmpfile();
  }
#line 260
  newhunk = tmp___0;
  }
#line 262
  if (! newhunk) {
    {
    {
#line 263
    tmp___1 = __errno_location();
    }
    {
#line 263
    error(1, *tmp___1, "Couldn\'t create temporary file");
    }
    }
  }
#line 265
  if (p) {
    {
#line 266
    p ++;
    {
#line 267
    orig_offset = strtoul((char const   */* __restrict  */)p, (char **/* __restrict  */)(& q),
                          10);
    }
    }
  }
#line 270
  if (! p) {
    {
    {
#line 271
    tmp___2 = strlen((char const   *)p);
    }
#line 271
    *(p + (tmp___2 - 1U)) = (char )'\000';
    {
#line 272
    error(1, 0, "Hunk addition requires original line: %s", meta);
    }
    }
  } else
#line 270
  if ((unsigned long )p == (unsigned long )q) {
    {
    {
#line 271
    tmp___2 = strlen((char const   *)p);
    }
#line 271
    *(p + (tmp___2 - 1U)) = (char )'\000';
    {
#line 272
    error(1, 0, "Hunk addition requires original line: %s", meta);
    }
    }
  }
  {
  {
#line 276
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 276
    if (! morig_count) {
#line 276
      if (! mnew_count) {
#line 276
        goto while_break;
      }
    }
    {
    {
#line 277
    tmp___3 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)modify);
    }
    }
#line 277
    if (tmp___3 == -1) {
#line 278
      goto while_break;
    }
#line 280
    if ((int )*(line + 0) != 43) {
      {
      {
#line 281
      error(1, 0, "Only whole hunks may be added");
      }
      }
    }
#line 284
    mnew_count --;
    {
#line 287
    if ((int )*(line + 1) == 32) {
#line 287
      goto case_32;
    }
#line 291
    if ((int )*(line + 1) == 43) {
#line 291
      goto case_43;
    }
#line 295
    if ((int )*(line + 1) == 45) {
#line 295
      goto case_45;
    }
#line 299
    goto switch_default;
    case_32: /* CIL Label */ 
#line 288
    orig_count ++;
#line 289
    new_count ++;
#line 290
    goto switch_break;
    case_43: /* CIL Label */ 
#line 292
    new_count ++;
#line 293
    this_offset ++;
#line 294
    goto switch_break;
    case_45: /* CIL Label */ 
#line 296
    orig_count ++;
#line 297
    this_offset --;
#line 298
    goto switch_break;
    switch_default: /* CIL Label */ 
    {
    {
#line 300
    error(1, 0, "Multiple added hunks not supported");
    }
    }
    switch_break: /* CIL Label */ ;
    }
    {
    {
#line 304
    fputs((char const   */* __restrict  */)(line + 1), (FILE */* __restrict  */)newhunk);
    }
    }
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 307
  new_offset = orig_offset + (unsigned long )offset;
#line 309
  if (! new_count) {
#line 310
    new_offset --;
  }
  {
  {
#line 312
  fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)"@@ -%lu",
          orig_offset);
  }
  }
#line 313
  if (orig_count != 1UL) {
    {
    {
#line 314
    fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)",%lu", orig_count);
    }
    }
  }
  {
  {
#line 315
  fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)" +%lu", new_offset);
  }
  }
#line 316
  if (new_count != 1UL) {
    {
    {
#line 317
    fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)",%lu", new_count);
    }
    }
  }
  {
  {
#line 318
  fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)" @@\n");
  }
  {
#line 320
  rewind(newhunk);
  }
  }
  {
  {
#line 321
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
    {
    {
#line 321
    tmp___4 = copy_lines(newhunk, t, 100UL);
    }
    }
#line 321
    if (! tmp___4) {
#line 321
      goto while_break___0;
    }
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
  {
#line 322
  fclose(newhunk);
  }
  }
#line 324
  if (line) {
    {
    {
#line 325
    free((void *)line);
    }
    }
  }
#line 327
  return (this_offset);
}
}
#line 331 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static long removed_hunk(char const   *meta , FILE *modify , FILE *t , struct hunk **hunkp ,
                         unsigned long morig_count , unsigned long mnew_count , unsigned long *replaced ) 
{ 
  struct hunk *hunk ;
  long this_offset ;
  char *line ;
  size_t linelen ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  unsigned long orig_count ;
  unsigned long new_count ;
  int r ;
  int tmp ;
  __ssize_t tmp___0 ;
  unsigned long oo ;
  unsigned long no ;
  char *trailing ;
  int tmp___1 ;
  size_t tmp___2 ;
  size_t tmp___3 ;
  int tmp___4 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;
  char *__cil_tmp28 ;
  char *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;
  char *__cil_tmp40 ;

  {
  {
#line 335
  hunk = *hunkp;
#line 336
  this_offset = 0L;
#line 337
  line = (char *)((void *)0);
#line 338
  linelen = (size_t )0;
#line 343
  *replaced = 0UL;
  {
#line 344
  tmp = read_atatline(meta, & orig_offset, & orig_count, & new_offset, & new_count);
  }
  }
#line 344
  if (tmp) {
#line 346
    goto out;
  }
  {
  {
#line 348
  tmp___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)modify);
  }
  }
#line 348
  if (tmp___0 == -1) {
#line 349
    goto out;
  }
#line 351
  if ((int )*(line + 0) == 43) {
#line 351
    if ((int )*(line + 1) == 64) {
      {
      {
#line 355
      tmp___1 = read_atatline((char const   *)(line + 1), & oo, (unsigned long *)((void *)0),
                              & no, (unsigned long *)((void *)0));
      }
      }
#line 355
      if (tmp___1) {
#line 356
        goto out;
      }
#line 359
      if (hunk->info) {
#line 359
        if (! (hunk->info)->info_written) {
          {
          {
#line 360
          fputs((char const   */* __restrict  */)(hunk->info)->orig_file, (FILE */* __restrict  */)t);
          }
          {
#line 361
          fputs((char const   */* __restrict  */)(hunk->info)->new_file, (FILE */* __restrict  */)t);
          }
#line 362
          (hunk->info)->info_written = 1;
          }
        }
      }
      {
      {
#line 365
      trailing = strchr((char const   *)(line + 1), '+');
      }
      {
#line 366
      tmp___2 = strcspn((char const   *)trailing, " \n");
      }
#line 366
      trailing += tmp___2;
      }
#line 367
      if ((int )*trailing == 32) {
#line 368
        trailing ++;
      }
      {
      {
#line 369
      tmp___3 = strspn((char const   *)trailing, "@");
      }
#line 369
      trailing += tmp___3;
      }
#line 371
      if (oo != orig_offset) {
#line 372
        no = (new_offset + oo) - orig_offset;
      } else {
#line 374
        oo = (orig_offset + no) - new_offset;
      }
      {
      {
#line 375
      fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)"@@ -%lu",
              oo);
      }
      }
#line 376
      if (orig_count != 1UL) {
        {
        {
#line 377
        fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)",%lu",
                orig_count);
        }
        }
      }
      {
      {
#line 378
      fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)" +%lu",
              no);
      }
      }
#line 379
      if (new_count != 1UL) {
        {
        {
#line 380
        fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)",%lu",
                new_count);
        }
        }
      }
      {
      {
#line 381
      fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)" @@%s",
              trailing);
      }
      }
#line 382
      goto out;
    }
  }
#line 385
  if (mnew_count) {
#line 386
    goto only_whole;
  }
#line 388
  morig_count --;
#line 388
  *replaced = morig_count;
  {
  {
#line 390
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 390
    if (! morig_count) {
#line 390
      goto while_break;
    }
    {
    {
#line 391
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 391
      if (! orig_count) {
#line 391
        if (! new_count) {
#line 391
          goto while_break___0;
        }
      }
#line 392
      if ((int )*(line + 0) != 45) {
#line 393
        goto only_whole;
      }
      {
#line 396
      if ((int )*(line + 1) == 32) {
#line 396
        goto case_32;
      }
#line 400
      if ((int )*(line + 1) == 43) {
#line 400
        goto case_43;
      }
#line 404
      if ((int )*(line + 1) == 45) {
#line 404
        goto case_45;
      }
#line 408
      goto switch_default;
      case_32: /* CIL Label */ 
#line 397
      orig_count --;
#line 398
      new_count --;
#line 399
      goto switch_break;
      case_43: /* CIL Label */ 
#line 401
      new_count --;
#line 402
      this_offset --;
#line 403
      goto switch_break;
      case_45: /* CIL Label */ 
#line 405
      orig_count --;
#line 406
      this_offset ++;
#line 407
      goto switch_break;
      switch_default: /* CIL Label */ 
      {
      {
#line 409
      error(1, 0, "Garbled input: %s", line + 1);
      }
      }
      switch_break: /* CIL Label */ ;
      }
#line 413
      morig_count --;
#line 413
      if (! morig_count) {
#line 414
        goto while_break___0;
      }
      {
      {
#line 416
      r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)modify);
      }
      }
#line 417
      if (! (r != -1)) {
        {
        {
#line 417
        __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                      417U, "removed_hunk");
        }
        }
      }
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 420
    if (morig_count) {
#line 421
      if ((int )*(line + 0) != 45) {
#line 422
        goto only_whole;
      }
      {
      {
#line 424
      tmp___4 = read_atatline((char const   *)(line + 1), & orig_offset, & orig_count,
                              & new_offset, & new_count);
      }
      }
#line 424
      if (tmp___4) {
#line 426
        goto out;
      }
#line 428
      hunk = hunk->next;
#line 429
      hunk->info = (*hunkp)->info;
#line 430
      if (hunk->info) {
#line 431
        (hunk->info)->info_pending = 1;
      }
      {
#line 432
      *hunkp = hunk;
      {
#line 434
      r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)modify);
      }
      }
#line 435
      if (! (r != -1)) {
        {
        {
#line 435
        __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                      435U, "removed_hunk");
        }
        }
      }
#line 436
      morig_count --;
    }
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  out: 
#line 441
  if (line) {
    {
    {
#line 442
    free((void *)line);
    }
    }
  }
#line 444
  return (this_offset);
  only_whole: 
  {
  {
#line 447
  error(1, 0, "Only whole hunks may be added");
  }
  {
#line 449
  exit(1);
  }
  }
}
}
#line 457 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static long show_modified_hunk(struct hunk **hunkp , long line_offset , FILE *modify ,
                               FILE *original , FILE *out ) 
{ 
  struct hunk *hunk ;
  long this_offset ;
  unsigned long calc_orig_count ;
  unsigned long calc_new_offset ;
  unsigned long calc_new_count ;
  unsigned long orig_offset ;
  unsigned long orig_count ;
  unsigned long new_offset ;
  unsigned long new_count ;
  unsigned long morig_offset ;
  unsigned long morig_count ;
  unsigned long mnew_offset ;
  unsigned long mnew_count ;
  char *line ;
  size_t linelen ;
  FILE *t ;
  FILE *tmp ;
  int t_written_to ;
  unsigned long i ;
  unsigned long at ;
  unsigned long replaced ;
  unsigned long unaltered ;
  char *trailing ;
  int r ;
  int *tmp___0 ;
  size_t tmp___1 ;
  size_t tmp___2 ;
  int trim ;
  int *tmp___3 ;
  __ssize_t tmp___4 ;
  long loff ;
  FILE *write_to ;
  FILE *write_to___0 ;
  long tmp___5 ;
  __ssize_t tmp___6 ;
  int tmp___7 ;
  __ssize_t tmp___8 ;
  __ssize_t tmp___9 ;
  char *__cil_tmp44 ;
  char *__cil_tmp45 ;
  char *__cil_tmp46 ;
  char *__cil_tmp47 ;
  char *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;
  char *__cil_tmp76 ;
  char *__cil_tmp77 ;
  char *__cil_tmp78 ;
  char *__cil_tmp79 ;
  char *__cil_tmp80 ;
  char *__cil_tmp81 ;
  char *__cil_tmp82 ;
  char *__cil_tmp83 ;
  char *__cil_tmp84 ;
  char *__cil_tmp85 ;
  char *__cil_tmp86 ;
  char *__cil_tmp87 ;
  char *__cil_tmp88 ;
  char *__cil_tmp89 ;
  char *__cil_tmp90 ;

  {
  {
#line 460
  hunk = *hunkp;
#line 461
  this_offset = 0L;
#line 466
  line = (char *)((void *)0);
#line 467
  linelen = (size_t )0;
  {
#line 468
  tmp = xtmpfile();
  }
#line 468
  t = tmp;
#line 469
  t_written_to = 0;
#line 470
  at = 1UL;
  }
#line 475
  if (! t) {
    {
    {
#line 476
    tmp___0 = __errno_location();
    }
    {
#line 476
    error(1, *tmp___0, "Couldn\'t open temporary file");
    }
    }
  }
  {
  {
#line 478
  rewind(modify);
  }
  {
#line 480
  fsetpos(original, (fpos_t const   *)(& hunk->filepos));
  }
  {
#line 481
  r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
              (FILE */* __restrict  */)original);
  }
  }
#line 482
  if (! (r != -1)) {
    {
    {
#line 482
    __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                  482U, "show_modified_hunk");
    }
    }
  }
#line 483
  if (hunk->info) {
    {
    {
#line 484
    r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)original);
    }
    }
#line 485
    if (! (r != -1)) {
      {
      {
#line 485
      __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                    485U, "show_modified_hunk");
      }
      }
    }
    {
    {
#line 486
    r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)original);
    }
    }
#line 487
    if (! (r != -1)) {
      {
      {
#line 487
      __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                    487U, "show_modified_hunk");
      }
      }
    }
#line 488
    at += 2UL;
  }
  {
  {
#line 490
  r = read_atatline((char const   *)line, & orig_offset, & orig_count, & new_offset,
                    & new_count);
  }
  }
#line 492
  if (! (! r)) {
    {
    {
#line 492
    __assert_fail("!r", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                  492U, "show_modified_hunk");
    }
    }
  }
  {
#line 493
  calc_orig_count = orig_count;
#line 494
  calc_new_offset = new_offset;
#line 495
  calc_new_count = new_count;
  {
#line 497
  trailing = strchr((char const   *)line, '+');
  }
  {
#line 498
  tmp___1 = strcspn((char const   *)trailing, " \n");
  }
#line 498
  trailing += tmp___1;
  }
#line 499
  if ((int )*trailing == 32) {
#line 500
    trailing ++;
  }
  {
  {
#line 501
  tmp___2 = strspn((char const   *)trailing, "@");
  }
#line 501
  trailing += tmp___2;
  {
#line 502
  trailing = xstrdup((char const   *)trailing);
  }
  {
#line 504
  r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
              (FILE */* __restrict  */)modify);
  }
  }
#line 505
  if (! (r != -1)) {
    {
    {
#line 505
    __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                  505U, "show_modified_hunk");
    }
    }
  }
  {
  {
#line 506
  r = read_atatline((char const   *)line, & morig_offset, & morig_count, & mnew_offset,
                    & mnew_count);
  }
  }
#line 508
  if (! (! r)) {
    {
    {
#line 508
    __assert_fail("!r", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                  508U, "show_modified_hunk");
    }
    }
  }
#line 509
  replaced = morig_count;
  {
  {
#line 511
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 513
    trim = 0;
#line 514
    if (morig_offset < hunk->line_in_diff) {
      {
      {
#line 515
      tmp___3 = __errno_location();
      }
      {
#line 515
      error(1, *tmp___3, "Invalid changes made");
      }
      }
    }
#line 517
    unaltered = morig_offset - hunk->line_in_diff;
#line 518
    if (! morig_count) {
#line 519
      unaltered ++;
    }
#line 520
    if (unaltered > at) {
#line 521
      unaltered -= at;
    } else {
#line 522
      unaltered = 0UL;
    }
#line 524
    if (! unaltered) {
#line 525
      trim = 1;
    }
#line 529
    i = unaltered;
    {
    {
#line 529
    while (1) {
      while_continue___7: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 529
      if (! i) {
#line 529
        goto while_break___0;
      }
      {
      {
#line 530
      r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)original);
      }
      }
#line 531
      if (! (r != -1)) {
        {
        {
#line 531
        __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                      531U, "show_modified_hunk");
        }
        }
      }
      {
      {
#line 532
      fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)t);
      }
#line 533
      at ++;
#line 534
      t_written_to = 1;
      }
      {
#line 537
      if ((int )*(line + 0) == 32) {
#line 537
        goto case_32;
      }
#line 539
      if ((int )*(line + 0) == 45) {
#line 539
        goto case_45;
      }
#line 542
      if ((int )*(line + 0) == 43) {
#line 542
        goto case_43;
      }
#line 536
      goto switch_break;
      case_32: /* CIL Label */ 
#line 538
      if (new_count) {
#line 538
        new_count --;
      }
      case_45: /* CIL Label */ 
#line 540
      if (orig_count) {
#line 540
        orig_count --;
      }
#line 541
      goto switch_break;
      case_43: /* CIL Label */ 
#line 543
      if (new_count) {
#line 543
        new_count --;
      }
#line 544
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
#line 529
      i --;
    }
    while_break___7: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
    {
#line 548
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 548
      if (! morig_count) {
#line 548
        if (! mnew_count) {
#line 548
          goto while_break___1;
        }
      }
      {
      {
#line 549
      tmp___4 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)modify);
      }
      }
#line 549
      if (tmp___4 == -1) {
#line 550
        goto while_break___1;
      }
#line 552
      if ((int )*(line + 0) == 92) {
        {
        {
#line 553
        error(1, 0, "Don\'t know how to handle newline issues yet.");
        }
        }
      } else
#line 552
      if ((int )*(line + 1) == 92) {
        {
        {
#line 553
        error(1, 0, "Don\'t know how to handle newline issues yet.");
        }
        }
      }
      {
#line 561
      if ((int )*(line + 0) == 45) {
#line 561
        goto case_45___0;
      }
#line 593
      if ((int )*(line + 0) == 43) {
#line 593
        goto case_43___1;
      }
#line 560
      goto switch_break___0;
      case_45___0: /* CIL Label */ 
      {
#line 563
      if ((int )*(line + 1) == 43) {
#line 563
        goto case_43___0;
      }
#line 568
      if ((int )*(line + 1) == 45) {
#line 568
        goto case_45___1;
      }
#line 572
      if ((int )*(line + 1) == 32) {
#line 572
        goto case_32___0;
      }
#line 576
      if ((int )*(line + 1) == 64) {
#line 576
        goto case_64;
      }
#line 578
      goto switch_default;
      case_43___0: /* CIL Label */ 
#line 564
      this_offset --;
#line 565
      calc_new_count --;
#line 566
      trim = 0;
#line 567
      goto switch_break___1;
      case_45___1: /* CIL Label */ 
#line 569
      this_offset ++;
#line 570
      calc_orig_count --;
#line 571
      goto switch_break___1;
      case_32___0: /* CIL Label */ 
#line 573
      calc_new_count --;
#line 574
      calc_orig_count --;
#line 575
      goto switch_break___1;
      case_64: /* CIL Label */ 
#line 577
      goto hunk_end;
      switch_default: /* CIL Label */ 
      {
      {
#line 579
      error(1, 0, "Not supported: %c%c", (int )*(line + 0), (int )*(line + 1));
      }
      }
      switch_break___1: /* CIL Label */ ;
      }
#line 584
      if (trim) {
#line 585
        orig_offset ++;
#line 586
        calc_new_offset ++;
      }
#line 589
      if (morig_count) {
#line 590
        morig_count --;
      }
#line 592
      goto switch_break___0;
      case_43___1: /* CIL Label */ 
      {
#line 595
      if ((int )*(line + 1) == 43) {
#line 595
        goto case_43___2;
      }
#line 601
      if ((int )*(line + 1) == 45) {
#line 601
        goto case_45___2;
      }
#line 608
      if ((int )*(line + 1) == 32) {
#line 608
        goto case_32___1;
      }
#line 614
      if ((int )*(line + 1) == 64) {
#line 614
        goto case_64___0;
      }
#line 616
      goto switch_default___0;
      case_43___2: /* CIL Label */ 
      {
#line 596
      this_offset ++;
#line 597
      calc_new_count ++;
      {
#line 598
      fputs((char const   */* __restrict  */)(line + 1), (FILE */* __restrict  */)t);
      }
#line 599
      t_written_to = 1;
      }
#line 600
      goto switch_break___2;
      case_45___2: /* CIL Label */ 
      {
#line 602
      this_offset --;
#line 603
      calc_orig_count ++;
#line 604
      trim = 0;
      {
#line 605
      fputs((char const   */* __restrict  */)(line + 1), (FILE */* __restrict  */)t);
      }
#line 606
      t_written_to = 1;
      }
#line 607
      goto switch_break___2;
      case_32___1: /* CIL Label */ 
      {
#line 609
      calc_orig_count ++;
#line 610
      calc_new_count ++;
      {
#line 611
      fputs((char const   */* __restrict  */)(line + 1), (FILE */* __restrict  */)t);
      }
#line 612
      t_written_to = 1;
      }
#line 613
      goto switch_break___2;
      case_64___0: /* CIL Label */ 
#line 615
      goto hunk_end;
      switch_default___0: /* CIL Label */ 
      {
      {
#line 617
      error(1, 0, "Not supported: %c%c", (int )*(line + 0), (int )*(line + 1));
      }
      }
      switch_break___2: /* CIL Label */ ;
      }
#line 622
      if (trim) {
#line 623
        orig_offset --;
#line 624
        calc_new_offset --;
      }
#line 627
      if (mnew_count) {
#line 628
        mnew_count --;
      }
#line 630
      goto switch_break___0;
      switch_break___0: /* CIL Label */ ;
      }
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
    {
    {
#line 638
    while (1) {
      while_continue___9: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
#line 638
      if (! replaced) {
#line 638
        goto while_break___2;
      }
      {
#line 639
      replaced --;
      {
#line 640
      r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)original);
      }
      }
#line 641
      if (! (r != -1)) {
        {
        {
#line 641
        __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                      641U, "show_modified_hunk");
        }
        }
      }
#line 642
      at ++;
      {
#line 644
      if ((int )*(line + 0) == 32) {
#line 644
        goto case_32___2;
      }
#line 646
      if ((int )*(line + 0) == 45) {
#line 646
        goto case_45___3;
      }
#line 649
      if ((int )*(line + 0) == 43) {
#line 649
        goto case_43___3;
      }
#line 643
      goto switch_break___3;
      case_32___2: /* CIL Label */ 
#line 645
      if (new_count) {
#line 645
        new_count --;
      }
      case_45___3: /* CIL Label */ 
#line 647
      if (orig_count) {
#line 647
        orig_count --;
      }
#line 648
      goto switch_break___3;
      case_43___3: /* CIL Label */ 
#line 650
      if (new_count) {
#line 650
        new_count --;
      }
#line 651
      goto switch_break___3;
      switch_break___3: /* CIL Label */ ;
      }
    }
    while_break___9: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
    hunk_end: 
#line 656
    if (*(line + 0)) {
#line 656
      if ((int )*(line + 1) == 64) {
#line 657
        if ((int )*(line + 0) == 43) {
#line 660
          if (t_written_to) {
#line 660
            write_to = t;
          } else {
#line 660
            write_to = out;
          }
#line 661
          if (hunk->info) {
#line 661
            if (! (hunk->info)->info_written) {
              {
              {
#line 662
              fputs((char const   */* __restrict  */)(hunk->info)->orig_file, (FILE */* __restrict  */)out);
              }
              {
#line 663
              fputs((char const   */* __restrict  */)(hunk->info)->new_file, (FILE */* __restrict  */)out);
              }
#line 664
              (hunk->info)->info_written = 1;
              }
            }
          }
          {
          {
#line 666
          loff = added_hunk((char const   *)(line + 1), this_offset, modify, write_to,
                            morig_count, mnew_count);
          }
          }
#line 672
          if (! hunk->discard_offset) {
#line 673
            line_offset += loff;
          }
        } else
#line 680
        if ((int )*(line + 0) == 45) {
#line 682
          if (t_written_to) {
#line 682
            write_to___0 = t;
          } else {
#line 682
            write_to___0 = out;
          }
          {
          {
#line 683
          tmp___5 = removed_hunk((char const   *)(line + 1), modify, write_to___0,
                                 hunkp, morig_count, mnew_count, & replaced);
          }
#line 683
          this_offset += tmp___5;
#line 688
          hunk = *hunkp;
#line 697
          calc_orig_count = 0UL;
#line 698
          calc_new_count = 0UL;
          }
          {
          {
#line 700
          while (1) {
            while_continue___10: /* CIL Label */ ;
            while_continue___3: /* CIL Label */ ;
#line 700
            if (! replaced) {
#line 700
              goto while_break___3;
            }
            {
#line 701
            replaced --;
            {
#line 702
            r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)original);
            }
            }
#line 704
            if (! (r != -1)) {
              {
              {
#line 704
              __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                            704U, "show_modified_hunk");
              }
              }
            }
#line 705
            at ++;
            {
#line 707
            if ((int )*(line + 0) == 32) {
#line 707
              goto case_32___3;
            }
#line 709
            if ((int )*(line + 0) == 45) {
#line 709
              goto case_45___4;
            }
#line 712
            if ((int )*(line + 0) == 43) {
#line 712
              goto case_43___4;
            }
#line 706
            goto switch_break___4;
            case_32___3: /* CIL Label */ 
#line 708
            if (new_count) {
#line 708
              new_count --;
            }
            case_45___4: /* CIL Label */ 
#line 710
            if (orig_count) {
#line 710
              orig_count --;
            }
#line 711
            goto switch_break___4;
            case_43___4: /* CIL Label */ 
#line 713
            if (new_count) {
#line 713
              new_count --;
            }
#line 714
            goto switch_break___4;
            switch_break___4: /* CIL Label */ ;
            }
          }
          while_break___10: /* CIL Label */ ;
          }
          while_break___3: /* CIL Label */ ;
          }
        } else {
          {
          {
#line 717
          error(1, 0, "diff output not understood");
          }
          }
        }
      }
    }
    {
    {
#line 721
    tmp___6 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)modify);
    }
    }
#line 721
    if (tmp___6 == -1) {
#line 722
      goto while_break;
    }
    {
    {
#line 724
    r = read_atatline((char const   *)line, & morig_offset, & morig_count, & mnew_offset,
                      & mnew_count);
    }
    }
#line 726
    if (! (! r)) {
      {
      {
#line 726
      __assert_fail("!r", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                    726U, "show_modified_hunk");
      }
      }
    }
    {
#line 727
    replaced = morig_count;
    {
#line 511
    tmp___7 = feof(modify);
    }
    }
#line 511
    if (tmp___7) {
#line 511
      goto while_break;
    }
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 734
  while (1) {
    while_continue___11: /* CIL Label */ ;
    while_continue___4: /* CIL Label */ ;
#line 734
    if (! orig_count) {
#line 734
      if (! new_count) {
#line 734
        goto while_break___4;
      }
    }
    {
    {
#line 735
    tmp___8 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)original);
    }
    }
#line 735
    if (tmp___8 == -1) {
#line 736
      goto while_break___4;
    }
    {
    {
#line 737
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)t);
    }
#line 741
    at ++;
    }
    {
#line 743
    if ((int )*(line + 0) == 32) {
#line 743
      goto case_32___4;
    }
#line 745
    if ((int )*(line + 0) == 45) {
#line 745
      goto case_45___5;
    }
#line 748
    if ((int )*(line + 0) == 43) {
#line 748
      goto case_43___5;
    }
#line 742
    goto switch_break___5;
    case_32___4: /* CIL Label */ 
#line 744
    if (new_count) {
#line 744
      new_count --;
    }
    case_45___5: /* CIL Label */ 
#line 746
    if (orig_count) {
#line 746
      orig_count --;
    }
#line 747
    goto switch_break___5;
    case_43___5: /* CIL Label */ 
#line 749
    if (new_count) {
#line 749
      new_count --;
    }
#line 750
    goto switch_break___5;
    switch_break___5: /* CIL Label */ ;
    }
#line 752
    if (! ((int )*(line + 0) != 64)) {
      {
      {
#line 752
      __assert_fail("line[0] != \'@\'", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                    752U, "show_modified_hunk");
      }
      }
    }
  }
  while_break___11: /* CIL Label */ ;
  }
  while_break___4: /* CIL Label */ ;
  }
#line 759
  if (hunk->info) {
#line 759
    if (! (hunk->info)->info_written) {
      {
      {
#line 760
      fputs((char const   */* __restrict  */)(hunk->info)->orig_file, (FILE */* __restrict  */)out);
      }
      {
#line 761
      fputs((char const   */* __restrict  */)(hunk->info)->new_file, (FILE */* __restrict  */)out);
      }
#line 762
      (hunk->info)->info_written = 1;
      }
    }
  }
  {
  {
#line 764
  rewind(t);
  }
  }
#line 766
  if (calc_orig_count) {
#line 766
    goto _L;
  } else
#line 766
  if (calc_new_count) {
    _L: /* CIL Label */ 
    {
    {
#line 767
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"@@ -%lu",
            orig_offset);
    }
    }
#line 768
    if (calc_orig_count != 1UL) {
      {
      {
#line 769
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
              calc_orig_count);
      }
      }
    }
    {
    {
#line 770
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" +%lu",
            calc_new_offset + (unsigned long )line_offset);
    }
    }
#line 771
    if (calc_new_count != 1UL) {
      {
      {
#line 772
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
              calc_new_count);
      }
      }
    }
    {
    {
#line 773
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" @@%s",
            trailing);
    }
    }
  }
  {
  {
#line 776
  free((void *)trailing);
  }
  }
  {
  {
#line 777
  while (1) {
    while_continue___12: /* CIL Label */ ;
    while_continue___5: /* CIL Label */ ;
    {
    {
#line 777
    tmp___9 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)t);
    }
    }
#line 777
    if (! (tmp___9 != -1)) {
#line 777
      goto while_break___5;
    }
    {
    {
#line 778
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    }
  }
  while_break___12: /* CIL Label */ ;
  }
  while_break___5: /* CIL Label */ ;
  }
#line 780
  if (line) {
    {
    {
#line 781
    free((void *)line);
    }
    }
  }
  {
  {
#line 782
  fclose(modify);
  }
  {
#line 783
  fclose(t);
  }
  {
#line 788
  copy_trailing(hunk, original, out, at - 1UL);
  }
  }
#line 792
  return (this_offset);
}
}
#line 799 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static int rediff(char const   *original , char const   *edited , FILE *out ) 
{ 
  pid_t child ;
  FILE *o ;
  FILE *m ;
  FILE *t ;
  char *line ;
  size_t linelen ;
  unsigned long linenum___1 ;
  struct hunk *hunks___1 ;
  struct hunk **p ;
  struct hunk *last ;
  struct hunk *current_hunk ;
  long line_offset ;
  fpos_t first_hunk ;
  unsigned long o_count ;
  unsigned long n_count ;
  struct hunk *newhunk ;
  fpos_t pos ;
  __ssize_t tmp ;
  int *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  void *tmp___5 ;
  struct file_info *info ;
  void *tmp___6 ;
  int tmp___7 ;
  char *tmp___8 ;
  int *tmp___9 ;
  __ssize_t tmp___10 ;
  char *tmp___11 ;
  int *tmp___12 ;
  __ssize_t tmp___13 ;
  int tmp___14 ;
  __ssize_t tmp___15 ;
  int tmp___16 ;
  size_t buffer_size ;
  char *buffer ;
  void *tmp___17 ;
  size_t got ;
  size_t tmp___18 ;
  int tmp___19 ;
  int *tmp___20 ;
  unsigned long orig_line ;
  unsigned long orig_count ;
  struct hunk *which ;
  fpos_t pos___0 ;
  __ssize_t tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int header ;
  long tmp___24 ;
  struct hunk *tmp___25 ;
  __ssize_t tmp___26 ;
  int tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  long tmp___30 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;
  char *__cil_tmp76 ;
  char *__cil_tmp77 ;
  char *__cil_tmp78 ;
  char *__cil_tmp79 ;
  char *__cil_tmp80 ;

  {
  {
#line 804
  t = (FILE *)((void *)0);
#line 805
  line = (char *)((void *)0);
#line 806
  linelen = (size_t )0;
#line 807
  linenum___1 = 0UL;
#line 808
  hunks___1 = (struct hunk *)((void *)0);
#line 808
  p = & hunks___1;
#line 808
  last = (struct hunk *)((void *)0);
#line 809
  current_hunk = (struct hunk *)((void *)0);
#line 810
  line_offset = 0L;
  {
#line 814
  o = xopen(original, "rbm");
  }
  }
  {
  {
#line 815
  while (1) {
    while_continue___7: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 815
    tmp___16 = feof(o);
    }
    }
#line 815
    if (tmp___16) {
#line 815
      goto while_break;
    }
    {
    {
#line 821
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 822
      fgetpos((FILE */* __restrict  */)o, (fpos_t */* __restrict  */)(& pos));
      }
      {
#line 823
      tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)o);
      }
      }
#line 823
      if (tmp == -1) {
#line 824
        goto while_break___0;
      }
      {
#line 825
      linenum___1 ++;
      {
#line 827
      tmp___1 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 827
      if (! tmp___1) {
        {
        {
#line 828
        tmp___0 = __errno_location();
        }
        {
#line 828
        error(1, *tmp___0, "Don\'t know how to handle context format yet.");
        }
        }
      }
      {
      {
#line 821
      tmp___2 = strncmp((char const   *)line, "@@ ", (size_t )3);
      }
      }
#line 821
      if (tmp___2) {
        {
        {
#line 821
        tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
        }
        }
#line 821
        if (! tmp___3) {
#line 821
          goto while_break___0;
        }
      } else {
#line 821
        goto while_break___0;
      }
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
    {
#line 834
    tmp___4 = feof(o);
    }
    }
#line 834
    if (tmp___4) {
#line 835
      goto while_break;
    }
#line 837
    if (last) {
#line 838
      last->num_lines = (linenum___1 - last->line_in_diff) + 1UL;
    }
    {
    {
#line 840
    tmp___5 = xmalloc((size_t )sizeof(*newhunk));
    }
#line 840
    newhunk = (struct hunk *)tmp___5;
#line 841
    newhunk->filepos = pos;
#line 842
    newhunk->line_in_diff = linenum___1;
#line 843
    newhunk->num_lines = 0UL;
    {
#line 845
    tmp___14 = strncmp((char const   *)line, "--- ", (size_t )4);
    }
    }
#line 845
    if (tmp___14) {
#line 858
      newhunk->info = (struct file_info *)((void *)0);
    } else {
      {
      {
#line 846
      tmp___6 = xmalloc((size_t )sizeof(*info));
      }
#line 846
      info = (struct file_info *)tmp___6;
#line 847
      tmp___7 = 0;
#line 847
      info->info_pending = tmp___7;
#line 847
      info->info_written = tmp___7;
      {
#line 848
      tmp___8 = xstrdup((char const   *)line);
      }
#line 848
      info->orig_file = (char const   *)tmp___8;
      {
#line 849
      tmp___10 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)o);
      }
      }
#line 849
      if (tmp___10 == -1) {
        {
        {
#line 850
        tmp___9 = __errno_location();
        }
        {
#line 850
        error(1, *tmp___9, "Premature end of file");
        }
        }
      }
      {
      {
#line 852
      tmp___11 = xstrdup((char const   *)line);
      }
#line 852
      info->new_file = (char const   *)tmp___11;
#line 853
      newhunk->info = info;
      {
#line 854
      tmp___13 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)o);
      }
      }
#line 854
      if (tmp___13 == -1) {
        {
        {
#line 855
        tmp___12 = __errno_location();
        }
        {
#line 855
        error(1, *tmp___12, "Premature end of file");
        }
        }
      }
#line 857
      linenum___1 += 2UL;
    }
    {
    {
#line 860
    read_atatline((char const   *)line, & newhunk->orig_offset, & newhunk->orig_count,
                  & newhunk->new_offset, & newhunk->new_count);
    }
#line 864
    o_count = newhunk->orig_count;
#line 865
    n_count = newhunk->new_count;
#line 867
    newhunk->next = (struct hunk *)((void *)0);
    }
#line 868
    if (*p) {
#line 869
      (*p)->next = newhunk;
    }
#line 870
    last = newhunk;
#line 870
    *p = last;
#line 871
    p = & newhunk->next;
    {
    {
#line 883
    while (1) {
      while_continue___9: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 883
      if (! o_count) {
#line 883
        if (! n_count) {
#line 883
          goto while_break___1;
        }
      }
      {
      {
#line 884
      tmp___15 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)o);
      }
      }
#line 884
      if (tmp___15 == -1) {
#line 885
        goto while_break___1;
      }
#line 887
      linenum___1 ++;
      {
#line 889
      if ((int )*(line + 0) == 32) {
#line 889
        goto case_32;
      }
#line 891
      if ((int )*(line + 0) == 45) {
#line 891
        goto case_45;
      }
#line 894
      if ((int )*(line + 0) == 43) {
#line 894
        goto case_43;
      }
#line 888
      goto switch_break;
      case_32: /* CIL Label */ 
#line 890
      if (n_count) {
#line 890
        n_count --;
      }
      case_45: /* CIL Label */ 
#line 892
      if (o_count) {
#line 892
        o_count --;
      }
#line 893
      goto switch_break;
      case_43: /* CIL Label */ 
#line 895
      if (n_count) {
#line 895
        n_count --;
      }
#line 896
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
    }
    while_break___9: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 901
  if (! hunks___1) {
    {
    {
#line 902
    error(1, 0, "Original patch seems empty");
    }
    }
  }
  {
#line 904
  last->num_lines = (linenum___1 - last->line_in_diff) + 1UL;
  {
#line 907
  t = xpipe("diff", & child, "r", "diff", "-U0", original, edited, (void *)0);
  }
  {
#line 909
  m = xtmpfile();
  }
  }
#line 910
  if (m) {
    {
#line 911
    buffer_size = (size_t )10000;
    {
#line 912
    tmp___17 = xmalloc(buffer_size);
    }
#line 912
    buffer = (char *)tmp___17;
    }
    {
    {
#line 913
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
      {
      {
#line 913
      tmp___19 = feof(t);
      }
      }
#line 913
      if (tmp___19) {
#line 913
        goto while_break___2;
      }
      {
      {
#line 914
      tmp___18 = fread((void */* __restrict  */)buffer, (size_t )1, buffer_size, (FILE */* __restrict  */)t);
      }
#line 914
      got = tmp___18;
      {
#line 915
      fwrite((void const   */* __restrict  */)buffer, (size_t )1, got, (FILE */* __restrict  */)m);
      }
      }
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
    {
    {
#line 917
    fclose(t);
    }
    {
#line 918
    waitpid(child, (int *)((void *)0), 0);
    }
    {
#line 919
    rewind(m);
    }
    {
#line 920
    free((void *)buffer);
    }
    }
  } else {
    {
    {
#line 921
    tmp___20 = __errno_location();
    }
    {
#line 921
    error(1, *tmp___20, "Couldn\'t create temporary file");
    }
    }
  }
#line 927
  *line = (char )'\000';
  {
  {
#line 928
  while (1) {
    while_continue___11: /* CIL Label */ ;
    while_continue___3: /* CIL Label */ ;
    {
    {
#line 928
    tmp___29 = feof(m);
    }
    }
#line 928
    if (tmp___29) {
#line 928
      goto while_break___3;
    }
    {
    {
#line 934
    while (1) {
      while_continue___12: /* CIL Label */ ;
      while_continue___4: /* CIL Label */ ;
      {
      {
#line 934
      tmp___22 = strncmp((char const   *)line, "@@ ", (size_t )3);
      }
      }
#line 934
      if (! tmp___22) {
#line 934
        goto while_break___4;
      }
      {
      {
#line 935
      fgetpos((FILE */* __restrict  */)m, (fpos_t */* __restrict  */)(& pos___0));
      }
      {
#line 936
      tmp___21 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)m);
      }
      }
#line 936
      if (tmp___21 == -1) {
#line 937
        goto while_break___4;
      }
    }
    while_break___12: /* CIL Label */ ;
    }
    while_break___4: /* CIL Label */ ;
    }
    {
    {
#line 940
    tmp___23 = feof(m);
    }
    }
#line 940
    if (tmp___23) {
#line 941
      goto while_break___3;
    }
    {
    {
#line 943
    read_atatline((char const   *)line, & orig_line, & orig_count, (unsigned long *)((void *)0),
                  (unsigned long *)((void *)0));
    }
    }
#line 944
    if (! orig_count) {
#line 945
      orig_line ++;
    }
#line 948
    which = hunks___1;
    {
    {
#line 948
    while (1) {
      while_continue___13: /* CIL Label */ ;
      while_continue___5: /* CIL Label */ ;
#line 948
      if (! which) {
#line 948
        goto while_break___5;
      }
#line 951
      if (! which->next) {
#line 953
        goto while_break___5;
      }
#line 956
      if ((which->next)->info) {
#line 956
        header = 2;
      } else {
#line 956
        header = 0;
      }
#line 957
      if ((which->next)->line_in_diff + (unsigned long )header > orig_line) {
#line 959
        goto while_break___5;
      }
#line 948
      which = which->next;
    }
    while_break___13: /* CIL Label */ ;
    }
    while_break___5: /* CIL Label */ ;
    }
#line 961
    if (! which) {
      {
      {
#line 961
      __assert_fail("which", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                    961U, "rediff");
      }
      }
    }
#line 963
    if (which->line_in_diff + which->num_lines <= orig_line) {
#line 964
      which->discard_offset = 1;
    }
#line 976
    if ((unsigned long )current_hunk != (unsigned long )which) {
#line 977
      if (current_hunk) {
        {
        {
#line 978
        tmp___24 = show_modified_hunk(& current_hunk, line_offset, t, o, out);
        }
#line 978
        line_offset += tmp___24;
#line 981
        current_hunk = current_hunk->next;
        }
      }
#line 985
      if (current_hunk) {
#line 985
        tmp___25 = current_hunk;
      } else {
#line 985
        tmp___25 = hunks___1;
      }
      {
      {
#line 985
      copy_to(tmp___25, which, & line_offset, o, out, (unsigned long )current_hunk == (unsigned long )((void *)0));
      }
#line 991
      first_hunk = pos___0;
      {
#line 992
      t = xtmpfile();
      }
      }
    }
    {
#line 995
    current_hunk = which;
    {
#line 998
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)t);
    }
    }
    {
    {
#line 999
    while (1) {
      while_continue___14: /* CIL Label */ ;
      while_continue___6: /* CIL Label */ ;
      {
      {
#line 999
      tmp___28 = feof(m);
      }
      }
#line 999
      if (tmp___28) {
#line 999
        goto while_break___6;
      }
      {
      {
#line 1000
      tmp___26 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)m);
      }
      }
#line 1000
      if (tmp___26 == -1) {
#line 1001
        goto while_break___6;
      }
      {
      {
#line 1002
      tmp___27 = strncmp((char const   *)line, "@@ ", (size_t )3);
      }
      }
#line 1002
      if (! tmp___27) {
#line 1003
        goto while_break___6;
      }
      {
      {
#line 1004
      fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)t);
      }
      }
    }
    while_break___14: /* CIL Label */ ;
    }
    while_break___6: /* CIL Label */ ;
    }
  }
  while_break___11: /* CIL Label */ ;
  }
  while_break___3: /* CIL Label */ ;
  }
#line 1009
  if (current_hunk) {
    {
    {
#line 1010
    tmp___30 = show_modified_hunk(& current_hunk, line_offset, t, o, out);
    }
#line 1010
    line_offset += tmp___30;
#line 1012
    current_hunk = current_hunk->next;
    }
#line 1013
    if (current_hunk) {
      {
      {
#line 1014
      copy_to(current_hunk, (struct hunk *)((void *)0), & line_offset, o, out, 0);
      }
      }
    }
  } else {
    {
    {
#line 1016
    copy_to(hunks___1, (struct hunk *)((void *)0), & line_offset, o, out, 1);
    }
    }
  }
  {
  {
#line 1018
  fclose(o);
  }
  {
#line 1019
  fclose(m);
  }
  }
#line 1020
  if (line) {
    {
    {
#line 1021
    free((void *)line);
    }
    }
  }
#line 1023
  return (0);
}
}
#line 1025 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static char *syntax_str___0  =    (char *)"usage: %s ORIGINAL EDITED\n       %s EDITED\n";
#line 1028
static  __attribute__((__noreturn__)) void syntax___0(int err ) ;
#line 1028 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static void syntax___0(int err ) 
{ 
  struct _IO_FILE *tmp ;

  {
#line 1031
  if (err) {
#line 1031
    tmp = stderr;
  } else {
#line 1031
    tmp = stdout;
  }
  {
  {
#line 1031
  fprintf((FILE */* __restrict  */)tmp, (char const   */* __restrict  */)syntax_str___0,
          progname, progname);
  }
  {
#line 1032
  exit(err);
  }
  }
}
}
#line 1041 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static struct option long_options___0[3]  = {      {"help", 0, (int *)0, 'h'}, 
        {"version", 0, (int *)0, 'v'}, 
        {(char const   *)0, 0, (int *)0, 0}};
#line 78 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static unsigned long copy_hunk___0(FILE *in , FILE *out , unsigned long orig_lines ,
                                   unsigned long new_lines ) 
{ 
  int newline ;
  fpos_t pos ;
  char *line ;
  size_t linelen ;
  unsigned long count ;
  __ssize_t tmp ;

  {
#line 82
  newline = 1;
#line 84
  line = (char *)((void *)0);
#line 85
  linelen = (size_t )0;
#line 86
  count = 0UL;
  {
  {
#line 88
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 88
    if (! orig_lines) {
#line 88
      if (! new_lines) {
#line 88
        if (! newline) {
#line 88
          goto while_break;
        }
      }
    }
    {
    {
#line 89
    fgetpos((FILE */* __restrict  */)in, (fpos_t */* __restrict  */)(& pos));
    }
    {
#line 90
    tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)in);
    }
    }
#line 90
    if (tmp == -1) {
#line 91
      goto while_break;
    }
#line 93
    if (! orig_lines) {
#line 93
      if (! new_lines) {
#line 93
        if ((int )*(line + 0) != 92) {
#line 95
          goto while_break;
        }
      }
    }
    {
#line 97
    count ++;
    {
#line 99
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    }
    {
#line 101
    if ((int )*(line + 0) == 32) {
#line 101
      goto case_32;
    }
#line 103
    if ((int )*(line + 0) == 45) {
#line 103
      goto case_45;
    }
#line 106
    if ((int )*(line + 0) == 43) {
#line 106
      goto case_43;
    }
#line 109
    if ((int )*(line + 0) == 92) {
#line 109
      goto case_92;
    }
#line 100
    goto switch_break;
    case_32: /* CIL Label */ 
#line 102
    if (new_lines) {
#line 102
      new_lines --;
    }
    case_45: /* CIL Label */ 
#line 104
    if (orig_lines) {
#line 104
      orig_lines --;
    }
#line 105
    goto switch_break;
    case_43: /* CIL Label */ 
#line 107
    if (new_lines) {
#line 107
      new_lines --;
    }
#line 108
    goto switch_break;
    case_92: /* CIL Label */ 
#line 110
    newline = 0;
#line 111
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 115
  if (newline) {
    {
    {
#line 117
    fsetpos(in, (fpos_t const   *)(& pos));
    }
    }
  }
#line 119
  return (count);
}
}
#line 123 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static unsigned long adjust_offsets_and_copy___0(long *offset , FILE *in , FILE *out ) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long orig_offset ;
  unsigned long orig_lines ;
  unsigned long new_offset ;
  unsigned long new_lines ;
  unsigned long count ;
  char *trailing ;
  __ssize_t tmp ;
  __ssize_t tmp___0 ;
  __ssize_t tmp___1 ;
  int tmp___2 ;
  size_t tmp___3 ;
  int tmp___4 ;
  size_t tmp___5 ;
  size_t tmp___6 ;
  unsigned long tmp___7 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;
  char *__cil_tmp25 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;
  char *__cil_tmp28 ;
  char *__cil_tmp29 ;

  {
  {
#line 126
  line = (char *)((void *)0);
#line 127
  linelen = (size_t )0;
#line 129
  count = 0UL;
  {
#line 132
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)in);
  }
  }
#line 132
  if (tmp == -1) {
#line 133
    goto out;
  }
  {
#line 134
  count ++;
  {
#line 136
  tmp___2 = strncmp((char const   *)line, "--- ", (size_t )4);
  }
  }
#line 136
  if (! tmp___2) {
    {
    {
#line 139
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    {
#line 140
    tmp___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)in);
    }
    }
#line 140
    if (tmp___0 == -1) {
#line 141
      goto out;
    }
    {
#line 142
    count ++;
    {
#line 143
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    {
#line 144
    tmp___1 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)in);
    }
    }
#line 144
    if (tmp___1 == -1) {
#line 145
      goto out;
    }
#line 146
    count ++;
#line 149
    *offset = 0L;
  }
  {
  {
#line 152
  tmp___4 = read_atatline((char const   *)line, & orig_offset, & orig_lines, & new_offset,
                          & new_lines);
  }
  }
#line 152
  if (tmp___4) {
    {
    {
#line 154
    tmp___3 = strlen((char const   *)line);
    }
#line 154
    *(line + (tmp___3 - 1U)) = (char )'\000';
    {
#line 155
    error(1, 0, "Line not understood: %s", line);
    }
    }
  }
  {
  {
#line 159
  trailing = strchr((char const   *)line, '+');
  }
  {
#line 160
  tmp___5 = strcspn((char const   *)trailing, " \n");
  }
#line 160
  trailing += tmp___5;
  }
#line 161
  if ((int )*trailing == 32) {
#line 162
    trailing ++;
  }
  {
  {
#line 163
  tmp___6 = strspn((char const   *)trailing, "@");
  }
#line 163
  trailing += tmp___6;
  {
#line 166
  fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"@@ -%lu",
          orig_offset);
  }
  }
#line 167
  if (orig_lines != 1UL) {
    {
    {
#line 168
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
            orig_lines);
    }
    }
  }
  {
  {
#line 169
  fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" +%lu",
          new_offset + (unsigned long )*offset);
  }
  }
#line 170
  if (new_lines != 1UL) {
    {
    {
#line 171
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
            new_lines);
    }
    }
  }
  {
  {
#line 172
  fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" @@%s",
          trailing);
  }
  {
#line 173
  free((void *)line);
  }
  {
#line 176
  tmp___7 = copy_hunk___0(in, out, orig_lines, new_lines);
  }
#line 176
  count += tmp___7;
  }
  out: 
#line 179
  return (count);
}
}
#line 183 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static unsigned long copy_lines___0(FILE *in , FILE *out , unsigned long n ) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long count ;
  __ssize_t tmp ;
  unsigned long tmp___0 ;

  {
#line 185
  line = (char *)((void *)0);
#line 186
  linelen = (size_t )0;
#line 187
  count = 0UL;
  {
  {
#line 188
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 188
    tmp___0 = n;
#line 188
    n --;
#line 188
    if (! tmp___0) {
#line 188
      goto while_break;
    }
    {
    {
#line 189
    tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)in);
    }
    }
#line 189
    if (tmp == -1) {
#line 190
      goto while_break;
    }
    {
#line 191
    count ++;
    {
#line 192
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 194
  if (line) {
    {
    {
#line 195
    free((void *)line);
    }
    }
  }
#line 196
  return (count);
}
}
#line 201 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static void copy_trailing___0(struct hunk *hunk , FILE *in , FILE *out , unsigned long done ) 
{ 
  unsigned long todo ;
  unsigned long tmp ;

  {
#line 204
  if (hunk->next) {
#line 207
    if (done < (hunk->next)->line_in_diff - hunk->line_in_diff) {
#line 208
      todo = ((hunk->next)->line_in_diff - hunk->line_in_diff) - done;
#line 211
      if (todo > 1UL) {
        {
        {
#line 212
        copy_lines___0(in, out, todo - 1UL);
        }
        }
      }
    }
  } else {
    {
    {
#line 216
    while (1) {
      while_continue___0: /* CIL Label */ ;
      while_continue: /* CIL Label */ ;
      {
      {
#line 216
      tmp = copy_lines___0(in, out, 100UL);
      }
      }
#line 216
      if (! tmp) {
#line 216
        goto while_break;
      }
    }
    while_break___0: /* CIL Label */ ;
    }
    while_break: /* CIL Label */ ;
    }
  }
#line 219
  return;
}
}
#line 226 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static void copy_to___0(struct hunk *from , struct hunk *upto , long *line_offset ,
                        FILE *in , FILE *out , int is_first ) 
{ 
  unsigned long count ;

  {
#line 229
  if (! is_first) {
#line 229
    if (from) {
#line 229
      if (from->info) {
#line 229
        if (! (from->info)->info_written) {
#line 229
          if ((from->info)->info_pending) {
            {
            {
#line 231
            fputs((char const   */* __restrict  */)(from->info)->orig_file, (FILE */* __restrict  */)out);
            }
            {
#line 232
            fputs((char const   */* __restrict  */)(from->info)->new_file, (FILE */* __restrict  */)out);
            }
#line 233
            (from->info)->info_written = 1;
            }
          }
        }
      }
    }
  }
#line 236
  if (is_first) {
#line 236
    if (from) {
      {
      {
#line 238
      fseek(in, 0L, 0);
      }
      {
#line 239
      copy_lines___0(in, out, from->line_in_diff - 1UL);
      }
      }
    }
  }
  {
  {
#line 242
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 242
    if (from) {
#line 242
      if (! ((unsigned long )from != (unsigned long )upto)) {
#line 242
        goto while_break;
      }
    } else {
#line 242
      goto while_break;
    }
    {
    {
#line 244
    fsetpos(in, (fpos_t const   *)(& from->filepos));
    }
    {
#line 245
    count = adjust_offsets_and_copy___0(line_offset, in, out);
    }
    {
#line 246
    copy_trailing___0(from, in, out, count);
    }
#line 242
    from = from->next;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 248
  return;
}
}
#line 251 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static long added_hunk___0(char const   *meta , long offset , FILE *modify , FILE *t ,
                           unsigned long morig_count , unsigned long mnew_count ) 
{ 
  long this_offset ;
  char *line ;
  size_t linelen ;
  char *p ;
  char *tmp ;
  char *q ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  unsigned long orig_count ;
  unsigned long new_count ;
  FILE *newhunk ;
  FILE *tmp___0 ;
  int *tmp___1 ;
  size_t tmp___2 ;
  __ssize_t tmp___3 ;
  unsigned long tmp___4 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;
  char *__cil_tmp25 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;
  char *__cil_tmp28 ;
  char *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;

  {
  {
#line 254
  this_offset = 0L;
#line 255
  line = (char *)((void *)0);
#line 256
  linelen = (size_t )0;
  {
#line 257
  tmp = strchr(meta, '-');
  }
#line 257
  p = tmp;
#line 258
  orig_offset = 0UL;
#line 259
  orig_count = 0UL;
#line 259
  new_count = 0UL;
  {
#line 260
  tmp___0 = xtmpfile();
  }
#line 260
  newhunk = tmp___0;
  }
#line 262
  if (! newhunk) {
    {
    {
#line 263
    tmp___1 = __errno_location();
    }
    {
#line 263
    error(1, *tmp___1, "Couldn\'t create temporary file");
    }
    }
  }
#line 265
  if (p) {
    {
#line 266
    p ++;
    {
#line 267
    orig_offset = strtoul((char const   */* __restrict  */)p, (char **/* __restrict  */)(& q),
                          10);
    }
    }
  }
#line 270
  if (! p) {
    {
    {
#line 271
    tmp___2 = strlen((char const   *)p);
    }
#line 271
    *(p + (tmp___2 - 1U)) = (char )'\000';
    {
#line 272
    error(1, 0, "Hunk addition requires original line: %s", meta);
    }
    }
  } else
#line 270
  if ((unsigned long )p == (unsigned long )q) {
    {
    {
#line 271
    tmp___2 = strlen((char const   *)p);
    }
#line 271
    *(p + (tmp___2 - 1U)) = (char )'\000';
    {
#line 272
    error(1, 0, "Hunk addition requires original line: %s", meta);
    }
    }
  }
  {
  {
#line 276
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 276
    if (! morig_count) {
#line 276
      if (! mnew_count) {
#line 276
        goto while_break;
      }
    }
    {
    {
#line 277
    tmp___3 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)modify);
    }
    }
#line 277
    if (tmp___3 == -1) {
#line 278
      goto while_break;
    }
#line 280
    if ((int )*(line + 0) != 43) {
      {
      {
#line 281
      error(1, 0, "Only whole hunks may be added");
      }
      }
    }
#line 284
    mnew_count --;
    {
#line 287
    if ((int )*(line + 1) == 32) {
#line 287
      goto case_32;
    }
#line 291
    if ((int )*(line + 1) == 43) {
#line 291
      goto case_43;
    }
#line 295
    if ((int )*(line + 1) == 45) {
#line 295
      goto case_45;
    }
#line 299
    goto switch_default;
    case_32: /* CIL Label */ 
#line 288
    orig_count ++;
#line 289
    new_count ++;
#line 290
    goto switch_break;
    case_43: /* CIL Label */ 
#line 292
    new_count ++;
#line 293
    this_offset ++;
#line 294
    goto switch_break;
    case_45: /* CIL Label */ 
#line 296
    orig_count ++;
#line 297
    this_offset --;
#line 298
    goto switch_break;
    switch_default: /* CIL Label */ 
    {
    {
#line 300
    error(1, 0, "Multiple added hunks not supported");
    }
    }
    switch_break: /* CIL Label */ ;
    }
    {
    {
#line 304
    fputs((char const   */* __restrict  */)(line + 1), (FILE */* __restrict  */)newhunk);
    }
    }
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 307
  new_offset = orig_offset + (unsigned long )offset;
#line 309
  if (! new_count) {
#line 310
    new_offset --;
  }
  {
  {
#line 312
  fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)"@@ -%lu",
          orig_offset);
  }
  }
#line 313
  if (orig_count != 1UL) {
    {
    {
#line 314
    fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)",%lu", orig_count);
    }
    }
  }
  {
  {
#line 315
  fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)" +%lu", new_offset);
  }
  }
#line 316
  if (new_count != 1UL) {
    {
    {
#line 317
    fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)",%lu", new_count);
    }
    }
  }
  {
  {
#line 318
  fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)" @@\n");
  }
  {
#line 320
  rewind(newhunk);
  }
  }
  {
  {
#line 321
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
    {
    {
#line 321
    tmp___4 = copy_lines___0(newhunk, t, 100UL);
    }
    }
#line 321
    if (! tmp___4) {
#line 321
      goto while_break___0;
    }
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
  {
#line 322
  fclose(newhunk);
  }
  }
#line 324
  if (line) {
    {
    {
#line 325
    free((void *)line);
    }
    }
  }
#line 327
  return (this_offset);
}
}
#line 331 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static long removed_hunk___0(char const   *meta , FILE *modify , FILE *t , struct hunk **hunkp ,
                             unsigned long morig_count , unsigned long mnew_count ,
                             unsigned long *replaced ) 
{ 
  struct hunk *hunk ;
  long this_offset ;
  char *line ;
  size_t linelen ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  unsigned long orig_count ;
  unsigned long new_count ;
  int r ;
  int tmp ;
  __ssize_t tmp___0 ;
  unsigned long oo ;
  unsigned long no ;
  char *trailing ;
  int tmp___1 ;
  size_t tmp___2 ;
  size_t tmp___3 ;
  int tmp___4 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;
  char *__cil_tmp28 ;
  char *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;
  char *__cil_tmp40 ;

  {
  {
#line 335
  hunk = *hunkp;
#line 336
  this_offset = 0L;
#line 337
  line = (char *)((void *)0);
#line 338
  linelen = (size_t )0;
#line 343
  *replaced = 0UL;
  {
#line 344
  tmp = read_atatline(meta, & orig_offset, & orig_count, & new_offset, & new_count);
  }
  }
#line 344
  if (tmp) {
#line 346
    goto out;
  }
  {
  {
#line 348
  tmp___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)modify);
  }
  }
#line 348
  if (tmp___0 == -1) {
#line 349
    goto out;
  }
#line 351
  if ((int )*(line + 0) == 43) {
#line 351
    if ((int )*(line + 1) == 64) {
      {
      {
#line 355
      tmp___1 = read_atatline((char const   *)(line + 1), & oo, (unsigned long *)((void *)0),
                              & no, (unsigned long *)((void *)0));
      }
      }
#line 355
      if (tmp___1) {
#line 356
        goto out;
      }
#line 359
      if (hunk->info) {
#line 359
        if (! (hunk->info)->info_written) {
          {
          {
#line 360
          fputs((char const   */* __restrict  */)(hunk->info)->orig_file, (FILE */* __restrict  */)t);
          }
          {
#line 361
          fputs((char const   */* __restrict  */)(hunk->info)->new_file, (FILE */* __restrict  */)t);
          }
#line 362
          (hunk->info)->info_written = 1;
          }
        }
      }
      {
      {
#line 365
      trailing = strchr((char const   *)(line + 1), '+');
      }
      {
#line 366
      tmp___2 = strcspn((char const   *)trailing, " \n");
      }
#line 366
      trailing += tmp___2;
      }
#line 367
      if ((int )*trailing == 32) {
#line 368
        trailing ++;
      }
      {
      {
#line 369
      tmp___3 = strspn((char const   *)trailing, "@");
      }
#line 369
      trailing += tmp___3;
      }
#line 371
      if (oo != orig_offset) {
#line 372
        no = (new_offset + oo) - orig_offset;
      } else {
#line 374
        oo = (orig_offset + no) - new_offset;
      }
      {
      {
#line 375
      fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)"@@ -%lu",
              oo);
      }
      }
#line 376
      if (orig_count != 1UL) {
        {
        {
#line 377
        fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)",%lu",
                orig_count);
        }
        }
      }
      {
      {
#line 378
      fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)" +%lu",
              no);
      }
      }
#line 379
      if (new_count != 1UL) {
        {
        {
#line 380
        fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)",%lu",
                new_count);
        }
        }
      }
      {
      {
#line 381
      fprintf((FILE */* __restrict  */)t, (char const   */* __restrict  */)" @@%s",
              trailing);
      }
      }
#line 382
      goto out;
    }
  }
#line 385
  if (mnew_count) {
#line 386
    goto only_whole;
  }
#line 388
  morig_count --;
#line 388
  *replaced = morig_count;
  {
  {
#line 390
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 390
    if (! morig_count) {
#line 390
      goto while_break;
    }
    {
    {
#line 391
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 391
      if (! orig_count) {
#line 391
        if (! new_count) {
#line 391
          goto while_break___0;
        }
      }
#line 392
      if ((int )*(line + 0) != 45) {
#line 393
        goto only_whole;
      }
      {
#line 396
      if ((int )*(line + 1) == 32) {
#line 396
        goto case_32;
      }
#line 400
      if ((int )*(line + 1) == 43) {
#line 400
        goto case_43;
      }
#line 404
      if ((int )*(line + 1) == 45) {
#line 404
        goto case_45;
      }
#line 408
      goto switch_default;
      case_32: /* CIL Label */ 
#line 397
      orig_count --;
#line 398
      new_count --;
#line 399
      goto switch_break;
      case_43: /* CIL Label */ 
#line 401
      new_count --;
#line 402
      this_offset --;
#line 403
      goto switch_break;
      case_45: /* CIL Label */ 
#line 405
      orig_count --;
#line 406
      this_offset ++;
#line 407
      goto switch_break;
      switch_default: /* CIL Label */ 
      {
      {
#line 409
      error(1, 0, "Garbled input: %s", line + 1);
      }
      }
      switch_break: /* CIL Label */ ;
      }
#line 413
      morig_count --;
#line 413
      if (! morig_count) {
#line 414
        goto while_break___0;
      }
      {
      {
#line 416
      r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)modify);
      }
      }
#line 417
      if (! (r != -1)) {
        {
        {
#line 417
        __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                      417U, "removed_hunk");
        }
        }
      }
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 420
    if (morig_count) {
#line 421
      if ((int )*(line + 0) != 45) {
#line 422
        goto only_whole;
      }
      {
      {
#line 424
      tmp___4 = read_atatline((char const   *)(line + 1), & orig_offset, & orig_count,
                              & new_offset, & new_count);
      }
      }
#line 424
      if (tmp___4) {
#line 426
        goto out;
      }
#line 428
      hunk = hunk->next;
#line 429
      hunk->info = (*hunkp)->info;
#line 430
      if (hunk->info) {
#line 431
        (hunk->info)->info_pending = 1;
      }
      {
#line 432
      *hunkp = hunk;
      {
#line 434
      r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)modify);
      }
      }
#line 435
      if (! (r != -1)) {
        {
        {
#line 435
        __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                      435U, "removed_hunk");
        }
        }
      }
#line 436
      morig_count --;
    }
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  out: 
#line 441
  if (line) {
    {
    {
#line 442
    free((void *)line);
    }
    }
  }
#line 444
  return (this_offset);
  only_whole: 
  {
  {
#line 447
  error(1, 0, "Only whole hunks may be added");
  }
  {
#line 449
  exit(1);
  }
  }
}
}
#line 457 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static long show_modified_hunk___0(struct hunk **hunkp , long line_offset , FILE *modify ,
                                   FILE *original , FILE *out ) 
{ 
  struct hunk *hunk ;
  long this_offset ;
  unsigned long calc_orig_count ;
  unsigned long calc_new_offset ;
  unsigned long calc_new_count ;
  unsigned long orig_offset ;
  unsigned long orig_count ;
  unsigned long new_offset ;
  unsigned long new_count ;
  unsigned long morig_offset ;
  unsigned long morig_count ;
  unsigned long mnew_offset ;
  unsigned long mnew_count ;
  char *line ;
  size_t linelen ;
  FILE *t ;
  FILE *tmp ;
  int t_written_to ;
  unsigned long i ;
  unsigned long at ;
  unsigned long replaced ;
  unsigned long unaltered ;
  char *trailing ;
  int r ;
  int *tmp___0 ;
  size_t tmp___1 ;
  size_t tmp___2 ;
  int trim ;
  int *tmp___3 ;
  __ssize_t tmp___4 ;
  long loff ;
  FILE *write_to ;
  FILE *write_to___0 ;
  long tmp___5 ;
  __ssize_t tmp___6 ;
  int tmp___7 ;
  __ssize_t tmp___8 ;
  __ssize_t tmp___9 ;
  char *__cil_tmp44 ;
  char *__cil_tmp45 ;
  char *__cil_tmp46 ;
  char *__cil_tmp47 ;
  char *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;
  char *__cil_tmp76 ;
  char *__cil_tmp77 ;
  char *__cil_tmp78 ;
  char *__cil_tmp79 ;
  char *__cil_tmp80 ;
  char *__cil_tmp81 ;
  char *__cil_tmp82 ;
  char *__cil_tmp83 ;
  char *__cil_tmp84 ;
  char *__cil_tmp85 ;
  char *__cil_tmp86 ;
  char *__cil_tmp87 ;
  char *__cil_tmp88 ;
  char *__cil_tmp89 ;
  char *__cil_tmp90 ;

  {
  {
#line 460
  hunk = *hunkp;
#line 461
  this_offset = 0L;
#line 466
  line = (char *)((void *)0);
#line 467
  linelen = (size_t )0;
  {
#line 468
  tmp = xtmpfile();
  }
#line 468
  t = tmp;
#line 469
  t_written_to = 0;
#line 470
  at = 1UL;
  }
#line 475
  if (! t) {
    {
    {
#line 476
    tmp___0 = __errno_location();
    }
    {
#line 476
    error(1, *tmp___0, "Couldn\'t open temporary file");
    }
    }
  }
  {
  {
#line 478
  rewind(modify);
  }
  {
#line 480
  fsetpos(original, (fpos_t const   *)(& hunk->filepos));
  }
  {
#line 481
  r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
              (FILE */* __restrict  */)original);
  }
  }
#line 482
  if (! (r != -1)) {
    {
    {
#line 482
    __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                  482U, "show_modified_hunk");
    }
    }
  }
#line 483
  if (hunk->info) {
    {
    {
#line 484
    r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)original);
    }
    }
#line 485
    if (! (r != -1)) {
      {
      {
#line 485
      __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                    485U, "show_modified_hunk");
      }
      }
    }
    {
    {
#line 486
    r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)original);
    }
    }
#line 487
    if (! (r != -1)) {
      {
      {
#line 487
      __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                    487U, "show_modified_hunk");
      }
      }
    }
#line 488
    at += 2UL;
  }
  {
  {
#line 490
  r = read_atatline((char const   *)line, & orig_offset, & orig_count, & new_offset,
                    & new_count);
  }
  }
#line 492
  if (! (! r)) {
    {
    {
#line 492
    __assert_fail("!r", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                  492U, "show_modified_hunk");
    }
    }
  }
  {
#line 493
  calc_orig_count = orig_count;
#line 494
  calc_new_offset = new_offset;
#line 495
  calc_new_count = new_count;
  {
#line 497
  trailing = strchr((char const   *)line, '+');
  }
  {
#line 498
  tmp___1 = strcspn((char const   *)trailing, " \n");
  }
#line 498
  trailing += tmp___1;
  }
#line 499
  if ((int )*trailing == 32) {
#line 500
    trailing ++;
  }
  {
  {
#line 501
  tmp___2 = strspn((char const   *)trailing, "@");
  }
#line 501
  trailing += tmp___2;
  {
#line 502
  trailing = xstrdup((char const   *)trailing);
  }
  {
#line 504
  r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
              (FILE */* __restrict  */)modify);
  }
  }
#line 505
  if (! (r != -1)) {
    {
    {
#line 505
    __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                  505U, "show_modified_hunk");
    }
    }
  }
  {
  {
#line 506
  r = read_atatline((char const   *)line, & morig_offset, & morig_count, & mnew_offset,
                    & mnew_count);
  }
  }
#line 508
  if (! (! r)) {
    {
    {
#line 508
    __assert_fail("!r", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                  508U, "show_modified_hunk");
    }
    }
  }
#line 509
  replaced = morig_count;
  {
  {
#line 511
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 513
    trim = 0;
#line 514
    if (morig_offset < hunk->line_in_diff) {
      {
      {
#line 515
      tmp___3 = __errno_location();
      }
      {
#line 515
      error(1, *tmp___3, "Invalid changes made");
      }
      }
    }
#line 517
    unaltered = morig_offset - hunk->line_in_diff;
#line 518
    if (! morig_count) {
#line 519
      unaltered ++;
    }
#line 520
    if (unaltered > at) {
#line 521
      unaltered -= at;
    } else {
#line 522
      unaltered = 0UL;
    }
#line 524
    if (! unaltered) {
#line 525
      trim = 1;
    }
#line 529
    i = unaltered;
    {
    {
#line 529
    while (1) {
      while_continue___7: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 529
      if (! i) {
#line 529
        goto while_break___0;
      }
      {
      {
#line 530
      r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)original);
      }
      }
#line 531
      if (! (r != -1)) {
        {
        {
#line 531
        __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                      531U, "show_modified_hunk");
        }
        }
      }
      {
      {
#line 532
      fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)t);
      }
#line 533
      at ++;
#line 534
      t_written_to = 1;
      }
      {
#line 537
      if ((int )*(line + 0) == 32) {
#line 537
        goto case_32;
      }
#line 539
      if ((int )*(line + 0) == 45) {
#line 539
        goto case_45;
      }
#line 542
      if ((int )*(line + 0) == 43) {
#line 542
        goto case_43;
      }
#line 536
      goto switch_break;
      case_32: /* CIL Label */ 
#line 538
      if (new_count) {
#line 538
        new_count --;
      }
      case_45: /* CIL Label */ 
#line 540
      if (orig_count) {
#line 540
        orig_count --;
      }
#line 541
      goto switch_break;
      case_43: /* CIL Label */ 
#line 543
      if (new_count) {
#line 543
        new_count --;
      }
#line 544
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
#line 529
      i --;
    }
    while_break___7: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
    {
#line 548
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 548
      if (! morig_count) {
#line 548
        if (! mnew_count) {
#line 548
          goto while_break___1;
        }
      }
      {
      {
#line 549
      tmp___4 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)modify);
      }
      }
#line 549
      if (tmp___4 == -1) {
#line 550
        goto while_break___1;
      }
#line 552
      if ((int )*(line + 0) == 92) {
        {
        {
#line 553
        error(1, 0, "Don\'t know how to handle newline issues yet.");
        }
        }
      } else
#line 552
      if ((int )*(line + 1) == 92) {
        {
        {
#line 553
        error(1, 0, "Don\'t know how to handle newline issues yet.");
        }
        }
      }
      {
#line 561
      if ((int )*(line + 0) == 45) {
#line 561
        goto case_45___0;
      }
#line 593
      if ((int )*(line + 0) == 43) {
#line 593
        goto case_43___1;
      }
#line 560
      goto switch_break___0;
      case_45___0: /* CIL Label */ 
      {
#line 563
      if ((int )*(line + 1) == 43) {
#line 563
        goto case_43___0;
      }
#line 568
      if ((int )*(line + 1) == 45) {
#line 568
        goto case_45___1;
      }
#line 572
      if ((int )*(line + 1) == 32) {
#line 572
        goto case_32___0;
      }
#line 576
      if ((int )*(line + 1) == 64) {
#line 576
        goto case_64;
      }
#line 578
      goto switch_default;
      case_43___0: /* CIL Label */ 
#line 564
      this_offset --;
#line 565
      calc_new_count --;
#line 566
      trim = 0;
#line 567
      goto switch_break___1;
      case_45___1: /* CIL Label */ 
#line 569
      this_offset ++;
#line 570
      calc_orig_count --;
#line 571
      goto switch_break___1;
      case_32___0: /* CIL Label */ 
#line 573
      calc_new_count --;
#line 574
      calc_orig_count --;
#line 575
      goto switch_break___1;
      case_64: /* CIL Label */ 
#line 577
      goto hunk_end;
      switch_default: /* CIL Label */ 
      {
      {
#line 579
      error(1, 0, "Not supported: %c%c", (int )*(line + 0), (int )*(line + 1));
      }
      }
      switch_break___1: /* CIL Label */ ;
      }
#line 584
      if (trim) {
#line 585
        orig_offset ++;
#line 586
        calc_new_offset ++;
      }
#line 589
      if (morig_count) {
#line 590
        morig_count --;
      }
#line 592
      goto switch_break___0;
      case_43___1: /* CIL Label */ 
      {
#line 595
      if ((int )*(line + 1) == 43) {
#line 595
        goto case_43___2;
      }
#line 601
      if ((int )*(line + 1) == 45) {
#line 601
        goto case_45___2;
      }
#line 608
      if ((int )*(line + 1) == 32) {
#line 608
        goto case_32___1;
      }
#line 614
      if ((int )*(line + 1) == 64) {
#line 614
        goto case_64___0;
      }
#line 616
      goto switch_default___0;
      case_43___2: /* CIL Label */ 
      {
#line 596
      this_offset ++;
#line 597
      calc_new_count ++;
      {
#line 598
      fputs((char const   */* __restrict  */)(line + 1), (FILE */* __restrict  */)t);
      }
#line 599
      t_written_to = 1;
      }
#line 600
      goto switch_break___2;
      case_45___2: /* CIL Label */ 
      {
#line 602
      this_offset --;
#line 603
      calc_orig_count ++;
#line 604
      trim = 0;
      {
#line 605
      fputs((char const   */* __restrict  */)(line + 1), (FILE */* __restrict  */)t);
      }
#line 606
      t_written_to = 1;
      }
#line 607
      goto switch_break___2;
      case_32___1: /* CIL Label */ 
      {
#line 609
      calc_orig_count ++;
#line 610
      calc_new_count ++;
      {
#line 611
      fputs((char const   */* __restrict  */)(line + 1), (FILE */* __restrict  */)t);
      }
#line 612
      t_written_to = 1;
      }
#line 613
      goto switch_break___2;
      case_64___0: /* CIL Label */ 
#line 615
      goto hunk_end;
      switch_default___0: /* CIL Label */ 
      {
      {
#line 617
      error(1, 0, "Not supported: %c%c", (int )*(line + 0), (int )*(line + 1));
      }
      }
      switch_break___2: /* CIL Label */ ;
      }
#line 622
      if (trim) {
#line 623
        orig_offset --;
#line 624
        calc_new_offset --;
      }
#line 627
      if (mnew_count) {
#line 628
        mnew_count --;
      }
#line 630
      goto switch_break___0;
      switch_break___0: /* CIL Label */ ;
      }
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
    {
    {
#line 638
    while (1) {
      while_continue___9: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
#line 638
      if (! replaced) {
#line 638
        goto while_break___2;
      }
      {
#line 639
      replaced --;
      {
#line 640
      r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)original);
      }
      }
#line 641
      if (! (r != -1)) {
        {
        {
#line 641
        __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                      641U, "show_modified_hunk");
        }
        }
      }
#line 642
      at ++;
      {
#line 644
      if ((int )*(line + 0) == 32) {
#line 644
        goto case_32___2;
      }
#line 646
      if ((int )*(line + 0) == 45) {
#line 646
        goto case_45___3;
      }
#line 649
      if ((int )*(line + 0) == 43) {
#line 649
        goto case_43___3;
      }
#line 643
      goto switch_break___3;
      case_32___2: /* CIL Label */ 
#line 645
      if (new_count) {
#line 645
        new_count --;
      }
      case_45___3: /* CIL Label */ 
#line 647
      if (orig_count) {
#line 647
        orig_count --;
      }
#line 648
      goto switch_break___3;
      case_43___3: /* CIL Label */ 
#line 650
      if (new_count) {
#line 650
        new_count --;
      }
#line 651
      goto switch_break___3;
      switch_break___3: /* CIL Label */ ;
      }
    }
    while_break___9: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
    hunk_end: 
#line 656
    if (*(line + 0)) {
#line 656
      if ((int )*(line + 1) == 64) {
#line 657
        if ((int )*(line + 0) == 43) {
#line 660
          if (t_written_to) {
#line 660
            write_to = t;
          } else {
#line 660
            write_to = out;
          }
#line 661
          if (hunk->info) {
#line 661
            if (! (hunk->info)->info_written) {
              {
              {
#line 662
              fputs((char const   */* __restrict  */)(hunk->info)->orig_file, (FILE */* __restrict  */)out);
              }
              {
#line 663
              fputs((char const   */* __restrict  */)(hunk->info)->new_file, (FILE */* __restrict  */)out);
              }
#line 664
              (hunk->info)->info_written = 1;
              }
            }
          }
          {
          {
#line 666
          loff = added_hunk___0((char const   *)(line + 1), this_offset, modify, write_to,
                                morig_count, mnew_count);
          }
          }
#line 672
          if (! hunk->discard_offset) {
#line 673
            line_offset += loff;
          }
        } else
#line 680
        if ((int )*(line + 0) == 45) {
#line 682
          if (t_written_to) {
#line 682
            write_to___0 = t;
          } else {
#line 682
            write_to___0 = out;
          }
          {
          {
#line 683
          tmp___5 = removed_hunk___0((char const   *)(line + 1), modify, write_to___0,
                                     hunkp, morig_count, mnew_count, & replaced);
          }
#line 683
          this_offset += tmp___5;
#line 688
          hunk = *hunkp;
#line 697
          calc_orig_count = 0UL;
#line 698
          calc_new_count = 0UL;
          }
          {
          {
#line 700
          while (1) {
            while_continue___10: /* CIL Label */ ;
            while_continue___3: /* CIL Label */ ;
#line 700
            if (! replaced) {
#line 700
              goto while_break___3;
            }
            {
#line 701
            replaced --;
            {
#line 702
            r = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)original);
            }
            }
#line 704
            if (! (r != -1)) {
              {
              {
#line 704
              __assert_fail("r != -1", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                            704U, "show_modified_hunk");
              }
              }
            }
#line 705
            at ++;
            {
#line 707
            if ((int )*(line + 0) == 32) {
#line 707
              goto case_32___3;
            }
#line 709
            if ((int )*(line + 0) == 45) {
#line 709
              goto case_45___4;
            }
#line 712
            if ((int )*(line + 0) == 43) {
#line 712
              goto case_43___4;
            }
#line 706
            goto switch_break___4;
            case_32___3: /* CIL Label */ 
#line 708
            if (new_count) {
#line 708
              new_count --;
            }
            case_45___4: /* CIL Label */ 
#line 710
            if (orig_count) {
#line 710
              orig_count --;
            }
#line 711
            goto switch_break___4;
            case_43___4: /* CIL Label */ 
#line 713
            if (new_count) {
#line 713
              new_count --;
            }
#line 714
            goto switch_break___4;
            switch_break___4: /* CIL Label */ ;
            }
          }
          while_break___10: /* CIL Label */ ;
          }
          while_break___3: /* CIL Label */ ;
          }
        } else {
          {
          {
#line 717
          error(1, 0, "diff output not understood");
          }
          }
        }
      }
    }
    {
    {
#line 721
    tmp___6 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)modify);
    }
    }
#line 721
    if (tmp___6 == -1) {
#line 722
      goto while_break;
    }
    {
    {
#line 724
    r = read_atatline((char const   *)line, & morig_offset, & morig_count, & mnew_offset,
                      & mnew_count);
    }
    }
#line 726
    if (! (! r)) {
      {
      {
#line 726
      __assert_fail("!r", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                    726U, "show_modified_hunk");
      }
      }
    }
    {
#line 727
    replaced = morig_count;
    {
#line 511
    tmp___7 = feof(modify);
    }
    }
#line 511
    if (tmp___7) {
#line 511
      goto while_break;
    }
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 734
  while (1) {
    while_continue___11: /* CIL Label */ ;
    while_continue___4: /* CIL Label */ ;
#line 734
    if (! orig_count) {
#line 734
      if (! new_count) {
#line 734
        goto while_break___4;
      }
    }
    {
    {
#line 735
    tmp___8 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)original);
    }
    }
#line 735
    if (tmp___8 == -1) {
#line 736
      goto while_break___4;
    }
    {
    {
#line 737
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)t);
    }
#line 741
    at ++;
    }
    {
#line 743
    if ((int )*(line + 0) == 32) {
#line 743
      goto case_32___4;
    }
#line 745
    if ((int )*(line + 0) == 45) {
#line 745
      goto case_45___5;
    }
#line 748
    if ((int )*(line + 0) == 43) {
#line 748
      goto case_43___5;
    }
#line 742
    goto switch_break___5;
    case_32___4: /* CIL Label */ 
#line 744
    if (new_count) {
#line 744
      new_count --;
    }
    case_45___5: /* CIL Label */ 
#line 746
    if (orig_count) {
#line 746
      orig_count --;
    }
#line 747
    goto switch_break___5;
    case_43___5: /* CIL Label */ 
#line 749
    if (new_count) {
#line 749
      new_count --;
    }
#line 750
    goto switch_break___5;
    switch_break___5: /* CIL Label */ ;
    }
#line 752
    if (! ((int )*(line + 0) != 64)) {
      {
      {
#line 752
      __assert_fail("line[0] != \'@\'", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                    752U, "show_modified_hunk");
      }
      }
    }
  }
  while_break___11: /* CIL Label */ ;
  }
  while_break___4: /* CIL Label */ ;
  }
#line 759
  if (hunk->info) {
#line 759
    if (! (hunk->info)->info_written) {
      {
      {
#line 760
      fputs((char const   */* __restrict  */)(hunk->info)->orig_file, (FILE */* __restrict  */)out);
      }
      {
#line 761
      fputs((char const   */* __restrict  */)(hunk->info)->new_file, (FILE */* __restrict  */)out);
      }
#line 762
      (hunk->info)->info_written = 1;
      }
    }
  }
  {
  {
#line 764
  rewind(t);
  }
  }
#line 766
  if (calc_orig_count) {
#line 766
    goto _L;
  } else
#line 766
  if (calc_new_count) {
    _L: /* CIL Label */ 
    {
    {
#line 767
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"@@ -%lu",
            orig_offset);
    }
    }
#line 768
    if (calc_orig_count != 1UL) {
      {
      {
#line 769
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
              calc_orig_count);
      }
      }
    }
    {
    {
#line 770
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" +%lu",
            calc_new_offset + (unsigned long )line_offset);
    }
    }
#line 771
    if (calc_new_count != 1UL) {
      {
      {
#line 772
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
              calc_new_count);
      }
      }
    }
    {
    {
#line 773
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" @@%s",
            trailing);
    }
    }
  }
  {
  {
#line 776
  free((void *)trailing);
  }
  }
  {
  {
#line 777
  while (1) {
    while_continue___12: /* CIL Label */ ;
    while_continue___5: /* CIL Label */ ;
    {
    {
#line 777
    tmp___9 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)t);
    }
    }
#line 777
    if (! (tmp___9 != -1)) {
#line 777
      goto while_break___5;
    }
    {
    {
#line 778
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    }
  }
  while_break___12: /* CIL Label */ ;
  }
  while_break___5: /* CIL Label */ ;
  }
#line 780
  if (line) {
    {
    {
#line 781
    free((void *)line);
    }
    }
  }
  {
  {
#line 782
  fclose(modify);
  }
  {
#line 783
  fclose(t);
  }
  {
#line 788
  copy_trailing___0(hunk, original, out, at - 1UL);
  }
  }
#line 792
  return (this_offset);
}
}
#line 799 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static int rediff___0(char const   *original , char const   *edited , FILE *out ) 
{ 
  pid_t child ;
  FILE *o ;
  FILE *m ;
  FILE *t ;
  char *line ;
  size_t linelen ;
  unsigned long linenum___1 ;
  struct hunk *hunks___1 ;
  struct hunk **p ;
  struct hunk *last ;
  struct hunk *current_hunk ;
  long line_offset ;
  fpos_t first_hunk ;
  unsigned long o_count ;
  unsigned long n_count ;
  struct hunk *newhunk ;
  fpos_t pos ;
  __ssize_t tmp ;
  int *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  void *tmp___5 ;
  struct file_info *info ;
  void *tmp___6 ;
  int tmp___7 ;
  char *tmp___8 ;
  int *tmp___9 ;
  __ssize_t tmp___10 ;
  char *tmp___11 ;
  int *tmp___12 ;
  __ssize_t tmp___13 ;
  int tmp___14 ;
  __ssize_t tmp___15 ;
  int tmp___16 ;
  size_t buffer_size ;
  char *buffer ;
  void *tmp___17 ;
  size_t got ;
  size_t tmp___18 ;
  int tmp___19 ;
  int *tmp___20 ;
  unsigned long orig_line ;
  unsigned long orig_count ;
  struct hunk *which ;
  fpos_t pos___0 ;
  __ssize_t tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int header ;
  long tmp___24 ;
  struct hunk *tmp___25 ;
  __ssize_t tmp___26 ;
  int tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  long tmp___30 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;
  char *__cil_tmp76 ;
  char *__cil_tmp77 ;
  char *__cil_tmp78 ;
  char *__cil_tmp79 ;
  char *__cil_tmp80 ;

  {
  {
#line 804
  t = (FILE *)((void *)0);
#line 805
  line = (char *)((void *)0);
#line 806
  linelen = (size_t )0;
#line 807
  linenum___1 = 0UL;
#line 808
  hunks___1 = (struct hunk *)((void *)0);
#line 808
  p = & hunks___1;
#line 808
  last = (struct hunk *)((void *)0);
#line 809
  current_hunk = (struct hunk *)((void *)0);
#line 810
  line_offset = 0L;
  {
#line 814
  o = xopen(original, "rbm");
  }
  }
  {
  {
#line 815
  while (1) {
    while_continue___7: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 815
    tmp___16 = feof(o);
    }
    }
#line 815
    if (tmp___16) {
#line 815
      goto while_break;
    }
    {
    {
#line 821
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 822
      fgetpos((FILE */* __restrict  */)o, (fpos_t */* __restrict  */)(& pos));
      }
      {
#line 823
      tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)o);
      }
      }
#line 823
      if (tmp == -1) {
#line 824
        goto while_break___0;
      }
      {
#line 825
      linenum___1 ++;
      {
#line 827
      tmp___1 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 827
      if (! tmp___1) {
        {
        {
#line 828
        tmp___0 = __errno_location();
        }
        {
#line 828
        error(1, *tmp___0, "Don\'t know how to handle context format yet.");
        }
        }
      }
      {
      {
#line 821
      tmp___2 = strncmp((char const   *)line, "@@ ", (size_t )3);
      }
      }
#line 821
      if (tmp___2) {
        {
        {
#line 821
        tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
        }
        }
#line 821
        if (! tmp___3) {
#line 821
          goto while_break___0;
        }
      } else {
#line 821
        goto while_break___0;
      }
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
    {
#line 834
    tmp___4 = feof(o);
    }
    }
#line 834
    if (tmp___4) {
#line 835
      goto while_break;
    }
#line 837
    if (last) {
#line 838
      last->num_lines = (linenum___1 - last->line_in_diff) + 1UL;
    }
    {
    {
#line 840
    tmp___5 = xmalloc((size_t )sizeof(*newhunk));
    }
#line 840
    newhunk = (struct hunk *)tmp___5;
#line 841
    newhunk->filepos = pos;
#line 842
    newhunk->line_in_diff = linenum___1;
#line 843
    newhunk->num_lines = 0UL;
    {
#line 845
    tmp___14 = strncmp((char const   *)line, "--- ", (size_t )4);
    }
    }
#line 845
    if (tmp___14) {
#line 858
      newhunk->info = (struct file_info *)((void *)0);
    } else {
      {
      {
#line 846
      tmp___6 = xmalloc((size_t )sizeof(*info));
      }
#line 846
      info = (struct file_info *)tmp___6;
#line 847
      tmp___7 = 0;
#line 847
      info->info_pending = tmp___7;
#line 847
      info->info_written = tmp___7;
      {
#line 848
      tmp___8 = xstrdup((char const   *)line);
      }
#line 848
      info->orig_file = (char const   *)tmp___8;
      {
#line 849
      tmp___10 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)o);
      }
      }
#line 849
      if (tmp___10 == -1) {
        {
        {
#line 850
        tmp___9 = __errno_location();
        }
        {
#line 850
        error(1, *tmp___9, "Premature end of file");
        }
        }
      }
      {
      {
#line 852
      tmp___11 = xstrdup((char const   *)line);
      }
#line 852
      info->new_file = (char const   *)tmp___11;
#line 853
      newhunk->info = info;
      {
#line 854
      tmp___13 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)o);
      }
      }
#line 854
      if (tmp___13 == -1) {
        {
        {
#line 855
        tmp___12 = __errno_location();
        }
        {
#line 855
        error(1, *tmp___12, "Premature end of file");
        }
        }
      }
#line 857
      linenum___1 += 2UL;
    }
    {
    {
#line 860
    read_atatline((char const   *)line, & newhunk->orig_offset, & newhunk->orig_count,
                  & newhunk->new_offset, & newhunk->new_count);
    }
#line 864
    o_count = newhunk->orig_count;
#line 865
    n_count = newhunk->new_count;
#line 867
    newhunk->next = (struct hunk *)((void *)0);
    }
#line 868
    if (*p) {
#line 869
      (*p)->next = newhunk;
    }
#line 870
    last = newhunk;
#line 870
    *p = last;
#line 871
    p = & newhunk->next;
    {
    {
#line 883
    while (1) {
      while_continue___9: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 883
      if (! o_count) {
#line 883
        if (! n_count) {
#line 883
          goto while_break___1;
        }
      }
      {
      {
#line 884
      tmp___15 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)o);
      }
      }
#line 884
      if (tmp___15 == -1) {
#line 885
        goto while_break___1;
      }
#line 887
      linenum___1 ++;
      {
#line 889
      if ((int )*(line + 0) == 32) {
#line 889
        goto case_32;
      }
#line 891
      if ((int )*(line + 0) == 45) {
#line 891
        goto case_45;
      }
#line 894
      if ((int )*(line + 0) == 43) {
#line 894
        goto case_43;
      }
#line 888
      goto switch_break;
      case_32: /* CIL Label */ 
#line 890
      if (n_count) {
#line 890
        n_count --;
      }
      case_45: /* CIL Label */ 
#line 892
      if (o_count) {
#line 892
        o_count --;
      }
#line 893
      goto switch_break;
      case_43: /* CIL Label */ 
#line 895
      if (n_count) {
#line 895
        n_count --;
      }
#line 896
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
    }
    while_break___9: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 901
  if (! hunks___1) {
    {
    {
#line 902
    error(1, 0, "Original patch seems empty");
    }
    }
  }
  {
#line 904
  last->num_lines = (linenum___1 - last->line_in_diff) + 1UL;
  {
#line 907
  t = xpipe("diff", & child, "r", "diff", "-U0", original, edited, (void *)0);
  }
  {
#line 909
  m = xtmpfile();
  }
  }
#line 910
  if (m) {
    {
#line 911
    buffer_size = (size_t )10000;
    {
#line 912
    tmp___17 = xmalloc(buffer_size);
    }
#line 912
    buffer = (char *)tmp___17;
    }
    {
    {
#line 913
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
      {
      {
#line 913
      tmp___19 = feof(t);
      }
      }
#line 913
      if (tmp___19) {
#line 913
        goto while_break___2;
      }
      {
      {
#line 914
      tmp___18 = fread((void */* __restrict  */)buffer, (size_t )1, buffer_size, (FILE */* __restrict  */)t);
      }
#line 914
      got = tmp___18;
      {
#line 915
      fwrite((void const   */* __restrict  */)buffer, (size_t )1, got, (FILE */* __restrict  */)m);
      }
      }
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
    {
    {
#line 917
    fclose(t);
    }
    {
#line 918
    waitpid(child, (int *)((void *)0), 0);
    }
    {
#line 919
    rewind(m);
    }
    {
#line 920
    free((void *)buffer);
    }
    }
  } else {
    {
    {
#line 921
    tmp___20 = __errno_location();
    }
    {
#line 921
    error(1, *tmp___20, "Couldn\'t create temporary file");
    }
    }
  }
#line 927
  *line = (char )'\000';
  {
  {
#line 928
  while (1) {
    while_continue___11: /* CIL Label */ ;
    while_continue___3: /* CIL Label */ ;
    {
    {
#line 928
    tmp___29 = feof(m);
    }
    }
#line 928
    if (tmp___29) {
#line 928
      goto while_break___3;
    }
    {
    {
#line 934
    while (1) {
      while_continue___12: /* CIL Label */ ;
      while_continue___4: /* CIL Label */ ;
      {
      {
#line 934
      tmp___22 = strncmp((char const   *)line, "@@ ", (size_t )3);
      }
      }
#line 934
      if (! tmp___22) {
#line 934
        goto while_break___4;
      }
      {
      {
#line 935
      fgetpos((FILE */* __restrict  */)m, (fpos_t */* __restrict  */)(& pos___0));
      }
      {
#line 936
      tmp___21 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)m);
      }
      }
#line 936
      if (tmp___21 == -1) {
#line 937
        goto while_break___4;
      }
    }
    while_break___12: /* CIL Label */ ;
    }
    while_break___4: /* CIL Label */ ;
    }
    {
    {
#line 940
    tmp___23 = feof(m);
    }
    }
#line 940
    if (tmp___23) {
#line 941
      goto while_break___3;
    }
    {
    {
#line 943
    read_atatline((char const   *)line, & orig_line, & orig_count, (unsigned long *)((void *)0),
                  (unsigned long *)((void *)0));
    }
    }
#line 944
    if (! orig_count) {
#line 945
      orig_line ++;
    }
#line 948
    which = hunks___1;
    {
    {
#line 948
    while (1) {
      while_continue___13: /* CIL Label */ ;
      while_continue___5: /* CIL Label */ ;
#line 948
      if (! which) {
#line 948
        goto while_break___5;
      }
#line 951
      if (! which->next) {
#line 953
        goto while_break___5;
      }
#line 956
      if ((which->next)->info) {
#line 956
        header = 2;
      } else {
#line 956
        header = 0;
      }
#line 957
      if ((which->next)->line_in_diff + (unsigned long )header > orig_line) {
#line 959
        goto while_break___5;
      }
#line 948
      which = which->next;
    }
    while_break___13: /* CIL Label */ ;
    }
    while_break___5: /* CIL Label */ ;
    }
#line 961
    if (! which) {
      {
      {
#line 961
      __assert_fail("which", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c",
                    961U, "rediff");
      }
      }
    }
#line 963
    if (which->line_in_diff + which->num_lines <= orig_line) {
#line 964
      which->discard_offset = 1;
    }
#line 976
    if ((unsigned long )current_hunk != (unsigned long )which) {
#line 977
      if (current_hunk) {
        {
        {
#line 978
        tmp___24 = show_modified_hunk___0(& current_hunk, line_offset, t, o, out);
        }
#line 978
        line_offset += tmp___24;
#line 981
        current_hunk = current_hunk->next;
        }
      }
#line 985
      if (current_hunk) {
#line 985
        tmp___25 = current_hunk;
      } else {
#line 985
        tmp___25 = hunks___1;
      }
      {
      {
#line 985
      copy_to___0(tmp___25, which, & line_offset, o, out, (unsigned long )current_hunk == (unsigned long )((void *)0));
      }
#line 991
      first_hunk = pos___0;
      {
#line 992
      t = xtmpfile();
      }
      }
    }
    {
#line 995
    current_hunk = which;
    {
#line 998
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)t);
    }
    }
    {
    {
#line 999
    while (1) {
      while_continue___14: /* CIL Label */ ;
      while_continue___6: /* CIL Label */ ;
      {
      {
#line 999
      tmp___28 = feof(m);
      }
      }
#line 999
      if (tmp___28) {
#line 999
        goto while_break___6;
      }
      {
      {
#line 1000
      tmp___26 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)m);
      }
      }
#line 1000
      if (tmp___26 == -1) {
#line 1001
        goto while_break___6;
      }
      {
      {
#line 1002
      tmp___27 = strncmp((char const   *)line, "@@ ", (size_t )3);
      }
      }
#line 1002
      if (! tmp___27) {
#line 1003
        goto while_break___6;
      }
      {
      {
#line 1004
      fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)t);
      }
      }
    }
    while_break___14: /* CIL Label */ ;
    }
    while_break___6: /* CIL Label */ ;
    }
  }
  while_break___11: /* CIL Label */ ;
  }
  while_break___3: /* CIL Label */ ;
  }
#line 1009
  if (current_hunk) {
    {
    {
#line 1010
    tmp___30 = show_modified_hunk___0(& current_hunk, line_offset, t, o, out);
    }
#line 1010
    line_offset += tmp___30;
#line 1012
    current_hunk = current_hunk->next;
    }
#line 1013
    if (current_hunk) {
      {
      {
#line 1014
      copy_to___0(current_hunk, (struct hunk *)((void *)0), & line_offset, o, out,
                  0);
      }
      }
    }
  } else {
    {
    {
#line 1016
    copy_to___0(hunks___1, (struct hunk *)((void *)0), & line_offset, o, out, 1);
    }
    }
  }
  {
  {
#line 1018
  fclose(o);
  }
  {
#line 1019
  fclose(m);
  }
  }
#line 1020
  if (line) {
    {
    {
#line 1021
    free((void *)line);
    }
    }
  }
#line 1023
  return (0);
}
}
#line 1025 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static char *syntax_str___1  =    (char *)"usage: %s ORIGINAL EDITED\n       %s EDITED\n";
#line 1028
static  __attribute__((__noreturn__)) void syntax___1(int err ) ;
#line 1028 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static void syntax___1(int err ) 
{ 
  struct _IO_FILE *tmp ;

  {
#line 1031
  if (err) {
#line 1031
    tmp = stderr;
  } else {
#line 1031
    tmp = stdout;
  }
  {
  {
#line 1031
  fprintf((FILE */* __restrict  */)tmp, (char const   */* __restrict  */)syntax_str___1,
          progname, progname);
  }
  {
#line 1032
  exit(err);
  }
  }
}
}
#line 1041 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/rediff.c"
static struct option long_options___1[3]  = {      {"help", 0, (int *)0, 'h'}, 
        {"version", 0, (int *)0, 'v'}, 
        {(char const   *)0, 0, (int *)0, 0}};
#line 220 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void copy_context_hunks___2(char **line , size_t *linelen , ssize_t *got ,
                                   unsigned long *linenum___1 ) 
{ 
  unsigned long unchanged ;
  unsigned long line_start ;
  unsigned long line_end ;
  unsigned long line_count ;
  char *n ;
  char *end ;
  int i ;
  int first ;
  int tmp ;
  char const   *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  unsigned long tmp___3 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;

  {
  {
  {
#line 223
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 224
    unchanged = 0UL;
#line 229
    i = 0;
    {
    {
#line 229
    while (1) {
      while_continue___3: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 229
      if (! (i < 2)) {
#line 229
        goto while_break___0;
      }
      {
#line 230
      first = 1;
      {
#line 231
      *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                     (FILE */* __restrict  */)stdin);
      }
      }
#line 232
      if (*got == -1) {
#line 233
        return;
      }
#line 234
      (*linenum___1) ++;
#line 236
      if (! i) {
        {
        {
#line 236
        tmp = strncmp((char const   *)*line, "***************", (size_t )15);
        }
        }
#line 236
        if (! tmp) {
#line 241
          i --;
#line 242
          goto __Cont;
        }
      }
#line 245
      if (i) {
#line 245
        tmp___0 = "--- ";
      } else {
#line 245
        tmp___0 = "*** ";
      }
      {
      {
#line 245
      tmp___1 = strncmp((char const   *)*line, tmp___0, (size_t )4);
      }
      }
#line 245
      if (tmp___1) {
#line 246
        return;
      }
      do_line_counts: 
      {
#line 249
      n = *line + 4;
      {
#line 250
      line_start = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
      }
      }
#line 251
      if ((unsigned long )n == (unsigned long )end) {
#line 252
        return;
      }
#line 254
      if ((int )*end == 44) {
        {
#line 255
        n = end + 1;
        {
#line 256
        line_end = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
        }
        }
#line 257
        if ((unsigned long )n == (unsigned long )end) {
#line 258
          return;
        }
#line 260
        if (line_start > line_end) {
#line 261
          return;
        }
#line 263
        line_count = (line_end - line_start) + 1UL;
      } else {
#line 265
        line_end = line_start;
#line 266
        if (line_start) {
#line 266
          line_count = 1UL;
        } else {
#line 266
          line_count = 0UL;
        }
      }
      {
      {
#line 269
      fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      }
#line 271
      if (i) {
#line 271
        if (line_count == unchanged) {
#line 272
          goto while_break___0;
        }
      }
      {
      {
#line 274
      while (1) {
        while_continue___4: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 274
        tmp___3 = line_count;
#line 274
        line_count --;
#line 274
        if (! tmp___3) {
#line 274
          goto while_break___1;
        }
        {
        {
#line 275
        *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                       (FILE */* __restrict  */)stdin);
        }
        }
#line 276
        if (*got == -1) {
#line 277
          return;
        }
#line 278
        (*linenum___1) ++;
#line 280
        if (! i) {
#line 280
          if (first) {
            {
#line 281
            first = 0;
            {
#line 282
            tmp___2 = strncmp((char const   *)*line, "--- ", (size_t )4);
            }
            }
#line 282
            if (! tmp___2) {
#line 284
              i ++;
#line 285
              goto do_line_counts;
            }
          }
        }
        {
        {
#line 289
        fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1,
               (FILE */* __restrict  */)stdout);
        }
        }
#line 290
        if ((int )*(*line) == 32) {
#line 291
          unchanged ++;
        }
      }
      while_break___4: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
      __Cont: /* CIL Label */ 
#line 229
      i ++;
    }
    while_break___3: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
}
}
#line 297 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void convert_unified_hunks_to_context___2(char **line , size_t *linelen , unsigned long *linenum___1 ) 
{ 
  unsigned long orig_offset ;
  unsigned long orig_count ;
  unsigned long new_offset ;
  unsigned long new_count ;
  char **orig_line ;
  char **new_line ;
  char **orig_what ;
  char **new_what ;
  char **whats ;
  unsigned int n_whats ;
  unsigned long orig_linenum ;
  unsigned long new_linenum ;
  char const   *no_newline_str ;
  int tmp ;
  __ssize_t tmp___0 ;
  char *last_orig ;
  char *last_new ;
  char *misc ;
  char *what ;
  int newline ;
  int can_omit_from ;
  int can_omit_to ;
  unsigned long i ;
  int tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  void *tmp___4 ;
  void *tmp___5 ;
  void *tmp___6 ;
  int get_out ;
  __ssize_t tmp___7 ;
  unsigned long tmp___8 ;
  unsigned long tmp___9 ;
  void *tmp___10 ;
  unsigned int tmp___11 ;
  unsigned long tmp___12 ;
  void *tmp___13 ;
  unsigned int tmp___14 ;
  unsigned long tmp___15 ;
  size_t tmp___16 ;
  size_t tmp___17 ;
  char *l ;
  size_t tmp___18 ;
  char *l___0 ;
  size_t tmp___19 ;
  int tmp___20 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;

  {
  {
#line 300
  orig_count = 0UL;
#line 300
  new_count = 0UL;
#line 301
  orig_line = (char **)((void *)0);
#line 301
  new_line = (char **)((void *)0);
#line 302
  orig_what = (char **)((void *)0);
#line 302
  new_what = (char **)((void *)0);
#line 303
  whats = (char **)((void *)0);
#line 304
  n_whats = 0U;
#line 306
  no_newline_str = "\\ No newline at end of file\n";
  {
#line 308
  tmp = feof(stdin);
  }
  }
#line 308
  if (tmp) {
#line 309
    goto eof;
  }
  {
  {
#line 311
  tmp___0 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                    (FILE */* __restrict  */)stdin);
  }
  }
#line 311
  if (tmp___0 == -1) {
#line 312
    goto eof;
  }
#line 313
  (*linenum___1) ++;
  {
  {
#line 315
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
#line 316
    last_orig = (char *)((void *)0);
#line 317
    last_new = (char *)((void *)0);
#line 318
    misc = (char *)((void *)0);
#line 319
    what = (char *)((void *)0);
#line 320
    newline = 1;
#line 321
    can_omit_from = 1;
#line 321
    can_omit_to = 1;
    {
#line 324
    tmp___1 = read_atatline((char const   *)*line, & orig_offset, & orig_count, & new_offset,
                            & new_count);
    }
    }
#line 324
    if (tmp___1) {
#line 326
      return;
    }
    {
    {
#line 328
    misc = strchr((char const   *)(*line + 2), '@');
    }
#line 329
    misc += 2;
    {
#line 330
    misc = xstrdup((char const   *)misc);
    }
    {
#line 333
    tmp___2 = xmalloc((size_t )(sizeof(char *) * orig_count));
    }
#line 333
    orig_line = (char **)tmp___2;
    {
#line 334
    tmp___3 = xmalloc((size_t )(sizeof(char *) * new_count));
    }
#line 334
    new_line = (char **)tmp___3;
    {
#line 335
    tmp___4 = xmalloc((size_t )(sizeof(char *) * orig_count));
    }
#line 335
    orig_what = (char **)tmp___4;
    {
#line 336
    tmp___5 = xmalloc((size_t )(sizeof(char *) * new_count));
    }
#line 336
    new_what = (char **)tmp___5;
    {
#line 337
    tmp___6 = xmalloc((size_t )(sizeof(char *) * (orig_count + new_count)));
    }
#line 337
    whats = (char **)tmp___6;
#line 338
    new_linenum = 0UL;
#line 338
    orig_linenum = new_linenum;
    }
    {
    {
#line 339
    while (1) {
      while_continue___7: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 339
      if (! (orig_linenum < orig_count)) {
#line 339
        if (! (new_linenum < new_count)) {
#line 339
          if (! newline) {
#line 339
            goto while_break___0;
          }
        }
      }
      {
#line 341
      get_out = 0;
      {
#line 343
      tmp___7 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                        (FILE */* __restrict  */)stdin);
      }
      }
#line 343
      if (tmp___7 == -1) {
#line 345
        goto while_break___0;
      }
#line 346
      (*linenum___1) ++;
#line 348
      if (orig_linenum >= orig_count) {
#line 348
        if (new_linenum >= new_count) {
#line 348
          if ((int )*(*line) != 92) {
#line 351
            goto while_break___0;
          }
        }
      }
      {
#line 354
      if ((int )*(*line) == 32) {
#line 354
        goto case_32;
      }
#line 364
      if ((int )*(*line) == 45) {
#line 364
        goto case_45;
      }
#line 380
      if ((int )*(*line) == 43) {
#line 380
        goto case_43;
      }
#line 396
      if ((int )*(*line) == 92) {
#line 396
        goto case_92;
      }
#line 405
      goto switch_default;
      case_32: /* CIL Label */ 
      {
#line 355
      what = (char *)((void *)0);
#line 356
      *(orig_what + orig_linenum) = (char *)" ";
#line 357
      *(new_what + new_linenum) = (char *)" ";
      {
#line 358
      *(orig_line + orig_linenum) = xstrdup((char const   *)(*line + 1));
      }
      {
#line 359
      *(new_line + new_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 360
      tmp___8 = orig_linenum;
#line 360
      orig_linenum ++;
#line 360
      last_orig = *(orig_line + tmp___8);
#line 361
      tmp___9 = new_linenum;
#line 361
      new_linenum ++;
#line 361
      last_new = *(new_line + tmp___9);
      }
#line 362
      goto switch_break;
      case_45: /* CIL Label */ 
#line 365
      if (what) {
#line 366
        if ((int )*what != 45) {
#line 367
          *what = (char )'!';
        }
      } else {
        {
        {
#line 369
        tmp___10 = xmalloc((size_t )sizeof(char ));
        }
#line 369
        what = (char *)tmp___10;
#line 370
        *what = (char )'-';
#line 371
        tmp___11 = n_whats;
#line 371
        n_whats ++;
#line 371
        *(whats + tmp___11) = what;
        }
      }
      {
#line 373
      *(orig_what + orig_linenum) = what;
      {
#line 374
      *(orig_line + orig_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 375
      tmp___12 = orig_linenum;
#line 375
      orig_linenum ++;
#line 375
      last_orig = *(orig_line + tmp___12);
#line 376
      last_new = (char *)((void *)0);
#line 377
      can_omit_from = 0;
      }
#line 378
      goto switch_break;
      case_43: /* CIL Label */ 
#line 381
      if (what) {
#line 382
        if ((int )*what != 43) {
#line 383
          *what = (char )'!';
        }
      } else {
        {
        {
#line 385
        tmp___13 = xmalloc((size_t )sizeof(char ));
        }
#line 385
        what = (char *)tmp___13;
#line 386
        *what = (char )'+';
#line 387
        tmp___14 = n_whats;
#line 387
        n_whats ++;
#line 387
        *(whats + tmp___14) = what;
        }
      }
      {
#line 389
      *(new_what + new_linenum) = what;
      {
#line 390
      *(new_line + new_linenum) = xstrdup((char const   *)(*line + 1));
      }
#line 391
      last_orig = (char *)((void *)0);
#line 392
      tmp___15 = new_linenum;
#line 392
      new_linenum ++;
#line 392
      last_new = *(new_line + tmp___15);
#line 393
      can_omit_to = 0;
      }
#line 394
      goto switch_break;
      case_92: /* CIL Label */ 
#line 397
      if (last_orig) {
        {
        {
#line 398
        tmp___16 = strlen((char const   *)last_orig);
        }
#line 398
        *(last_orig + (tmp___16 - 1U)) = (char )'\000';
        }
      }
#line 399
      if (last_new) {
        {
        {
#line 400
        tmp___17 = strlen((char const   *)last_new);
        }
#line 400
        *(last_new + (tmp___17 - 1U)) = (char )'\000';
        }
      }
#line 401
      last_new = (char *)((void *)0);
#line 401
      last_orig = last_new;
#line 402
      newline = 0;
#line 403
      goto switch_break;
      switch_default: /* CIL Label */ 
#line 406
      get_out = 1;
      switch_break: /* CIL Label */ ;
      }
#line 409
      if (get_out) {
#line 410
        goto while_break___0;
      }
    }
    while_break___7: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 413
    if (orig_linenum < orig_count) {
      {
      {
#line 415
      error(1, 0, "Garbled input at line %lu", *linenum___1);
      }
      }
    } else
#line 413
    if (new_linenum < new_count) {
      {
      {
#line 415
      error(1, 0, "Garbled input at line %lu", *linenum___1);
      }
      }
    }
    {
    {
#line 418
    printf((char const   */* __restrict  */)"*** %lu", orig_offset);
    }
    }
#line 419
    if (orig_count) {
      {
      {
#line 420
      printf((char const   */* __restrict  */)",%lu", (orig_offset + orig_count) - 1UL);
      }
      }
    }
    {
    {
#line 422
    printf((char const   */* __restrict  */)" ****%s", misc);
    }
    }
#line 423
    if (! can_omit_from) {
#line 424
      i = 0UL;
      {
      {
#line 424
      while (1) {
        while_continue___8: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 424
        if (! (i < orig_count)) {
#line 424
          goto while_break___1;
        }
        {
#line 425
        l = *(orig_line + i);
        {
#line 426
        printf((char const   */* __restrict  */)"%c %s", (int )*(*(orig_what + i)),
               l);
        }
        {
#line 427
        tmp___18 = strlen((char const   *)l);
        }
        }
#line 427
        if ((int )*(l + (tmp___18 - 1U)) != 10) {
          {
          {
#line 428
          printf((char const   */* __restrict  */)"\n%s", no_newline_str);
          }
          }
        }
#line 424
        i ++;
      }
      while_break___8: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
    }
    {
    {
#line 431
    printf((char const   */* __restrict  */)"--- %lu", new_offset);
    }
    }
#line 432
    if (new_count) {
      {
      {
#line 433
      printf((char const   */* __restrict  */)",%lu", (new_offset + new_count) - 1UL);
      }
      }
    }
    {
    {
#line 435
    puts(" ----");
    }
    }
#line 436
    if (! can_omit_to) {
#line 437
      i = 0UL;
      {
      {
#line 437
      while (1) {
        while_continue___9: /* CIL Label */ ;
        while_continue___2: /* CIL Label */ ;
#line 437
        if (! (i < new_count)) {
#line 437
          goto while_break___2;
        }
        {
#line 438
        l___0 = *(new_line + i);
        {
#line 439
        printf((char const   */* __restrict  */)"%c %s", (int )*(*(new_what + i)),
               l___0);
        }
        {
#line 440
        tmp___19 = strlen((char const   *)l___0);
        }
        }
#line 440
        if ((int )*(l___0 + (tmp___19 - 1U)) != 10) {
          {
          {
#line 441
          printf((char const   */* __restrict  */)"\n%s", no_newline_str);
          }
          }
        }
#line 437
        i ++;
      }
      while_break___9: /* CIL Label */ ;
      }
      while_break___2: /* CIL Label */ ;
      }
    }
    eof: 
#line 445
    i = 0UL;
    {
    {
#line 445
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___3: /* CIL Label */ ;
#line 445
      if (! (i < orig_count)) {
#line 445
        goto while_break___3;
      }
      {
      {
#line 446
      free((void *)*(orig_line + i));
      }
#line 445
      i ++;
      }
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___3: /* CIL Label */ ;
    }
#line 448
    i = 0UL;
    {
    {
#line 448
    while (1) {
      while_continue___11: /* CIL Label */ ;
      while_continue___4: /* CIL Label */ ;
#line 448
      if (! (i < new_count)) {
#line 448
        goto while_break___4;
      }
      {
      {
#line 449
      free((void *)*(new_line + i));
      }
#line 448
      i ++;
      }
    }
    while_break___11: /* CIL Label */ ;
    }
    while_break___4: /* CIL Label */ ;
    }
#line 451
    i = 0UL;
    {
    {
#line 451
    while (1) {
      while_continue___12: /* CIL Label */ ;
      while_continue___5: /* CIL Label */ ;
#line 451
      if (! (i < (unsigned long )n_whats)) {
#line 451
        goto while_break___5;
      }
      {
      {
#line 452
      free((void *)*(whats + i));
      }
#line 451
      i ++;
      }
    }
    while_break___12: /* CIL Label */ ;
    }
    while_break___5: /* CIL Label */ ;
    }
    {
    {
#line 454
    free((void *)orig_line);
    }
    {
#line 455
    free((void *)new_line);
    }
    {
#line 456
    free((void *)orig_what);
    }
    {
#line 457
    free((void *)new_what);
    }
    {
#line 458
    free((void *)whats);
    }
    {
#line 459
    free((void *)misc);
    }
#line 460
    n_whats = 0U;
#line 460
    new_count = (unsigned long )n_whats;
#line 460
    orig_count = new_count;
#line 461
    new_line = (char **)((void *)0);
#line 461
    orig_line = new_line;
#line 462
    new_what = (char **)((void *)0);
#line 462
    orig_what = new_what;
#line 463
    whats = (char **)((void *)0);
#line 464
    misc = (char *)((void *)0);
    {
#line 466
    tmp___20 = feof(stdin);
    }
    }
#line 466
    if (tmp___20) {
#line 467
      return;
    }
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
}
}
#line 473 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void do_convert_to_context___2(void) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long linenum___1 ;
  ssize_t got ;
  __ssize_t tmp ;
  int is_context ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;

  {
  {
#line 475
  line = (char *)((void *)0);
#line 476
  linelen = (size_t )0;
#line 477
  linenum___1 = 0UL;
  {
#line 478
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)stdin);
  }
#line 478
  got = tmp;
  }
#line 480
  if (got == -1) {
#line 481
    return;
  }
#line 482
  linenum___1 ++;
  {
  {
#line 484
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 485
    is_context = 0;
    {
    {
#line 487
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 488
      tmp___0 = feof(stdin);
      }
      }
#line 488
      if (tmp___0) {
#line 489
        goto eof;
      }
      {
      {
#line 491
      tmp___1 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 491
      if (! tmp___1) {
#line 492
        is_context = 0;
#line 493
        goto while_break___0;
      }
      {
      {
#line 496
      tmp___2 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 496
      if (! tmp___2) {
#line 497
        is_context = 1;
#line 498
        goto while_break___0;
      }
      {
      {
#line 501
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 503
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 504
      if (got == -1) {
#line 505
        goto eof;
      }
#line 506
      linenum___1 ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 509
    if (is_context) {
      {
      {
#line 510
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 511
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 512
      if (got == -1) {
#line 513
        goto eof;
      }
      {
#line 514
      linenum___1 ++;
      {
#line 516
      tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 516
      if (tmp___3) {
#line 517
        goto __Cont;
      }
      {
      {
#line 519
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 520
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 521
      if (got == -1) {
#line 522
        goto eof;
      }
      {
#line 523
      linenum___1 ++;
      {
#line 525
      tmp___4 = strncmp((char const   *)line, "***************", (size_t )15);
      }
      }
#line 525
      if (tmp___4) {
#line 526
        goto __Cont;
      }
      {
      {
#line 528
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 529
      copy_context_hunks___2(& line, & linelen, & got, & linenum___1);
      }
      }
    } else {
      {
      {
#line 531
      printf((char const   */* __restrict  */)"*** %s", line + 4);
      }
      {
#line 532
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 533
      if (got == -1) {
#line 534
        goto eof;
      }
      {
#line 535
      linenum___1 ++;
      {
#line 537
      tmp___5 = strncmp((char const   *)line, "+++ ", (size_t )4);
      }
      }
#line 537
      if (tmp___5) {
#line 538
        goto __Cont;
      }
      {
      {
#line 540
      printf((char const   */* __restrict  */)"--- ");
      }
      {
#line 541
      fwrite((void const   */* __restrict  */)(line + 4), (size_t )got - 4U, (size_t )1,
             (FILE */* __restrict  */)stdout);
      }
      {
#line 542
      puts("***************");
      }
      {
#line 543
      convert_unified_hunks_to_context___2(& line, & linelen, & linenum___1);
      }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  eof: 
#line 549
  if (line) {
    {
    {
#line 550
    free((void *)line);
    }
    }
  }
#line 552
  return;
}
}
#line 555 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void copy_unified_hunks___2(char **line , size_t *linelen , ssize_t *got ,
                                   unsigned long *linenum___1 ) 
{ 
  unsigned long orig_count ;
  unsigned long new_count ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;

  {
#line 558
  orig_count = 0UL;
#line 558
  new_count = 0UL;
  {
  {
#line 561
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 562
    tmp = feof(stdin);
    }
    }
#line 562
    if (tmp) {
#line 563
      return;
    }
    {
    {
#line 565
    *got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                   (FILE */* __restrict  */)stdin);
    }
    }
#line 566
    if (*got == -1) {
#line 567
      return;
    }
#line 568
    (*linenum___1) ++;
#line 570
    if (! orig_count) {
#line 570
      if (! new_count) {
#line 570
        if ((int )*(*line) != 92) {
          {
          {
#line 571
          tmp___0 = strncmp((char const   *)*line, "@@ ", (size_t )3);
          }
          }
#line 571
          if (tmp___0) {
#line 572
            goto while_break;
          }
          {
          {
#line 574
          tmp___1 = read_atatline((char const   *)*line, & orig_offset, & orig_count,
                                  & new_offset, & new_count);
          }
          }
#line 574
          if (tmp___1) {
            {
            {
#line 576
            error(1, 0, "line %lu not understood: %s", *linenum___1, *line);
            }
            }
          }
          {
          {
#line 580
          fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
          }
#line 581
          goto __Cont;
        }
      }
    }
#line 584
    if (orig_count) {
#line 584
      if ((int )*(*line) != 43) {
#line 585
        orig_count --;
      }
    }
#line 586
    if (new_count) {
#line 586
      if ((int )*(*line) != 45) {
#line 587
        new_count --;
      }
    }
    {
    {
#line 589
    fwrite((void const   */* __restrict  */)*line, (size_t )*got, (size_t )1, (FILE */* __restrict  */)stdout);
    }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 591
  return;
}
}
#line 593 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void convert_context_hunks_to_unified___2(char **line , size_t *linelen , unsigned long *linenum___1 ) 
{ 
  int happy ;
  size_t i ;
  char *misc ;
  unsigned long unchanged ;
  unsigned long line_start[2] ;
  unsigned long line_end ;
  unsigned long line_count[2] ;
  char *n ;
  char *end ;
  char **lines___1[2] ;
  size_t *linelengths[2] ;
  size_t n_lines[2] ;
  size_t at[2] ;
  ssize_t got ;
  int first ;
  unsigned long lnum ;
  int tmp ;
  __ssize_t tmp___0 ;
  char *m ;
  int tmp___1 ;
  int tmp___2 ;
  char const   *tmp___3 ;
  int tmp___4 ;
  char const   *tmp___5 ;
  void *tmp___6 ;
  void *tmp___7 ;
  int tmp___8 ;
  void *tmp___9 ;
  char *l[2] ;
  size_t llen[2] ;
  int tmp___10 ;
  void *__cil_tmp35 ;
  void *__cil_tmp36 ;
  void *__cil_tmp37 ;
  void *__cil_tmp38 ;
  void *__cil_tmp39 ;
  void *__cil_tmp40 ;
  void *__cil_tmp41 ;
  void *__cil_tmp42 ;
  char *__cil_tmp43 ;
  char *__cil_tmp44 ;
  char *__cil_tmp45 ;
  char *__cil_tmp46 ;
  char *__cil_tmp47 ;
  char *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;

  {
#line 596
  happy = 1;
  {
  {
#line 598
  while (1) {
    while_continue___7: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 598
    if (! happy) {
#line 598
      goto while_break;
    }
#line 600
    misc = (char *)((void *)0);
#line 601
    unchanged = 0UL;
#line 610
    n_lines[1] = (size_t )0;
#line 610
    n_lines[0] = n_lines[1];
#line 611
    linelengths[1] = (size_t *)((void *)0);
#line 611
    linelengths[0] = linelengths[1];
#line 612
    lines___1[1] = (char **)((void *)0);
#line 612
    lines___1[0] = lines___1[1];
#line 614
    i = (size_t )0;
    {
    {
#line 614
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 614
      if (! (i < 2U)) {
#line 614
        goto while_break___0;
      }
      {
#line 615
      first = 1;
      {
#line 618
      tmp = feof(stdin);
      }
      }
#line 618
      if (tmp) {
#line 619
        goto eof;
      }
      {
      {
#line 621
      tmp___0 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                        (FILE */* __restrict  */)stdin);
      }
      }
#line 621
      if (tmp___0 == -1) {
#line 622
        goto eof;
      }
#line 623
      (*linenum___1) ++;
#line 625
      if (! i) {
        {
        {
#line 625
        tmp___2 = strncmp((char const   *)*line, "***************", (size_t )15);
        }
        }
#line 625
        if (! tmp___2) {
          {
#line 626
          m = *line + 15;
          {
#line 627
          tmp___1 = strcmp((char const   *)m, "\n");
          }
          }
#line 627
          if (tmp___1) {
            {
            {
#line 628
            misc = xstrdup((char const   *)m);
            }
            }
          }
#line 629
          i --;
#line 630
          goto __Cont;
        }
      }
#line 633
      if (i) {
#line 633
        tmp___3 = "--- ";
      } else {
#line 633
        tmp___3 = "*** ";
      }
      {
      {
#line 633
      tmp___4 = strncmp((char const   *)*line, tmp___3, (size_t )4);
      }
      }
#line 633
      if (tmp___4) {
#line 634
        goto unhappy;
      }
      do_line_counts: 
      {
#line 637
      n = *line + 4;
      {
#line 638
      line_start[i] = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                              10);
      }
      }
#line 639
      if ((unsigned long )n == (unsigned long )end) {
#line 640
        goto unhappy;
      }
#line 642
      if ((int )*end == 44) {
        {
#line 643
        n = end + 1;
        {
#line 644
        line_end = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                           10);
        }
        }
#line 645
        if ((unsigned long )n == (unsigned long )end) {
#line 646
          goto unhappy;
        }
#line 648
        if (line_start[i] > line_end) {
#line 649
          goto unhappy;
        }
#line 651
        line_count[i] = (line_end - line_start[i]) + 1UL;
      } else {
#line 653
        line_end = line_start[i];
#line 654
        if (line_start[i]) {
#line 654
          line_count[i] = 1UL;
        } else {
#line 654
          line_count[i] = 0UL;
        }
      }
#line 657
      if (i) {
#line 657
        tmp___5 = "----";
      } else {
#line 657
        tmp___5 = "****";
      }
      {
      {
#line 657
      n = strstr((char const   *)n, tmp___5);
      }
      }
#line 658
      if (! misc) {
        {
        {
#line 659
        misc = xstrdup((char const   *)(n + 4));
        }
        }
      }
#line 661
      if (i) {
#line 661
        if (line_count[i] == unchanged) {
#line 662
          goto while_break___0;
        }
      }
      {
#line 664
      n_lines[i] = (size_t )line_count[i];
      {
#line 665
      tmp___6 = xmalloc((size_t )(sizeof(char *) * line_count[i]));
      }
#line 665
      lines___1[i] = (char **)tmp___6;
      {
#line 666
      tmp___7 = xmalloc((size_t )(sizeof(size_t ) * line_count[i]));
      }
#line 666
      linelengths[i] = (size_t *)tmp___7;
      {
#line 668
      memset((void *)lines___1[i], 0, (size_t )(sizeof(char *) * line_count[i]));
      }
#line 670
      lnum = 0UL;
      }
      {
      {
#line 670
      while (1) {
        while_continue___9: /* CIL Label */ ;
        while_continue___1: /* CIL Label */ ;
#line 670
        if (! (lnum < line_count[i])) {
#line 670
          goto while_break___1;
        }
        {
        {
#line 671
        got = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                      (FILE */* __restrict  */)stdin);
        }
        }
#line 672
        if (got == -1) {
#line 673
          goto eof;
        }
#line 674
        (*linenum___1) ++;
#line 676
        if (! i) {
#line 676
          if (first) {
            {
#line 677
            first = 0;
            {
#line 678
            tmp___8 = strncmp((char const   *)*line, "--- ", (size_t )4);
            }
            }
#line 678
            if (! tmp___8) {
#line 680
              n_lines[i] = (size_t )0;
#line 681
              i ++;
#line 682
              goto do_line_counts;
            }
          }
        }
        {
        {
#line 686
        tmp___9 = xmalloc((size_t )got + 1U);
        }
#line 686
        *(lines___1[i] + lnum) = (char *)tmp___9;
        {
#line 687
        memcpy((void */* __restrict  */)*(lines___1[i] + lnum), (void const   */* __restrict  */)*line,
               (size_t )got);
        }
#line 688
        *(*(lines___1[i] + lnum) + got) = (char )'\000';
#line 689
        *(linelengths[i] + lnum) = (size_t )got;
        }
#line 690
        if ((int )*(*line) == 32) {
#line 691
          unchanged ++;
        }
#line 670
        lnum ++;
      }
      while_break___9: /* CIL Label */ ;
      }
      while_break___1: /* CIL Label */ ;
      }
      __Cont: /* CIL Label */ 
#line 614
      i ++;
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
    {
#line 695
    printf((char const   */* __restrict  */)"@@ -%lu", line_start[0]);
    }
    }
#line 696
    if (line_count[0] != 1UL) {
      {
      {
#line 697
      printf((char const   */* __restrict  */)",%lu", line_count[0]);
      }
      }
    }
    {
    {
#line 699
    printf((char const   */* __restrict  */)" +%lu", line_start[1]);
    }
    }
#line 700
    if (line_count[1] != 1UL) {
      {
      {
#line 701
      printf((char const   */* __restrict  */)",%lu", line_count[1]);
      }
      }
    }
    {
    {
#line 703
    printf((char const   */* __restrict  */)" @@%s", misc);
    }
#line 706
    at[1] = (size_t )0;
#line 706
    at[0] = at[1];
    }
    {
    {
#line 707
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
#line 707
      if (! (at[0] < n_lines[0])) {
#line 707
        if (! (at[1] < n_lines[1])) {
#line 707
          goto while_break___2;
        }
      }
#line 708
      l[0] = (char *)((void *)0);
#line 708
      l[1] = (char *)((void *)0);
#line 710
      if (lines___1[0]) {
#line 710
        if (at[0] < n_lines[0]) {
#line 711
          l[0] = *(lines___1[0] + at[0]);
#line 712
          llen[0] = *(linelengths[0] + at[0]);
        }
      }
#line 714
      if (lines___1[1]) {
#line 714
        if (at[1] < n_lines[1]) {
#line 715
          l[1] = *(lines___1[1] + at[1]);
#line 716
          llen[1] = *(linelengths[1] + at[1]);
        }
      }
#line 719
      if (l[0]) {
#line 719
        if ((int )*(l[0]) == 32) {
#line 719
          if (l[1]) {
#line 719
            if ((int )*(l[1]) == 32) {
              {
              {
#line 720
              fwrite((void const   */* __restrict  */)(l[0] + 1), llen[0] - 1U, (size_t )1,
                     (FILE */* __restrict  */)stdout);
              }
#line 721
              (at[0]) ++;
#line 722
              (at[1]) ++;
              }
            } else {
#line 719
              goto _L___12;
            }
          } else {
#line 719
            goto _L___12;
          }
        } else {
#line 719
          goto _L___12;
        }
      } else
      _L___12: /* CIL Label */ 
#line 723
      if (l[0]) {
#line 723
        if ((int )*(l[0]) == 32) {
#line 723
          if (! l[1]) {
            {
            {
#line 724
            fwrite((void const   */* __restrict  */)(l[0] + 1), llen[0] - 1U, (size_t )1,
                   (FILE */* __restrict  */)stdout);
            }
#line 725
            (at[0]) ++;
            }
          } else {
#line 723
            goto _L___9;
          }
        } else {
#line 723
          goto _L___9;
        }
      } else
      _L___9: /* CIL Label */ 
#line 726
      if (l[0]) {
#line 726
        if ((int )*(l[0]) == 45) {
          {
          {
#line 727
          putchar('-');
          }
          {
#line 728
          fwrite((void const   */* __restrict  */)(l[0] + 2), llen[0] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 729
          (at[0]) ++;
          }
        } else {
#line 726
          goto _L___7;
        }
      } else
      _L___7: /* CIL Label */ 
#line 730
      if (l[1]) {
#line 730
        if ((int )*(l[1]) == 43) {
          {
          {
#line 731
          putchar('+');
          }
          {
#line 732
          fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 733
          (at[1]) ++;
          }
        } else {
#line 730
          goto _L___6;
        }
      } else
      _L___6: /* CIL Label */ 
#line 734
      if (l[0]) {
#line 734
        if ((int )*(l[0]) == 33) {
#line 734
          if (l[1]) {
#line 734
            if ((int )*(l[1]) == 33) {
              {
              {
#line 736
              while (1) {
                while_continue___11: /* CIL Label */ ;
                while_continue___3: /* CIL Label */ ;
#line 736
                if (at[0] < n_lines[0]) {
#line 736
                  if (! ((int )*(*(lines___1[0] + at[0])) == 33)) {
#line 736
                    goto while_break___3;
                  }
                } else {
#line 736
                  goto while_break___3;
                }
                {
                {
#line 738
                putchar('-');
                }
                {
#line 739
                fwrite((void const   */* __restrict  */)(*(lines___1[0] + at[0]) + 2),
                       *(linelengths[0] + at[0]) - 2U, (size_t )1, (FILE */* __restrict  */)stdout);
                }
#line 742
                (at[0]) ++;
                }
              }
              while_break___11: /* CIL Label */ ;
              }
              while_break___3: /* CIL Label */ ;
              }
              {
              {
#line 744
              while (1) {
                while_continue___12: /* CIL Label */ ;
                while_continue___4: /* CIL Label */ ;
#line 744
                if (at[1] < n_lines[1]) {
#line 744
                  if (! ((int )*(*(lines___1[1] + at[1])) == 33)) {
#line 744
                    goto while_break___4;
                  }
                } else {
#line 744
                  goto while_break___4;
                }
                {
                {
#line 746
                putchar('+');
                }
                {
#line 747
                fwrite((void const   */* __restrict  */)(*(lines___1[1] + at[1]) + 2),
                       *(linelengths[1] + at[1]) - 2U, (size_t )1, (FILE */* __restrict  */)stdout);
                }
#line 750
                (at[1]) ++;
                }
              }
              while_break___12: /* CIL Label */ ;
              }
              while_break___4: /* CIL Label */ ;
              }
            } else {
#line 734
              goto _L___5;
            }
          } else {
#line 734
            goto _L___5;
          }
        } else {
#line 734
          goto _L___5;
        }
      } else
      _L___5: /* CIL Label */ 
#line 752
      if (l[0]) {
#line 752
        if ((int )*(l[0]) == 33) {
          {
          {
#line 753
          putchar('-');
          }
          {
#line 754
          fwrite((void const   */* __restrict  */)(l[0] + 2), llen[0] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 755
          (at[0]) ++;
          }
        } else {
#line 752
          goto _L___2;
        }
      } else
      _L___2: /* CIL Label */ 
#line 756
      if (l[1]) {
#line 756
        if ((int )*(l[1]) == 33) {
          {
          {
#line 757
          putchar('+');
          }
          {
#line 758
          fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
                 (FILE */* __restrict  */)stdout);
          }
#line 759
          (at[1]) ++;
          }
        } else {
#line 756
          goto _L___1;
        }
      } else
      _L___1: /* CIL Label */ 
#line 760
      if (l[0]) {
#line 760
        if ((int )*(l[0]) == 92) {
          {
          {
#line 761
          fwrite((void const   */* __restrict  */)l[0], llen[0], (size_t )1, (FILE */* __restrict  */)stdout);
          }
          {
#line 762
          putchar('\n');
          }
#line 763
          (at[0]) ++;
          }
        } else {
#line 760
          goto _L___0;
        }
      } else
      _L___0: /* CIL Label */ 
#line 764
      if (l[1]) {
#line 764
        if ((int )*(l[1]) == 92) {
          {
          {
#line 765
          fwrite((void const   */* __restrict  */)l[1], llen[1], (size_t )1, (FILE */* __restrict  */)stdout);
          }
          {
#line 766
          putchar('\n');
          }
#line 767
          (at[1]) ++;
          }
        } else {
#line 764
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 768
      if (! l[0]) {
        {
        {
#line 769
        putchar((int )*(l[1]));
        }
        {
#line 770
        fwrite((void const   */* __restrict  */)(l[1] + 2), llen[1] - 2U, (size_t )1,
               (FILE */* __restrict  */)stdout);
        }
#line 771
        (at[1]) ++;
        }
      } else {
        {
        {
#line 773
        printf((char const   */* __restrict  */)"Don\'t know how to handle this:\n1: %s2: %s",
               l[0], l[1]);
        }
        {
#line 775
        exit(1);
        }
        }
      }
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
    eof: 
    {
    {
#line 780
    free((void *)misc);
    }
#line 781
    i = (size_t )0;
    }
    {
    {
#line 781
    while (1) {
      while_continue___13: /* CIL Label */ ;
      while_continue___5: /* CIL Label */ ;
#line 781
      if (! (i < n_lines[0])) {
#line 781
        goto while_break___5;
      }
      {
      {
#line 782
      free((void *)*(lines___1[0] + i));
      }
#line 781
      i ++;
      }
    }
    while_break___13: /* CIL Label */ ;
    }
    while_break___5: /* CIL Label */ ;
    }
#line 783
    i = (size_t )0;
    {
    {
#line 783
    while (1) {
      while_continue___14: /* CIL Label */ ;
      while_continue___6: /* CIL Label */ ;
#line 783
      if (! (i < n_lines[1])) {
#line 783
        goto while_break___6;
      }
      {
      {
#line 784
      free((void *)*(lines___1[1] + i));
      }
#line 783
      i ++;
      }
    }
    while_break___14: /* CIL Label */ ;
    }
    while_break___6: /* CIL Label */ ;
    }
    {
    {
#line 785
    free((void *)lines___1[0]);
    }
    {
#line 786
    free((void *)linelengths[0]);
    }
    {
#line 787
    free((void *)lines___1[1]);
    }
    {
#line 788
    free((void *)linelengths[1]);
    }
    {
#line 790
    tmp___10 = feof(stdin);
    }
    }
#line 790
    if (tmp___10) {
#line 791
      return;
    }
#line 793
    goto while_continue;
    unhappy: 
#line 796
    happy = 0;
#line 797
    goto eof;
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 799
  return;
}
}
#line 803 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static void do_convert_to_unified___2(void) 
{ 
  char *line ;
  size_t linelen ;
  unsigned long linenum___1 ;
  ssize_t got ;
  __ssize_t tmp ;
  int is_context ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  char *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;
  char *__cil_tmp15 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;

  {
  {
#line 805
  line = (char *)((void *)0);
#line 806
  linelen = (size_t )0;
#line 807
  linenum___1 = 0UL;
  {
#line 808
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)stdin);
  }
#line 808
  got = tmp;
  }
#line 810
  if (got == -1) {
#line 811
    return;
  }
#line 812
  linenum___1 ++;
  {
  {
#line 814
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 815
    is_context = 0;
    {
    {
#line 817
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 818
      tmp___0 = feof(stdin);
      }
      }
#line 818
      if (tmp___0) {
#line 819
        goto eof;
      }
      {
      {
#line 821
      tmp___1 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 821
      if (! tmp___1) {
#line 822
        is_context = 0;
#line 823
        goto while_break___0;
      }
      {
      {
#line 826
      tmp___2 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 826
      if (! tmp___2) {
#line 827
        is_context = 1;
#line 828
        goto while_break___0;
      }
      {
      {
#line 831
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 833
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 834
      if (got == -1) {
#line 835
        goto eof;
      }
#line 836
      linenum___1 ++;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 839
    if (is_context) {
      {
      {
#line 840
      printf((char const   */* __restrict  */)"--- %s", line + 4);
      }
      {
#line 841
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 842
      if (got == -1) {
#line 843
        goto eof;
      }
      {
#line 844
      linenum___1 ++;
      {
#line 846
      tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 846
      if (tmp___3) {
#line 847
        goto __Cont;
      }
      {
      {
#line 849
      printf((char const   */* __restrict  */)"+++ ");
      }
      {
#line 850
      fwrite((void const   */* __restrict  */)(line + 4), (size_t )got - 4U, (size_t )1,
             (FILE */* __restrict  */)stdout);
      }
      {
#line 851
      convert_context_hunks_to_unified___2(& line, & linelen, & linenum___1);
      }
      }
    } else {
      {
      {
#line 854
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 855
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)stdin);
      }
      }
#line 856
      if (got == -1) {
#line 857
        goto eof;
      }
      {
#line 858
      linenum___1 ++;
      {
#line 860
      tmp___4 = strncmp((char const   *)line, "+++ ", (size_t )4);
      }
      }
#line 860
      if (tmp___4) {
#line 861
        goto __Cont;
      }
      {
      {
#line 863
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)stdout);
      }
      {
#line 864
      copy_unified_hunks___2(& line, & linelen, & got, & linenum___1);
      }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  eof: 
#line 869
  if (line) {
    {
    {
#line 870
    free((void *)line);
    }
    }
  }
#line 872
  return;
}
}
#line 875 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static FILE *do_convert___2(FILE *f , char const   *mode___3 , int seekable , void (*fn)(void) ) 
{ 
  int fildes[2] ;
  int fd ;
  int tmp ;
  FILE *ret ;
  char *tmp___0 ;
  char *tmp___1 ;
  int *tmp___2 ;
  int tmp___3 ;
  __pid_t tmp___4 ;
  int *tmp___5 ;
  FILE *tmp___6 ;
  FILE *tmp___7 ;
  int c ;
  int tmp___8 ;
  int tmp___9 ;
  char *tmp___10 ;
  char *tmp___11 ;
  int *tmp___12 ;
  int tmp___13 ;
  __pid_t tmp___14 ;
  int *tmp___15 ;
  FILE *tmp___16 ;
  char *tmp___17 ;
  char *tmp___18 ;
  void *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;

  {
  {
  {
#line 879
  tmp = fileno(f);
  }
#line 879
  fd = tmp;
  {
#line 882
  fflush((FILE *)((void *)0));
  }
  {
#line 883
  tmp___18 = strchr(mode___3, 'r');
  }
  }
#line 883
  if (tmp___18) {
    {
    {
#line 884
    tmp___0 = strchr(mode___3, 'w');
    }
    }
#line 884
    if (tmp___0) {
#line 886
      return ((FILE *)((void *)0));
    } else {
      {
      {
#line 884
      tmp___1 = strchr(mode___3, '+');
      }
      }
#line 884
      if (tmp___1) {
#line 886
        return ((FILE *)((void *)0));
      }
    }
    {
    {
#line 892
    tmp___3 = pipe((int *)(fildes));
    }
    }
#line 892
    if (tmp___3) {
      {
      {
#line 893
      tmp___2 = __errno_location();
      }
      {
#line 893
      error(1, *tmp___2, "pipe failed");
      }
      }
    }
    {
    {
#line 895
    tmp___4 = fork();
    }
    }
    {
#line 896
    if (tmp___4 == -1) {
#line 896
      goto case_neg_1;
    }
#line 921
    if (tmp___4 == 0) {
#line 921
      goto case_0;
    }
#line 899
    goto switch_default;
    case_neg_1: /* CIL Label */ 
    {
    {
#line 897
    tmp___5 = __errno_location();
    }
    {
#line 897
    error(1, *tmp___5, "fork failed");
    }
    }
    switch_default: /* CIL Label */ 
    {
    {
#line 901
    close(fildes[1]);
    }
    {
#line 902
    ret = fdopen(fildes[0], mode___3);
    }
    }
#line 904
    if (seekable) {
      {
      {
#line 905
      tmp___7 = xtmpfile();
      }
#line 905
      tmp___6 = tmp___7;
      }
      {
      {
#line 906
      while (1) {
        while_continue___0: /* CIL Label */ ;
        while_continue: /* CIL Label */ ;
        {
        {
#line 906
        tmp___9 = feof(ret);
        }
        }
#line 906
        if (tmp___9) {
#line 906
          goto while_break;
        }
        {
        {
#line 907
        tmp___8 = fgetc(ret);
        }
#line 907
        c = tmp___8;
        }
#line 909
        if (c == -1) {
#line 910
          goto while_break;
        }
        {
        {
#line 912
        fputc(c, tmp___6);
        }
        }
      }
      while_break___0: /* CIL Label */ ;
      }
      while_break: /* CIL Label */ ;
      }
      {
      {
#line 915
      rewind(tmp___6);
      }
      }
#line 916
      return (tmp___6);
    }
#line 919
    return (ret);
    case_0: /* CIL Label */ 
    {
    {
#line 932
    close(fildes[0]);
    }
    }
#line 934
    if (fd != 0) {
      {
      {
#line 935
      dup2(fd, 0);
      }
      {
#line 936
      fclose(f);
      }
      }
    }
#line 939
    if (fildes[1] != 1) {
      {
      {
#line 940
      dup2(fildes[1], 1);
      }
      }
    }
    {
    {
#line 942
    (*fn)();
    }
    {
#line 943
    exit(0);
    }
    }
    switch_break: /* CIL Label */ ;
    }
  } else {
    {
    {
#line 946
    tmp___17 = strchr(mode___3, 'w');
    }
    }
#line 946
    if (tmp___17) {
      {
      {
#line 947
      tmp___10 = strchr(mode___3, 'r');
      }
      }
#line 947
      if (tmp___10) {
#line 949
        return ((FILE *)((void *)0));
      } else {
        {
        {
#line 947
        tmp___11 = strchr(mode___3, '+');
        }
        }
#line 947
        if (tmp___11) {
#line 949
          return ((FILE *)((void *)0));
        }
      }
      {
      {
#line 954
      tmp___13 = pipe((int *)(fildes));
      }
      }
#line 954
      if (tmp___13) {
        {
        {
#line 955
        tmp___12 = __errno_location();
        }
        {
#line 955
        error(1, *tmp___12, "pipe failed");
        }
        }
      }
      {
      {
#line 957
      tmp___14 = fork();
      }
      }
      {
#line 958
      if (tmp___14 == -1) {
#line 958
        goto case_neg_1___0;
      }
#line 966
      if (tmp___14 == 0) {
#line 966
        goto case_0___0;
      }
#line 961
      goto switch_default___0;
      case_neg_1___0: /* CIL Label */ 
      {
      {
#line 959
      tmp___15 = __errno_location();
      }
      {
#line 959
      error(1, *tmp___15, "fork failed");
      }
      }
      switch_default___0: /* CIL Label */ 
      {
      {
#line 963
      close(fildes[1]);
      }
      {
#line 964
      tmp___16 = fdopen(fildes[1], mode___3);
      }
      }
#line 964
      return (tmp___16);
      case_0___0: /* CIL Label */ 
      {
      {
#line 974
      close(fildes[0]);
      }
      }
#line 976
      if (fildes[0] != 0) {
        {
        {
#line 977
        dup2(fildes[0], 0);
        }
        }
      }
#line 979
      if (fd != 1) {
        {
        {
#line 980
        dup2(fd, 1);
        }
        {
#line 981
        fclose(f);
        }
        }
      }
      {
      {
#line 984
      (*fn)();
      }
      {
#line 985
      exit(0);
      }
      }
      switch_break___0: /* CIL Label */ ;
      }
    }
  }
#line 989
  return ((FILE *)((void *)0));
}
}
#line 1002 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/diff.c"
static int read_timezone___2(char const   *tz ) 
{ 
  int zone ;
  char *endptr ;
  size_t tmp ;
  long tmp___0 ;
  char *__cil_tmp6 ;

  {
  {
#line 1005
  zone = -1;
  {
#line 1008
  tmp = strspn(tz, " ");
  }
#line 1008
  tz += tmp;
  {
#line 1009
  tmp___0 = strtol((char const   */* __restrict  */)tz, (char **/* __restrict  */)(& endptr),
                   10);
  }
#line 1009
  zone = (int )tmp___0;
  }
#line 1010
  if ((unsigned long )tz == (unsigned long )endptr) {
#line 1011
    zone = -1;
  }
#line 1013
  return (zone);
}
}
#line 125 "/usr/include/locale.h"
extern  __attribute__((__nothrow__)) char *setlocale(int __category , char const   *__locale ) ;
#line 567 "/usr/include/regex.h"
extern int regcomp(regex_t * __restrict  __preg , char const   * __restrict  __pattern ,
                   int __cflags ) ;
#line 571
extern int regexec(regex_t const   * __restrict  __preg , char const   * __restrict  __string ,
                   size_t __nmatch , regmatch_t * __restrict  __pmatch , int __eflags ) ;
#line 576
extern size_t regerror(int __errcode , regex_t const   * __restrict  __preg , char * __restrict  __errbuf ,
                       size_t __errbuf_size ) ;
#line 59 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
enum __anonenum_output_matching_30 output_matching  =    (enum __anonenum_output_matching_30 )0;
#line 65 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct patlist *pat_include  =    (struct patlist *)((void *)0);
#line 66 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct patlist *pat_exclude  =    (struct patlist *)((void *)0);
#line 67 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct range *hunks  =    (struct range *)((void *)0);
#line 68 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct range *lines  =    (struct range *)((void *)0);
#line 69 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct range *files  =    (struct range *)((void *)0);
#line 70 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static enum line_numbering number_lines  =    (enum line_numbering )0;
#line 71 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int number_files  =    0;
#line 73 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int unzip___0  =    0;
#line 74 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static enum __anonenum_mode_31 mode___0  ;
#line 79 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static regex_t *regex  =    (regex_t *)((void *)0);
#line 80 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static size_t num_regex  =    (size_t )0;
#line 81 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int clean_comments  =    0;
#line 82 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int numbering  =    0;
#line 83 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int annotating  =    0;
#line 84 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int ignore_components___0  =    0;
#line 85 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int strip_components  =    0;
#line 86 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static char const   *prefix_to_add  =    (char const   *)((void *)0);
#line 87 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static char const   *old_prefix_to_add  =    (char const   *)((void *)0);
#line 88 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static char const   *new_prefix_to_add  =    (char const   *)((void *)0);
#line 89 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int show_status  =    0;
#line 90 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int verbose  =    0;
#line 91 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int removing_timestamp  =    0;
#line 92 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int egrepping  =    0;
#line 93 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int print_patchnames  =    -1;
#line 94 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int empty_files_as_absent  =    0;
#line 95 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static unsigned long filecount  =    0UL;
#line 97 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int regexecs(regex_t *regex___1 , size_t num_regex___1 , char const   *string ,
                    size_t nmatch , regmatch_t *pmatch , int eflags ) 
{ 
  size_t i ;
  int ret ;

  {
#line 102
  ret = 1;
#line 103
  i = (size_t )0;
  {
  {
#line 103
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 103
    if (! (i < num_regex___1)) {
#line 103
      goto while_break;
    }
    {
    {
#line 104
    ret = regexec((regex_t const   */* __restrict  */)(regex___1 + i), (char const   */* __restrict  */)string,
                  nmatch, (regmatch_t */* __restrict  */)pmatch, eflags);
    }
    }
#line 104
    if (! ret) {
#line 106
      goto while_break;
    }
#line 103
    i ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 107
  return (ret);
}
}
#line 110 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int file_exists(char const   *name , char const   *timestamp ) 
{ 
  struct tm t ;
  long zone ;
  int tmp ;
  int tmp___0 ;
  long offset ;
  char *__cil_tmp8 ;

  {
  {
#line 113
  zone = -1L;
  {
#line 115
  tmp = strcmp(name, "/dev/null");
  }
  }
#line 115
  if (! tmp) {
#line 116
    return (0);
  }
  {
  {
#line 118
  tmp___0 = read_timestamp(timestamp, & t, & zone);
  }
  }
#line 118
  if (tmp___0) {
#line 119
    return (1);
  }
#line 124
  if (t.tm_sec == 0) {
#line 124
    if (t.tm_year == 69) {
#line 124
      if (t.tm_mon == 11) {
#line 124
        if (t.tm_mday == 31) {
#line 124
          if (t.tm_hour >= 9) {
#line 124
            goto _L;
          } else {
#line 124
            goto _L___2;
          }
        } else {
#line 124
          goto _L___2;
        }
      } else {
#line 124
        goto _L___2;
      }
    } else
    _L___2: /* CIL Label */ 
#line 124
    if (t.tm_year == 70) {
#line 124
      if (t.tm_mon == 0) {
#line 124
        if (t.tm_mday == 1) {
#line 124
          if (t.tm_hour <= 15) {
            _L: /* CIL Label */ 
#line 124
            if (t.tm_min % 15 == 0) {
#line 130
              if (zone != -1L) {
#line 132
                offset = 0L;
#line 133
                if (t.tm_year == 69) {
#line 134
                  offset = (long )(100 * (t.tm_hour - 24));
#line 135
                  if (t.tm_min) {
#line 136
                    offset += (long )((100 + t.tm_min) - 60);
                  }
                } else {
#line 138
                  offset = (long )(100 * t.tm_hour);
#line 139
                  offset += (long )t.tm_min;
                }
#line 142
                if (offset != zone) {
#line 143
                  return (1);
                }
              }
#line 146
              return (0);
            }
          }
        }
      }
    }
  }
#line 150
  return (1);
}
}
#line 153 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int output_header_line(char const   *line ) 
{ 
  char *fn ;
  int h ;
  size_t tmp ;
  int tmp___0 ;
  int tmp___1 ;
  char const   *tmp___2 ;
  char *__cil_tmp8 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;

  {
  {
  {
#line 156
  tmp = strcspn(line + 4, "\t\n");
  }
#line 156
  h = (int )tmp;
  {
#line 158
  fwrite((void const   */* __restrict  */)line, (size_t )1, (size_t )4, (FILE */* __restrict  */)stdout);
  }
  }
#line 160
  if (prefix_to_add) {
    {
    {
#line 161
    fputs((char const   */* __restrict  */)prefix_to_add, (FILE */* __restrict  */)stdout);
    }
    }
  } else {
#line 163
    if (old_prefix_to_add) {
      {
      {
#line 163
      tmp___0 = strncmp(line, "---", (size_t )3);
      }
      }
#line 163
      if (tmp___0 == 0) {
        {
        {
#line 164
        fputs((char const   */* __restrict  */)old_prefix_to_add, (FILE */* __restrict  */)stdout);
        }
        }
      }
    }
#line 165
    if (new_prefix_to_add) {
      {
      {
#line 165
      tmp___1 = strncmp(line, "+++", (size_t )3);
      }
      }
#line 165
      if (tmp___1 == 0) {
        {
        {
#line 166
        fputs((char const   */* __restrict  */)new_prefix_to_add, (FILE */* __restrict  */)stdout);
        }
        }
      }
    }
  }
  {
  {
#line 169
  fn = xstrndup(line + 4, (size_t const   )h);
  }
  {
#line 170
  tmp___2 = stripped((char const   *)fn, strip_components);
  }
  {
#line 170
  fputs((char const   */* __restrict  */)tmp___2, (FILE */* __restrict  */)stdout);
  }
  }
#line 171
  if (removing_timestamp) {
    {
    {
#line 172
    putchar('\n');
    }
    }
  } else {
    {
    {
#line 174
    fputs((char const   */* __restrict  */)((line + 4) + h), (FILE */* __restrict  */)stdout);
    }
    }
  }
  {
  {
#line 176
  free((void *)fn);
  }
  }
#line 177
  return (0);
}
}
#line 180 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int file_matches(void) 
{ 
  int f ;
  struct range *r ;

  {
#line 183
  f = 0;
#line 188
  r = files;
  {
  {
#line 188
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 188
    if (! r) {
#line 188
      goto while_break;
    }
#line 189
    if (r->start == 0xffffffffffffffffUL) {
#line 189
      goto _L;
    } else
#line 189
    if (r->start <= filecount) {
      _L: /* CIL Label */ 
#line 189
      if (r->end == 0xffffffffffffffffUL) {
#line 193
        f = 1;
#line 194
        goto while_break;
      } else
#line 189
      if (filecount <= r->end) {
#line 193
        f = 1;
#line 194
        goto while_break;
      }
    }
#line 188
    r = r->next;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 197
  if (files) {
#line 197
    if (! f) {
#line 198
      return (0);
    }
  }
#line 200
  return (1);
}
}
#line 203 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void display_filename(unsigned long linenum___1 , char status , char const   *filename ,
                             char const   *patchname ) 
{ 
  int tmp ;
  char const   *tmp___0 ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;

  {
#line 206
  if ((unsigned int )mode___0 == 1U) {
    {
    {
#line 206
    tmp = file_matches();
    }
    }
#line 206
    if (! tmp) {
#line 209
      return;
    }
  }
#line 211
  if (print_patchnames) {
    {
    {
#line 212
    printf((char const   */* __restrict  */)"%s:", patchname);
    }
    }
  }
#line 213
  if (numbering) {
    {
    {
#line 214
    printf((char const   */* __restrict  */)"%lu\t", linenum___1);
    }
    }
  }
#line 215
  if (number_files) {
    {
    {
#line 216
    printf((char const   */* __restrict  */)"File #%-3lu\t", filecount);
    }
    }
  }
#line 217
  if (show_status) {
    {
    {
#line 218
    printf((char const   */* __restrict  */)"%c ", (int )status);
    }
    }
  }
#line 219
  if (prefix_to_add) {
    {
    {
#line 220
    fputs((char const   */* __restrict  */)prefix_to_add, (FILE */* __restrict  */)stdout);
    }
    }
  }
  {
  {
#line 221
  tmp___0 = stripped(filename, strip_components);
  }
  {
#line 221
  puts(tmp___0);
  }
  }
#line 222
  return;
}
}
#line 224 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int hunk_matches(unsigned long orig_offset , unsigned long orig_count , unsigned long hunknum ) 
{ 
  int h ;
  int l ;
  struct range *r ;
  int tmp ;

  {
  {
#line 228
  h = 0;
#line 228
  l = 0;
  {
#line 232
  tmp = file_matches();
  }
  }
#line 232
  if (! tmp) {
#line 233
    return (0);
  }
#line 237
  if (! orig_count) {
#line 238
    orig_count = 1UL;
  }
#line 242
  r = hunks;
  {
  {
#line 242
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 242
    if (! r) {
#line 242
      goto while_break;
    }
#line 243
    if (r->start == 0xffffffffffffffffUL) {
#line 243
      goto _L;
    } else
#line 243
    if (r->start <= hunknum) {
      _L: /* CIL Label */ 
#line 243
      if (r->end == 0xffffffffffffffffUL) {
#line 247
        h = 1;
#line 248
        goto while_break;
      } else
#line 243
      if (hunknum <= r->end) {
#line 247
        h = 1;
#line 248
        goto while_break;
      }
    }
#line 242
    r = r->next;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 253
  r = lines;
  {
  {
#line 253
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 253
    if (! r) {
#line 253
      goto while_break___0;
    }
#line 254
    if (r->start == 0xffffffffffffffffUL) {
#line 254
      goto _L___0;
    } else
#line 254
    if (r->start < orig_offset + orig_count) {
      _L___0: /* CIL Label */ 
#line 254
      if (r->end == 0xffffffffffffffffUL) {
#line 258
        l = 1;
#line 259
        goto while_break___0;
      } else
#line 254
      if (r->end >= orig_offset) {
#line 258
        l = 1;
#line 259
        goto while_break___0;
      }
    }
#line 253
    r = r->next;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 262
  if (hunks) {
#line 262
    if (! h) {
#line 263
      return (0);
    }
  }
#line 265
  if (lines) {
#line 265
    if (! l) {
#line 266
      return (0);
    }
  }
#line 268
  return (1);
}
}
#line 271 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int do_unified(FILE *f , char **header , int match , char **line , size_t *linelen ,
                      unsigned long *linenum___1 , unsigned long start_linenum , char status ,
                      char const   *bestname , char const   *patchname , int *orig_file_exists ,
                      int *new_file_exists ) 
{ 
  unsigned long orig_count ;
  unsigned long new_count ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  unsigned long hunknum ;
  unsigned long track_linenum ;
  int header_displayed ;
  int hunk_match ;
  long munge_offset ;
  int displayed_filename ;
  unsigned long last_hunkmatch ;
  unsigned long hunk_linenum ;
  FILE *match_tmpf ;
  int grepmatch ;
  long delayed_munge ;
  int ret ;
  int orig_is_empty ;
  int new_is_empty ;
  ssize_t got ;
  __ssize_t tmp ;
  char *trailing ;
  int tmp___0 ;
  int tmp___1 ;
  size_t tmp___2 ;
  size_t tmp___3 ;
  char *p ;
  int first_hunk ;
  FILE *output_to ;
  int ch ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  FILE *output_to___0 ;
  unsigned long tmp___7 ;
  char *__cil_tmp47 ;
  char *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;

  {
#line 279
  orig_count = 0UL;
#line 279
  new_count = 0UL;
#line 281
  hunknum = 0UL;
#line 282
  track_linenum = 0UL;
#line 283
  header_displayed = 0;
#line 284
  hunk_match = match;
#line 285
  munge_offset = 0L;
#line 286
  displayed_filename = 0;
#line 287
  last_hunkmatch = 0UL;
#line 288
  hunk_linenum = *linenum___1;
#line 289
  match_tmpf = (FILE *)((void *)0);
#line 290
  grepmatch = 0;
#line 291
  delayed_munge = 0L;
#line 292
  ret = 0;
#line 293
  orig_is_empty = 1;
#line 293
  new_is_empty = 1;
#line 295
  if ((unsigned int )output_matching == 2U) {
    {
    {
#line 296
    match_tmpf = xtmpfile();
    }
    }
  }
  {
  {
#line 298
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 299
    tmp = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                  (FILE */* __restrict  */)f);
    }
#line 299
    got = tmp;
    }
#line 300
    if (got == -1) {
#line 301
      ret = -1;
#line 302
      goto out;
    }
#line 304
    (*linenum___1) ++;
#line 306
    if (! orig_count) {
#line 306
      if (! new_count) {
#line 306
        if ((int )*(*line) != 92) {
          {
          {
#line 309
          tmp___0 = strncmp((char const   *)*line, "@@ ", (size_t )3);
          }
          }
#line 309
          if (tmp___0) {
#line 310
            goto while_break;
          }
#line 313
          hunknum ++;
#line 314
          hunk_linenum = *linenum___1;
#line 316
          if ((unsigned int )output_matching == 1U) {
#line 316
            if (! grepmatch) {
#line 320
              munge_offset += delayed_munge;
            }
          }
#line 322
          if ((unsigned int )output_matching != 2U) {
#line 323
            grepmatch = 0;
          }
#line 324
          if ((unsigned int )output_matching == 1U) {
#line 325
            if (match_tmpf) {
              {
              {
#line 326
              fclose(match_tmpf);
              }
              }
            }
            {
            {
#line 327
            match_tmpf = xtmpfile();
            }
            }
          }
          {
          {
#line 330
          tmp___1 = read_atatline((char const   *)*line, & orig_offset, & orig_count,
                                  & new_offset, & new_count);
          }
          }
#line 330
          if (tmp___1) {
            {
            {
#line 332
            error(1, 0, "line not understood: %s", *line);
            }
            }
          }
#line 335
          if (orig_count) {
#line 336
            orig_is_empty = 0;
          }
#line 337
          if (new_count) {
#line 338
            new_is_empty = 0;
          }
#line 341
          if (match) {
            {
            {
#line 342
            hunk_match = hunk_matches(orig_offset, orig_count, hunknum);
            }
            }
          } else {
#line 345
            hunk_match = 0;
          }
          {
          {
#line 347
          trailing = strchr((char const   *)*line, '+');
          }
          {
#line 348
          tmp___2 = strcspn((char const   *)trailing, " \n");
          }
#line 348
          trailing += tmp___2;
          }
#line 349
          if ((int )*trailing == 32) {
#line 350
            trailing ++;
          }
          {
          {
#line 351
          tmp___3 = strspn((char const   *)trailing, "@");
          }
#line 351
          trailing += tmp___3;
          }
#line 353
          if (hunk_match) {
#line 353
            if (numbering) {
#line 353
              if (verbose) {
#line 353
                if ((unsigned int )mode___0 != 2U) {
#line 355
                  if (print_patchnames) {
                    {
                    {
#line 356
                    printf((char const   */* __restrict  */)"%s-", patchname);
                    }
                    }
                  }
                  {
                  {
#line 357
                  printf((char const   */* __restrict  */)"\t%lu\tHunk #%lu", hunk_linenum,
                         hunknum);
                  }
                  }
#line 359
                  if (verbose > 1) {
#line 360
                    p = trailing;
#line 361
                    if ((int )*p != 10) {
#line 362
                      p ++;
                    }
                    {
                    {
#line 363
                    printf((char const   */* __restrict  */)"\t%s", p);
                    }
                    }
                  } else {
                    {
                    {
#line 365
                    putchar('\n');
                    }
                    }
                  }
                }
              }
            }
          }
#line 368
          if (hunk_match) {
#line 368
            if ((unsigned int )mode___0 == 0U) {
#line 368
              goto _L___0;
            } else
#line 368
            if ((unsigned int )output_matching != 0U) {
              _L___0: /* CIL Label */ 
#line 371
              first_hunk = ! header_displayed;
#line 372
              output_to = stdout;
#line 374
              if ((unsigned int )mode___0 == 2U) {
#line 375
                delayed_munge = (long )(orig_count - new_count);
#line 376
                if (! grepmatch) {
#line 377
                  output_to = match_tmpf;
                }
              }
#line 380
              if (! header_displayed) {
#line 380
                if ((unsigned int )mode___0 != 2U) {
#line 383
                  if ((unsigned int )number_lines != 2U) {
                    {
                    {
#line 384
                    output_header_line((char const   *)*(header + 0));
                    }
                    }
                  }
#line 385
                  if ((unsigned int )number_lines != 1U) {
                    {
                    {
#line 386
                    output_header_line((char const   *)*(header + 1));
                    }
                    }
                  }
#line 387
                  header_displayed = 1;
                }
              }
              {
#line 390
              if ((unsigned int )number_lines == 0U) {
#line 390
                goto case_0;
              }
#line 414
              if ((unsigned int )number_lines == 1U) {
#line 414
                goto case_1;
              }
#line 422
              if ((unsigned int )number_lines == 2U) {
#line 422
                goto case_2;
              }
#line 389
              goto switch_break;
              case_0: /* CIL Label */ 
              {
              {
#line 395
              fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)"@@ -%lu",
                      orig_offset);
              }
              }
#line 397
              if (orig_count != 1UL) {
                {
                {
#line 398
                fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)",%lu",
                        orig_count);
                }
                }
              }
              {
              {
#line 400
              fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)" +%lu",
                      new_offset + (unsigned long )munge_offset);
              }
              }
#line 402
              if (new_count != 1UL) {
                {
                {
#line 403
                fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)",%lu",
                        new_count);
                }
                }
              }
              {
              {
#line 405
              fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)" @@");
              }
              }
#line 407
              if (annotating) {
                {
                {
#line 408
                fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)" Hunk #%lu, %s",
                        hunknum, bestname);
                }
                }
              }
              {
              {
#line 412
              fputs((char const   */* __restrict  */)trailing, (FILE */* __restrict  */)output_to);
              }
              }
#line 413
              goto switch_break;
              case_1: /* CIL Label */ 
#line 416
              track_linenum = orig_offset;
#line 417
              if (! first_hunk) {
                {
                {
#line 420
                fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
                }
                }
              } else
#line 417
              if ((unsigned int )output_matching == 2U) {
#line 417
                if (hunknum > 1UL) {
                  {
                  {
#line 420
                  fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
                  }
                  }
                }
              }
#line 421
              goto switch_break;
              case_2: /* CIL Label */ 
#line 424
              track_linenum = new_offset + (unsigned long )munge_offset;
#line 426
              if (! first_hunk) {
                {
                {
#line 429
                fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
                }
                }
              } else
#line 426
              if ((unsigned int )output_matching == 2U) {
#line 426
                if (hunknum > 1UL) {
                  {
                  {
#line 429
                  fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
                  }
                  }
                }
              }
#line 430
              goto switch_break;
              switch_break: /* CIL Label */ ;
              }
            } else {
#line 368
              goto _L;
            }
          } else
          _L: /* CIL Label */ 
#line 432
          if ((unsigned int )mode___0 == 0U) {
#line 436
            munge_offset = (long )((unsigned long )munge_offset + (orig_count - new_count));
          }
#line 438
          goto __Cont;
        }
      }
    }
#line 441
    if ((int )*(*line) != 92) {
#line 442
      if (orig_count) {
#line 442
        if ((int )*(*line) != 43) {
#line 443
          orig_count --;
        }
      }
#line 444
      if (new_count) {
#line 444
        if ((int )*(*line) != 45) {
#line 445
          new_count --;
        }
      }
    }
#line 448
    if (hunk_match) {
#line 448
      if ((unsigned int )mode___0 == 2U) {
        {
        {
#line 448
        tmp___6 = regexecs(regex, num_regex, (char const   *)(*line + 1), (size_t )0,
                           (regmatch_t *)((void *)0), 0);
        }
        }
#line 448
        if (! tmp___6) {
#line 450
          if ((unsigned int )output_matching == 0U) {
#line 451
            if (! displayed_filename) {
              {
#line 452
              displayed_filename = 1;
              {
#line 453
              display_filename(start_linenum, status, bestname, patchname);
              }
              }
            }
#line 458
            if (numbering) {
#line 458
              if (verbose) {
#line 458
                if (hunknum > last_hunkmatch) {
#line 460
                  last_hunkmatch = hunknum;
#line 461
                  if (print_patchnames) {
                    {
                    {
#line 462
                    printf((char const   */* __restrict  */)"%s-", patchname);
                    }
                    }
                  }
                  {
                  {
#line 463
                  printf((char const   */* __restrict  */)"\t%lu\tHunk #%lu\n", hunk_linenum,
                         hunknum);
                  }
                  }
                }
              }
            }
          } else {
#line 467
            if (match_tmpf) {
#line 468
              if (! header_displayed) {
#line 468
                if ((unsigned int )number_lines != 2U) {
                  {
                  {
#line 470
                  output_header_line((char const   *)*(header + 0));
                  }
                  }
                }
              }
#line 472
              if (! header_displayed) {
#line 472
                if ((unsigned int )number_lines != 1U) {
                  {
                  {
#line 474
                  output_header_line((char const   *)*(header + 1));
                  }
                  }
                }
              }
#line 476
              if (! header_displayed) {
#line 477
                header_displayed = 1;
              }
              {
              {
#line 479
              rewind(match_tmpf);
              }
              }
              {
              {
#line 480
              while (1) {
                while_continue___2: /* CIL Label */ ;
                while_continue___0: /* CIL Label */ ;
                {
                {
#line 480
                tmp___5 = feof(match_tmpf);
                }
                }
#line 480
                if (tmp___5) {
#line 480
                  goto while_break___0;
                }
                {
                {
#line 481
                tmp___4 = fgetc(match_tmpf);
                }
#line 481
                ch = tmp___4;
                }
#line 482
                if (ch == -1) {
#line 483
                  goto while_break___0;
                }
                {
                {
#line 484
                putchar(ch);
                }
                }
              }
              while_break___2: /* CIL Label */ ;
              }
              while_break___0: /* CIL Label */ ;
              }
              {
              {
#line 486
              fclose(match_tmpf);
              }
#line 487
              match_tmpf = (FILE *)((void *)0);
              }
            }
#line 489
            grepmatch = 1;
          }
        }
      }
    }
#line 493
    if (hunk_match) {
#line 493
      if ((unsigned int )mode___0 == 0U) {
#line 493
        goto _L___2;
      } else
#line 493
      if ((unsigned int )output_matching != 0U) {
        _L___2: /* CIL Label */ 
#line 496
        output_to___0 = stdout;
#line 497
        if ((unsigned int )mode___0 == 2U) {
#line 497
          if (! grepmatch) {
#line 498
            output_to___0 = match_tmpf;
          }
        }
#line 499
        if ((unsigned int )number_lines == 0U) {
          {
          {
#line 501
          fwrite((void const   */* __restrict  */)*line, (size_t )got, (size_t )1,
                 (FILE */* __restrict  */)output_to___0);
          }
          }
        } else
#line 502
        if ((unsigned int )number_lines == 1U) {
#line 502
          if ((int )*(*line) != 43) {
            {
#line 505
            tmp___7 = track_linenum;
#line 505
            track_linenum ++;
            {
#line 505
            fprintf((FILE */* __restrict  */)output_to___0, (char const   */* __restrict  */)"%lu\t:%s",
                    tmp___7, *line + 1);
            }
            }
          } else {
#line 502
            goto _L___1;
          }
        } else
        _L___1: /* CIL Label */ 
#line 502
        if ((unsigned int )number_lines == 2U) {
#line 502
          if ((int )*(*line) != 45) {
            {
#line 505
            tmp___7 = track_linenum;
#line 505
            track_linenum ++;
            {
#line 505
            fprintf((FILE */* __restrict  */)output_to___0, (char const   */* __restrict  */)"%lu\t:%s",
                    tmp___7, *line + 1);
            }
            }
          }
        }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  out: 
#line 511
  if (match_tmpf) {
    {
    {
#line 512
    fclose(match_tmpf);
    }
    }
  }
#line 514
  if (empty_files_as_absent) {
#line 515
    if ((unsigned long )orig_file_exists != (unsigned long )((void *)0)) {
#line 515
      if (orig_is_empty) {
#line 516
        *orig_file_exists = 0;
      }
    }
#line 517
    if ((unsigned long )new_file_exists != (unsigned long )((void *)0)) {
#line 517
      if (new_is_empty) {
#line 518
        *new_file_exists = 0;
      }
    }
  }
#line 521
  return (ret);
}
}
#line 524 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int do_context(FILE *f , char **header , int match , char **line , size_t *linelen ,
                      unsigned long *linenum___1 , unsigned long start_linenum , char status ,
                      char const   *bestname , char const   *patchname , int *orig_file_exists ,
                      int *new_file_exists ) 
{ 
  unsigned long line_start ;
  unsigned long line_end ;
  unsigned long line_count ;
  unsigned long hunknum ;
  unsigned long track_linenum ;
  unsigned long changed[2] ;
  long munge_offset ;
  int header_displayed ;
  char *n ;
  char *end ;
  int i ;
  int hunk_match ;
  int displayed_filename ;
  unsigned long last_hunkmatch ;
  unsigned long hunk_linenum ;
  FILE *match_tmpf ;
  int grepmatch ;
  int ret ;
  unsigned long unchanged ;
  int first_hunk ;
  int orig_is_empty ;
  int new_is_empty ;
  __ssize_t tmp ;
  int tmp___0 ;
  int first ;
  __ssize_t tmp___1 ;
  int tmp___2 ;
  char const   *tmp___3 ;
  int tmp___4 ;
  FILE *output_to ;
  ssize_t got ;
  __ssize_t tmp___5 ;
  int ch ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  FILE *output_to___0 ;
  unsigned long tmp___9 ;
  unsigned long tmp___10 ;
  void *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;

  {
  {
#line 533
  hunknum = 0UL;
#line 534
  track_linenum = 0UL;
#line 536
  munge_offset = 0L;
#line 537
  header_displayed = 0;
#line 540
  hunk_match = 0;
#line 541
  displayed_filename = 0;
#line 542
  last_hunkmatch = 0UL;
#line 543
  hunk_linenum = *linenum___1;
#line 544
  match_tmpf = (FILE *)((void *)0);
#line 545
  grepmatch = 0;
#line 546
  ret = 0;
#line 548
  first_hunk = 0;
#line 549
  orig_is_empty = 1;
#line 549
  new_is_empty = 1;
  {
#line 563
  tmp = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                (FILE */* __restrict  */)f);
  }
  }
#line 563
  if (tmp == -1) {
#line 564
    return (-1);
  }
  {
#line 565
  (*linenum___1) ++;
  {
#line 567
  tmp___0 = strncmp((char const   *)*line, "***************", (size_t )15);
  }
  }
#line 567
  if (tmp___0) {
#line 568
    return (1);
  }
#line 570
  if ((unsigned int )output_matching == 2U) {
    {
    {
#line 571
    match_tmpf = xtmpfile();
    }
    }
  }
  next_hunk: 
#line 574
  unchanged = 0UL;
#line 575
  changed[1] = 0UL;
#line 575
  changed[0] = changed[1];
#line 577
  i = 0;
  {
  {
#line 577
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 577
    if (! (i < 2)) {
#line 577
      goto while_break;
    }
#line 578
    first = 1;
#line 580
    if (i == 0) {
#line 581
      first_hunk = ! header_displayed;
    }
    {
    {
#line 583
    tmp___1 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                      (FILE */* __restrict  */)f);
    }
    }
#line 583
    if (tmp___1 == -1) {
#line 584
      ret = -1;
#line 585
      goto out;
    }
#line 588
    (*linenum___1) ++;
#line 590
    if (! i) {
      {
      {
#line 590
      tmp___2 = strncmp((char const   *)*line, "***************", (size_t )15);
      }
      }
#line 590
      if (! tmp___2) {
#line 594
        i --;
#line 595
        goto __Cont;
      }
    }
#line 598
    if (i) {
#line 598
      tmp___3 = "--- ";
    } else {
#line 598
      tmp___3 = "*** ";
    }
    {
    {
#line 598
    tmp___4 = strncmp((char const   *)*line, tmp___3, (size_t )4);
    }
    }
#line 598
    if (tmp___4) {
#line 599
      ret = 1;
#line 600
      goto out;
    }
#line 603
    if (! i) {
#line 604
      hunknum ++;
#line 605
      hunk_linenum = *linenum___1;
#line 606
      if ((unsigned int )output_matching != 2U) {
#line 607
        grepmatch = 0;
      }
#line 608
      if ((unsigned int )output_matching == 1U) {
#line 609
        if (match_tmpf) {
          {
          {
#line 610
          fclose(match_tmpf);
          }
          }
        }
        {
        {
#line 611
        match_tmpf = xtmpfile();
        }
        }
      }
    }
    do_line_counts: 
    {
#line 616
    n = *line + 4;
    {
#line 617
    line_start = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                         10);
    }
    }
#line 618
    if ((unsigned long )n == (unsigned long )end) {
#line 619
      ret = 1;
#line 620
      goto out;
    }
#line 623
    if ((int )*end == 44) {
      {
#line 624
      n = end + 1;
      {
#line 625
      line_end = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                         10);
      }
      }
#line 626
      if ((unsigned long )n == (unsigned long )end) {
#line 627
        ret = 1;
#line 628
        goto out;
      }
#line 631
      if (line_start > line_end) {
#line 632
        ret = 1;
#line 633
        goto out;
      }
#line 636
      line_count = (line_end - line_start) + 1UL;
    } else {
#line 638
      line_end = line_start;
#line 639
      if (line_start) {
#line 639
        line_count = 1UL;
      } else {
#line 639
        line_count = 0UL;
      }
    }
    {
    {
#line 642
    n = strchr((char const   *)n, '*');
    }
    }
#line 643
    if (n) {
#line 644
      n += 4;
    }
#line 646
    if (! i) {
#line 647
      if (match) {
        {
        {
#line 648
        hunk_match = hunk_matches(line_start, line_count, hunknum);
        }
        }
      } else {
#line 651
        hunk_match = 0;
      }
#line 653
      if (hunk_match) {
#line 653
        if (numbering) {
#line 653
          if (verbose) {
#line 653
            if ((unsigned int )mode___0 != 2U) {
#line 655
              if (print_patchnames) {
                {
                {
#line 656
                printf((char const   */* __restrict  */)"%s-", patchname);
                }
                }
              }
              {
              {
#line 657
              printf((char const   */* __restrict  */)"\t%lu\tHunk #%lu\n", hunk_linenum,
                     hunknum);
              }
              }
            }
          }
        }
      }
    }
#line 662
    if (hunk_match) {
#line 662
      if ((unsigned int )mode___0 == 0U) {
#line 662
        goto _L;
      } else
#line 662
      if ((unsigned int )output_matching != 0U) {
        _L: /* CIL Label */ 
#line 664
        output_to = stdout;
#line 666
        if ((unsigned int )mode___0 == 2U) {
#line 666
          if (! grepmatch) {
#line 667
            output_to = match_tmpf;
          }
        }
#line 670
        if (! header_displayed) {
#line 670
          if ((unsigned int )mode___0 == 0U) {
#line 671
            if ((unsigned int )number_lines != 2U) {
              {
              {
#line 672
              output_header_line((char const   *)*(header + 0));
              }
              }
            }
#line 673
            if ((unsigned int )number_lines != 1U) {
              {
              {
#line 674
              output_header_line((char const   *)*(header + 1));
              }
              }
            }
#line 675
            header_displayed = 1;
          }
        }
#line 678
        if ((unsigned int )number_lines == 0U) {
          {
#line 679
          if (i == 0) {
#line 679
            goto case_0;
          }
#line 696
          if (i == 1) {
#line 696
            goto case_1;
          }
#line 678
          goto switch_break;
          case_0: /* CIL Label */ 
          {
          {
#line 680
          fputs((char const   */* __restrict  */)"***************\n", (FILE */* __restrict  */)output_to);
          }
          {
#line 681
          fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)"*** %lu",
                  line_start);
          }
          }
#line 682
          if (line_end != line_start) {
            {
            {
#line 683
            fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)",%lu",
                    line_end);
            }
            }
          }
          {
          {
#line 684
          fputs((char const   */* __restrict  */)" ****", (FILE */* __restrict  */)output_to);
          }
          }
#line 686
          if (annotating) {
            {
            {
#line 687
            fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)" Hunk #%lu, %s\n",
                    hunknum, bestname);
            }
            }
          } else
#line 690
          if (n) {
            {
            {
#line 691
            fputs((char const   */* __restrict  */)n, (FILE */* __restrict  */)output_to);
            }
            }
          } else {
            {
            {
#line 693
            fputc('\n', output_to);
            }
            }
          }
#line 695
          goto switch_break;
          case_1: /* CIL Label */ 
          {
          {
#line 697
          fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)"--- %lu",
                  line_start + (unsigned long )munge_offset);
          }
          }
#line 699
          if (line_end != line_start) {
            {
            {
#line 700
            fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)",%lu",
                    line_end + (unsigned long )munge_offset);
            }
            }
          }
          {
          {
#line 702
          fputs((char const   */* __restrict  */)" ----\n", (FILE */* __restrict  */)output_to);
          }
          }
#line 703
          goto switch_break;
          switch_break: /* CIL Label */ ;
          }
        }
        {
#line 707
        if ((unsigned int )number_lines == 0U) {
#line 707
          goto case_0___0;
        }
#line 710
        if ((unsigned int )number_lines == 1U) {
#line 710
          goto case_1___0;
        }
#line 722
        if ((unsigned int )number_lines == 2U) {
#line 722
          goto case_2;
        }
#line 706
        goto switch_break___0;
        case_0___0: /* CIL Label */ 
#line 708
        goto switch_break___0;
        case_1___0: /* CIL Label */ 
#line 711
        if (i != 0) {
#line 712
          goto switch_break___0;
        }
#line 715
        track_linenum = line_start;
#line 716
        if (! first_hunk) {
          {
          {
#line 719
          fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
          }
          }
        } else
#line 716
        if ((unsigned int )output_matching == 2U) {
#line 716
          if (hunknum > 1UL) {
            {
            {
#line 719
            fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
            }
            }
          }
        }
#line 720
        goto switch_break___0;
        case_2: /* CIL Label */ 
#line 723
        if (i != 1) {
#line 724
          goto switch_break___0;
        }
#line 726
        track_linenum = line_start + (unsigned long )munge_offset;
#line 727
        if (! first_hunk) {
          {
          {
#line 730
          fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
          }
          }
        } else
#line 727
        if ((unsigned int )output_matching == 2U) {
#line 727
          if (hunknum > 1UL) {
            {
            {
#line 730
            fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
            }
            }
          }
        }
#line 731
        goto switch_break___0;
        switch_break___0: /* CIL Label */ ;
        }
      }
    }
#line 735
    if (i) {
#line 735
      if (line_count == unchanged) {
#line 736
        goto while_break;
      }
    }
    {
    {
#line 738
    while (1) {
      while_continue___3: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 738
      tmp___10 = line_count;
#line 738
      line_count --;
#line 738
      if (! tmp___10) {
#line 738
        goto while_break___0;
      }
      {
      {
#line 739
      tmp___5 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                        (FILE */* __restrict  */)f);
      }
#line 739
      got = tmp___5;
      }
#line 740
      if (got == -1) {
#line 741
        ret = -1;
#line 742
        goto out;
      }
#line 745
      (*linenum___1) ++;
#line 747
      if (hunk_match) {
#line 747
        if ((unsigned int )mode___0 == 2U) {
          {
          {
#line 747
          tmp___7 = regexecs(regex, num_regex, (char const   *)(*line + 2), (size_t )0,
                             (regmatch_t *)((void *)0), 0);
          }
          }
#line 747
          if (! tmp___7) {
#line 750
            if ((unsigned int )output_matching == 0U) {
#line 751
              if (! displayed_filename) {
                {
#line 752
                displayed_filename = 1;
                {
#line 753
                display_filename(start_linenum, status, bestname, patchname);
                }
                }
              }
#line 759
              if (numbering) {
#line 759
                if (verbose) {
#line 759
                  if (hunknum > last_hunkmatch) {
#line 761
                    last_hunkmatch = hunknum;
#line 762
                    if (print_patchnames) {
                      {
                      {
#line 763
                      printf((char const   */* __restrict  */)"%s-", patchname);
                      }
                      }
                    }
                    {
                    {
#line 765
                    printf((char const   */* __restrict  */)"\t%lu\tHunk #%lu\n",
                           hunk_linenum, hunknum);
                    }
                    }
                  }
                }
              }
            } else {
#line 769
              if (! header_displayed) {
#line 770
                if ((unsigned int )number_lines != 2U) {
                  {
                  {
#line 771
                  output_header_line((char const   *)*(header + 0));
                  }
                  }
                }
#line 772
                if ((unsigned int )number_lines != 1U) {
                  {
                  {
#line 773
                  output_header_line((char const   *)*(header + 1));
                  }
                  }
                }
#line 774
                header_displayed = 1;
              }
#line 777
              if (match_tmpf) {
                {
                {
#line 778
                rewind(match_tmpf);
                }
                }
                {
                {
#line 779
                while (1) {
                  while_continue___4: /* CIL Label */ ;
                  while_continue___1: /* CIL Label */ ;
                  {
                  {
#line 779
                  tmp___6 = feof(match_tmpf);
                  }
                  }
#line 779
                  if (tmp___6) {
#line 779
                    goto while_break___1;
                  }
                  {
                  {
#line 781
                  ch = fgetc(match_tmpf);
                  }
                  }
#line 782
                  if (ch == -1) {
#line 783
                    goto while_break___1;
                  }
                  {
                  {
#line 784
                  putchar(ch);
                  }
                  }
                }
                while_break___4: /* CIL Label */ ;
                }
                while_break___1: /* CIL Label */ ;
                }
                {
                {
#line 786
                fclose(match_tmpf);
                }
#line 787
                match_tmpf = (FILE *)((void *)0);
                }
              }
#line 790
              grepmatch = 1;
            }
          }
        }
      }
#line 794
      if (! i) {
#line 794
        if (first) {
          {
#line 795
          first = 0;
          {
#line 796
          tmp___8 = strncmp((char const   *)*line, "--- ", (size_t )4);
          }
          }
#line 796
          if (! tmp___8) {
#line 799
            i ++;
#line 800
            goto do_line_counts;
          }
        }
      }
#line 804
      if ((int )*(*line) == 32) {
#line 805
        unchanged ++;
      }
#line 807
      if (empty_files_as_absent) {
        {
#line 809
        if ((int )*(*line) == 33) {
#line 809
          goto case_33;
        }
#line 809
        if ((int )*(*line) == 32) {
#line 809
          goto case_33;
        }
#line 812
        if ((int )*(*line) == 43) {
#line 812
          goto case_43;
        }
#line 815
        if ((int )*(*line) == 45) {
#line 815
          goto case_45;
        }
#line 807
        goto switch_break___1;
        case_33: /* CIL Label */ 
        case_32: /* CIL Label */ 
#line 810
        orig_is_empty = 0;
#line 810
        new_is_empty = orig_is_empty;
#line 811
        goto switch_break___1;
        case_43: /* CIL Label */ 
#line 813
        new_is_empty = 0;
#line 814
        goto switch_break___1;
        case_45: /* CIL Label */ 
#line 816
        orig_is_empty = 0;
#line 817
        goto switch_break___1;
        switch_break___1: /* CIL Label */ ;
        }
      }
#line 820
      if (hunk_match) {
#line 820
        if ((unsigned int )mode___0 == 0U) {
#line 820
          goto _L___1;
        } else
#line 820
        if ((unsigned int )output_matching != 0U) {
          _L___1: /* CIL Label */ 
#line 823
          output_to___0 = stdout;
#line 824
          if ((unsigned int )mode___0 == 2U) {
#line 824
            if (! grepmatch) {
#line 825
              output_to___0 = match_tmpf;
            }
          }
#line 827
          if ((unsigned int )number_lines == 0U) {
            {
            {
#line 828
            fwrite((void const   */* __restrict  */)*line, (size_t )got, (size_t )1,
                   (FILE */* __restrict  */)output_to___0);
            }
            }
          } else
#line 830
          if ((unsigned int )number_lines == 1U) {
#line 830
            if (! i) {
              {
#line 832
              tmp___9 = track_linenum;
#line 832
              track_linenum ++;
              {
#line 832
              fprintf((FILE */* __restrict  */)output_to___0, (char const   */* __restrict  */)"%lu\t:",
                      tmp___9);
              }
              {
#line 834
              fwrite((void const   */* __restrict  */)(*line + 2), (size_t )got - 2U,
                     (size_t )1, (FILE */* __restrict  */)output_to___0);
              }
              }
            } else {
#line 830
              goto _L___0;
            }
          } else
          _L___0: /* CIL Label */ 
#line 830
          if ((unsigned int )number_lines == 2U) {
#line 830
            if (i) {
              {
#line 832
              tmp___9 = track_linenum;
#line 832
              track_linenum ++;
              {
#line 832
              fprintf((FILE */* __restrict  */)output_to___0, (char const   */* __restrict  */)"%lu\t:",
                      tmp___9);
              }
              {
#line 834
              fwrite((void const   */* __restrict  */)(*line + 2), (size_t )got - 2U,
                     (size_t )1, (FILE */* __restrict  */)output_to___0);
              }
              }
            }
          }
        }
      }
#line 839
      if ((unsigned int )mode___0 == 0U) {
#line 839
        if (! hunk_match) {
#line 839
          goto _L___2;
        } else {
#line 839
          goto _L___3;
        }
      } else
      _L___3: /* CIL Label */ 
#line 839
      if ((unsigned int )output_matching == 1U) {
        _L___2: /* CIL Label */ 
        {
#line 842
        if ((int )*(*line) == 33) {
#line 842
          goto case_33___0;
        }
#line 845
        if ((int )*(*line) == 43) {
#line 845
          goto case_43___0;
        }
#line 848
        if ((int )*(*line) == 45) {
#line 848
          goto case_45___0;
        }
#line 841
        goto switch_break___2;
        case_33___0: /* CIL Label */ 
#line 843
        (changed[i]) ++;
#line 844
        goto switch_break___2;
        case_43___0: /* CIL Label */ 
#line 846
        (changed[1]) ++;
#line 847
        goto switch_break___2;
        case_45___0: /* CIL Label */ 
#line 849
        (changed[0]) ++;
#line 850
        goto switch_break___2;
        switch_break___2: /* CIL Label */ ;
        }
      }
    }
    while_break___3: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    __Cont: /* CIL Label */ 
#line 577
    i ++;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 855
  if ((unsigned int )output_matching != 1U) {
#line 856
    munge_offset = (long )((unsigned long )munge_offset + (changed[0] - changed[1]));
  } else
#line 855
  if (! grepmatch) {
#line 856
    munge_offset = (long )((unsigned long )munge_offset + (changed[0] - changed[1]));
  }
#line 857
  goto next_hunk;
  out: 
#line 860
  if (match_tmpf) {
    {
    {
#line 861
    fclose(match_tmpf);
    }
    }
  }
#line 863
  if (empty_files_as_absent) {
#line 864
    if ((unsigned long )orig_file_exists != (unsigned long )((void *)0)) {
#line 864
      if (orig_is_empty) {
#line 865
        *orig_file_exists = 0;
      }
    }
#line 866
    if ((unsigned long )new_file_exists != (unsigned long )((void *)0)) {
#line 866
      if (new_is_empty) {
#line 867
        *new_file_exists = 0;
      }
    }
  }
#line 870
  return (ret);
}
}
#line 875
static int filterdiff(FILE *f , char const   *patchname ) ;
#line 875 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static unsigned long linenum  =    1UL;
#line 873 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int filterdiff(FILE *f , char const   *patchname ) 
{ 
  char *names[2] ;
  char *header[2] ;
  char *line ;
  size_t linelen ;
  char *p ;
  char const   *p_stripped ;
  int match ;
  int i ;
  __ssize_t tmp ;
  char status ;
  unsigned long start_linenum ;
  int orig_file_exists ;
  int new_file_exists ;
  int is_context ;
  int result ;
  int (*do_diff)(FILE * , char ** , int  , char ** , size_t * , unsigned long * ,
                 unsigned long  , char  , char const   * , char const   * , int * ,
                 int * ) ;
  int tmp___0 ;
  int tmp___1 ;
  __ssize_t tmp___2 ;
  size_t tmp___3 ;
  __ssize_t tmp___4 ;
  char const   *tmp___5 ;
  int tmp___6 ;
  size_t tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  void *__cil_tmp29 ;
  void *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;

  {
  {
#line 877
  header[0] = (char *)((void *)0);
#line 877
  header[1] = (char *)((void *)0);
#line 878
  line = (char *)((void *)0);
#line 879
  linelen = (size_t )0;
  {
#line 885
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)f);
  }
  }
#line 885
  if (tmp == -1) {
#line 886
    return (0);
  }
  {
  {
#line 888
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 889
    status = (char )'!';
#line 892
    is_context = 0;
#line 899
    orig_file_exists = 0;
    {
    {
#line 903
    while (1) {
      while_continue___4: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 904
      tmp___0 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 904
      if (! tmp___0) {
#line 905
        is_context = 0;
#line 906
        goto while_break___0;
      }
      {
      {
#line 909
      tmp___1 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 909
      if (! tmp___1) {
#line 910
        is_context = 1;
#line 911
        goto while_break___0;
      }
#line 916
      if ((unsigned int )mode___0 == 0U) {
#line 916
        if (pat_exclude) {
#line 916
          goto _L;
        } else
#line 916
        if (verbose) {
          _L: /* CIL Label */ 
#line 916
          if (! clean_comments) {
            {
            {
#line 918
            fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)stdout);
            }
            }
          }
        }
      }
      {
      {
#line 920
      tmp___2 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)f);
      }
      }
#line 920
      if (tmp___2 == -1) {
#line 921
        goto eof;
      }
#line 922
      linenum ++;
    }
    while_break___4: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 925
    start_linenum = linenum;
    {
#line 926
    header[0] = xstrdup((char const   *)line);
    }
    {
#line 927
    names[0] = filename_from_header((char const   *)(line + 4));
    }
    }
#line 928
    if ((unsigned int )mode___0 != 0U) {
#line 928
      if (show_status) {
        {
        {
#line 929
        tmp___3 = strlen((char const   *)names[0]);
        }
        {
#line 929
        orig_file_exists = file_exists((char const   *)names[0], (char const   *)((line + 4) + tmp___3));
        }
        }
      }
    }
    {
    {
#line 932
    tmp___4 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)f);
    }
    }
#line 932
    if (tmp___4 == -1) {
#line 935
      if ((unsigned int )mode___0 == 0U) {
#line 935
        if (pat_exclude) {
#line 935
          goto _L___0;
        } else
#line 935
        if (verbose) {
          _L___0: /* CIL Label */ 
#line 935
          if (! clean_comments) {
            {
            {
#line 937
            fputs((char const   */* __restrict  */)header[0], (FILE */* __restrict  */)stdout);
            }
            }
          }
        }
      }
      {
      {
#line 938
      free((void *)names[0]);
      }
      }
#line 939
      goto eof;
    }
#line 941
    linenum ++;
#line 943
    if (is_context) {
#line 943
      tmp___5 = "--- ";
    } else {
#line 943
      tmp___5 = "+++ ";
    }
    {
    {
#line 943
    tmp___6 = strncmp((char const   *)line, tmp___5, (size_t )4);
    }
    }
#line 943
    if (tmp___6) {
#line 946
      if ((unsigned int )mode___0 == 0U) {
#line 946
        if (pat_exclude) {
#line 946
          goto _L___1;
        } else
#line 946
        if (verbose) {
          _L___1: /* CIL Label */ 
#line 946
          if (! clean_comments) {
            {
            {
#line 948
            fputs((char const   */* __restrict  */)header[0], (FILE */* __restrict  */)stdout);
            }
            }
          }
        }
      }
      {
      {
#line 949
      free((void *)names[0]);
      }
      {
#line 950
      free((void *)header[0]);
      }
#line 951
      header[0] = (char *)((void *)0);
      }
#line 952
      goto __Cont;
    }
    {
#line 955
    filecount ++;
    {
#line 956
    header[1] = xstrdup((char const   *)line);
    }
    {
#line 957
    names[1] = filename_from_header((char const   *)(line + 4));
    }
    }
#line 959
    if ((unsigned int )mode___0 != 0U) {
#line 959
      if (show_status) {
        {
        {
#line 960
        tmp___7 = strlen((char const   *)names[1]);
        }
        {
#line 960
        new_file_exists = file_exists((char const   *)names[1], (char const   *)((line + 4) + tmp___7));
        }
        }
      }
    }
    {
    {
#line 964
    p = best_name(2, names);
    }
    {
#line 965
    p_stripped = stripped((char const   *)p, ignore_components___0);
    }
    {
#line 967
    tmp___8 = patlist_match(pat_exclude, p_stripped);
    }
    }
#line 967
    if (tmp___8) {
#line 967
      tmp___9 = 0;
    } else {
#line 967
      tmp___9 = 1;
    }
#line 967
    match = tmp___9;
#line 968
    if (match) {
#line 968
      if ((unsigned long )pat_include != (unsigned long )((void *)0)) {
        {
        {
#line 969
        match = patlist_match(pat_include, p_stripped);
        }
        }
      }
    }
#line 972
    if (match) {
#line 972
      if (! show_status) {
#line 972
        if ((unsigned int )mode___0 == 1U) {
          {
          {
#line 973
          display_filename(start_linenum, status, (char const   *)p, patchname);
          }
          }
        }
      }
    }
#line 976
    if (is_context) {
#line 977
      do_diff = & do_context;
    } else {
#line 979
      do_diff = & do_unified;
    }
    {
    {
#line 981
    result = (*do_diff)(f, (char **)(header), match, & line, & linelen, & linenum,
                        start_linenum, status, (char const   *)p, patchname, & orig_file_exists,
                        & new_file_exists);
    }
    }
#line 987
    if (match) {
#line 987
      if (show_status) {
#line 987
        if ((unsigned int )mode___0 == 1U) {
#line 988
          if (! orig_file_exists) {
#line 989
            status = (char )'+';
          } else
#line 990
          if (! new_file_exists) {
#line 991
            status = (char )'-';
          }
          {
          {
#line 993
          display_filename(start_linenum, status, (char const   *)p, patchname);
          }
          }
        }
      }
    }
    {
#line 998
    if (result == -1) {
#line 998
      goto case_neg_1;
    }
#line 1002
    if (result == 1) {
#line 1002
      goto case_1;
    }
#line 997
    goto switch_break;
    case_neg_1: /* CIL Label */ 
    {
    {
#line 999
    free((void *)names[0]);
    }
    {
#line 1000
    free((void *)names[1]);
    }
    }
#line 1001
    goto eof;
    case_1: /* CIL Label */ 
#line 1003
    goto next_diff;
    switch_break: /* CIL Label */ ;
    }
    next_diff: 
#line 1007
    i = 0;
    {
    {
#line 1007
    while (1) {
      while_continue___5: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 1007
      if (! (i < 2)) {
#line 1007
        goto while_break___1;
      }
      {
      {
#line 1008
      free((void *)names[i]);
      }
      {
#line 1009
      free((void *)header[i]);
      }
#line 1010
      header[i] = (char *)((void *)0);
#line 1007
      i ++;
      }
    }
    while_break___5: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  eof: 
#line 1015
  i = 0;
  {
  {
#line 1015
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue___2: /* CIL Label */ ;
#line 1015
    if (! (i < 2)) {
#line 1015
      goto while_break___2;
    }
#line 1016
    if (header[i]) {
      {
      {
#line 1017
      free((void *)header[i]);
      }
      }
    }
#line 1015
    i ++;
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break___2: /* CIL Label */ ;
  }
#line 1019
  if (line) {
    {
    {
#line 1020
    free((void *)line);
    }
    }
  }
#line 1022
  return (0);
}
}
#line 1025 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
char const   *syntax_str  =    "Options:\n  -x PAT, --exclude=PAT\n            exclude files matching PAT\n  -X FILE, --exclude-from-file=FILE\n            exclude files that match any pattern in FILE\n  -i PAT, --include=PAT\n            include only files matching PAT\n  -I FILE, --include-from-file=FILE\n            include only files that match any pattern in FILE\n  --hunks=H, -# H\n            include only hunks in range H\n  --lines=L include only hunks with (original) lines in range L\n  --files=F include only files in range F\n  --annotate (filterdiff, grepdiff)\n            annotate each hunk with the filename and hunk number (filterdiff, grepdiff)\n  --as-numbered-lines=before|after (filterdiff, grepdiff)\n            display lines as they would look before, or after, the (filterdiff, grepdiff)\n            patch is applied (filterdiff, grepdiff)\n  --format=context|unified (filterdiff, grepdiff)\n            set output format (filterdiff, grepdiff)\n  --output-matching=hunk|file (grepdiff)\n            show matching hunks or file-level diffs (grepdiff)\n  --remove-timestamps (filterdiff, grepdiff)\n            don\'t show timestamps from output (filterdiff, grepdiff)\n  --clean (filterdiff)\n            remove all comments (non-diff lines) from output (filterdiff)\n  -z, --decompress\n            decompress .gz and .bz2 files\n  -n, --line-number\n            show line numbers (lsdiff, grepdiff)\n  --number-files (lsdiff, grepdiff)\n            show file numbers, for use with filterdiff\'s --files option (lsdiff, grepdiff)\n  -H, --with-filename (lsdiff, grepdiff)\n            show patch file names (lsdiff, grepdiff)\n  -h, --no-filename (lsdiff, grepdiff)\n            suppress patch file names (lsdiff, grepdiff)\n  -p N, --strip-match=N\n            initial pathname components to ignore\n  --strip=N initial pathname components to strip\n  --addprefix=PREFIX\n            prefix pathnames with PREFIX\n  --addoldprefix=PREFIX\n            prefix pathnames in old files with PREFIX\n  --addnewprefix=PREFIX\n            prefix pathnames in new files with PREFIX\n  -s, --status\n            show file additions and removals (lsdiff)\n  -v, --verbose\n            verbose output -- use more than once for extra verbosity\n  -E, --extended-regexp\n            use extended regexps, like egrep (grepdiff)\n  -E, --empty-files-as-absent (lsdiff)\n            treat empty files as absent (lsdiff)\n  -f FILE, --file=FILE\n            read regular expressions from FILE (grepdiff)\n  --filter  run as \'filterdiff\' (grepdiff, lsdiff)\n  --list    run as \'lsdiff\' (filterdiff, grepdiff)\n  --grep    run as \'grepdiff\' (filterdiff, lsdiff)\n";
#line 1086
static  __attribute__((__noreturn__)) void syntax___2(int err ) ;
#line 1086 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void syntax___2(int err ) 
{ 
  char *s ;
  char *tmp ;
  char const   *usage ;
  char *p ;
  char *next ;
  struct _IO_FILE *tmp___0 ;
  char *endp ;
  char *tmp___1 ;
  char *begp ;
  char *tmp___2 ;
  char *comma ;
  char *tmp___3 ;
  int tmp___4 ;
  size_t tmp___5 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;

  {
  {
  {
#line 1089
  tmp = xstrdup(syntax_str);
  }
#line 1089
  s = tmp;
#line 1090
  usage = "usage: %s [OPTION]... [files ...]\n";
  }
#line 1092
  if ((unsigned int )mode___0 == 2U) {
#line 1093
    usage = "usage: %s [OPTION]... REGEX [files ...]\n";
  }
#line 1094
  if (err) {
#line 1094
    tmp___0 = stderr;
  } else {
#line 1094
    tmp___0 = stdout;
  }
  {
  {
#line 1094
  fprintf((FILE */* __restrict  */)tmp___0, (char const   */* __restrict  */)usage,
          progname);
  }
#line 1095
  p = s;
  }
  {
  {
#line 1095
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1095
    if (p) {
#line 1095
      if (! *p) {
#line 1095
        goto while_break;
      }
    } else {
#line 1095
      goto while_break;
    }
    {
    {
#line 1097
    next = strchr((char const   *)p, '\n');
    }
    }
#line 1098
    if (! next) {
#line 1099
      goto while_break;
    }
#line 1100
    endp = next;
#line 1101
    tmp___1 = next;
#line 1101
    next ++;
#line 1101
    *tmp___1 = (char )'\000';
#line 1102
    endp --;
#line 1102
    if ((int )*endp == 41) {
      {
      {
#line 1103
      tmp___2 = strrchr((char const   *)p, '(');
      }
#line 1103
      begp = tmp___2;
      }
#line 1105
      if (! begp) {
#line 1106
        goto while_break;
      }
#line 1107
      tmp___3 = begp;
#line 1107
      begp ++;
#line 1107
      *tmp___3 = (char )'\000';
#line 1108
      *endp = (char )'\000';
      {
      {
#line 1109
      while (1) {
        while_continue___2: /* CIL Label */ ;
        while_continue___0: /* CIL Label */ ;
        {
        {
#line 1110
        comma = strchr((char const   *)begp, ',');
        }
        }
#line 1111
        if (comma) {
#line 1112
          *comma = (char )'\000';
        }
        {
        {
#line 1113
        tmp___4 = strcmp((char const   *)progname, (char const   *)begp);
        }
        }
#line 1113
        if (! tmp___4) {
          {
          {
#line 1114
          puts((char const   *)p);
          }
          }
#line 1115
          goto while_break___0;
        }
#line 1117
        if (comma) {
          {
          {
#line 1118
          tmp___5 = strspn((char const   *)(comma + 1), " ");
          }
#line 1118
          begp = (comma + 1) + tmp___5;
          }
        }
#line 1109
        if (! comma) {
#line 1109
          goto while_break___0;
        }
      }
      while_break___2: /* CIL Label */ ;
      }
      while_break___0: /* CIL Label */ ;
      }
    } else {
      {
      {
#line 1122
      puts((char const   *)p);
      }
      }
    }
#line 1095
    p = next;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1124
  exit(err);
  }
  }
}
}
#line 1127 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void parse_range(struct range **r , char const   *rstr ) 
{ 
  unsigned long n ;
  char *end ;
  void *tmp ;
  unsigned long tmp___0 ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;

  {
#line 1133
  if ((int const   )*rstr == 45) {
#line 1134
    n = 0xffffffffffffffffUL;
  } else {
    {
    {
#line 1136
    n = strtoul((char const   */* __restrict  */)rstr, (char **/* __restrict  */)(& end),
                0);
    }
    }
#line 1137
    if ((unsigned long )rstr == (unsigned long )end) {
#line 1138
      if (*end) {
        {
        {
#line 1139
        error(1, 0, "not understood: \'%s\'", end);
        }
        }
      } else {
        {
        {
#line 1142
        error(1, 0, "missing number in range list");
        }
        }
      }
#line 1145
      *r = (struct range *)((void *)0);
#line 1146
      return;
    }
#line 1149
    rstr = (char const   *)end;
  }
  {
  {
#line 1152
  tmp = xmalloc((size_t )sizeof(*(*r)));
  }
#line 1152
  *r = (struct range *)tmp;
#line 1153
  tmp___0 = n;
#line 1153
  (*r)->end = tmp___0;
#line 1153
  (*r)->start = tmp___0;
#line 1154
  (*r)->next = (struct range *)((void *)0);
  }
#line 1155
  if ((int const   )*rstr == 45) {
    {
#line 1156
    rstr ++;
    {
#line 1157
    n = strtoul((char const   */* __restrict  */)rstr, (char **/* __restrict  */)(& end),
                0);
    }
    }
#line 1158
    if ((unsigned long )rstr == (unsigned long )end) {
#line 1159
      n = 0xffffffffffffffffUL;
    }
#line 1161
    (*r)->end = n;
#line 1162
    rstr = (char const   *)end;
#line 1164
    if ((*r)->start != 0xffffffffffffffffUL) {
#line 1164
      if ((*r)->start > (*r)->end) {
        {
        {
#line 1165
        error(1, 0, "invalid range: %lu-%lu", (*r)->start, (*r)->end);
        }
        }
      }
    }
  }
#line 1169
  if ((int const   )*rstr == 44) {
    {
    {
#line 1170
    parse_range(& (*r)->next, rstr + 1);
    }
    }
  } else
#line 1171
  if ((int const   )*rstr != 0) {
    {
    {
#line 1172
    error(1, 0, "not understood: \'%s\'", rstr);
    }
    }
  }
#line 1173
  return;
}
}
#line 1175 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void set_list(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1178
  set_progname("lsdiff");
  }
#line 1179
  mode___0 = (enum __anonenum_mode_31 )1;
  }
#line 1180
  return;
}
}
#line 1182 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void set_filter(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1185
  set_progname("filterdiff");
  }
#line 1186
  mode___0 = (enum __anonenum_mode_31 )0;
  }
#line 1187
  return;
}
}
#line 1189 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void set_grep(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1192
  set_progname("grepdiff");
  }
#line 1193
  mode___0 = (enum __anonenum_mode_31 )2;
  }
#line 1194
  return;
}
}
#line 1196 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void determine_mode_from_name(char const   *argv0 ) 
{ 
  char const   *p ;
  char *tmp ;
  char const   *tmp___0 ;
  char *tmp___1 ;
  char *tmp___2 ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;

  {
  {
  {
#line 1199
  tmp = strrchr(argv0, '/');
  }
#line 1199
  p = (char const   *)tmp;
#line 1200
  tmp___0 = p;
#line 1200
  p ++;
  }
#line 1200
  if (! tmp___0) {
#line 1201
    p = argv0;
  }
  {
  {
#line 1202
  tmp___2 = strstr(p, "lsdiff");
  }
  }
#line 1202
  if (tmp___2) {
    {
    {
#line 1203
    set_list();
    }
    }
  } else {
    {
    {
#line 1204
    tmp___1 = strstr(p, "grepdiff");
    }
    }
#line 1204
    if (tmp___1) {
      {
      {
#line 1205
      set_grep();
      }
      }
    } else {
      {
      {
#line 1207
      set_filter();
      }
      }
    }
  }
#line 1208
  return;
}
}
#line 1210 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static FILE *convert_format(FILE *f , char format ) 
{ 
  char *__cil_tmp3 ;
  char *__cil_tmp4 ;

  {
  {
#line 1215
  if ((int )format == 99) {
#line 1215
    goto case_99;
  }
#line 1218
  if ((int )format == 117) {
#line 1218
    goto case_117;
  }
#line 1213
  goto switch_default;
  switch_default: /* CIL Label */ 
#line 1214
  goto switch_break;
  case_99: /* CIL Label */ 
  {
  {
#line 1216
  f = convert_to_context(f, "rb", 0);
  }
  }
#line 1217
  goto switch_break;
  case_117: /* CIL Label */ 
  {
  {
#line 1219
  f = convert_to_unified(f, "rb", 0);
  }
  }
#line 1220
  goto switch_break;
  switch_break: /* CIL Label */ ;
  }
#line 1223
  return (f);
}
}
#line 1226 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int read_regex_file(char const   *file ) 
{ 
  FILE *f ;
  FILE *tmp ;
  char *line ;
  size_t linelen ;
  ssize_t got ;
  int err ;
  int *tmp___0 ;
  void *tmp___1 ;
  char errstr[300] ;
  int tmp___2 ;
  void *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;

  {
  {
  {
#line 1229
  tmp = fopen((char const   */* __restrict  */)file, (char const   */* __restrict  */)"r");
  }
#line 1229
  f = tmp;
#line 1230
  line = (char *)((void *)0);
#line 1231
  linelen = (size_t )0;
  }
#line 1235
  if (! f) {
    {
    {
#line 1236
    tmp___0 = __errno_location();
    }
    {
#line 1236
    error(1, *tmp___0, "cannot open %s", file);
    }
    }
  }
  {
  {
#line 1238
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1238
    got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)f);
    }
    }
#line 1238
    if (! (got > 0)) {
#line 1238
      goto while_break;
    }
#line 1239
    got --;
#line 1239
    if ((int )*(line + got) == 10) {
#line 1240
      *(line + got) = (char )'\000';
    }
    {
#line 1242
    num_regex ++;
    {
#line 1242
    tmp___1 = xrealloc((void *)regex, (size_t )((unsigned long )num_regex * sizeof(*(regex + 0))));
    }
#line 1242
    regex = (regex_t *)tmp___1;
    {
#line 1243
    err = regcomp((regex_t */* __restrict  */)(regex + (num_regex - 1U)), (char const   */* __restrict  */)line,
                  (((1 << 1) << 1) << 1) | egrepping);
    }
    }
#line 1245
    if (err) {
      {
      {
#line 1247
      regerror(err, (regex_t const   */* __restrict  */)(regex + (num_regex - 1U)),
               (char */* __restrict  */)(errstr), (size_t )sizeof(errstr));
      }
      {
#line 1249
      error(1, 0, (char const   *)(errstr));
      }
      {
#line 1250
      exit(1);
      }
      }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1254
  free((void *)line);
  }
  {
#line 1255
  tmp___2 = fclose(f);
  }
  }
#line 1255
  return (tmp___2);
}
}
#line 1268 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct option long_options___2[36]  = 
#line 1268
  {      {"help", 0, (int *)0, 1072}, 
        {"version", 0, (int *)0, 1086}, 
        {"verbose", 0, (int *)0, 'v'}, 
        {"list", 0, (int *)0, 'l'}, 
        {"filter", 0, (int *)0, 1102}, 
        {"grep", 0, (int *)0, 'g'}, 
        {"strip", 1, (int *)0, 1083}, 
        {"addprefix", 1, (int *)0, 1065}, 
        {"addoldprefix", 1, (int *)0, 1079}, 
        {"addnewprefix", 1, (int *)0, 1078}, 
        {"hunks", 1, (int *)0, '#'}, 
        {"lines", 1, (int *)0, 1058}, 
        {"files", 1, (int *)0, 1119}, 
        {"as-numbered-lines", 1, (int *)0, 1076}, 
        {"annotate", 0, (int *)0, 1097}, 
        {"format", 1, (int *)0, 1070}, 
        {"output-matching", 1, (int *)0, 1111}, 
        {"remove-timestamps", 0, (int *)0, 1114}, 
        {"with-filename", 0, (int *)0, 'H'}, 
        {"no-filename", 0, (int *)0, 'h'}, 
        {"empty-files-as-absent", 0, (int *)0, 'E'}, 
        {"number-files", 0, (int *)0, 1110}, 
        {"clean", 0, (int *)0, 1099}, 
        {"strip-match", 1, (int *)0, 'p'}, 
        {"include", 1, (int *)0, 'i'}, 
        {"exclude", 1, (int *)0, 'x'}, 
        {"include-from-file", 1, (int *)0, 'I'}, 
        {"exclude-from-file", 1, (int *)0, 'X'}, 
        {"decompress", 0, (int *)0, 'z'}, 
        {"line-number", 0, (int *)0, 'n'}, 
        {"strip-match", 1, (int *)0, 'p'}, 
        {"status", 0, (int *)0, 's'}, 
        {"extended-regexp", 0, (int *)0, 'E'}, 
        {"empty-files-as-removed", 0, (int *)0, 'E'}, 
        {"file", 1, (int *)0, 'f'}, 
        {(char const   *)0, 0, (int *)0, 0}};
#line 65 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct patlist *pat_include___0  =    (struct patlist *)((void *)0);
#line 66 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct patlist *pat_exclude___0  =    (struct patlist *)((void *)0);
#line 67 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct range *hunks___0  =    (struct range *)((void *)0);
#line 68 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct range *lines___0  =    (struct range *)((void *)0);
#line 69 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct range *files___0  =    (struct range *)((void *)0);
#line 70 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static enum line_numbering number_lines___0  =    (enum line_numbering )0;
#line 71 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int number_files___0  =    0;
#line 73 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int unzip___1  =    0;
#line 74 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static enum __anonenum_mode_31___0 mode___1  ;
#line 79 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static regex_t *regex___0  =    (regex_t *)((void *)0);
#line 80 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static size_t num_regex___0  =    (size_t )0;
#line 81 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int clean_comments___0  =    0;
#line 82 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int numbering___0  =    0;
#line 83 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int annotating___0  =    0;
#line 84 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int ignore_components___1  =    0;
#line 85 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int strip_components___0  =    0;
#line 86 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static char const   *prefix_to_add___0  =    (char const   *)((void *)0);
#line 87 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static char const   *old_prefix_to_add___0  =    (char const   *)((void *)0);
#line 88 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static char const   *new_prefix_to_add___0  =    (char const   *)((void *)0);
#line 89 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int show_status___0  =    0;
#line 90 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int verbose___0  =    0;
#line 91 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int removing_timestamp___0  =    0;
#line 92 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int egrepping___0  =    0;
#line 93 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int print_patchnames___0  =    -1;
#line 94 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int empty_files_as_absent___0  =    0;
#line 95 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static unsigned long filecount___0  =    0UL;
#line 97 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int regexecs___0(regex_t *regex___1 , size_t num_regex___1 , char const   *string ,
                        size_t nmatch , regmatch_t *pmatch , int eflags ) 
{ 
  size_t i ;
  int ret ;

  {
#line 102
  ret = 1;
#line 103
  i = (size_t )0;
  {
  {
#line 103
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 103
    if (! (i < num_regex___1)) {
#line 103
      goto while_break;
    }
    {
    {
#line 104
    ret = regexec((regex_t const   */* __restrict  */)(regex___1 + i), (char const   */* __restrict  */)string,
                  nmatch, (regmatch_t */* __restrict  */)pmatch, eflags);
    }
    }
#line 104
    if (! ret) {
#line 106
      goto while_break;
    }
#line 103
    i ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 107
  return (ret);
}
}
#line 110 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int file_exists___0(char const   *name , char const   *timestamp ) 
{ 
  struct tm t ;
  long zone ;
  int tmp ;
  int tmp___0 ;
  long offset ;
  char *__cil_tmp8 ;

  {
  {
#line 113
  zone = -1L;
  {
#line 115
  tmp = strcmp(name, "/dev/null");
  }
  }
#line 115
  if (! tmp) {
#line 116
    return (0);
  }
  {
  {
#line 118
  tmp___0 = read_timestamp(timestamp, & t, & zone);
  }
  }
#line 118
  if (tmp___0) {
#line 119
    return (1);
  }
#line 124
  if (t.tm_sec == 0) {
#line 124
    if (t.tm_year == 69) {
#line 124
      if (t.tm_mon == 11) {
#line 124
        if (t.tm_mday == 31) {
#line 124
          if (t.tm_hour >= 9) {
#line 124
            goto _L;
          } else {
#line 124
            goto _L___2;
          }
        } else {
#line 124
          goto _L___2;
        }
      } else {
#line 124
        goto _L___2;
      }
    } else
    _L___2: /* CIL Label */ 
#line 124
    if (t.tm_year == 70) {
#line 124
      if (t.tm_mon == 0) {
#line 124
        if (t.tm_mday == 1) {
#line 124
          if (t.tm_hour <= 15) {
            _L: /* CIL Label */ 
#line 124
            if (t.tm_min % 15 == 0) {
#line 130
              if (zone != -1L) {
#line 132
                offset = 0L;
#line 133
                if (t.tm_year == 69) {
#line 134
                  offset = (long )(100 * (t.tm_hour - 24));
#line 135
                  if (t.tm_min) {
#line 136
                    offset += (long )((100 + t.tm_min) - 60);
                  }
                } else {
#line 138
                  offset = (long )(100 * t.tm_hour);
#line 139
                  offset += (long )t.tm_min;
                }
#line 142
                if (offset != zone) {
#line 143
                  return (1);
                }
              }
#line 146
              return (0);
            }
          }
        }
      }
    }
  }
#line 150
  return (1);
}
}
#line 153 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int output_header_line___0(char const   *line ) 
{ 
  char *fn ;
  int h ;
  size_t tmp ;
  int tmp___0 ;
  int tmp___1 ;
  char const   *tmp___2 ;
  char *__cil_tmp8 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;

  {
  {
  {
#line 156
  tmp = strcspn(line + 4, "\t\n");
  }
#line 156
  h = (int )tmp;
  {
#line 158
  fwrite((void const   */* __restrict  */)line, (size_t )1, (size_t )4, (FILE */* __restrict  */)stdout);
  }
  }
#line 160
  if (prefix_to_add___0) {
    {
    {
#line 161
    fputs((char const   */* __restrict  */)prefix_to_add___0, (FILE */* __restrict  */)stdout);
    }
    }
  } else {
#line 163
    if (old_prefix_to_add___0) {
      {
      {
#line 163
      tmp___0 = strncmp(line, "---", (size_t )3);
      }
      }
#line 163
      if (tmp___0 == 0) {
        {
        {
#line 164
        fputs((char const   */* __restrict  */)old_prefix_to_add___0, (FILE */* __restrict  */)stdout);
        }
        }
      }
    }
#line 165
    if (new_prefix_to_add___0) {
      {
      {
#line 165
      tmp___1 = strncmp(line, "+++", (size_t )3);
      }
      }
#line 165
      if (tmp___1 == 0) {
        {
        {
#line 166
        fputs((char const   */* __restrict  */)new_prefix_to_add___0, (FILE */* __restrict  */)stdout);
        }
        }
      }
    }
  }
  {
  {
#line 169
  fn = xstrndup(line + 4, (size_t const   )h);
  }
  {
#line 170
  tmp___2 = stripped((char const   *)fn, strip_components___0);
  }
  {
#line 170
  fputs((char const   */* __restrict  */)tmp___2, (FILE */* __restrict  */)stdout);
  }
  }
#line 171
  if (removing_timestamp___0) {
    {
    {
#line 172
    putchar('\n');
    }
    }
  } else {
    {
    {
#line 174
    fputs((char const   */* __restrict  */)((line + 4) + h), (FILE */* __restrict  */)stdout);
    }
    }
  }
  {
  {
#line 176
  free((void *)fn);
  }
  }
#line 177
  return (0);
}
}
#line 180 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int file_matches___0(void) 
{ 
  int f ;
  struct range *r ;

  {
#line 183
  f = 0;
#line 188
  r = files___0;
  {
  {
#line 188
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 188
    if (! r) {
#line 188
      goto while_break;
    }
#line 189
    if (r->start == 0xffffffffffffffffUL) {
#line 189
      goto _L;
    } else
#line 189
    if (r->start <= filecount___0) {
      _L: /* CIL Label */ 
#line 189
      if (r->end == 0xffffffffffffffffUL) {
#line 193
        f = 1;
#line 194
        goto while_break;
      } else
#line 189
      if (filecount___0 <= r->end) {
#line 193
        f = 1;
#line 194
        goto while_break;
      }
    }
#line 188
    r = r->next;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 197
  if (files___0) {
#line 197
    if (! f) {
#line 198
      return (0);
    }
  }
#line 200
  return (1);
}
}
#line 203 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void display_filename___0(unsigned long linenum___1 , char status , char const   *filename ,
                                 char const   *patchname ) 
{ 
  int tmp ;
  char const   *tmp___0 ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;

  {
#line 206
  if ((unsigned int )mode___1 == 1U) {
    {
    {
#line 206
    tmp = file_matches___0();
    }
    }
#line 206
    if (! tmp) {
#line 209
      return;
    }
  }
#line 211
  if (print_patchnames___0) {
    {
    {
#line 212
    printf((char const   */* __restrict  */)"%s:", patchname);
    }
    }
  }
#line 213
  if (numbering___0) {
    {
    {
#line 214
    printf((char const   */* __restrict  */)"%lu\t", linenum___1);
    }
    }
  }
#line 215
  if (number_files___0) {
    {
    {
#line 216
    printf((char const   */* __restrict  */)"File #%-3lu\t", filecount___0);
    }
    }
  }
#line 217
  if (show_status___0) {
    {
    {
#line 218
    printf((char const   */* __restrict  */)"%c ", (int )status);
    }
    }
  }
#line 219
  if (prefix_to_add___0) {
    {
    {
#line 220
    fputs((char const   */* __restrict  */)prefix_to_add___0, (FILE */* __restrict  */)stdout);
    }
    }
  }
  {
  {
#line 221
  tmp___0 = stripped(filename, strip_components___0);
  }
  {
#line 221
  puts(tmp___0);
  }
  }
#line 222
  return;
}
}
#line 224 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int hunk_matches___0(unsigned long orig_offset , unsigned long orig_count ,
                            unsigned long hunknum ) 
{ 
  int h ;
  int l ;
  struct range *r ;
  int tmp ;

  {
  {
#line 228
  h = 0;
#line 228
  l = 0;
  {
#line 232
  tmp = file_matches___0();
  }
  }
#line 232
  if (! tmp) {
#line 233
    return (0);
  }
#line 237
  if (! orig_count) {
#line 238
    orig_count = 1UL;
  }
#line 242
  r = hunks___0;
  {
  {
#line 242
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 242
    if (! r) {
#line 242
      goto while_break;
    }
#line 243
    if (r->start == 0xffffffffffffffffUL) {
#line 243
      goto _L;
    } else
#line 243
    if (r->start <= hunknum) {
      _L: /* CIL Label */ 
#line 243
      if (r->end == 0xffffffffffffffffUL) {
#line 247
        h = 1;
#line 248
        goto while_break;
      } else
#line 243
      if (hunknum <= r->end) {
#line 247
        h = 1;
#line 248
        goto while_break;
      }
    }
#line 242
    r = r->next;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 253
  r = lines___0;
  {
  {
#line 253
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 253
    if (! r) {
#line 253
      goto while_break___0;
    }
#line 254
    if (r->start == 0xffffffffffffffffUL) {
#line 254
      goto _L___0;
    } else
#line 254
    if (r->start < orig_offset + orig_count) {
      _L___0: /* CIL Label */ 
#line 254
      if (r->end == 0xffffffffffffffffUL) {
#line 258
        l = 1;
#line 259
        goto while_break___0;
      } else
#line 254
      if (r->end >= orig_offset) {
#line 258
        l = 1;
#line 259
        goto while_break___0;
      }
    }
#line 253
    r = r->next;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 262
  if (hunks___0) {
#line 262
    if (! h) {
#line 263
      return (0);
    }
  }
#line 265
  if (lines___0) {
#line 265
    if (! l) {
#line 266
      return (0);
    }
  }
#line 268
  return (1);
}
}
#line 271 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int do_unified___0(FILE *f , char **header , int match , char **line , size_t *linelen ,
                          unsigned long *linenum___1 , unsigned long start_linenum ,
                          char status , char const   *bestname , char const   *patchname ,
                          int *orig_file_exists , int *new_file_exists ) 
{ 
  unsigned long orig_count ;
  unsigned long new_count ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  unsigned long hunknum ;
  unsigned long track_linenum ;
  int header_displayed ;
  int hunk_match ;
  long munge_offset ;
  int displayed_filename ;
  unsigned long last_hunkmatch ;
  unsigned long hunk_linenum ;
  FILE *match_tmpf ;
  int grepmatch ;
  long delayed_munge ;
  int ret ;
  int orig_is_empty ;
  int new_is_empty ;
  ssize_t got ;
  __ssize_t tmp ;
  char *trailing ;
  int tmp___0 ;
  int tmp___1 ;
  size_t tmp___2 ;
  size_t tmp___3 ;
  char *p ;
  int first_hunk ;
  FILE *output_to ;
  int ch ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  FILE *output_to___0 ;
  unsigned long tmp___7 ;
  char *__cil_tmp47 ;
  char *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;

  {
#line 279
  orig_count = 0UL;
#line 279
  new_count = 0UL;
#line 281
  hunknum = 0UL;
#line 282
  track_linenum = 0UL;
#line 283
  header_displayed = 0;
#line 284
  hunk_match = match;
#line 285
  munge_offset = 0L;
#line 286
  displayed_filename = 0;
#line 287
  last_hunkmatch = 0UL;
#line 288
  hunk_linenum = *linenum___1;
#line 289
  match_tmpf = (FILE *)((void *)0);
#line 290
  grepmatch = 0;
#line 291
  delayed_munge = 0L;
#line 292
  ret = 0;
#line 293
  orig_is_empty = 1;
#line 293
  new_is_empty = 1;
#line 295
  if ((unsigned int )output_matching == 2U) {
    {
    {
#line 296
    match_tmpf = xtmpfile();
    }
    }
  }
  {
  {
#line 298
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 299
    tmp = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                  (FILE */* __restrict  */)f);
    }
#line 299
    got = tmp;
    }
#line 300
    if (got == -1) {
#line 301
      ret = -1;
#line 302
      goto out;
    }
#line 304
    (*linenum___1) ++;
#line 306
    if (! orig_count) {
#line 306
      if (! new_count) {
#line 306
        if ((int )*(*line) != 92) {
          {
          {
#line 309
          tmp___0 = strncmp((char const   *)*line, "@@ ", (size_t )3);
          }
          }
#line 309
          if (tmp___0) {
#line 310
            goto while_break;
          }
#line 313
          hunknum ++;
#line 314
          hunk_linenum = *linenum___1;
#line 316
          if ((unsigned int )output_matching == 1U) {
#line 316
            if (! grepmatch) {
#line 320
              munge_offset += delayed_munge;
            }
          }
#line 322
          if ((unsigned int )output_matching != 2U) {
#line 323
            grepmatch = 0;
          }
#line 324
          if ((unsigned int )output_matching == 1U) {
#line 325
            if (match_tmpf) {
              {
              {
#line 326
              fclose(match_tmpf);
              }
              }
            }
            {
            {
#line 327
            match_tmpf = xtmpfile();
            }
            }
          }
          {
          {
#line 330
          tmp___1 = read_atatline((char const   *)*line, & orig_offset, & orig_count,
                                  & new_offset, & new_count);
          }
          }
#line 330
          if (tmp___1) {
            {
            {
#line 332
            error(1, 0, "line not understood: %s", *line);
            }
            }
          }
#line 335
          if (orig_count) {
#line 336
            orig_is_empty = 0;
          }
#line 337
          if (new_count) {
#line 338
            new_is_empty = 0;
          }
#line 341
          if (match) {
            {
            {
#line 342
            hunk_match = hunk_matches___0(orig_offset, orig_count, hunknum);
            }
            }
          } else {
#line 345
            hunk_match = 0;
          }
          {
          {
#line 347
          trailing = strchr((char const   *)*line, '+');
          }
          {
#line 348
          tmp___2 = strcspn((char const   *)trailing, " \n");
          }
#line 348
          trailing += tmp___2;
          }
#line 349
          if ((int )*trailing == 32) {
#line 350
            trailing ++;
          }
          {
          {
#line 351
          tmp___3 = strspn((char const   *)trailing, "@");
          }
#line 351
          trailing += tmp___3;
          }
#line 353
          if (hunk_match) {
#line 353
            if (numbering___0) {
#line 353
              if (verbose___0) {
#line 353
                if ((unsigned int )mode___1 != 2U) {
#line 355
                  if (print_patchnames___0) {
                    {
                    {
#line 356
                    printf((char const   */* __restrict  */)"%s-", patchname);
                    }
                    }
                  }
                  {
                  {
#line 357
                  printf((char const   */* __restrict  */)"\t%lu\tHunk #%lu", hunk_linenum,
                         hunknum);
                  }
                  }
#line 359
                  if (verbose___0 > 1) {
#line 360
                    p = trailing;
#line 361
                    if ((int )*p != 10) {
#line 362
                      p ++;
                    }
                    {
                    {
#line 363
                    printf((char const   */* __restrict  */)"\t%s", p);
                    }
                    }
                  } else {
                    {
                    {
#line 365
                    putchar('\n');
                    }
                    }
                  }
                }
              }
            }
          }
#line 368
          if (hunk_match) {
#line 368
            if ((unsigned int )mode___1 == 0U) {
#line 368
              goto _L___0;
            } else
#line 368
            if ((unsigned int )output_matching != 0U) {
              _L___0: /* CIL Label */ 
#line 371
              first_hunk = ! header_displayed;
#line 372
              output_to = stdout;
#line 374
              if ((unsigned int )mode___1 == 2U) {
#line 375
                delayed_munge = (long )(orig_count - new_count);
#line 376
                if (! grepmatch) {
#line 377
                  output_to = match_tmpf;
                }
              }
#line 380
              if (! header_displayed) {
#line 380
                if ((unsigned int )mode___1 != 2U) {
#line 383
                  if ((unsigned int )number_lines___0 != 2U) {
                    {
                    {
#line 384
                    output_header_line___0((char const   *)*(header + 0));
                    }
                    }
                  }
#line 385
                  if ((unsigned int )number_lines___0 != 1U) {
                    {
                    {
#line 386
                    output_header_line___0((char const   *)*(header + 1));
                    }
                    }
                  }
#line 387
                  header_displayed = 1;
                }
              }
              {
#line 390
              if ((unsigned int )number_lines___0 == 0U) {
#line 390
                goto case_0;
              }
#line 414
              if ((unsigned int )number_lines___0 == 1U) {
#line 414
                goto case_1;
              }
#line 422
              if ((unsigned int )number_lines___0 == 2U) {
#line 422
                goto case_2;
              }
#line 389
              goto switch_break;
              case_0: /* CIL Label */ 
              {
              {
#line 395
              fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)"@@ -%lu",
                      orig_offset);
              }
              }
#line 397
              if (orig_count != 1UL) {
                {
                {
#line 398
                fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)",%lu",
                        orig_count);
                }
                }
              }
              {
              {
#line 400
              fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)" +%lu",
                      new_offset + (unsigned long )munge_offset);
              }
              }
#line 402
              if (new_count != 1UL) {
                {
                {
#line 403
                fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)",%lu",
                        new_count);
                }
                }
              }
              {
              {
#line 405
              fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)" @@");
              }
              }
#line 407
              if (annotating___0) {
                {
                {
#line 408
                fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)" Hunk #%lu, %s",
                        hunknum, bestname);
                }
                }
              }
              {
              {
#line 412
              fputs((char const   */* __restrict  */)trailing, (FILE */* __restrict  */)output_to);
              }
              }
#line 413
              goto switch_break;
              case_1: /* CIL Label */ 
#line 416
              track_linenum = orig_offset;
#line 417
              if (! first_hunk) {
                {
                {
#line 420
                fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
                }
                }
              } else
#line 417
              if ((unsigned int )output_matching == 2U) {
#line 417
                if (hunknum > 1UL) {
                  {
                  {
#line 420
                  fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
                  }
                  }
                }
              }
#line 421
              goto switch_break;
              case_2: /* CIL Label */ 
#line 424
              track_linenum = new_offset + (unsigned long )munge_offset;
#line 426
              if (! first_hunk) {
                {
                {
#line 429
                fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
                }
                }
              } else
#line 426
              if ((unsigned int )output_matching == 2U) {
#line 426
                if (hunknum > 1UL) {
                  {
                  {
#line 429
                  fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
                  }
                  }
                }
              }
#line 430
              goto switch_break;
              switch_break: /* CIL Label */ ;
              }
            } else {
#line 368
              goto _L;
            }
          } else
          _L: /* CIL Label */ 
#line 432
          if ((unsigned int )mode___1 == 0U) {
#line 436
            munge_offset = (long )((unsigned long )munge_offset + (orig_count - new_count));
          }
#line 438
          goto __Cont;
        }
      }
    }
#line 441
    if ((int )*(*line) != 92) {
#line 442
      if (orig_count) {
#line 442
        if ((int )*(*line) != 43) {
#line 443
          orig_count --;
        }
      }
#line 444
      if (new_count) {
#line 444
        if ((int )*(*line) != 45) {
#line 445
          new_count --;
        }
      }
    }
#line 448
    if (hunk_match) {
#line 448
      if ((unsigned int )mode___1 == 2U) {
        {
        {
#line 448
        tmp___6 = regexecs___0(regex___0, num_regex___0, (char const   *)(*line + 1),
                               (size_t )0, (regmatch_t *)((void *)0), 0);
        }
        }
#line 448
        if (! tmp___6) {
#line 450
          if ((unsigned int )output_matching == 0U) {
#line 451
            if (! displayed_filename) {
              {
#line 452
              displayed_filename = 1;
              {
#line 453
              display_filename___0(start_linenum, status, bestname, patchname);
              }
              }
            }
#line 458
            if (numbering___0) {
#line 458
              if (verbose___0) {
#line 458
                if (hunknum > last_hunkmatch) {
#line 460
                  last_hunkmatch = hunknum;
#line 461
                  if (print_patchnames___0) {
                    {
                    {
#line 462
                    printf((char const   */* __restrict  */)"%s-", patchname);
                    }
                    }
                  }
                  {
                  {
#line 463
                  printf((char const   */* __restrict  */)"\t%lu\tHunk #%lu\n", hunk_linenum,
                         hunknum);
                  }
                  }
                }
              }
            }
          } else {
#line 467
            if (match_tmpf) {
#line 468
              if (! header_displayed) {
#line 468
                if ((unsigned int )number_lines___0 != 2U) {
                  {
                  {
#line 470
                  output_header_line___0((char const   *)*(header + 0));
                  }
                  }
                }
              }
#line 472
              if (! header_displayed) {
#line 472
                if ((unsigned int )number_lines___0 != 1U) {
                  {
                  {
#line 474
                  output_header_line___0((char const   *)*(header + 1));
                  }
                  }
                }
              }
#line 476
              if (! header_displayed) {
#line 477
                header_displayed = 1;
              }
              {
              {
#line 479
              rewind(match_tmpf);
              }
              }
              {
              {
#line 480
              while (1) {
                while_continue___2: /* CIL Label */ ;
                while_continue___0: /* CIL Label */ ;
                {
                {
#line 480
                tmp___5 = feof(match_tmpf);
                }
                }
#line 480
                if (tmp___5) {
#line 480
                  goto while_break___0;
                }
                {
                {
#line 481
                tmp___4 = fgetc(match_tmpf);
                }
#line 481
                ch = tmp___4;
                }
#line 482
                if (ch == -1) {
#line 483
                  goto while_break___0;
                }
                {
                {
#line 484
                putchar(ch);
                }
                }
              }
              while_break___2: /* CIL Label */ ;
              }
              while_break___0: /* CIL Label */ ;
              }
              {
              {
#line 486
              fclose(match_tmpf);
              }
#line 487
              match_tmpf = (FILE *)((void *)0);
              }
            }
#line 489
            grepmatch = 1;
          }
        }
      }
    }
#line 493
    if (hunk_match) {
#line 493
      if ((unsigned int )mode___1 == 0U) {
#line 493
        goto _L___2;
      } else
#line 493
      if ((unsigned int )output_matching != 0U) {
        _L___2: /* CIL Label */ 
#line 496
        output_to___0 = stdout;
#line 497
        if ((unsigned int )mode___1 == 2U) {
#line 497
          if (! grepmatch) {
#line 498
            output_to___0 = match_tmpf;
          }
        }
#line 499
        if ((unsigned int )number_lines___0 == 0U) {
          {
          {
#line 501
          fwrite((void const   */* __restrict  */)*line, (size_t )got, (size_t )1,
                 (FILE */* __restrict  */)output_to___0);
          }
          }
        } else
#line 502
        if ((unsigned int )number_lines___0 == 1U) {
#line 502
          if ((int )*(*line) != 43) {
            {
#line 505
            tmp___7 = track_linenum;
#line 505
            track_linenum ++;
            {
#line 505
            fprintf((FILE */* __restrict  */)output_to___0, (char const   */* __restrict  */)"%lu\t:%s",
                    tmp___7, *line + 1);
            }
            }
          } else {
#line 502
            goto _L___1;
          }
        } else
        _L___1: /* CIL Label */ 
#line 502
        if ((unsigned int )number_lines___0 == 2U) {
#line 502
          if ((int )*(*line) != 45) {
            {
#line 505
            tmp___7 = track_linenum;
#line 505
            track_linenum ++;
            {
#line 505
            fprintf((FILE */* __restrict  */)output_to___0, (char const   */* __restrict  */)"%lu\t:%s",
                    tmp___7, *line + 1);
            }
            }
          }
        }
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  out: 
#line 511
  if (match_tmpf) {
    {
    {
#line 512
    fclose(match_tmpf);
    }
    }
  }
#line 514
  if (empty_files_as_absent___0) {
#line 515
    if ((unsigned long )orig_file_exists != (unsigned long )((void *)0)) {
#line 515
      if (orig_is_empty) {
#line 516
        *orig_file_exists = 0;
      }
    }
#line 517
    if ((unsigned long )new_file_exists != (unsigned long )((void *)0)) {
#line 517
      if (new_is_empty) {
#line 518
        *new_file_exists = 0;
      }
    }
  }
#line 521
  return (ret);
}
}
#line 524 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int do_context___0(FILE *f , char **header , int match , char **line , size_t *linelen ,
                          unsigned long *linenum___1 , unsigned long start_linenum ,
                          char status , char const   *bestname , char const   *patchname ,
                          int *orig_file_exists , int *new_file_exists ) 
{ 
  unsigned long line_start ;
  unsigned long line_end ;
  unsigned long line_count ;
  unsigned long hunknum ;
  unsigned long track_linenum ;
  unsigned long changed[2] ;
  long munge_offset ;
  int header_displayed ;
  char *n ;
  char *end ;
  int i ;
  int hunk_match ;
  int displayed_filename ;
  unsigned long last_hunkmatch ;
  unsigned long hunk_linenum ;
  FILE *match_tmpf ;
  int grepmatch ;
  int ret ;
  unsigned long unchanged ;
  int first_hunk ;
  int orig_is_empty ;
  int new_is_empty ;
  __ssize_t tmp ;
  int tmp___0 ;
  int first ;
  __ssize_t tmp___1 ;
  int tmp___2 ;
  char const   *tmp___3 ;
  int tmp___4 ;
  FILE *output_to ;
  ssize_t got ;
  __ssize_t tmp___5 ;
  int ch ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  FILE *output_to___0 ;
  unsigned long tmp___9 ;
  unsigned long tmp___10 ;
  void *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;

  {
  {
#line 533
  hunknum = 0UL;
#line 534
  track_linenum = 0UL;
#line 536
  munge_offset = 0L;
#line 537
  header_displayed = 0;
#line 540
  hunk_match = 0;
#line 541
  displayed_filename = 0;
#line 542
  last_hunkmatch = 0UL;
#line 543
  hunk_linenum = *linenum___1;
#line 544
  match_tmpf = (FILE *)((void *)0);
#line 545
  grepmatch = 0;
#line 546
  ret = 0;
#line 548
  first_hunk = 0;
#line 549
  orig_is_empty = 1;
#line 549
  new_is_empty = 1;
  {
#line 563
  tmp = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                (FILE */* __restrict  */)f);
  }
  }
#line 563
  if (tmp == -1) {
#line 564
    return (-1);
  }
  {
#line 565
  (*linenum___1) ++;
  {
#line 567
  tmp___0 = strncmp((char const   *)*line, "***************", (size_t )15);
  }
  }
#line 567
  if (tmp___0) {
#line 568
    return (1);
  }
#line 570
  if ((unsigned int )output_matching == 2U) {
    {
    {
#line 571
    match_tmpf = xtmpfile();
    }
    }
  }
  next_hunk: 
#line 574
  unchanged = 0UL;
#line 575
  changed[1] = 0UL;
#line 575
  changed[0] = changed[1];
#line 577
  i = 0;
  {
  {
#line 577
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 577
    if (! (i < 2)) {
#line 577
      goto while_break;
    }
#line 578
    first = 1;
#line 580
    if (i == 0) {
#line 581
      first_hunk = ! header_displayed;
    }
    {
    {
#line 583
    tmp___1 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                      (FILE */* __restrict  */)f);
    }
    }
#line 583
    if (tmp___1 == -1) {
#line 584
      ret = -1;
#line 585
      goto out;
    }
#line 588
    (*linenum___1) ++;
#line 590
    if (! i) {
      {
      {
#line 590
      tmp___2 = strncmp((char const   *)*line, "***************", (size_t )15);
      }
      }
#line 590
      if (! tmp___2) {
#line 594
        i --;
#line 595
        goto __Cont;
      }
    }
#line 598
    if (i) {
#line 598
      tmp___3 = "--- ";
    } else {
#line 598
      tmp___3 = "*** ";
    }
    {
    {
#line 598
    tmp___4 = strncmp((char const   *)*line, tmp___3, (size_t )4);
    }
    }
#line 598
    if (tmp___4) {
#line 599
      ret = 1;
#line 600
      goto out;
    }
#line 603
    if (! i) {
#line 604
      hunknum ++;
#line 605
      hunk_linenum = *linenum___1;
#line 606
      if ((unsigned int )output_matching != 2U) {
#line 607
        grepmatch = 0;
      }
#line 608
      if ((unsigned int )output_matching == 1U) {
#line 609
        if (match_tmpf) {
          {
          {
#line 610
          fclose(match_tmpf);
          }
          }
        }
        {
        {
#line 611
        match_tmpf = xtmpfile();
        }
        }
      }
    }
    do_line_counts: 
    {
#line 616
    n = *line + 4;
    {
#line 617
    line_start = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                         10);
    }
    }
#line 618
    if ((unsigned long )n == (unsigned long )end) {
#line 619
      ret = 1;
#line 620
      goto out;
    }
#line 623
    if ((int )*end == 44) {
      {
#line 624
      n = end + 1;
      {
#line 625
      line_end = strtoul((char const   */* __restrict  */)n, (char **/* __restrict  */)(& end),
                         10);
      }
      }
#line 626
      if ((unsigned long )n == (unsigned long )end) {
#line 627
        ret = 1;
#line 628
        goto out;
      }
#line 631
      if (line_start > line_end) {
#line 632
        ret = 1;
#line 633
        goto out;
      }
#line 636
      line_count = (line_end - line_start) + 1UL;
    } else {
#line 638
      line_end = line_start;
#line 639
      if (line_start) {
#line 639
        line_count = 1UL;
      } else {
#line 639
        line_count = 0UL;
      }
    }
    {
    {
#line 642
    n = strchr((char const   *)n, '*');
    }
    }
#line 643
    if (n) {
#line 644
      n += 4;
    }
#line 646
    if (! i) {
#line 647
      if (match) {
        {
        {
#line 648
        hunk_match = hunk_matches___0(line_start, line_count, hunknum);
        }
        }
      } else {
#line 651
        hunk_match = 0;
      }
#line 653
      if (hunk_match) {
#line 653
        if (numbering___0) {
#line 653
          if (verbose___0) {
#line 653
            if ((unsigned int )mode___1 != 2U) {
#line 655
              if (print_patchnames___0) {
                {
                {
#line 656
                printf((char const   */* __restrict  */)"%s-", patchname);
                }
                }
              }
              {
              {
#line 657
              printf((char const   */* __restrict  */)"\t%lu\tHunk #%lu\n", hunk_linenum,
                     hunknum);
              }
              }
            }
          }
        }
      }
    }
#line 662
    if (hunk_match) {
#line 662
      if ((unsigned int )mode___1 == 0U) {
#line 662
        goto _L;
      } else
#line 662
      if ((unsigned int )output_matching != 0U) {
        _L: /* CIL Label */ 
#line 664
        output_to = stdout;
#line 666
        if ((unsigned int )mode___1 == 2U) {
#line 666
          if (! grepmatch) {
#line 667
            output_to = match_tmpf;
          }
        }
#line 670
        if (! header_displayed) {
#line 670
          if ((unsigned int )mode___1 == 0U) {
#line 671
            if ((unsigned int )number_lines___0 != 2U) {
              {
              {
#line 672
              output_header_line___0((char const   *)*(header + 0));
              }
              }
            }
#line 673
            if ((unsigned int )number_lines___0 != 1U) {
              {
              {
#line 674
              output_header_line___0((char const   *)*(header + 1));
              }
              }
            }
#line 675
            header_displayed = 1;
          }
        }
#line 678
        if ((unsigned int )number_lines___0 == 0U) {
          {
#line 679
          if (i == 0) {
#line 679
            goto case_0;
          }
#line 696
          if (i == 1) {
#line 696
            goto case_1;
          }
#line 678
          goto switch_break;
          case_0: /* CIL Label */ 
          {
          {
#line 680
          fputs((char const   */* __restrict  */)"***************\n", (FILE */* __restrict  */)output_to);
          }
          {
#line 681
          fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)"*** %lu",
                  line_start);
          }
          }
#line 682
          if (line_end != line_start) {
            {
            {
#line 683
            fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)",%lu",
                    line_end);
            }
            }
          }
          {
          {
#line 684
          fputs((char const   */* __restrict  */)" ****", (FILE */* __restrict  */)output_to);
          }
          }
#line 686
          if (annotating___0) {
            {
            {
#line 687
            fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)" Hunk #%lu, %s\n",
                    hunknum, bestname);
            }
            }
          } else
#line 690
          if (n) {
            {
            {
#line 691
            fputs((char const   */* __restrict  */)n, (FILE */* __restrict  */)output_to);
            }
            }
          } else {
            {
            {
#line 693
            fputc('\n', output_to);
            }
            }
          }
#line 695
          goto switch_break;
          case_1: /* CIL Label */ 
          {
          {
#line 697
          fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)"--- %lu",
                  line_start + (unsigned long )munge_offset);
          }
          }
#line 699
          if (line_end != line_start) {
            {
            {
#line 700
            fprintf((FILE */* __restrict  */)output_to, (char const   */* __restrict  */)",%lu",
                    line_end + (unsigned long )munge_offset);
            }
            }
          }
          {
          {
#line 702
          fputs((char const   */* __restrict  */)" ----\n", (FILE */* __restrict  */)output_to);
          }
          }
#line 703
          goto switch_break;
          switch_break: /* CIL Label */ ;
          }
        }
        {
#line 707
        if ((unsigned int )number_lines___0 == 0U) {
#line 707
          goto case_0___0;
        }
#line 710
        if ((unsigned int )number_lines___0 == 1U) {
#line 710
          goto case_1___0;
        }
#line 722
        if ((unsigned int )number_lines___0 == 2U) {
#line 722
          goto case_2;
        }
#line 706
        goto switch_break___0;
        case_0___0: /* CIL Label */ 
#line 708
        goto switch_break___0;
        case_1___0: /* CIL Label */ 
#line 711
        if (i != 0) {
#line 712
          goto switch_break___0;
        }
#line 715
        track_linenum = line_start;
#line 716
        if (! first_hunk) {
          {
          {
#line 719
          fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
          }
          }
        } else
#line 716
        if ((unsigned int )output_matching == 2U) {
#line 716
          if (hunknum > 1UL) {
            {
            {
#line 719
            fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
            }
            }
          }
        }
#line 720
        goto switch_break___0;
        case_2: /* CIL Label */ 
#line 723
        if (i != 1) {
#line 724
          goto switch_break___0;
        }
#line 726
        track_linenum = line_start + (unsigned long )munge_offset;
#line 727
        if (! first_hunk) {
          {
          {
#line 730
          fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
          }
          }
        } else
#line 727
        if ((unsigned int )output_matching == 2U) {
#line 727
          if (hunknum > 1UL) {
            {
            {
#line 730
            fputs((char const   */* __restrict  */)"...\n", (FILE */* __restrict  */)output_to);
            }
            }
          }
        }
#line 731
        goto switch_break___0;
        switch_break___0: /* CIL Label */ ;
        }
      }
    }
#line 735
    if (i) {
#line 735
      if (line_count == unchanged) {
#line 736
        goto while_break;
      }
    }
    {
    {
#line 738
    while (1) {
      while_continue___3: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 738
      tmp___10 = line_count;
#line 738
      line_count --;
#line 738
      if (! tmp___10) {
#line 738
        goto while_break___0;
      }
      {
      {
#line 739
      tmp___5 = getline((char **/* __restrict  */)line, (size_t */* __restrict  */)linelen,
                        (FILE */* __restrict  */)f);
      }
#line 739
      got = tmp___5;
      }
#line 740
      if (got == -1) {
#line 741
        ret = -1;
#line 742
        goto out;
      }
#line 745
      (*linenum___1) ++;
#line 747
      if (hunk_match) {
#line 747
        if ((unsigned int )mode___1 == 2U) {
          {
          {
#line 747
          tmp___7 = regexecs___0(regex___0, num_regex___0, (char const   *)(*line + 2),
                                 (size_t )0, (regmatch_t *)((void *)0), 0);
          }
          }
#line 747
          if (! tmp___7) {
#line 750
            if ((unsigned int )output_matching == 0U) {
#line 751
              if (! displayed_filename) {
                {
#line 752
                displayed_filename = 1;
                {
#line 753
                display_filename___0(start_linenum, status, bestname, patchname);
                }
                }
              }
#line 759
              if (numbering___0) {
#line 759
                if (verbose___0) {
#line 759
                  if (hunknum > last_hunkmatch) {
#line 761
                    last_hunkmatch = hunknum;
#line 762
                    if (print_patchnames___0) {
                      {
                      {
#line 763
                      printf((char const   */* __restrict  */)"%s-", patchname);
                      }
                      }
                    }
                    {
                    {
#line 765
                    printf((char const   */* __restrict  */)"\t%lu\tHunk #%lu\n",
                           hunk_linenum, hunknum);
                    }
                    }
                  }
                }
              }
            } else {
#line 769
              if (! header_displayed) {
#line 770
                if ((unsigned int )number_lines___0 != 2U) {
                  {
                  {
#line 771
                  output_header_line___0((char const   *)*(header + 0));
                  }
                  }
                }
#line 772
                if ((unsigned int )number_lines___0 != 1U) {
                  {
                  {
#line 773
                  output_header_line___0((char const   *)*(header + 1));
                  }
                  }
                }
#line 774
                header_displayed = 1;
              }
#line 777
              if (match_tmpf) {
                {
                {
#line 778
                rewind(match_tmpf);
                }
                }
                {
                {
#line 779
                while (1) {
                  while_continue___4: /* CIL Label */ ;
                  while_continue___1: /* CIL Label */ ;
                  {
                  {
#line 779
                  tmp___6 = feof(match_tmpf);
                  }
                  }
#line 779
                  if (tmp___6) {
#line 779
                    goto while_break___1;
                  }
                  {
                  {
#line 781
                  ch = fgetc(match_tmpf);
                  }
                  }
#line 782
                  if (ch == -1) {
#line 783
                    goto while_break___1;
                  }
                  {
                  {
#line 784
                  putchar(ch);
                  }
                  }
                }
                while_break___4: /* CIL Label */ ;
                }
                while_break___1: /* CIL Label */ ;
                }
                {
                {
#line 786
                fclose(match_tmpf);
                }
#line 787
                match_tmpf = (FILE *)((void *)0);
                }
              }
#line 790
              grepmatch = 1;
            }
          }
        }
      }
#line 794
      if (! i) {
#line 794
        if (first) {
          {
#line 795
          first = 0;
          {
#line 796
          tmp___8 = strncmp((char const   *)*line, "--- ", (size_t )4);
          }
          }
#line 796
          if (! tmp___8) {
#line 799
            i ++;
#line 800
            goto do_line_counts;
          }
        }
      }
#line 804
      if ((int )*(*line) == 32) {
#line 805
        unchanged ++;
      }
#line 807
      if (empty_files_as_absent___0) {
        {
#line 809
        if ((int )*(*line) == 33) {
#line 809
          goto case_33;
        }
#line 809
        if ((int )*(*line) == 32) {
#line 809
          goto case_33;
        }
#line 812
        if ((int )*(*line) == 43) {
#line 812
          goto case_43;
        }
#line 815
        if ((int )*(*line) == 45) {
#line 815
          goto case_45;
        }
#line 807
        goto switch_break___1;
        case_33: /* CIL Label */ 
        case_32: /* CIL Label */ 
#line 810
        orig_is_empty = 0;
#line 810
        new_is_empty = orig_is_empty;
#line 811
        goto switch_break___1;
        case_43: /* CIL Label */ 
#line 813
        new_is_empty = 0;
#line 814
        goto switch_break___1;
        case_45: /* CIL Label */ 
#line 816
        orig_is_empty = 0;
#line 817
        goto switch_break___1;
        switch_break___1: /* CIL Label */ ;
        }
      }
#line 820
      if (hunk_match) {
#line 820
        if ((unsigned int )mode___1 == 0U) {
#line 820
          goto _L___1;
        } else
#line 820
        if ((unsigned int )output_matching != 0U) {
          _L___1: /* CIL Label */ 
#line 823
          output_to___0 = stdout;
#line 824
          if ((unsigned int )mode___1 == 2U) {
#line 824
            if (! grepmatch) {
#line 825
              output_to___0 = match_tmpf;
            }
          }
#line 827
          if ((unsigned int )number_lines___0 == 0U) {
            {
            {
#line 828
            fwrite((void const   */* __restrict  */)*line, (size_t )got, (size_t )1,
                   (FILE */* __restrict  */)output_to___0);
            }
            }
          } else
#line 830
          if ((unsigned int )number_lines___0 == 1U) {
#line 830
            if (! i) {
              {
#line 832
              tmp___9 = track_linenum;
#line 832
              track_linenum ++;
              {
#line 832
              fprintf((FILE */* __restrict  */)output_to___0, (char const   */* __restrict  */)"%lu\t:",
                      tmp___9);
              }
              {
#line 834
              fwrite((void const   */* __restrict  */)(*line + 2), (size_t )got - 2U,
                     (size_t )1, (FILE */* __restrict  */)output_to___0);
              }
              }
            } else {
#line 830
              goto _L___0;
            }
          } else
          _L___0: /* CIL Label */ 
#line 830
          if ((unsigned int )number_lines___0 == 2U) {
#line 830
            if (i) {
              {
#line 832
              tmp___9 = track_linenum;
#line 832
              track_linenum ++;
              {
#line 832
              fprintf((FILE */* __restrict  */)output_to___0, (char const   */* __restrict  */)"%lu\t:",
                      tmp___9);
              }
              {
#line 834
              fwrite((void const   */* __restrict  */)(*line + 2), (size_t )got - 2U,
                     (size_t )1, (FILE */* __restrict  */)output_to___0);
              }
              }
            }
          }
        }
      }
#line 839
      if ((unsigned int )mode___1 == 0U) {
#line 839
        if (! hunk_match) {
#line 839
          goto _L___2;
        } else {
#line 839
          goto _L___3;
        }
      } else
      _L___3: /* CIL Label */ 
#line 839
      if ((unsigned int )output_matching == 1U) {
        _L___2: /* CIL Label */ 
        {
#line 842
        if ((int )*(*line) == 33) {
#line 842
          goto case_33___0;
        }
#line 845
        if ((int )*(*line) == 43) {
#line 845
          goto case_43___0;
        }
#line 848
        if ((int )*(*line) == 45) {
#line 848
          goto case_45___0;
        }
#line 841
        goto switch_break___2;
        case_33___0: /* CIL Label */ 
#line 843
        (changed[i]) ++;
#line 844
        goto switch_break___2;
        case_43___0: /* CIL Label */ 
#line 846
        (changed[1]) ++;
#line 847
        goto switch_break___2;
        case_45___0: /* CIL Label */ 
#line 849
        (changed[0]) ++;
#line 850
        goto switch_break___2;
        switch_break___2: /* CIL Label */ ;
        }
      }
    }
    while_break___3: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    __Cont: /* CIL Label */ 
#line 577
    i ++;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 855
  if ((unsigned int )output_matching != 1U) {
#line 856
    munge_offset = (long )((unsigned long )munge_offset + (changed[0] - changed[1]));
  } else
#line 855
  if (! grepmatch) {
#line 856
    munge_offset = (long )((unsigned long )munge_offset + (changed[0] - changed[1]));
  }
#line 857
  goto next_hunk;
  out: 
#line 860
  if (match_tmpf) {
    {
    {
#line 861
    fclose(match_tmpf);
    }
    }
  }
#line 863
  if (empty_files_as_absent___0) {
#line 864
    if ((unsigned long )orig_file_exists != (unsigned long )((void *)0)) {
#line 864
      if (orig_is_empty) {
#line 865
        *orig_file_exists = 0;
      }
    }
#line 866
    if ((unsigned long )new_file_exists != (unsigned long )((void *)0)) {
#line 866
      if (new_is_empty) {
#line 867
        *new_file_exists = 0;
      }
    }
  }
#line 870
  return (ret);
}
}
#line 875
static int filterdiff___0(FILE *f , char const   *patchname ) ;
#line 875 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static unsigned long linenum___0  =    1UL;
#line 873 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int filterdiff___0(FILE *f , char const   *patchname ) 
{ 
  char *names[2] ;
  char *header[2] ;
  char *line ;
  size_t linelen ;
  char *p ;
  char const   *p_stripped ;
  int match ;
  int i ;
  __ssize_t tmp ;
  char status ;
  unsigned long start_linenum ;
  int orig_file_exists ;
  int new_file_exists ;
  int is_context ;
  int result ;
  int (*do_diff)(FILE * , char ** , int  , char ** , size_t * , unsigned long * ,
                 unsigned long  , char  , char const   * , char const   * , int * ,
                 int * ) ;
  int tmp___0 ;
  int tmp___1 ;
  __ssize_t tmp___2 ;
  size_t tmp___3 ;
  __ssize_t tmp___4 ;
  char const   *tmp___5 ;
  int tmp___6 ;
  size_t tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  void *__cil_tmp29 ;
  void *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;

  {
  {
#line 877
  header[0] = (char *)((void *)0);
#line 877
  header[1] = (char *)((void *)0);
#line 878
  line = (char *)((void *)0);
#line 879
  linelen = (size_t )0;
  {
#line 885
  tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)f);
  }
  }
#line 885
  if (tmp == -1) {
#line 886
    return (0);
  }
  {
  {
#line 888
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 889
    status = (char )'!';
#line 892
    is_context = 0;
#line 899
    orig_file_exists = 0;
    {
    {
#line 903
    while (1) {
      while_continue___4: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
      {
      {
#line 904
      tmp___0 = strncmp((char const   *)line, "--- ", (size_t )4);
      }
      }
#line 904
      if (! tmp___0) {
#line 905
        is_context = 0;
#line 906
        goto while_break___0;
      }
      {
      {
#line 909
      tmp___1 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 909
      if (! tmp___1) {
#line 910
        is_context = 1;
#line 911
        goto while_break___0;
      }
#line 916
      if ((unsigned int )mode___1 == 0U) {
#line 916
        if (pat_exclude___0) {
#line 916
          goto _L;
        } else
#line 916
        if (verbose___0) {
          _L: /* CIL Label */ 
#line 916
          if (! clean_comments___0) {
            {
            {
#line 918
            fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)stdout);
            }
            }
          }
        }
      }
      {
      {
#line 920
      tmp___2 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)f);
      }
      }
#line 920
      if (tmp___2 == -1) {
#line 921
        goto eof;
      }
#line 922
      linenum___0 ++;
    }
    while_break___4: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    {
#line 925
    start_linenum = linenum___0;
    {
#line 926
    header[0] = xstrdup((char const   *)line);
    }
    {
#line 927
    names[0] = filename_from_header((char const   *)(line + 4));
    }
    }
#line 928
    if ((unsigned int )mode___1 != 0U) {
#line 928
      if (show_status___0) {
        {
        {
#line 929
        tmp___3 = strlen((char const   *)names[0]);
        }
        {
#line 929
        orig_file_exists = file_exists___0((char const   *)names[0], (char const   *)((line + 4) + tmp___3));
        }
        }
      }
    }
    {
    {
#line 932
    tmp___4 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)f);
    }
    }
#line 932
    if (tmp___4 == -1) {
#line 935
      if ((unsigned int )mode___1 == 0U) {
#line 935
        if (pat_exclude___0) {
#line 935
          goto _L___0;
        } else
#line 935
        if (verbose___0) {
          _L___0: /* CIL Label */ 
#line 935
          if (! clean_comments___0) {
            {
            {
#line 937
            fputs((char const   */* __restrict  */)header[0], (FILE */* __restrict  */)stdout);
            }
            }
          }
        }
      }
      {
      {
#line 938
      free((void *)names[0]);
      }
      }
#line 939
      goto eof;
    }
#line 941
    linenum___0 ++;
#line 943
    if (is_context) {
#line 943
      tmp___5 = "--- ";
    } else {
#line 943
      tmp___5 = "+++ ";
    }
    {
    {
#line 943
    tmp___6 = strncmp((char const   *)line, tmp___5, (size_t )4);
    }
    }
#line 943
    if (tmp___6) {
#line 946
      if ((unsigned int )mode___1 == 0U) {
#line 946
        if (pat_exclude___0) {
#line 946
          goto _L___1;
        } else
#line 946
        if (verbose___0) {
          _L___1: /* CIL Label */ 
#line 946
          if (! clean_comments___0) {
            {
            {
#line 948
            fputs((char const   */* __restrict  */)header[0], (FILE */* __restrict  */)stdout);
            }
            }
          }
        }
      }
      {
      {
#line 949
      free((void *)names[0]);
      }
      {
#line 950
      free((void *)header[0]);
      }
#line 951
      header[0] = (char *)((void *)0);
      }
#line 952
      goto __Cont;
    }
    {
#line 955
    filecount___0 ++;
    {
#line 956
    header[1] = xstrdup((char const   *)line);
    }
    {
#line 957
    names[1] = filename_from_header((char const   *)(line + 4));
    }
    }
#line 959
    if ((unsigned int )mode___1 != 0U) {
#line 959
      if (show_status___0) {
        {
        {
#line 960
        tmp___7 = strlen((char const   *)names[1]);
        }
        {
#line 960
        new_file_exists = file_exists___0((char const   *)names[1], (char const   *)((line + 4) + tmp___7));
        }
        }
      }
    }
    {
    {
#line 964
    p = best_name(2, names);
    }
    {
#line 965
    p_stripped = stripped((char const   *)p, ignore_components___1);
    }
    {
#line 967
    tmp___8 = patlist_match(pat_exclude___0, p_stripped);
    }
    }
#line 967
    if (tmp___8) {
#line 967
      tmp___9 = 0;
    } else {
#line 967
      tmp___9 = 1;
    }
#line 967
    match = tmp___9;
#line 968
    if (match) {
#line 968
      if ((unsigned long )pat_include___0 != (unsigned long )((void *)0)) {
        {
        {
#line 969
        match = patlist_match(pat_include___0, p_stripped);
        }
        }
      }
    }
#line 972
    if (match) {
#line 972
      if (! show_status___0) {
#line 972
        if ((unsigned int )mode___1 == 1U) {
          {
          {
#line 973
          display_filename___0(start_linenum, status, (char const   *)p, patchname);
          }
          }
        }
      }
    }
#line 976
    if (is_context) {
#line 977
      do_diff = & do_context___0;
    } else {
#line 979
      do_diff = & do_unified___0;
    }
    {
    {
#line 981
    result = (*do_diff)(f, (char **)(header), match, & line, & linelen, & linenum___0,
                        start_linenum, status, (char const   *)p, patchname, & orig_file_exists,
                        & new_file_exists);
    }
    }
#line 987
    if (match) {
#line 987
      if (show_status___0) {
#line 987
        if ((unsigned int )mode___1 == 1U) {
#line 988
          if (! orig_file_exists) {
#line 989
            status = (char )'+';
          } else
#line 990
          if (! new_file_exists) {
#line 991
            status = (char )'-';
          }
          {
          {
#line 993
          display_filename___0(start_linenum, status, (char const   *)p, patchname);
          }
          }
        }
      }
    }
    {
#line 998
    if (result == -1) {
#line 998
      goto case_neg_1;
    }
#line 1002
    if (result == 1) {
#line 1002
      goto case_1;
    }
#line 997
    goto switch_break;
    case_neg_1: /* CIL Label */ 
    {
    {
#line 999
    free((void *)names[0]);
    }
    {
#line 1000
    free((void *)names[1]);
    }
    }
#line 1001
    goto eof;
    case_1: /* CIL Label */ 
#line 1003
    goto next_diff;
    switch_break: /* CIL Label */ ;
    }
    next_diff: 
#line 1007
    i = 0;
    {
    {
#line 1007
    while (1) {
      while_continue___5: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 1007
      if (! (i < 2)) {
#line 1007
        goto while_break___1;
      }
      {
      {
#line 1008
      free((void *)names[i]);
      }
      {
#line 1009
      free((void *)header[i]);
      }
#line 1010
      header[i] = (char *)((void *)0);
#line 1007
      i ++;
      }
    }
    while_break___5: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  eof: 
#line 1015
  i = 0;
  {
  {
#line 1015
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue___2: /* CIL Label */ ;
#line 1015
    if (! (i < 2)) {
#line 1015
      goto while_break___2;
    }
#line 1016
    if (header[i]) {
      {
      {
#line 1017
      free((void *)header[i]);
      }
      }
    }
#line 1015
    i ++;
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break___2: /* CIL Label */ ;
  }
#line 1019
  if (line) {
    {
    {
#line 1020
    free((void *)line);
    }
    }
  }
#line 1022
  return (0);
}
}
#line 1086
static  __attribute__((__noreturn__)) void syntax___3(int err ) ;
#line 1086 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void syntax___3(int err ) 
{ 
  char *s ;
  char *tmp ;
  char const   *usage ;
  char *p ;
  char *next ;
  struct _IO_FILE *tmp___0 ;
  char *endp ;
  char *tmp___1 ;
  char *begp ;
  char *tmp___2 ;
  char *comma ;
  char *tmp___3 ;
  int tmp___4 ;
  size_t tmp___5 ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;

  {
  {
  {
#line 1089
  tmp = xstrdup(syntax_str);
  }
#line 1089
  s = tmp;
#line 1090
  usage = "usage: %s [OPTION]... [files ...]\n";
  }
#line 1092
  if ((unsigned int )mode___1 == 2U) {
#line 1093
    usage = "usage: %s [OPTION]... REGEX [files ...]\n";
  }
#line 1094
  if (err) {
#line 1094
    tmp___0 = stderr;
  } else {
#line 1094
    tmp___0 = stdout;
  }
  {
  {
#line 1094
  fprintf((FILE */* __restrict  */)tmp___0, (char const   */* __restrict  */)usage,
          progname);
  }
#line 1095
  p = s;
  }
  {
  {
#line 1095
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1095
    if (p) {
#line 1095
      if (! *p) {
#line 1095
        goto while_break;
      }
    } else {
#line 1095
      goto while_break;
    }
    {
    {
#line 1097
    next = strchr((char const   *)p, '\n');
    }
    }
#line 1098
    if (! next) {
#line 1099
      goto while_break;
    }
#line 1100
    endp = next;
#line 1101
    tmp___1 = next;
#line 1101
    next ++;
#line 1101
    *tmp___1 = (char )'\000';
#line 1102
    endp --;
#line 1102
    if ((int )*endp == 41) {
      {
      {
#line 1103
      tmp___2 = strrchr((char const   *)p, '(');
      }
#line 1103
      begp = tmp___2;
      }
#line 1105
      if (! begp) {
#line 1106
        goto while_break;
      }
#line 1107
      tmp___3 = begp;
#line 1107
      begp ++;
#line 1107
      *tmp___3 = (char )'\000';
#line 1108
      *endp = (char )'\000';
      {
      {
#line 1109
      while (1) {
        while_continue___2: /* CIL Label */ ;
        while_continue___0: /* CIL Label */ ;
        {
        {
#line 1110
        comma = strchr((char const   *)begp, ',');
        }
        }
#line 1111
        if (comma) {
#line 1112
          *comma = (char )'\000';
        }
        {
        {
#line 1113
        tmp___4 = strcmp((char const   *)progname, (char const   *)begp);
        }
        }
#line 1113
        if (! tmp___4) {
          {
          {
#line 1114
          puts((char const   *)p);
          }
          }
#line 1115
          goto while_break___0;
        }
#line 1117
        if (comma) {
          {
          {
#line 1118
          tmp___5 = strspn((char const   *)(comma + 1), " ");
          }
#line 1118
          begp = (comma + 1) + tmp___5;
          }
        }
#line 1109
        if (! comma) {
#line 1109
          goto while_break___0;
        }
      }
      while_break___2: /* CIL Label */ ;
      }
      while_break___0: /* CIL Label */ ;
      }
    } else {
      {
      {
#line 1122
      puts((char const   *)p);
      }
      }
    }
#line 1095
    p = next;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1124
  exit(err);
  }
  }
}
}
#line 1127 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void parse_range___0(struct range **r , char const   *rstr ) 
{ 
  unsigned long n ;
  char *end ;
  void *tmp ;
  unsigned long tmp___0 ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;

  {
#line 1133
  if ((int const   )*rstr == 45) {
#line 1134
    n = 0xffffffffffffffffUL;
  } else {
    {
    {
#line 1136
    n = strtoul((char const   */* __restrict  */)rstr, (char **/* __restrict  */)(& end),
                0);
    }
    }
#line 1137
    if ((unsigned long )rstr == (unsigned long )end) {
#line 1138
      if (*end) {
        {
        {
#line 1139
        error(1, 0, "not understood: \'%s\'", end);
        }
        }
      } else {
        {
        {
#line 1142
        error(1, 0, "missing number in range list");
        }
        }
      }
#line 1145
      *r = (struct range *)((void *)0);
#line 1146
      return;
    }
#line 1149
    rstr = (char const   *)end;
  }
  {
  {
#line 1152
  tmp = xmalloc((size_t )sizeof(*(*r)));
  }
#line 1152
  *r = (struct range *)tmp;
#line 1153
  tmp___0 = n;
#line 1153
  (*r)->end = tmp___0;
#line 1153
  (*r)->start = tmp___0;
#line 1154
  (*r)->next = (struct range *)((void *)0);
  }
#line 1155
  if ((int const   )*rstr == 45) {
    {
#line 1156
    rstr ++;
    {
#line 1157
    n = strtoul((char const   */* __restrict  */)rstr, (char **/* __restrict  */)(& end),
                0);
    }
    }
#line 1158
    if ((unsigned long )rstr == (unsigned long )end) {
#line 1159
      n = 0xffffffffffffffffUL;
    }
#line 1161
    (*r)->end = n;
#line 1162
    rstr = (char const   *)end;
#line 1164
    if ((*r)->start != 0xffffffffffffffffUL) {
#line 1164
      if ((*r)->start > (*r)->end) {
        {
        {
#line 1165
        error(1, 0, "invalid range: %lu-%lu", (*r)->start, (*r)->end);
        }
        }
      }
    }
  }
#line 1169
  if ((int const   )*rstr == 44) {
    {
    {
#line 1170
    parse_range___0(& (*r)->next, rstr + 1);
    }
    }
  } else
#line 1171
  if ((int const   )*rstr != 0) {
    {
    {
#line 1172
    error(1, 0, "not understood: \'%s\'", rstr);
    }
    }
  }
#line 1173
  return;
}
}
#line 1175 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void set_list___0(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1178
  set_progname("lsdiff");
  }
#line 1179
  mode___1 = (enum __anonenum_mode_31___0 )1;
  }
#line 1180
  return;
}
}
#line 1182 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void set_filter___0(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1185
  set_progname("filterdiff");
  }
#line 1186
  mode___1 = (enum __anonenum_mode_31___0 )0;
  }
#line 1187
  return;
}
}
#line 1189 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void set_grep___0(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1192
  set_progname("grepdiff");
  }
#line 1193
  mode___1 = (enum __anonenum_mode_31___0 )2;
  }
#line 1194
  return;
}
}
#line 1196 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static void determine_mode_from_name___0(char const   *argv0 ) 
{ 
  char const   *p ;
  char *tmp ;
  char const   *tmp___0 ;
  char *tmp___1 ;
  char *tmp___2 ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;

  {
  {
  {
#line 1199
  tmp = strrchr(argv0, '/');
  }
#line 1199
  p = (char const   *)tmp;
#line 1200
  tmp___0 = p;
#line 1200
  p ++;
  }
#line 1200
  if (! tmp___0) {
#line 1201
    p = argv0;
  }
  {
  {
#line 1202
  tmp___2 = strstr(p, "lsdiff");
  }
  }
#line 1202
  if (tmp___2) {
    {
    {
#line 1203
    set_list___0();
    }
    }
  } else {
    {
    {
#line 1204
    tmp___1 = strstr(p, "grepdiff");
    }
    }
#line 1204
    if (tmp___1) {
      {
      {
#line 1205
      set_grep___0();
      }
      }
    } else {
      {
      {
#line 1207
      set_filter___0();
      }
      }
    }
  }
#line 1208
  return;
}
}
#line 1210 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static FILE *convert_format___0(FILE *f , char format ) 
{ 
  char *__cil_tmp3 ;
  char *__cil_tmp4 ;

  {
  {
#line 1215
  if ((int )format == 99) {
#line 1215
    goto case_99;
  }
#line 1218
  if ((int )format == 117) {
#line 1218
    goto case_117;
  }
#line 1213
  goto switch_default;
  switch_default: /* CIL Label */ 
#line 1214
  goto switch_break;
  case_99: /* CIL Label */ 
  {
  {
#line 1216
  f = convert_to_context(f, "rb", 0);
  }
  }
#line 1217
  goto switch_break;
  case_117: /* CIL Label */ 
  {
  {
#line 1219
  f = convert_to_unified(f, "rb", 0);
  }
  }
#line 1220
  goto switch_break;
  switch_break: /* CIL Label */ ;
  }
#line 1223
  return (f);
}
}
#line 1226 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static int read_regex_file___0(char const   *file ) 
{ 
  FILE *f ;
  FILE *tmp ;
  char *line ;
  size_t linelen ;
  ssize_t got ;
  int err ;
  int *tmp___0 ;
  void *tmp___1 ;
  char errstr[300] ;
  int tmp___2 ;
  void *__cil_tmp12 ;
  char *__cil_tmp13 ;
  char *__cil_tmp14 ;

  {
  {
  {
#line 1229
  tmp = fopen((char const   */* __restrict  */)file, (char const   */* __restrict  */)"r");
  }
#line 1229
  f = tmp;
#line 1230
  line = (char *)((void *)0);
#line 1231
  linelen = (size_t )0;
  }
#line 1235
  if (! f) {
    {
    {
#line 1236
    tmp___0 = __errno_location();
    }
    {
#line 1236
    error(1, *tmp___0, "cannot open %s", file);
    }
    }
  }
  {
  {
#line 1238
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1238
    got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)f);
    }
    }
#line 1238
    if (! (got > 0)) {
#line 1238
      goto while_break;
    }
#line 1239
    got --;
#line 1239
    if ((int )*(line + got) == 10) {
#line 1240
      *(line + got) = (char )'\000';
    }
    {
#line 1242
    num_regex___0 ++;
    {
#line 1242
    tmp___1 = xrealloc((void *)regex___0, (size_t )((unsigned long )num_regex___0 * sizeof(*(regex___0 + 0))));
    }
#line 1242
    regex___0 = (regex_t *)tmp___1;
    {
#line 1243
    err = regcomp((regex_t */* __restrict  */)(regex___0 + (num_regex___0 - 1U)),
                  (char const   */* __restrict  */)line, (((1 << 1) << 1) << 1) | egrepping___0);
    }
    }
#line 1245
    if (err) {
      {
      {
#line 1247
      regerror(err, (regex_t const   */* __restrict  */)(regex___0 + (num_regex___0 - 1U)),
               (char */* __restrict  */)(errstr), (size_t )sizeof(errstr));
      }
      {
#line 1249
      error(1, 0, (char const   *)(errstr));
      }
      {
#line 1250
      exit(1);
      }
      }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1254
  free((void *)line);
  }
  {
#line 1255
  tmp___2 = fclose(f);
  }
  }
#line 1255
  return (tmp___2);
}
}
#line 1268 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/filterdiff.c"
static struct option long_options___3[36]  = 
#line 1268
  {      {"help", 0, (int *)0, 1072}, 
        {"version", 0, (int *)0, 1086}, 
        {"verbose", 0, (int *)0, 'v'}, 
        {"list", 0, (int *)0, 'l'}, 
        {"filter", 0, (int *)0, 1102}, 
        {"grep", 0, (int *)0, 'g'}, 
        {"strip", 1, (int *)0, 1083}, 
        {"addprefix", 1, (int *)0, 1065}, 
        {"addoldprefix", 1, (int *)0, 1079}, 
        {"addnewprefix", 1, (int *)0, 1078}, 
        {"hunks", 1, (int *)0, '#'}, 
        {"lines", 1, (int *)0, 1058}, 
        {"files", 1, (int *)0, 1119}, 
        {"as-numbered-lines", 1, (int *)0, 1076}, 
        {"annotate", 0, (int *)0, 1097}, 
        {"format", 1, (int *)0, 1070}, 
        {"output-matching", 1, (int *)0, 1111}, 
        {"remove-timestamps", 0, (int *)0, 1114}, 
        {"with-filename", 0, (int *)0, 'H'}, 
        {"no-filename", 0, (int *)0, 'h'}, 
        {"empty-files-as-absent", 0, (int *)0, 'E'}, 
        {"number-files", 0, (int *)0, 1110}, 
        {"clean", 0, (int *)0, 1099}, 
        {"strip-match", 1, (int *)0, 'p'}, 
        {"include", 1, (int *)0, 'i'}, 
        {"exclude", 1, (int *)0, 'x'}, 
        {"include-from-file", 1, (int *)0, 'I'}, 
        {"exclude-from-file", 1, (int *)0, 'X'}, 
        {"decompress", 0, (int *)0, 'z'}, 
        {"line-number", 0, (int *)0, 'n'}, 
        {"strip-match", 1, (int *)0, 'p'}, 
        {"status", 0, (int *)0, 's'}, 
        {"extended-regexp", 0, (int *)0, 'E'}, 
        {"empty-files-as-removed", 0, (int *)0, 'E'}, 
        {"file", 1, (int *)0, 'f'}, 
        {(char const   *)0, 0, (int *)0, 0}};
#line 62 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static enum __anonenum_mode_54___0 mode___2  ;
#line 67 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int flipdiff_inplace___0  =    0;
#line 92 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int human_readable___0  =    1;
#line 93 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static char diff_opts___0[4]  ;
#line 94 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static unsigned int max_context_real___0  =    3U;
#line 94 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static unsigned int max_context___0  =    3U;
#line 95 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int context_specified___0  =    0;
#line 96 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int ignore_components___2  =    0;
#line 97 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int unzip___2  =    0;
#line 98 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int no_revert_omitted___0  =    0;
#line 99 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int debug___0  =    0;
#line 101 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct patlist *pat_drop_context___0  =    (struct patlist *)((void *)0);
#line 103 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct file_list *files_done___0  =    (struct file_list *)((void *)0);
#line 104 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct file_list *files_in_patch2___0  =    (struct file_list *)((void *)0);
#line 107 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int check_filename___0(char const   *fn ) 
{ 
  int tmp ;

  {
  {
  {
#line 110
  tmp = patlist_match(pat_drop_context___0, fn);
  }
  }
#line 110
  if (tmp) {
#line 111
    max_context___0 = 0U;
  } else {
#line 113
    max_context___0 = max_context_real___0;
  }
#line 115
  return (1);
}
}
#line 118 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void add_to_list___0(struct file_list **list , char const   *file , long pos ) 
{ 
  struct file_list *make ;
  void *tmp ;

  {
  {
  {
#line 122
  tmp = xmalloc((size_t )sizeof(*make));
  }
#line 122
  make = (struct file_list *)tmp;
#line 123
  make->next = (struct file_list *)((void *)0);
#line 124
  make->tail = (struct file_list *)((void *)0);
  {
#line 125
  make->file = xstrdup(file);
  }
#line 126
  make->pos = pos;
  }
#line 128
  if (*list) {
#line 129
    ((*list)->tail)->next = make;
#line 130
    (*list)->tail = make;
  } else {
#line 132
    make->tail = make;
#line 133
    *list = make;
  }
#line 135
  return;
}
}
#line 137 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static long file_in_list___0(struct file_list *list , char const   *file ) 
{ 
  char const   *tmp ;
  int tmp___0 ;

  {
  {
  {
#line 140
  file = stripped(file, ignore_components___2);
  }
  }
  {
  {
#line 141
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 141
    if (! list) {
#line 141
      goto while_break;
    }
    {
    {
#line 142
    tmp = stripped((char const   *)list->file, ignore_components___2);
    }
    {
#line 142
    tmp___0 = strcmp(tmp, file);
    }
    }
#line 142
    if (! tmp___0) {
#line 143
      return (list->pos);
    }
#line 144
    list = list->next;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 146
  return (-1L);
}
}
#line 149 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void free_list___0(struct file_list *list ) 
{ 
  struct file_list *next ;

  {
  {
  {
#line 153
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 153
    if (! list) {
#line 153
      goto while_break;
    }
    {
#line 154
    next = list->next;
    {
#line 155
    free((void *)list->file);
    }
    {
#line 156
    free((void *)list);
    }
#line 153
    list = next;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 158
  return;
}
}
#line 160 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void insert_line_before___0(struct lines_info *lines___1 , struct lines *at ,
                                   struct lines *make ) 
{ 


  {
#line 164
  make->next = at;
#line 165
  make->prev = at->prev;
#line 166
  if (at->prev) {
#line 167
    (at->prev)->next = make;
  } else {
#line 169
    lines___1->head = make;
  }
#line 170
  at->prev = make;
#line 171
  return;
}
}
#line 174 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int add_line___0(struct lines_info *lines___1 , char const   *line , size_t length ,
                        unsigned long n ) 
{ 
  struct lines *make ;
  struct lines *at ;
  void *tmp ;
  void *tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  char *__cil_tmp11 ;
  char *__cil_tmp12 ;

  {
  {
  {
#line 181
  tmp = xmalloc((size_t )sizeof(*make));
  }
#line 181
  make = (struct lines *)tmp;
#line 182
  make->n = n;
  {
#line 183
  tmp___0 = xmalloc(length + 1U);
  }
#line 183
  make->line = (char *)tmp___0;
  {
#line 184
  memcpy((void */* __restrict  */)make->line, (void const   */* __restrict  */)line,
         length);
  }
#line 185
  *(make->line + length) = (char )'\000';
#line 186
  make->length = length;
  }
#line 188
  if (! lines___1->tail) {
#line 190
    make->prev = (struct lines *)((void *)0);
#line 191
    make->next = (struct lines *)((void *)0);
#line 192
    lines___1->head = make;
#line 193
    lines___1->tail = make;
#line 194
    return (0);
  }
#line 196
  if ((lines___1->tail)->n < n) {
#line 198
    (lines___1->tail)->next = make;
#line 199
    make->next = (struct lines *)((void *)0);
#line 200
    make->prev = lines___1->tail;
#line 201
    lines___1->tail = make;
#line 202
    return (0);
  }
#line 205
  if (! lines___1->head) {
    {
    {
#line 206
    error(1, 0, "List corrupted: no head");
    }
    }
  }
#line 208
  at = lines___1->head;
  {
  {
#line 209
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 209
    if (! at) {
#line 209
      goto while_break;
    }
#line 210
    if (n < at->n) {
      {
      {
#line 211
      insert_line_before___0(lines___1, at, make);
      }
      }
#line 212
      return (0);
    }
#line 214
    if (n == at->n) {
      {
      {
#line 215
      free((void *)make->line);
      }
      {
#line 216
      free((void *)make);
      }
      }
#line 217
      if (at->length == length) {
        {
        {
#line 217
        tmp___1 = memcmp((void const   *)at->line, (void const   *)line, length);
        }
        }
#line 217
        if (! tmp___1) {
#line 220
          return (0);
        }
      }
#line 223
      if (at->length < length) {
#line 224
        return (-1);
      }
#line 225
      if (at->length > length) {
#line 226
        return (1);
      }
      {
      {
#line 227
      tmp___2 = memcmp((void const   *)at->line, (void const   *)line, length);
      }
      }
#line 227
      return (tmp___2);
    }
#line 229
    make->prev = at;
#line 230
    at = at->next;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 233
  if (! at) {
    {
    {
#line 234
    error(1, 0, "List corrupted: ordering");
    }
    }
  }
#line 236
  return (1);
}
}
#line 239 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void merge_lines___0(struct lines_info *lines1 , struct lines_info *lines2 ) 
{ 
  struct lines *at ;
  struct lines *at_prev ;
  struct lines *make ;
  struct lines *next ;

  {
#line 250
  if (lines2->first_offset < lines1->first_offset) {
#line 251
    lines1->first_offset = lines2->first_offset;
  }
#line 253
  if (! lines1->head) {
#line 255
    lines1->head = lines2->head;
#line 256
    return;
  }
#line 260
  at = lines1->head;
#line 261
  make = lines2->head;
  {
  {
#line 262
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 262
    if (! at) {
#line 262
      goto while_break;
    }
    {
    {
#line 263
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 263
      if (! make) {
#line 263
        goto while_break___0;
      }
#line 264
      if (make->n > at->n) {
#line 265
        goto while_break___0;
      }
#line 267
      if (make->n < at->n) {
        {
#line 268
        next = make->next;
        {
#line 270
        insert_line_before___0(lines1, at, make);
        }
#line 271
        make = next;
        }
#line 272
        goto while_continue___0;
      }
#line 275
      make = make->next;
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 277
    at_prev = at;
#line 278
    at = at->next;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 282
  if (make) {
#line 283
    at_prev->next = make;
  }
#line 284
  return;
}
}
#line 286 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void free_lines___0(struct lines *list ) 
{ 
  struct lines *next ;

  {
  {
  {
#line 290
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 290
    if (! list) {
#line 290
      goto while_break;
    }
    {
#line 291
    next = list->next;
    {
#line 292
    free((void *)list->line);
    }
    {
#line 293
    free((void *)list);
    }
#line 290
    list = next;
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 295
  return;
}
}
#line 297 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct lines *create_orig___0(FILE *f , struct lines_info *file , int reverted ,
                                     int *clash ) 
{ 
  unsigned long linenum___1 ;
  char *line ;
  char first_char ;
  size_t linelen ;
  int last_was_add ;
  long pos ;
  long tmp ;
  unsigned long min_context ;
  __ssize_t tmp___0 ;
  int tmp___1 ;
  unsigned long orig_lines ;
  unsigned long new_lines ;
  unsigned long newline ;
  int file_is_removed ;
  unsigned long context ;
  int leading_context ;
  char *p ;
  char *q ;
  int tmp___2 ;
  int tmp___3 ;
  ssize_t got ;
  unsigned long tmp___4 ;
  int tmp___5 ;
  struct lines *at ;
  struct lines *prev ;
  __ssize_t tmp___6 ;
  int tmp___7 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;

  {
  {
#line 302
  line = (char *)((void *)0);
#line 303
  linelen = (size_t )0;
  {
#line 305
  tmp = ftell(f);
  }
#line 305
  pos = tmp;
#line 306
  min_context = 3UL;
  }
  {
  {
#line 308
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 309
    tmp___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)f);
    }
    }
#line 309
    if (tmp___0 == -1) {
#line 310
      goto while_break;
    }
    {
    {
#line 308
    tmp___1 = strncmp((char const   *)line, "@@ ", (size_t )3);
    }
    }
#line 308
    if (! tmp___1) {
#line 308
      goto while_break;
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 313
  while (1) {
    while_continue___4: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
    {
    {
#line 313
    tmp___7 = feof(f);
    }
    }
#line 313
    if (tmp___7) {
#line 313
      goto while_break___0;
    }
    {
#line 316
    file_is_removed = 0;
    {
#line 321
    tmp___2 = strncmp((char const   *)line, "@@", (size_t )2);
    }
    }
#line 321
    if (tmp___2) {
      {
      {
#line 322
      fseek(f, pos, 0);
      }
      }
#line 323
      goto while_break___0;
    }
#line 326
    if (reverted) {
      {
      {
#line 327
      new_lines = orig_num_lines((char const   *)line);
      }
      {
#line 328
      orig_lines = new_num_lines((char const   *)line);
      }
      }
    } else {
      {
      {
#line 330
      orig_lines = orig_num_lines((char const   *)line);
      }
      {
#line 331
      new_lines = new_num_lines((char const   *)line);
      }
      }
    }
#line 334
    if (reverted) {
#line 334
      tmp___3 = '+';
    } else {
#line 334
      tmp___3 = '-';
    }
    {
    {
#line 334
    p = strchr((char const   *)line, tmp___3);
    }
    }
#line 335
    if (! p) {
#line 336
      goto while_break___0;
    }
    {
#line 338
    p ++;
    {
#line 339
    linenum___1 = strtoul((char const   */* __restrict  */)p, (char **/* __restrict  */)(& q),
                          10);
    }
    }
#line 340
    if ((unsigned long )p == (unsigned long )q) {
#line 341
      goto while_break___0;
    }
#line 342
    if (linenum___1 == 0UL) {
#line 343
      file_is_removed = 1;
#line 344
      file->first_offset = 0UL;
    } else
#line 345
    if (! file->first_offset) {
#line 345
      goto _L;
    } else
#line 345
    if (linenum___1 < file->first_offset) {
      _L: /* CIL Label */ 
#line 347
      file->first_offset = linenum___1;
#line 348
      if (! orig_lines) {
#line 349
        (file->first_offset) ++;
      }
    }
#line 354
    context = 0UL;
#line 355
    leading_context = 1;
#line 358
    last_was_add = 0;
#line 359
    newline = 1UL;
    {
    {
#line 360
    while (1) {
      while_continue___5: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 360
      if (! orig_lines) {
#line 360
        if (! new_lines) {
#line 360
          if (! newline) {
#line 360
            goto while_break___1;
          }
        }
      }
      {
      {
#line 362
      pos = ftell(f);
      }
      {
#line 363
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)f);
      }
      }
#line 364
      if (got == -1) {
#line 365
        goto while_break___1;
      }
#line 367
      if (! orig_lines) {
#line 367
        if (! new_lines) {
#line 367
          if ((int )*(line + 0) != 92) {
#line 369
            goto while_break___1;
          }
        }
      }
#line 371
      first_char = *(line + 0);
#line 372
      if (reverted) {
#line 373
        if ((int )first_char == 45) {
#line 374
          first_char = (char )'+';
        } else
#line 375
        if ((int )first_char == 43) {
#line 376
          first_char = (char )'-';
        }
      }
      {
#line 380
      if ((int )first_char == 32) {
#line 380
        goto case_32;
      }
#line 383
      if ((int )first_char == 45) {
#line 383
        goto case_45;
      }
#line 397
      if ((int )first_char == 43) {
#line 397
        goto case_43;
      }
#line 401
      if ((int )first_char == 92) {
#line 401
        goto case_92;
      }
#line 379
      goto switch_break;
      case_32: /* CIL Label */ 
#line 381
      if (leading_context) {
#line 381
        context ++;
      }
#line 382
      if (new_lines) {
#line 382
        new_lines --;
      }
      case_45: /* CIL Label */ 
#line 384
      leading_context = 0;
#line 385
      if (orig_lines) {
#line 385
        orig_lines --;
      }
#line 386
      if (! file_is_removed) {
        {
#line 387
        tmp___4 = linenum___1;
#line 387
        linenum___1 ++;
        {
#line 387
        tmp___5 = add_line___0(file, (char const   *)(line + 1), (size_t )got - 1U,
                               tmp___4);
        }
        }
#line 387
        if (tmp___5) {
#line 387
          if (clash) {
#line 390
            (*clash) ++;
#line 391
            if (debug___0) {
              {
              {
#line 392
              printf((char const   */* __restrict  */)"clash at line %lu\n", linenum___1 - 1UL);
              }
              }
            }
          }
        }
      }
#line 396
      goto switch_break;
      case_43: /* CIL Label */ 
#line 398
      leading_context = 0;
#line 399
      if (new_lines) {
#line 399
        new_lines --;
      }
#line 400
      goto switch_break;
      case_92: /* CIL Label */ 
#line 402
      leading_context = 0;
#line 403
      newline = 0UL;
#line 404
      if (! file_is_removed) {
#line 404
        if (! last_was_add) {
#line 405
          prev = (struct lines *)((void *)0);
#line 406
          at = file->head;
          {
          {
#line 406
          while (1) {
            while_continue___6: /* CIL Label */ ;
            while_continue___2: /* CIL Label */ ;
#line 406
            if (! at) {
#line 406
              goto while_break___2;
            }
#line 407
            prev = at;
#line 406
            at = at->next;
          }
          while_break___6: /* CIL Label */ ;
          }
          while_break___2: /* CIL Label */ ;
          }
#line 408
          if (! prev) {
            {
            {
#line 409
            error(1, 0, "Garbled patch");
            }
            }
          }
#line 411
          if (prev->length >= 1U) {
#line 411
            if ((int )*(prev->line + (prev->length - 1U)) == 10) {
#line 413
              (prev->length) --;
            }
          }
        }
      }
#line 415
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
#line 418
      last_was_add = (int )*(line + 0) == 43;
    }
    while_break___5: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
#line 421
    if (! newline) {
      {
      {
#line 422
      pos = ftell(f);
      }
      {
#line 423
      tmp___6 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)f);
      }
      }
#line 423
      if (tmp___6 == -1) {
#line 424
        goto while_break___0;
      }
    }
#line 427
    if (context < min_context) {
#line 428
      min_context = context;
    }
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 431
  if (line) {
    {
    {
#line 432
    free((void *)line);
    }
    }
  }
#line 434
  file->min_context = min_context;
#line 435
  return (file->head);
}
}
#line 438 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void construct_unline___0(struct lines_info *file_info ) 
{ 
  char *un ;
  struct lines *at ;
  size_t i ;
  char *tmp ;
  void *tmp___0 ;
  size_t j ;
  size_t tmp___1 ;
  unsigned short const   **tmp___2 ;
  size_t tmp___3 ;
  int tmp___4 ;
  size_t maxlength ;
  size_t len ;
  size_t tmp___5 ;
  char *tmp___6 ;
  void *tmp___7 ;
  size_t tmp___8 ;

  {
#line 445
  if (file_info->unline) {
#line 447
    return;
  }
  {
  {
#line 449
  tmp___0 = xmalloc((size_t )7);
  }
#line 449
  tmp = (char *)tmp___0;
#line 449
  file_info->unline = tmp;
#line 449
  un = tmp;
#line 452
  i = (size_t )0;
#line 452
  at = file_info->head;
  }
  {
  {
#line 452
  while (1) {
    while_continue___5: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 452
    if (at) {
#line 452
      if (! (i < 5U)) {
#line 452
        goto while_break;
      }
    } else {
#line 452
      goto while_break;
    }
    {
    {
#line 453
    tmp___1 = strlen((char const   *)at->line);
    }
#line 453
    j = tmp___1 - 1U;
    }
#line 454
    if (i < j) {
#line 455
      j = i;
    }
    {
#line 456
    *(un + i) = (char )((int )*(at->line + j) + 1);
    {
#line 457
    tmp___2 = __ctype_b_loc();
    }
    }
#line 457
    if ((int const   )*(*tmp___2 + (int )*(un + i)) & 2) {
#line 458
      *(un + i) = (char )'!';
    }
#line 452
    i ++;
#line 452
    at = at->next;
  }
  while_break___5: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 460
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 460
    if (! (i < 5U)) {
#line 460
      goto while_break___0;
    }
#line 461
    *(un + i) = (char )'!';
#line 460
    i ++;
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 462
  tmp___3 = i;
#line 462
  i ++;
#line 462
  *(un + tmp___3) = (char )'\n';
#line 463
  *(un + i) = (char )'\000';
#line 465
  i = (size_t )4;
  {
  {
#line 465
  while (1) {
    while_continue___7: /* CIL Label */ ;
    while_continue___1: /* CIL Label */ ;
#line 465
    if (! (i > 0U)) {
#line 465
      goto while_break___1;
    }
#line 467
    at = file_info->head;
    {
    {
#line 467
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
#line 467
      if (! at) {
#line 467
        goto while_break___2;
      }
      {
      {
#line 468
      tmp___4 = strcmp((char const   *)at->line, (char const   *)un);
      }
      }
#line 468
      if (! tmp___4) {
#line 469
        goto while_break___2;
      }
#line 467
      at = at->next;
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
#line 471
    if (! at) {
#line 473
      goto while_break___1;
    }
#line 475
    *(un + i) = (char )'\n';
#line 476
    *(un + (i + 1U)) = (char )'\000';
#line 465
    i --;
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 479
  if (i == 0U) {
#line 481
    maxlength = (size_t )0;
#line 482
    at = file_info->head;
    {
    {
#line 482
    while (1) {
      while_continue___9: /* CIL Label */ ;
      while_continue___3: /* CIL Label */ ;
#line 482
      if (! at) {
#line 482
        goto while_break___3;
      }
      {
      {
#line 483
      tmp___5 = strlen((char const   *)at->line);
      }
#line 483
      len = tmp___5;
      }
#line 484
      if (len > maxlength) {
#line 485
        maxlength = len;
      }
#line 482
      at = at->next;
    }
    while_break___9: /* CIL Label */ ;
    }
    while_break___3: /* CIL Label */ ;
    }
    {
    {
#line 488
    free((void *)un);
    }
    {
#line 489
    tmp___7 = xmalloc(maxlength + 3U);
    }
#line 489
    tmp___6 = (char *)tmp___7;
#line 489
    file_info->unline = tmp___6;
#line 489
    un = tmp___6;
#line 490
    i = (size_t )0;
    }
    {
    {
#line 490
    while (1) {
      while_continue___10: /* CIL Label */ ;
      while_continue___4: /* CIL Label */ ;
#line 490
      if (! (i < maxlength)) {
#line 490
        goto while_break___4;
      }
#line 491
      *(un + i) = (char )'!';
#line 490
      i ++;
    }
    while_break___10: /* CIL Label */ ;
    }
    while_break___4: /* CIL Label */ ;
    }
#line 492
    tmp___8 = i;
#line 492
    i ++;
#line 492
    *(un + tmp___8) = (char )'\n';
#line 493
    *(un + i) = (char )'\000';
  }
#line 495
  return;
}
}
#line 497 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int write_file___0(struct lines_info *file_info , int fd ) 
{ 
  unsigned long linenum___1 ;
  struct lines *at ;
  FILE *fout ;
  FILE *tmp ;
  unsigned long i ;
  unsigned long tmp___0 ;
  char *__cil_tmp9 ;
  char *__cil_tmp10 ;

  {
  {
  {
#line 502
  tmp = fdopen(fd, "w");
  }
#line 502
  fout = tmp;
  {
#line 504
  construct_unline___0(file_info);
  }
#line 505
  linenum___1 = 1UL;
  }
  {
  {
#line 505
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 505
    if (! (linenum___1 < file_info->first_offset)) {
#line 505
      goto while_break;
    }
    {
    {
#line 506
    fputs((char const   */* __restrict  */)file_info->unline, (FILE */* __restrict  */)fout);
    }
#line 505
    linenum___1 ++;
    }
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 508
  at = file_info->head;
  {
  {
#line 508
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 508
    if (! at) {
#line 508
      goto while_break___0;
    }
#line 509
    i = at->n - linenum___1;
    {
    {
#line 510
    while (1) {
      while_continue___4: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 510
      tmp___0 = i;
#line 510
      i --;
#line 510
      if (! tmp___0) {
#line 510
        goto while_break___1;
      }
      {
      {
#line 511
      fprintf((FILE */* __restrict  */)fout, (char const   */* __restrict  */)"%s",
              file_info->unline);
      }
#line 512
      linenum___1 ++;
      }
    }
    while_break___4: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
    {
    {
#line 514
    fwrite((void const   */* __restrict  */)at->line, at->length, (size_t )1, (FILE */* __restrict  */)fout);
    }
#line 515
    linenum___1 ++;
#line 508
    at = at->next;
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
  {
#line 517
  fclose(fout);
  }
  }
#line 518
  return (0);
}
}
#line 521 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int do_output_patch1_only___0(FILE *p1 , FILE *out , int not_reverted ) 
{ 
  char *line ;
  char *oldname ;
  char first_char ;
  size_t linelen ;
  ssize_t got ;
  long pos ;
  int *tmp ;
  __ssize_t tmp___0 ;
  int tmp___1 ;
  int *tmp___2 ;
  __ssize_t tmp___3 ;
  int tmp___4 ;
  int *tmp___5 ;
  unsigned long orig_lines ;
  unsigned long new_lines ;
  unsigned long newline ;
  char *d1 ;
  char *d2 ;
  char *p ;
  size_t h ;
  int tmp___6 ;
  size_t tmp___7 ;
  __ssize_t tmp___8 ;
  char *__cil_tmp27 ;
  char *__cil_tmp28 ;
  char *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;
  char *__cil_tmp40 ;
  char *__cil_tmp41 ;
  char *__cil_tmp42 ;
  char *__cil_tmp43 ;
  char *__cil_tmp44 ;

  {
  {
#line 531
  oldname = (char *)((void *)0);
#line 532
  linelen = (size_t )0;
  {
#line 533
  tmp___0 = getline((char **/* __restrict  */)(& oldname), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)p1);
  }
  }
#line 533
  if (tmp___0 < 0) {
    {
    {
#line 534
    tmp = __errno_location();
    }
    {
#line 534
    error(1, *tmp, "Bad patch #1");
    }
    }
  }
  {
  {
#line 536
  tmp___1 = strncmp((char const   *)oldname, "--- ", (size_t )4);
  }
  }
#line 536
  if (tmp___1) {
    {
    {
#line 537
    error(1, 0, "Bad patch #1");
    }
    }
  }
  {
#line 539
  line = (char *)((void *)0);
#line 540
  linelen = (size_t )0;
  {
#line 541
  tmp___3 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)p1);
  }
  }
#line 541
  if (tmp___3 < 0) {
    {
    {
#line 542
    tmp___2 = __errno_location();
    }
    {
#line 542
    error(1, *tmp___2, "Bad patch #1");
    }
    }
  }
  {
  {
#line 544
  tmp___4 = strncmp((char const   *)line, "+++ ", (size_t )4);
  }
  }
#line 544
  if (tmp___4) {
    {
    {
#line 545
    error(1, 0, "Bad patch #1");
    }
    }
  }
#line 547
  if (not_reverted) {
#line 549
    if (human_readable___0) {
#line 549
      if ((unsigned int )mode___2 != 2U) {
        {
        {
#line 550
        fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"unchanged:\n");
        }
        }
      }
    }
    {
    {
#line 551
    fputs((char const   */* __restrict  */)oldname, (FILE */* __restrict  */)out);
    }
    {
#line 552
    fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
    }
    }
  } else
#line 553
  if (! no_revert_omitted___0) {
#line 554
    if (human_readable___0) {
      {
      {
#line 555
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"reverted:\n");
      }
      }
    }
    {
    {
#line 556
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"--- %s",
            line + 4);
    }
    {
#line 557
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"+++ %s",
            oldname + 4);
    }
    }
  }
  {
  {
#line 559
  free((void *)oldname);
  }
  {
#line 561
  pos = ftell(p1);
  }
  {
#line 562
  got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                (FILE */* __restrict  */)p1);
  }
  }
#line 563
  if (got < 0) {
    {
    {
#line 564
    tmp___5 = __errno_location();
    }
    {
#line 564
    error(1, *tmp___5, "Bad patch #1");
    }
    }
  }
  {
  {
#line 566
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 573
    tmp___6 = strncmp((char const   *)line, "@@ ", (size_t )3);
    }
    }
#line 573
    if (tmp___6) {
      {
      {
#line 574
      fseek(p1, pos, 0);
      }
      }
#line 575
      goto while_break;
    }
    {
#line 578
    p = line + 3;
    {
#line 579
    h = strcspn((char const   *)p, " \t");
    }
    {
#line 580
    d1 = xstrndup((char const   *)p, (size_t const   )h);
    }
#line 581
    p += h;
    {
#line 582
    tmp___7 = strspn((char const   *)p, " \t");
    }
#line 582
    p += tmp___7;
    {
#line 583
    h = strcspn((char const   *)p, " \t");
    }
    {
#line 584
    d2 = xstrndup((char const   *)p, (size_t const   )h);
    }
    }
#line 585
    if (! *d1) {
      {
      {
#line 586
      error(1, 0, "Bad patch #1");
      }
      }
    } else
#line 585
    if (! *d2) {
      {
      {
#line 586
      error(1, 0, "Bad patch #1");
      }
      }
    }
#line 588
    if (not_reverted) {
      {
      {
#line 590
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
      }
      {
#line 591
      new_lines = orig_num_lines((char const   *)d1);
      }
      {
#line 592
      orig_lines = new_num_lines((char const   *)d2);
      }
      }
    } else {
#line 595
      if (! no_revert_omitted___0) {
        {
        {
#line 596
        fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"@@ -%s +%s @@\n",
                d2 + 1, d1 + 1);
        }
        }
      }
      {
      {
#line 598
      orig_lines = orig_num_lines((char const   *)d1);
      }
      {
#line 599
      new_lines = new_num_lines((char const   *)d2);
      }
      }
    }
    {
    {
#line 603
    free((void *)d1);
    }
    {
#line 604
    free((void *)d2);
    }
#line 606
    newline = 1UL;
    }
    {
    {
#line 607
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 607
      if (! orig_lines) {
#line 607
        if (! new_lines) {
#line 607
          if (! newline) {
#line 607
            goto while_break___0;
          }
        }
      }
      {
      {
#line 608
      pos = ftell(p1);
      }
      {
#line 609
      got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                    (FILE */* __restrict  */)p1);
      }
      }
#line 610
      if (got == -1) {
#line 611
        goto while_break___0;
      }
#line 613
      if (! orig_lines) {
#line 613
        if (! new_lines) {
#line 613
          if ((int )*(line + 0) != 92) {
#line 615
            goto while_break___0;
          }
        }
      }
#line 617
      first_char = *(line + 0);
#line 618
      if (not_reverted) {
#line 619
        if ((int )first_char == 43) {
#line 620
          first_char = (char )'-';
        } else
#line 621
        if ((int )first_char == 45) {
#line 622
          first_char = (char )'+';
        }
      }
      {
#line 626
      if ((int )first_char == 32) {
#line 626
        goto case_32;
      }
#line 632
      if ((int )first_char == 43) {
#line 632
        goto case_43;
      }
#line 640
      if ((int )first_char == 45) {
#line 640
        goto case_45;
      }
#line 648
      if ((int )first_char == 92) {
#line 648
        goto case_92;
      }
#line 625
      goto switch_break;
      case_32: /* CIL Label */ 
#line 627
      if (orig_lines) {
#line 627
        orig_lines --;
      }
#line 628
      if (new_lines) {
#line 628
        new_lines --;
      }
#line 629
      if (not_reverted) {
        {
        {
#line 630
        fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
        }
        }
      } else
#line 629
      if (! no_revert_omitted___0) {
        {
        {
#line 630
        fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
        }
        }
      }
#line 631
      goto switch_break;
      case_43: /* CIL Label */ 
#line 633
      if (new_lines) {
#line 633
        new_lines --;
      }
#line 634
      if (not_reverted) {
        {
        {
#line 635
        fputc('-', out);
        }
        {
#line 636
        fwrite((void const   */* __restrict  */)(line + 1), (size_t )got - 1U, (size_t )1,
               (FILE */* __restrict  */)out);
        }
        }
      } else
#line 634
      if (! no_revert_omitted___0) {
        {
        {
#line 635
        fputc('-', out);
        }
        {
#line 636
        fwrite((void const   */* __restrict  */)(line + 1), (size_t )got - 1U, (size_t )1,
               (FILE */* __restrict  */)out);
        }
        }
      }
#line 639
      goto switch_break;
      case_45: /* CIL Label */ 
#line 641
      if (orig_lines) {
#line 641
        orig_lines --;
      }
#line 642
      if (not_reverted) {
        {
        {
#line 643
        fputc('+', out);
        }
        {
#line 644
        fwrite((void const   */* __restrict  */)(line + 1), (size_t )got - 1U, (size_t )1,
               (FILE */* __restrict  */)out);
        }
        }
      } else
#line 642
      if (! no_revert_omitted___0) {
        {
        {
#line 643
        fputc('+', out);
        }
        {
#line 644
        fwrite((void const   */* __restrict  */)(line + 1), (size_t )got - 1U, (size_t )1,
               (FILE */* __restrict  */)out);
        }
        }
      }
#line 647
      goto switch_break;
      case_92: /* CIL Label */ 
#line 649
      newline = 0UL;
#line 650
      if (not_reverted) {
        {
        {
#line 651
        fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
        }
        }
      } else
#line 650
      if (! no_revert_omitted___0) {
        {
        {
#line 651
        fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
        }
        }
      }
#line 652
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 656
    if (! newline) {
      {
      {
#line 657
      pos = ftell(p1);
      }
      {
#line 658
      tmp___8 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)p1);
      }
      }
#line 658
      if (tmp___8 == -1) {
#line 659
        goto while_break;
      }
    }
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 663
  if (line) {
    {
    {
#line 664
    free((void *)line);
    }
    }
  }
#line 666
  return (0);
}
}
#line 669 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int output_patch1_only___0(FILE *p1 , FILE *out , int not_reverted ) 
{ 
  char const   *tmpdir ;
  unsigned int tmplen ;
  char tail1[20] ;
  char tail2[20] ;
  char *tmpp1 ;
  char *tmpp2 ;
  char options[100] ;
  int tmpp1fd ;
  int tmpp2fd ;
  long pos ;
  long start ;
  char *oldname ;
  char *newname ;
  size_t oldnamelen ;
  size_t newnamelen ;
  struct lines_info file_orig ;
  struct lines_info file_new ;
  pid_t child ;
  FILE *in ;
  int diff_is_empty ;
  unsigned int use_context ;
  int tmp ;
  char *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  int *tmp___3 ;
  __ssize_t tmp___4 ;
  int tmp___5 ;
  size_t tmp___6 ;
  int *tmp___7 ;
  __ssize_t tmp___8 ;
  int *tmp___9 ;
  int tmp___10 ;
  size_t tmp___11 ;
  int ch ;
  int tmp___12 ;
  int ch___0 ;
  int tmp___13 ;
  char *line ;
  size_t linelen ;
  ssize_t got ;
  __ssize_t tmp___14 ;
  void *__cil_tmp46 ;
  void *__cil_tmp47 ;
  void *__cil_tmp48 ;
  char *__cil_tmp49 ;
  char *__cil_tmp50 ;
  char *__cil_tmp51 ;
  char *__cil_tmp52 ;
  char *__cil_tmp53 ;
  char *__cil_tmp54 ;
  char *__cil_tmp55 ;
  char *__cil_tmp56 ;
  char *__cil_tmp57 ;
  char *__cil_tmp58 ;
  char *__cil_tmp59 ;
  char *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;

  {
#line 674
  tail1[0] = (char )'/';
#line 674
  tail1[1] = (char )'i';
#line 674
  tail1[2] = (char )'n';
#line 674
  tail1[3] = (char )'t';
#line 674
  tail1[4] = (char )'e';
#line 674
  tail1[5] = (char )'r';
#line 674
  tail1[6] = (char )'d';
#line 674
  tail1[7] = (char )'i';
#line 674
  tail1[8] = (char )'f';
#line 674
  tail1[9] = (char )'f';
#line 674
  tail1[10] = (char )'-';
#line 674
  tail1[11] = (char )'1';
#line 674
  tail1[12] = (char )'.';
#line 674
  tail1[13] = (char )'X';
#line 674
  tail1[14] = (char )'X';
#line 674
  tail1[15] = (char )'X';
#line 674
  tail1[16] = (char )'X';
#line 674
  tail1[17] = (char )'X';
#line 674
  tail1[18] = (char )'X';
#line 674
  tail1[19] = (char )'\000';
#line 675
  tail2[0] = (char )'/';
#line 675
  tail2[1] = (char )'i';
#line 675
  tail2[2] = (char )'n';
#line 675
  tail2[3] = (char )'t';
#line 675
  tail2[4] = (char )'e';
#line 675
  tail2[5] = (char )'r';
#line 675
  tail2[6] = (char )'d';
#line 675
  tail2[7] = (char )'i';
#line 675
  tail2[8] = (char )'f';
#line 675
  tail2[9] = (char )'f';
#line 675
  tail2[10] = (char )'-';
#line 675
  tail2[11] = (char )'2';
#line 675
  tail2[12] = (char )'.';
#line 675
  tail2[13] = (char )'X';
#line 675
  tail2[14] = (char )'X';
#line 675
  tail2[15] = (char )'X';
#line 675
  tail2[16] = (char )'X';
#line 675
  tail2[17] = (char )'X';
#line 675
  tail2[18] = (char )'X';
#line 675
  tail2[19] = (char )'\000';
#line 681
  oldname = (char *)((void *)0);
#line 681
  newname = (char *)((void *)0);
#line 682
  oldnamelen = (size_t )0;
#line 682
  newnamelen = (size_t )0;
#line 683
  file_orig.unline = (char *)((void *)0);
#line 683
  file_orig.first_offset = 0UL;
#line 683
  file_orig.min_context = 0UL;
#line 683
  file_orig.head = (struct lines *)((void *)0);
#line 683
  file_orig.tail = (struct lines *)((void *)0);
#line 684
  file_new.unline = (char *)((void *)0);
#line 684
  file_new.first_offset = 0UL;
#line 684
  file_new.min_context = 0UL;
#line 684
  file_new.head = (struct lines *)((void *)0);
#line 684
  file_new.tail = (struct lines *)((void *)0);
#line 687
  diff_is_empty = 1;
#line 688
  use_context = max_context___0;
#line 690
  if ((int )diff_opts___0[0] == 0) {
#line 690
    if (! context_specified___0) {
      {
      {
#line 691
      tmp = do_output_patch1_only___0(p1, out, not_reverted);
      }
      }
#line 691
      return (tmp);
    }
  }
  {
  {
#line 694
  tmp___0 = getenv("TMPDIR");
  }
#line 694
  tmpdir = (char const   *)tmp___0;
  }
#line 695
  if (! tmpdir) {
#line 696
    tmpdir = "/tmp";
  }
  {
  {
#line 698
  tmplen = strlen(tmpdir);
  }
  {
#line 699
  tmp___1 = __builtin_alloca((unsigned long )tmplen + sizeof(tail1));
  }
#line 699
  tmpp1 = (char *)tmp___1;
  {
#line 700
  memcpy((void */* __restrict  */)tmpp1, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 701
  memcpy((void */* __restrict  */)(tmpp1 + tmplen), (void const   */* __restrict  */)(tail1),
         (size_t )sizeof(tail1));
  }
  {
#line 702
  tmp___2 = __builtin_alloca((unsigned long )tmplen + sizeof(tail2));
  }
#line 702
  tmpp2 = (char *)tmp___2;
  {
#line 703
  memcpy((void */* __restrict  */)tmpp2, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 704
  memcpy((void */* __restrict  */)(tmpp2 + tmplen), (void const   */* __restrict  */)(tail2),
         (size_t )sizeof(tail2));
  }
  {
#line 706
  tmpp1fd = xmkstemp(tmpp1);
  }
  {
#line 707
  tmpp2fd = xmkstemp(tmpp2);
  }
  {
#line 709
  pos = ftell(p1);
  }
  }
  {
  {
#line 710
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 711
    if (oldname) {
      {
      {
#line 712
      free((void *)oldname);
      }
#line 713
      oldname = (char *)((void *)0);
#line 714
      oldnamelen = (size_t )0;
      }
    }
    {
    {
#line 716
    tmp___4 = getline((char **/* __restrict  */)(& oldname), (size_t */* __restrict  */)(& oldnamelen),
                      (FILE */* __restrict  */)p1);
    }
    }
#line 716
    if (tmp___4 < 0) {
      {
      {
#line 717
      tmp___3 = __errno_location();
      }
      {
#line 717
      error(1, *tmp___3, "Bad patch #1");
      }
      }
    }
    {
    {
#line 710
    tmp___5 = strncmp((char const   *)oldname, "--- ", (size_t )4);
    }
    }
#line 710
    if (! tmp___5) {
#line 710
      goto while_break;
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 720
  tmp___6 = strlen((char const   *)oldname);
  }
#line 720
  *(oldname + (tmp___6 - 1U)) = (char )'\000';
  {
#line 722
  tmp___8 = getline((char **/* __restrict  */)(& newname), (size_t */* __restrict  */)(& newnamelen),
                    (FILE */* __restrict  */)p1);
  }
  }
#line 722
  if (tmp___8 < 0) {
    {
    {
#line 723
    tmp___7 = __errno_location();
    }
    {
#line 723
    error(1, *tmp___7, "Bad patch #1");
    }
    }
  }
  {
  {
#line 724
  tmp___10 = strncmp((char const   *)newname, "+++ ", (size_t )4);
  }
  }
#line 724
  if (tmp___10) {
    {
    {
#line 725
    tmp___9 = __errno_location();
    }
    {
#line 725
    error(1, *tmp___9, "Bad patch #1");
    }
    }
  }
  {
  {
#line 726
  tmp___11 = strlen((char const   *)newname);
  }
#line 726
  *(newname + (tmp___11 - 1U)) = (char )'\000';
  {
#line 727
  start = ftell(p1);
  }
  {
#line 730
  fseek(p1, pos, 0);
  }
  {
#line 731
  create_orig___0(p1, & file_orig, ! not_reverted, (int *)((void *)0));
  }
  {
#line 732
  fseek(p1, pos, 0);
  }
  {
#line 733
  create_orig___0(p1, & file_new, not_reverted, (int *)((void *)0));
  }
  }
#line 736
  if (file_orig.min_context < (unsigned long )use_context) {
#line 737
    use_context = (unsigned int )file_orig.min_context;
  }
#line 739
  if (use_context == 3U) {
    {
    {
#line 740
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%su",
            diff_opts___0);
    }
    }
  } else {
    {
    {
#line 742
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%sU%d",
            diff_opts___0, use_context);
    }
    }
  }
  {
  {
#line 745
  write_file___0(& file_orig, tmpp1fd);
  }
#line 746
  file_new.unline = file_orig.unline;
  {
#line 747
  write_file___0(& file_new, tmpp2fd);
  }
  {
#line 748
  free_lines___0(file_orig.head);
  }
  {
#line 749
  free_lines___0(file_new.head);
  }
  {
#line 751
  fflush((FILE *)((void *)0));
  }
  {
#line 752
  in = xpipe("diff", & child, "r", "diff", options, tmpp1, tmpp2, (void *)0);
  }
  }
  {
  {
#line 755
  while (1) {
    while_continue___4: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
    {
    {
#line 756
    tmp___12 = fgetc(in);
    }
#line 756
    ch = tmp___12;
    }
#line 757
    if (ch == -1) {
#line 758
      goto while_break___0;
    } else
#line 757
    if (ch == 10) {
#line 758
      goto while_break___0;
    }
#line 759
    diff_is_empty = 0;
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
  {
#line 763
  while (1) {
    while_continue___5: /* CIL Label */ ;
    while_continue___1: /* CIL Label */ ;
    {
    {
#line 764
    tmp___13 = fgetc(in);
    }
#line 764
    ch___0 = tmp___13;
    }
#line 765
    if (ch___0 == -1) {
#line 766
      goto while_break___1;
    } else
#line 765
    if (ch___0 == 10) {
#line 766
      goto while_break___1;
    }
  }
  while_break___5: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
#line 769
  if (! diff_is_empty) {
#line 770
    line = (char *)((void *)0);
#line 771
    linelen = (size_t )0;
#line 772
    if (not_reverted) {
      {
      {
#line 773
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"--- %s\n",
              oldname + 4);
      }
      {
#line 774
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"+++ %s\n",
              newname + 4);
      }
      }
    } else {
      {
      {
#line 776
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"--- %s\n",
              newname + 4);
      }
      {
#line 777
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"+++ %s\n",
              oldname + 4);
      }
      }
    }
    {
    {
#line 779
    while (1) {
      while_continue___6: /* CIL Label */ ;
      while_continue___2: /* CIL Label */ ;
      {
      {
#line 780
      tmp___14 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)in);
      }
#line 780
      got = tmp___14;
      }
#line 781
      if (got < 0) {
#line 782
        goto while_break___2;
      }
      {
      {
#line 783
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
      }
      }
    }
    while_break___6: /* CIL Label */ ;
    }
    while_break___2: /* CIL Label */ ;
    }
  }
  {
  {
#line 787
  fclose(in);
  }
  {
#line 788
  waitpid(child, (int *)((void *)0), 0);
  }
  }
#line 789
  if (debug___0) {
    {
    {
#line 790
    printf((char const   */* __restrict  */)"reconstructed orig1=%s orig2=%s\n", tmpp1,
           tmpp2);
    }
    }
  } else {
    {
    {
#line 792
    unlink((char const   *)tmpp1);
    }
    {
#line 793
    unlink((char const   *)tmpp2);
    }
    }
  }
  {
  {
#line 795
  free((void *)oldname);
  }
  {
#line 796
  free((void *)newname);
  }
  }
#line 797
  return (0);
}
}
#line 800 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int apply_patch___0(FILE *patch , char const   *file , int reverted ) 
{ 
  unsigned long orig_lines ;
  unsigned long new_lines ;
  size_t linelen ;
  char *line ;
  pid_t child ;
  int status ;
  FILE *w ;
  char const   *tmp ;
  ssize_t got ;
  __ssize_t tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  union __anonunion_55___0 __constr_expr_1 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;

  {
#line 810
  if (reverted) {
#line 810
    tmp = "-Rsp0";
  } else {
#line 810
    tmp = "-sp0";
  }
  {
  {
#line 810
  w = xpipe("patch", & child, "w", "patch", tmp, (void *)0);
  }
  {
#line 813
  fprintf((FILE */* __restrict  */)w, (char const   */* __restrict  */)"--- %s\n+++ %s\n",
          file, file);
  }
#line 814
  line = (char *)((void *)0);
#line 815
  linelen = (size_t )0;
#line 816
  new_lines = 0UL;
#line 816
  orig_lines = new_lines;
  }
  {
  {
#line 817
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 818
    tmp___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)patch);
    }
#line 818
    got = tmp___0;
    }
#line 819
    if (got == -1) {
#line 820
      goto while_break;
    }
#line 823
    if (! orig_lines) {
#line 823
      if (! new_lines) {
        {
        {
#line 823
        tmp___1 = strncmp((char const   *)line, "--- ", (size_t )4);
        }
        }
#line 823
        if (! tmp___1) {
#line 824
          goto while_break;
        }
      }
    }
    {
    {
#line 826
    fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)w);
    }
    {
#line 828
    tmp___2 = strncmp((char const   *)line, "@@ ", (size_t )3);
    }
    }
#line 828
    if (! tmp___2) {
      {
      {
#line 829
      orig_lines = orig_num_lines((char const   *)line);
      }
      {
#line 830
      new_lines = new_num_lines((char const   *)line);
      }
      }
#line 831
      goto __Cont;
    }
#line 834
    if (orig_lines) {
#line 834
      if ((int )*(line + 0) != 43) {
#line 835
        orig_lines --;
      }
    }
#line 836
    if (new_lines) {
#line 836
      if ((int )*(line + 0) != 45) {
#line 837
        new_lines --;
      }
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 839
  fclose(w);
  }
  {
#line 840
  waitpid(child, & status, 0);
  }
  }
#line 842
  if (line) {
    {
    {
#line 843
    free((void *)line);
    }
    }
  }
#line 845
  __constr_expr_1.__in = status;
#line 845
  return ((__constr_expr_1.__i & 65280) >> 8);
}
}
#line 848 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int trim_context___0(FILE *f , char const   *unline , FILE *out ) 
{ 
  char *line ;
  size_t linelen ;
  fpos_t pos ;
  unsigned long pre ;
  unsigned long pre_seen ;
  unsigned long post ;
  unsigned long strip_pre ;
  unsigned long strip_post ;
  unsigned long orig_offset ;
  unsigned long new_offset ;
  unsigned long orig_count ;
  unsigned long orig_orig_count ;
  unsigned long new_orig_count ;
  unsigned long new_count ;
  unsigned long orig_new_count ;
  unsigned long new_new_count ;
  unsigned long total_count ;
  __ssize_t tmp ;
  int tmp___0 ;
  __ssize_t tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  ssize_t got ;
  __ssize_t tmp___4 ;
  unsigned long tmp___5 ;
  char *__cil_tmp29 ;
  char *__cil_tmp30 ;
  char *__cil_tmp31 ;
  char *__cil_tmp32 ;
  char *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;
  char *__cil_tmp40 ;

  {
#line 856
  line = (char *)((void *)0);
  {
  {
#line 859
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
#line 861
    pre = 0UL;
#line 861
    pre_seen = 0UL;
#line 861
    post = 0UL;
#line 862
    strip_pre = 0UL;
#line 862
    strip_post = 0UL;
#line 866
    total_count = 0UL;
    {
#line 869
    tmp = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)f);
    }
    }
#line 869
    if (tmp < 0) {
#line 870
      goto while_break;
    }
#line 872
    if ((int )*(line + 0) == 92) {
      {
      {
#line 874
      fputs((char const   */* __restrict  */)line, (FILE */* __restrict  */)out);
      }
      }
#line 875
      goto __Cont;
    }
    {
    {
#line 878
    tmp___0 = read_atatline((char const   *)line, & orig_offset, & orig_count, & new_offset,
                            & new_count);
    }
    }
#line 878
    if (tmp___0) {
      {
      {
#line 880
      error(1, 0, "Line not understood: %s", line);
      }
      }
    }
    {
#line 883
    new_orig_count = orig_count;
#line 883
    orig_orig_count = new_orig_count;
#line 884
    new_new_count = new_count;
#line 884
    orig_new_count = new_new_count;
    {
#line 885
    fgetpos((FILE */* __restrict  */)f, (fpos_t */* __restrict  */)(& pos));
    }
    }
    {
    {
#line 886
    while (1) {
      while_continue___3: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 886
      if (! orig_count) {
#line 886
        if (! new_count) {
#line 886
          goto while_break___0;
        }
      }
      {
      {
#line 887
      tmp___1 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)f);
      }
      }
#line 887
      if (tmp___1 < 0) {
#line 888
        goto while_break___0;
      }
#line 890
      total_count ++;
      {
#line 892
      if ((int )*(line + 0) == 32) {
#line 892
        goto case_32;
      }
#line 906
      if ((int )*(line + 0) == 45) {
#line 906
        goto case_45;
      }
#line 913
      if ((int )*(line + 0) == 43) {
#line 913
        goto case_43;
      }
#line 891
      goto switch_break;
      case_32: /* CIL Label */ 
#line 893
      if (orig_count) {
#line 893
        orig_count --;
      }
#line 894
      if (new_count) {
#line 894
        new_count --;
      }
#line 895
      if (! pre_seen) {
        {
#line 896
        pre ++;
        {
#line 897
        tmp___2 = strcmp((char const   *)(line + 1), unline);
        }
        }
#line 897
        if (! tmp___2) {
#line 898
          strip_pre = pre;
        }
      } else {
#line 900
        post ++;
#line 901
        if (strip_post) {
#line 903
          strip_post ++;
        } else {
          {
          {
#line 901
          tmp___3 = strcmp((char const   *)(line + 1), unline);
          }
          }
#line 901
          if (! tmp___3) {
#line 903
            strip_post ++;
          }
        }
      }
#line 905
      goto switch_break;
      case_45: /* CIL Label */ 
#line 907
      if (orig_count) {
#line 907
        orig_count --;
      }
#line 908
      if (strip_post) {
#line 909
        goto split_hunk;
      }
#line 910
      pre_seen = 1UL;
#line 911
      post = 0UL;
#line 912
      goto switch_break;
      case_43: /* CIL Label */ 
#line 914
      if (new_count) {
#line 914
        new_count --;
      }
#line 915
      if (strip_post) {
#line 916
        goto split_hunk;
      }
#line 917
      pre_seen = 1UL;
#line 918
      post = 0UL;
#line 919
      goto switch_break;
      switch_break: /* CIL Label */ ;
      }
    }
    while_break___3: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
#line 923
    pre -= strip_pre;
#line 924
    post -= strip_post;
#line 925
    if (pre > post) {
#line 926
      strip_pre += pre - post;
    }
#line 927
    orig_offset += strip_pre;
#line 928
    new_orig_count -= strip_pre + strip_post;
#line 929
    new_offset += strip_pre;
#line 930
    new_new_count -= strip_pre + strip_post;
#line 931
    if (orig_orig_count) {
#line 931
      if (! new_orig_count) {
#line 932
        orig_offset --;
      }
    }
#line 933
    if (orig_new_count) {
#line 933
      if (! new_new_count) {
#line 934
        new_offset --;
      }
    }
#line 936
    if (debug___0) {
      {
      {
#line 937
      printf((char const   */* __restrict  */)"Trim: %lu,%lu\n", strip_pre, strip_post);
      }
      }
    }
    {
    {
#line 939
    fsetpos(f, (fpos_t const   *)(& pos));
    }
    {
#line 940
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"@@ -%lu",
            orig_offset);
    }
    }
#line 941
    if (new_orig_count != 1UL) {
      {
      {
#line 942
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
              new_orig_count);
      }
      }
    }
    {
    {
#line 943
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" +%lu",
            new_offset);
    }
    }
#line 944
    if (new_new_count != 1UL) {
      {
      {
#line 945
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)",%lu",
              new_new_count);
      }
      }
    }
    {
    {
#line 946
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)" @@\n");
    }
    }
    {
    {
#line 948
    while (1) {
      while_continue___4: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
#line 948
      tmp___5 = total_count;
#line 948
      total_count --;
#line 948
      if (! tmp___5) {
#line 948
        goto while_break___1;
      }
      {
      {
#line 949
      tmp___4 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)f);
      }
#line 949
      got = tmp___4;
      }
#line 950
      if (! (got > 0)) {
        {
        {
#line 950
        __assert_fail("got > 0", "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c",
                      950U, "trim_context");
        }
        }
      }
#line 952
      if (strip_pre) {
#line 953
        strip_pre --;
#line 954
        goto while_continue___1;
      }
#line 957
      if (total_count < strip_post) {
#line 958
        goto while_continue___1;
      }
      {
      {
#line 960
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)out);
      }
      }
    }
    while_break___4: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 964
  free((void *)line);
  }
  }
#line 965
  return (0);
  split_hunk: 
  {
  {
#line 968
  error(0, 0, "hunk-splitting is required in this case, but is not yet implemented");
  }
  {
#line 969
  error(1, 0, "use the -U option to work around this");
  }
  }
#line 970
  return (0);
}
}
#line 973 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int output_delta___0(FILE *p1 , FILE *p2 , FILE *out ) 
{ 
  char const   *tmpdir ;
  char *tmp ;
  unsigned int tmplen ;
  char tail1[20] ;
  char tail2[20] ;
  char *tmpp1 ;
  char *tmpp2 ;
  int tmpp1fd ;
  int tmpp2fd ;
  struct lines_info file ;
  struct lines_info file2 ;
  char *oldname ;
  char *newname ;
  pid_t child ;
  FILE *in ;
  size_t namelen ;
  long pos1 ;
  long tmp___0 ;
  long pos2 ;
  long tmp___1 ;
  long pristine1 ;
  long pristine2 ;
  long start1 ;
  long start2 ;
  char options[100] ;
  int diff_is_empty ;
  void *tmp___2 ;
  void *tmp___3 ;
  int *tmp___4 ;
  __ssize_t tmp___5 ;
  int tmp___6 ;
  size_t tmp___7 ;
  int *tmp___8 ;
  __ssize_t tmp___9 ;
  int tmp___10 ;
  size_t tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int ch ;
  int tmp___14 ;
  int ch___0 ;
  int tmp___15 ;
  FILE *tmpdiff ;
  FILE *tmp___16 ;
  char *line ;
  size_t linelen ;
  ssize_t got ;
  __ssize_t tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  char *p ;
  char *q ;
  char c ;
  char d ;
  char const   *tmp___20 ;
  void *__cil_tmp59 ;
  void *__cil_tmp60 ;
  void *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;
  char *__cil_tmp75 ;
  char *__cil_tmp76 ;
  char *__cil_tmp77 ;
  char *__cil_tmp78 ;
  char *__cil_tmp79 ;
  char *__cil_tmp80 ;
  char *__cil_tmp81 ;
  char *__cil_tmp82 ;
  char *__cil_tmp83 ;

  {
  {
  {
#line 976
  tmp = getenv("TMPDIR");
  }
#line 976
  tmpdir = (char const   *)tmp;
#line 978
  tail1[0] = (char )'/';
#line 978
  tail1[1] = (char )'i';
#line 978
  tail1[2] = (char )'n';
#line 978
  tail1[3] = (char )'t';
#line 978
  tail1[4] = (char )'e';
#line 978
  tail1[5] = (char )'r';
#line 978
  tail1[6] = (char )'d';
#line 978
  tail1[7] = (char )'i';
#line 978
  tail1[8] = (char )'f';
#line 978
  tail1[9] = (char )'f';
#line 978
  tail1[10] = (char )'-';
#line 978
  tail1[11] = (char )'1';
#line 978
  tail1[12] = (char )'.';
#line 978
  tail1[13] = (char )'X';
#line 978
  tail1[14] = (char )'X';
#line 978
  tail1[15] = (char )'X';
#line 978
  tail1[16] = (char )'X';
#line 978
  tail1[17] = (char )'X';
#line 978
  tail1[18] = (char )'X';
#line 978
  tail1[19] = (char )'\000';
#line 979
  tail2[0] = (char )'/';
#line 979
  tail2[1] = (char )'i';
#line 979
  tail2[2] = (char )'n';
#line 979
  tail2[3] = (char )'t';
#line 979
  tail2[4] = (char )'e';
#line 979
  tail2[5] = (char )'r';
#line 979
  tail2[6] = (char )'d';
#line 979
  tail2[7] = (char )'i';
#line 979
  tail2[8] = (char )'f';
#line 979
  tail2[9] = (char )'f';
#line 979
  tail2[10] = (char )'-';
#line 979
  tail2[11] = (char )'2';
#line 979
  tail2[12] = (char )'.';
#line 979
  tail2[13] = (char )'X';
#line 979
  tail2[14] = (char )'X';
#line 979
  tail2[15] = (char )'X';
#line 979
  tail2[16] = (char )'X';
#line 979
  tail2[17] = (char )'X';
#line 979
  tail2[18] = (char )'X';
#line 979
  tail2[19] = (char )'\000';
#line 982
  file.unline = (char *)((void *)0);
#line 982
  file.first_offset = 0UL;
#line 982
  file.min_context = 0UL;
#line 982
  file.head = (struct lines *)((void *)0);
#line 982
  file.tail = (struct lines *)((void *)0);
#line 983
  file2.unline = (char *)((void *)0);
#line 983
  file2.first_offset = 0UL;
#line 983
  file2.min_context = 0UL;
#line 983
  file2.head = (struct lines *)((void *)0);
#line 983
  file2.tail = (struct lines *)((void *)0);
#line 984
  oldname = (char *)((void *)0);
#line 984
  newname = (char *)((void *)0);
  {
#line 988
  tmp___0 = ftell(p1);
  }
#line 988
  pos1 = tmp___0;
  {
#line 988
  tmp___1 = ftell(p2);
  }
#line 988
  pos2 = tmp___1;
#line 992
  diff_is_empty = 1;
  {
#line 994
  pristine1 = ftell(p1);
  }
  {
#line 995
  pristine2 = ftell(p2);
  }
  }
#line 997
  if (! tmpdir) {
#line 998
    tmpdir = "/tmp";
  }
  {
  {
#line 1000
  tmplen = strlen(tmpdir);
  }
  {
#line 1001
  tmp___2 = __builtin_alloca((unsigned long )tmplen + sizeof(tail1));
  }
#line 1001
  tmpp1 = (char *)tmp___2;
  {
#line 1002
  memcpy((void */* __restrict  */)tmpp1, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 1003
  memcpy((void */* __restrict  */)(tmpp1 + tmplen), (void const   */* __restrict  */)(tail1),
         (size_t )sizeof(tail1));
  }
  {
#line 1004
  tmp___3 = __builtin_alloca((unsigned long )tmplen + sizeof(tail2));
  }
#line 1004
  tmpp2 = (char *)tmp___3;
  {
#line 1005
  memcpy((void */* __restrict  */)tmpp2, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 1006
  memcpy((void */* __restrict  */)(tmpp2 + tmplen), (void const   */* __restrict  */)(tail2),
         (size_t )sizeof(tail2));
  }
  }
#line 1008
  if (max_context___0 == 3U) {
    {
    {
#line 1009
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%su",
            diff_opts___0);
    }
    }
  } else {
    {
    {
#line 1011
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%sU%d",
            diff_opts___0, max_context___0);
    }
    }
  }
  {
  {
#line 1013
  tmpp1fd = xmkstemp(tmpp1);
  }
  {
#line 1014
  tmpp2fd = xmkstemp(tmpp2);
  }
  }
  {
  {
#line 1016
  while (1) {
    while_continue___4: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1017
    if (oldname) {
      {
      {
#line 1018
      free((void *)oldname);
      }
#line 1019
      oldname = (char *)((void *)0);
      }
    }
    {
    {
#line 1021
    tmp___5 = getline((char **/* __restrict  */)(& oldname), (size_t */* __restrict  */)(& namelen),
                      (FILE */* __restrict  */)p1);
    }
    }
#line 1021
    if (tmp___5 < 0) {
      {
      {
#line 1022
      tmp___4 = __errno_location();
      }
      {
#line 1022
      error(1, *tmp___4, "Bad patch #1");
      }
      }
    }
    {
    {
#line 1016
    tmp___6 = strncmp((char const   *)oldname, "+++ ", (size_t )4);
    }
    }
#line 1016
    if (! tmp___6) {
#line 1016
      goto while_break;
    }
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1025
  tmp___7 = strlen((char const   *)oldname);
  }
#line 1025
  *(oldname + (tmp___7 - 1U)) = (char )'\000';
  }
  {
  {
#line 1027
  while (1) {
    while_continue___5: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 1028
    if (newname) {
      {
      {
#line 1029
      free((void *)newname);
      }
#line 1030
      newname = (char *)((void *)0);
      }
    }
    {
    {
#line 1032
    tmp___9 = getline((char **/* __restrict  */)(& newname), (size_t */* __restrict  */)(& namelen),
                      (FILE */* __restrict  */)p2);
    }
    }
#line 1032
    if (tmp___9 < 0) {
      {
      {
#line 1033
      tmp___8 = __errno_location();
      }
      {
#line 1033
      error(1, *tmp___8, "Bad patch #2");
      }
      }
    }
    {
    {
#line 1027
    tmp___10 = strncmp((char const   *)newname, "+++ ", (size_t )4);
    }
    }
#line 1027
    if (! tmp___10) {
#line 1027
      goto while_break___0;
    }
  }
  while_break___5: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
  {
#line 1036
  tmp___11 = strlen((char const   *)newname);
  }
#line 1036
  *(newname + (tmp___11 - 1U)) = (char )'\000';
  {
#line 1038
  start1 = ftell(p1);
  }
  {
#line 1039
  start2 = ftell(p2);
  }
  {
#line 1040
  fseek(p1, pos1, 0);
  }
  {
#line 1041
  fseek(p2, pos2, 0);
  }
  {
#line 1042
  create_orig___0(p2, & file, 0, (int *)((void *)0));
  }
  {
#line 1043
  fseek(p1, pos1, 0);
  }
  {
#line 1044
  fseek(p2, pos2, 0);
  }
  {
#line 1045
  create_orig___0(p1, & file2, (unsigned int )mode___2 == 1U, (int *)((void *)0));
  }
  {
#line 1046
  merge_lines___0(& file, & file2);
  }
  {
#line 1047
  pos1 = ftell(p1);
  }
  {
#line 1050
  write_file___0(& file, tmpp1fd);
  }
  {
#line 1051
  write_file___0(& file, tmpp2fd);
  }
  {
#line 1052
  free_lines___0(file.head);
  }
  {
#line 1054
  fseek(p1, start1, 0);
  }
  {
#line 1055
  fseek(p2, start2, 0);
  }
  {
#line 1057
  tmp___12 = apply_patch___0(p1, (char const   *)tmpp1, (unsigned int )mode___2 == 1U);
  }
  }
#line 1057
  if (tmp___12) {
    {
    {
#line 1058
    error(1, 0, "Error applying patch1 to reconstructed file");
    }
    }
  }
  {
  {
#line 1061
  tmp___13 = apply_patch___0(p2, (char const   *)tmpp2, 0);
  }
  }
#line 1061
  if (tmp___13) {
    {
    {
#line 1062
    error(1, 0, "Error applying patch2 to reconstructed file");
    }
    }
  }
  {
  {
#line 1065
  fseek(p1, pos1, 0);
  }
  {
#line 1067
  fflush((FILE *)((void *)0));
  }
  {
#line 1069
  in = xpipe("diff", & child, "r", "diff", options, tmpp1, tmpp2, (void *)0);
  }
  }
  {
  {
#line 1072
  while (1) {
    while_continue___6: /* CIL Label */ ;
    while_continue___1: /* CIL Label */ ;
    {
    {
#line 1073
    tmp___14 = fgetc(in);
    }
#line 1073
    ch = tmp___14;
    }
#line 1074
    if (ch == -1) {
#line 1075
      goto while_break___1;
    } else
#line 1074
    if (ch == 10) {
#line 1075
      goto while_break___1;
    }
#line 1076
    diff_is_empty = 0;
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  {
  {
#line 1080
  while (1) {
    while_continue___7: /* CIL Label */ ;
    while_continue___2: /* CIL Label */ ;
    {
    {
#line 1081
    tmp___15 = fgetc(in);
    }
#line 1081
    ch___0 = tmp___15;
    }
#line 1082
    if (ch___0 == -1) {
#line 1083
      goto while_break___2;
    } else
#line 1082
    if (ch___0 == 10) {
#line 1083
      goto while_break___2;
    }
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break___2: /* CIL Label */ ;
  }
#line 1086
  if (! diff_is_empty) {
    {
    {
#line 1090
    tmp___16 = xtmpfile();
    }
#line 1090
    tmpdiff = tmp___16;
#line 1091
    line = (char *)((void *)0);
    }
    {
    {
#line 1093
    while (1) {
      while_continue___8: /* CIL Label */ ;
      while_continue___3: /* CIL Label */ ;
      {
      {
#line 1094
      tmp___17 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                         (FILE */* __restrict  */)in);
      }
#line 1094
      got = tmp___17;
      }
#line 1095
      if (got < 0) {
#line 1096
        goto while_break___3;
      }
      {
      {
#line 1097
      fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1, (FILE */* __restrict  */)tmpdiff);
      }
      }
#line 1098
      if ((int )*line != 32) {
        {
        {
#line 1098
        tmp___19 = strcmp((char const   *)(line + 1), (char const   *)file.unline);
        }
        }
#line 1098
        if (! tmp___19) {
          {
          {
#line 1105
          got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)in);
          }
          }
#line 1106
          if (got < 0) {
#line 1107
            goto __Cont;
          } else {
            {
            {
#line 1108
            tmp___18 = strncmp((char const   *)line, "@@ ", (size_t )3);
            }
            }
#line 1108
            if (tmp___18) {
              {
              {
#line 1113
              fclose(tmpdiff);
              }
              {
#line 1114
              free((void *)line);
              }
              }
#line 1115
              goto evasive_action;
            }
          }
          {
          {
#line 1117
          fwrite((void const   */* __restrict  */)line, (size_t )got, (size_t )1,
                 (FILE */* __restrict  */)tmpdiff);
          }
          }
        }
      }
      __Cont: /* CIL Label */ ;
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___3: /* CIL Label */ ;
    }
    {
    {
#line 1120
    free((void *)line);
    }
    }
#line 1123
    if (human_readable___0) {
      {
#line 1125
      d = (char )'\000';
#line 1125
      c = d;
      {
#line 1126
      p = strchr((char const   *)(oldname + 4), '\t');
      }
      }
#line 1127
      if (p) {
#line 1128
        c = *p;
#line 1129
        *p = (char )'\000';
      }
      {
      {
#line 1131
      q = strchr((char const   *)(newname + 4), '\t');
      }
      }
#line 1132
      if (q) {
#line 1133
        d = *q;
#line 1134
        *q = (char )'\000';
      }
      {
      {
#line 1136
      fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"diff %s %s %s\n",
              options, oldname + 4, newname + 4);
      }
      }
#line 1138
      if (p) {
#line 1138
        *p = c;
      }
#line 1139
      if (q) {
#line 1139
        *q = d;
      }
    }
    {
    {
#line 1141
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"--- %s\n",
            oldname + 4);
    }
    {
#line 1142
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"+++ %s\n",
            newname + 4);
    }
    {
#line 1143
    rewind(tmpdiff);
    }
    {
#line 1144
    trim_context___0(tmpdiff, (char const   *)file.unline, out);
    }
    {
#line 1145
    fclose(tmpdiff);
    }
    }
  }
  {
  {
#line 1148
  fclose(in);
  }
  {
#line 1149
  waitpid(child, (int *)((void *)0), 0);
  }
  }
#line 1150
  if (debug___0) {
    {
    {
#line 1151
    printf((char const   */* __restrict  */)"reconstructed orig1=%s orig2=%s\n", tmpp1,
           tmpp2);
    }
    }
  } else {
    {
    {
#line 1153
    unlink((char const   *)tmpp1);
    }
    {
#line 1154
    unlink((char const   *)tmpp2);
    }
    }
  }
  {
  {
#line 1156
  free((void *)oldname);
  }
  {
#line 1157
  free((void *)newname);
  }
  }
#line 1158
  return (0);
  evasive_action: 
#line 1161
  if (debug___0) {
    {
    {
#line 1162
    printf((char const   */* __restrict  */)"reconstructed orig1=%s orig2=%s\n", tmpp1,
           tmpp2);
    }
    }
  } else {
    {
    {
#line 1164
    unlink((char const   *)tmpp1);
    }
    {
#line 1165
    unlink((char const   *)tmpp2);
    }
    }
  }
#line 1167
  if (human_readable___0) {
#line 1168
    if ((unsigned int )mode___2 == 1U) {
#line 1168
      tmp___20 = "merge";
    } else {
#line 1168
      tmp___20 = "interdiff";
    }
    {
    {
#line 1168
    fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"%s impossible; taking evasive action\n",
            tmp___20);
    }
    }
  }
  {
  {
#line 1170
  fseek(p1, pristine1, 0);
  }
  {
#line 1171
  fseek(p2, pristine2, 0);
  }
  {
#line 1172
  output_patch1_only___0(p1, out, (unsigned int )mode___2 == 1U);
  }
  {
#line 1173
  output_patch1_only___0(p2, out, 1);
  }
  }
#line 1174
  return (0);
}
}
#line 1177 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int copy_residue___0(FILE *p2 , FILE *out ) 
{ 
  struct file_list *at ;
  long tmp ;
  int tmp___0 ;
  char *__cil_tmp6 ;

  {
#line 1182
  at = files_in_patch2___0;
  {
  {
#line 1182
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1182
    if (! at) {
#line 1182
      goto while_break;
    }
    {
    {
#line 1184
    tmp = file_in_list___0(files_done___0, (char const   *)at->file);
    }
    }
#line 1184
    if (tmp != -1L) {
#line 1185
      goto __Cont;
    }
    {
    {
#line 1188
    tmp___0 = check_filename___0((char const   *)at->file);
    }
    }
#line 1188
    if (! tmp___0) {
#line 1189
      goto __Cont;
    }
    {
    {
#line 1191
    fseek(p2, at->pos, 0);
    }
    }
#line 1192
    if (human_readable___0) {
#line 1192
      if ((unsigned int )mode___2 != 2U) {
        {
        {
#line 1193
        fprintf((FILE */* __restrict  */)out, (char const   */* __restrict  */)"only in patch2:\n");
        }
        }
      }
    }
    {
    {
#line 1195
    output_patch1_only___0(p2, out, 1);
    }
    }
    __Cont: /* CIL Label */ 
#line 1182
    at = at->next;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1198
  return (0);
}
}
#line 1201 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int index_patch2___0(FILE *p2 ) 
{ 
  char *line ;
  size_t linelen ;
  int is_context ;
  int file_is_empty ;
  unsigned long skip ;
  char *names[2] ;
  char *p ;
  char *end ;
  long pos ;
  long tmp ;
  __ssize_t tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  __ssize_t tmp___4 ;
  int tmp___5 ;
  __ssize_t tmp___6 ;
  int tmp___7 ;
  char *tmp___8 ;
  __ssize_t tmp___9 ;
  unsigned long tmp___10 ;
  int tmp___11 ;
  void *__cil_tmp24 ;
  char *__cil_tmp25 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;
  char *__cil_tmp28 ;
  char *__cil_tmp29 ;

  {
#line 1204
  line = (char *)((void *)0);
#line 1205
  linelen = (size_t )0;
#line 1206
  is_context = 0;
#line 1207
  file_is_empty = 1;
  {
  {
#line 1210
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1210
    tmp___11 = feof(p2);
    }
    }
#line 1210
    if (tmp___11) {
#line 1210
      goto while_break;
    }
    {
    {
#line 1214
    tmp = ftell(p2);
    }
#line 1214
    pos = tmp;
    {
#line 1216
    tmp___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p2);
    }
    }
#line 1216
    if (tmp___0 == -1) {
#line 1217
      goto while_break;
    }
    {
#line 1219
    file_is_empty = 0;
    {
#line 1221
    tmp___3 = strncmp((char const   *)line, "--- ", (size_t )4);
    }
    }
#line 1221
    if (tmp___3) {
      {
      {
#line 1222
      tmp___1 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 1222
      if (tmp___1) {
#line 1222
        tmp___2 = 0;
      } else {
#line 1222
        tmp___2 = 1;
      }
#line 1222
      is_context = tmp___2;
#line 1223
      goto while_continue;
    }
#line 1226
    if (is_context) {
      {
      {
#line 1227
      error(1, 0, "I don\'t understand context diffs yet.");
      }
      }
    }
    {
    {
#line 1230
    names[0] = filename_from_header((char const   *)(line + 4));
    }
    {
#line 1232
    tmp___4 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p2);
    }
    }
#line 1232
    if (tmp___4 == -1) {
      {
      {
#line 1233
      free((void *)names[0]);
      }
      }
#line 1234
      goto while_break;
    }
    {
    {
#line 1237
    tmp___5 = strncmp((char const   *)line, "+++ ", (size_t )4);
    }
    }
#line 1237
    if (tmp___5) {
      {
      {
#line 1238
      free((void *)names[0]);
      }
      }
#line 1239
      goto while_continue;
    }
    {
    {
#line 1242
    names[1] = filename_from_header((char const   *)(line + 4));
    }
    {
#line 1244
    tmp___6 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p2);
    }
    }
#line 1244
    if (tmp___6 == -1) {
      {
      {
#line 1245
      free((void *)names[0]);
      }
      {
#line 1246
      free((void *)names[1]);
      }
      }
#line 1247
      goto while_break;
    }
    {
    {
#line 1250
    tmp___7 = strncmp((char const   *)line, "@@ ", (size_t )3);
    }
    }
#line 1250
    if (tmp___7) {
#line 1251
      goto try_next;
    }
    {
    {
#line 1253
    p = strchr((char const   *)(line + 3), '+');
    }
    }
#line 1254
    if (! p) {
#line 1255
      goto try_next;
    }
    {
    {
#line 1256
    p = strchr((char const   *)p, ',');
    }
    }
#line 1257
    if (p) {
      {
#line 1259
      p ++;
      {
#line 1260
      skip = strtoul((char const   */* __restrict  */)p, (char **/* __restrict  */)(& end),
                     10);
      }
      }
#line 1261
      if ((unsigned long )p == (unsigned long )end) {
#line 1262
        goto try_next;
      }
    } else {
#line 1265
      skip = 1UL;
    }
    {
    {
#line 1267
    tmp___8 = best_name(2, names);
    }
    {
#line 1267
    add_to_list___0(& files_in_patch2___0, (char const   *)tmp___8, pos);
    }
    }
    {
    {
#line 1269
    while (1) {
      while_continue___2: /* CIL Label */ ;
      while_continue___0: /* CIL Label */ ;
#line 1269
      tmp___10 = skip;
#line 1269
      skip --;
#line 1269
      if (! tmp___10) {
#line 1269
        goto while_break___0;
      }
      {
      {
#line 1270
      tmp___9 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                        (FILE */* __restrict  */)p2);
      }
      }
#line 1270
      if (tmp___9 == -1) {
#line 1271
        goto while_break___0;
      }
#line 1273
      if ((int )*(line + 0) == 45) {
#line 1275
        skip ++;
      }
    }
    while_break___2: /* CIL Label */ ;
    }
    while_break___0: /* CIL Label */ ;
    }
    try_next: 
    {
    {
#line 1279
    free((void *)names[0]);
    }
    {
#line 1280
    free((void *)names[1]);
    }
    }
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1283
  if (line) {
    {
    {
#line 1284
    free((void *)line);
    }
    }
  }
#line 1286
  if (file_is_empty) {
#line 1287
    return (0);
  } else
#line 1286
  if (files_in_patch2___0) {
#line 1287
    return (0);
  } else {
#line 1289
    return (1);
  }
}
}
#line 1313 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct offset *add_offset___0(unsigned long line , long offset , struct offset *offsets ,
                                     unsigned long *allocated , unsigned long *num_offsets ) 
{ 
  void *tmp ;
  char *__cil_tmp7 ;

  {
#line 1318
  if (*num_offsets == *allocated) {
    {
#line 1319
    *allocated *= 2UL;
    {
#line 1320
    tmp = xrealloc((void *)offsets, (size_t )(*allocated * sizeof(struct offset )));
    }
#line 1320
    offsets = (struct offset *)tmp;
    }
  }
#line 1323
  (offsets + *num_offsets)->line = line;
#line 1324
  (offsets + *num_offsets)->offset = offset;
#line 1325
  (*num_offsets) ++;
#line 1326
  if (debug___0) {
    {
    {
#line 1327
    printf((char const   */* __restrict  */)"%lu: %ld\n", line, offset);
    }
    }
  }
#line 1328
  return (offsets);
}
}
#line 1331 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int patch2_removes_line___0(unsigned long line , struct offset *offsets , unsigned long num_offsets ) 
{ 
  unsigned long i ;
  unsigned long this_line ;
  long this_offset ;
  char *__cil_tmp7 ;

  {
#line 1337
  i = 0UL;
  {
  {
#line 1337
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1337
    if (! (i < num_offsets)) {
#line 1337
      goto while_break;
    }
#line 1338
    this_line = (offsets + i)->line;
#line 1339
    this_offset = (offsets + i)->offset;
#line 1340
    if (this_line <= line) {
#line 1340
      if (this_offset < 0L) {
#line 1340
        if (this_line - (unsigned long )this_offset > line) {
#line 1343
          if (debug___0) {
            {
            {
#line 1344
            printf((char const   */* __restrict  */)"@%lu: removed (%ld)\n", line,
                   this_offset);
            }
            }
          }
#line 1346
          return (1);
        }
      }
    }
#line 1337
    i ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1350
  return (0);
}
}
#line 1353 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static long offset_at_line___0(unsigned long line , struct offset *offsets , unsigned long num_offsets ) 
{ 
  long offset ;
  unsigned long i ;
  unsigned long this_line ;
  long this_offset ;
  char *__cil_tmp8 ;

  {
#line 1358
  offset = 0L;
#line 1360
  i = 0UL;
  {
  {
#line 1360
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1360
    if (! (i < num_offsets)) {
#line 1360
      goto while_break;
    }
#line 1361
    this_line = (offsets + i)->line;
#line 1362
    this_offset = (offsets + i)->offset;
#line 1364
    if (this_line > line) {
#line 1365
      goto while_break;
    }
#line 1367
    offset += this_offset;
#line 1368
    if (this_line <= line) {
#line 1368
      if (this_offset < 0L) {
#line 1368
        if (this_line - (unsigned long )this_offset > line) {
#line 1371
          goto while_break;
        }
      }
    }
#line 1360
    i ++;
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1374
  if (debug___0) {
    {
    {
#line 1375
    printf((char const   */* __restrict  */)"@%lu: %ld\n", line, offset);
    }
    }
  }
#line 1377
  return (offset);
}
}
#line 1380 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int insert_line___0(struct lines_info *lines___1 , char const   *line , size_t length ,
                           unsigned long n ) 
{ 
  struct lines *at ;
  int tmp ;
  char *__cil_tmp7 ;

  {
#line 1387
  at = lines___1->head;
  {
  {
#line 1387
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1387
    if (! at) {
#line 1387
      goto while_break;
    }
#line 1388
    if (n <= at->n) {
#line 1389
      goto while_break;
    }
#line 1387
    at = at->next;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1391
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 1391
    if (! at) {
#line 1391
      goto while_break___0;
    }
#line 1392
    (at->n) ++;
#line 1393
    at = at->next;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 1397
  if (debug___0) {
    {
    {
#line 1398
    printf((char const   */* __restrict  */)"Insert at %lu: %s", n, line);
    }
    }
  }
  {
  {
#line 1400
  tmp = add_line___0(lines___1, line, length, n);
  }
  }
#line 1400
  return (tmp);
}
}
#line 1403 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void remove_line___0(struct lines_info *lines___1 , char const   *line , unsigned long n ) 
{ 
  struct lines *at ;
  struct lines *kill___0 ;
  int tmp ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;

  {
#line 1407
  kill___0 = (struct lines *)((void *)0);
#line 1410
  at = lines___1->head;
  {
  {
#line 1410
  while (1) {
    while_continue___1: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
#line 1410
    if (! at) {
#line 1410
      goto while_break;
    }
#line 1411
    if (n <= at->n) {
#line 1412
      goto while_break;
    }
#line 1410
    at = at->next;
  }
  while_break___1: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1414
  if (at) {
#line 1414
    if (n == at->n) {
      {
#line 1415
      kill___0 = at;
      {
#line 1416
      tmp = strcmp((char const   *)at->line, line);
      }
      }
#line 1416
      if (tmp) {
#line 1416
        if (kill___0->prev) {
#line 1417
          kill___0 = kill___0->prev;
#line 1418
          if (debug___0) {
            {
            {
#line 1419
            printf((char const   */* __restrict  */)"Not removing from %lu: %s", n,
                   at->line);
            }
            }
          }
        }
      }
    }
  }
#line 1424
  at = kill___0;
  {
  {
#line 1425
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
#line 1425
    if (! at) {
#line 1425
      goto while_break___0;
    }
#line 1426
    (at->n) --;
#line 1427
    at = at->next;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 1431
  if (debug___0) {
    {
    {
#line 1432
    printf((char const   */* __restrict  */)"Remove from %lu: %s", n, kill___0->line);
    }
    }
  }
#line 1434
  if (kill___0->prev) {
#line 1435
    (kill___0->prev)->next = kill___0->next;
  }
#line 1437
  if (kill___0->next) {
#line 1438
    (kill___0->next)->prev = kill___0->prev;
  }
#line 1440
  if ((unsigned long )lines___1->head == (unsigned long )kill___0) {
#line 1441
    lines___1->head = kill___0->next;
  }
#line 1443
  if ((unsigned long )lines___1->tail == (unsigned long )kill___0) {
#line 1444
    lines___1->tail = kill___0->prev;
  }
  {
  {
#line 1446
  free((void *)kill___0->line);
  }
  {
#line 1447
  free((void *)kill___0);
  }
  }
#line 1448
  return;
}
}
#line 1450 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int take_diff___0(char const   *f1 , char const   *f2 , char **headers , char const   *unline ,
                         FILE *out ) 
{ 
  char options[100] ;
  pid_t child ;
  int diff_is_empty ;
  FILE *in ;
  int ch ;
  int tmp ;
  int ch___0 ;
  int tmp___0 ;
  FILE *tmpdiff ;
  FILE *tmp___1 ;
  int ch___1 ;
  int tmp___2 ;
  int tmp___3 ;
  void *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;
  char *__cil_tmp25 ;

  {
#line 1456
  diff_is_empty = 1;
#line 1459
  if (max_context___0 == 3U) {
    {
    {
#line 1460
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%su",
            diff_opts___0);
    }
    }
  } else {
    {
    {
#line 1462
    sprintf((char */* __restrict  */)(options), (char const   */* __restrict  */)"-%sU%d",
            diff_opts___0, max_context___0);
    }
    }
  }
#line 1464
  if (debug___0) {
    {
    {
#line 1465
    printf((char const   */* __restrict  */)"+ diff %s %s %s\n", options, f1, f2);
    }
    }
  }
  {
  {
#line 1467
  in = xpipe("diff", & child, "r", "diff", options, f1, f2, (void *)0);
  }
  }
  {
  {
#line 1470
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1471
    tmp = fgetc(in);
    }
#line 1471
    ch = tmp;
    }
#line 1472
    if (ch == -1) {
#line 1473
      goto while_break;
    } else
#line 1472
    if (ch == 10) {
#line 1473
      goto while_break;
    }
#line 1474
    diff_is_empty = 0;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1478
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
    {
    {
#line 1479
    tmp___0 = fgetc(in);
    }
#line 1479
    ch___0 = tmp___0;
    }
#line 1480
    if (ch___0 == -1) {
#line 1481
      goto while_break___0;
    } else
#line 1480
    if (ch___0 == 10) {
#line 1481
      goto while_break___0;
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
#line 1484
  if (! diff_is_empty) {
    {
    {
#line 1485
    tmp___1 = xtmpfile();
    }
#line 1485
    tmpdiff = tmp___1;
    }
    {
    {
#line 1486
    while (1) {
      while_continue___4: /* CIL Label */ ;
      while_continue___1: /* CIL Label */ ;
      {
      {
#line 1486
      tmp___3 = feof(in);
      }
      }
#line 1486
      if (tmp___3) {
#line 1486
        goto while_break___1;
      }
      {
      {
#line 1487
      tmp___2 = fgetc(in);
      }
#line 1487
      ch___1 = tmp___2;
      }
#line 1488
      if (ch___1 != -1) {
        {
        {
#line 1489
        fputc(ch___1, tmpdiff);
        }
        }
      }
    }
    while_break___4: /* CIL Label */ ;
    }
    while_break___1: /* CIL Label */ ;
    }
    {
    {
#line 1491
    rewind(tmpdiff);
    }
    {
#line 1492
    fputs((char const   */* __restrict  */)*(headers + 0), (FILE */* __restrict  */)out);
    }
    {
#line 1493
    fputs((char const   */* __restrict  */)*(headers + 1), (FILE */* __restrict  */)out);
    }
    {
#line 1494
    trim_context___0(tmpdiff, unline, out);
    }
    {
#line 1495
    fclose(tmpdiff);
    }
    }
  }
  {
  {
#line 1498
  fclose(in);
  }
  {
#line 1499
  waitpid(child, (int *)((void *)0), 0);
  }
  }
#line 1500
  return (0);
}
}
#line 1503 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int flipdiff___0(FILE *p1 , FILE *p2 , FILE *flip1 , FILE *flip2 ) 
{ 
  char *line ;
  size_t linelen ;
  char tail1[19] ;
  char tail2[19] ;
  char tail3[19] ;
  char *tmpdir ;
  char *tmp ;
  char *header1[2] ;
  char *header2[2] ;
  unsigned int tmplen ;
  char *tmpp1 ;
  char *tmpp2 ;
  char *tmpp3 ;
  int tmpfd ;
  FILE *f ;
  fpos_t at1 ;
  fpos_t at2 ;
  struct lines_info intermediate ;
  struct offset *offsets ;
  unsigned long offset_alloc ;
  unsigned long num_offsets ;
  long this_offset ;
  unsigned long first_linenum ;
  unsigned long linenum___1 ;
  int saw_first_offset ;
  int clash ;
  unsigned long orig_lines ;
  unsigned long new_lines ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  char const   *tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  void *tmp___6 ;
  __ssize_t tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  ssize_t got ;
  int tmp___11 ;
  int tmp___12 ;
  ssize_t got___0 ;
  int tmp___13 ;
  int tmp___14 ;
  unsigned long at ;
  long tmp___15 ;
  int tmp___16 ;
  unsigned long at___0 ;
  long tmp___17 ;
  int tmp___18 ;
  void *__cil_tmp56 ;
  void *__cil_tmp57 ;
  void *__cil_tmp58 ;
  void *__cil_tmp59 ;
  void *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char *__cil_tmp62 ;
  char *__cil_tmp63 ;
  char *__cil_tmp64 ;
  char *__cil_tmp65 ;
  char *__cil_tmp66 ;
  char *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char *__cil_tmp69 ;
  char *__cil_tmp70 ;
  char *__cil_tmp71 ;
  char *__cil_tmp72 ;
  char *__cil_tmp73 ;
  char *__cil_tmp74 ;

  {
  {
#line 1506
  line = (char *)((void *)0);
#line 1507
  linelen = (size_t )0;
#line 1508
  tail1[0] = (char )'/';
#line 1508
  tail1[1] = (char )'f';
#line 1508
  tail1[2] = (char )'l';
#line 1508
  tail1[3] = (char )'i';
#line 1508
  tail1[4] = (char )'p';
#line 1508
  tail1[5] = (char )'d';
#line 1508
  tail1[6] = (char )'i';
#line 1508
  tail1[7] = (char )'f';
#line 1508
  tail1[8] = (char )'f';
#line 1508
  tail1[9] = (char )'-';
#line 1508
  tail1[10] = (char )'1';
#line 1508
  tail1[11] = (char )'.';
#line 1508
  tail1[12] = (char )'X';
#line 1508
  tail1[13] = (char )'X';
#line 1508
  tail1[14] = (char )'X';
#line 1508
  tail1[15] = (char )'X';
#line 1508
  tail1[16] = (char )'X';
#line 1508
  tail1[17] = (char )'X';
#line 1508
  tail1[18] = (char )'\000';
#line 1509
  tail2[0] = (char )'/';
#line 1509
  tail2[1] = (char )'f';
#line 1509
  tail2[2] = (char )'l';
#line 1509
  tail2[3] = (char )'i';
#line 1509
  tail2[4] = (char )'p';
#line 1509
  tail2[5] = (char )'d';
#line 1509
  tail2[6] = (char )'i';
#line 1509
  tail2[7] = (char )'f';
#line 1509
  tail2[8] = (char )'f';
#line 1509
  tail2[9] = (char )'-';
#line 1509
  tail2[10] = (char )'2';
#line 1509
  tail2[11] = (char )'.';
#line 1509
  tail2[12] = (char )'X';
#line 1509
  tail2[13] = (char )'X';
#line 1509
  tail2[14] = (char )'X';
#line 1509
  tail2[15] = (char )'X';
#line 1509
  tail2[16] = (char )'X';
#line 1509
  tail2[17] = (char )'X';
#line 1509
  tail2[18] = (char )'\000';
#line 1510
  tail3[0] = (char )'/';
#line 1510
  tail3[1] = (char )'f';
#line 1510
  tail3[2] = (char )'l';
#line 1510
  tail3[3] = (char )'i';
#line 1510
  tail3[4] = (char )'p';
#line 1510
  tail3[5] = (char )'d';
#line 1510
  tail3[6] = (char )'i';
#line 1510
  tail3[7] = (char )'f';
#line 1510
  tail3[8] = (char )'f';
#line 1510
  tail3[9] = (char )'-';
#line 1510
  tail3[10] = (char )'3';
#line 1510
  tail3[11] = (char )'.';
#line 1510
  tail3[12] = (char )'X';
#line 1510
  tail3[13] = (char )'X';
#line 1510
  tail3[14] = (char )'X';
#line 1510
  tail3[15] = (char )'X';
#line 1510
  tail3[16] = (char )'X';
#line 1510
  tail3[17] = (char )'X';
#line 1510
  tail3[18] = (char )'\000';
  {
#line 1511
  tmp = getenv("TMPDIR");
  }
#line 1511
  tmpdir = tmp;
#line 1518
  intermediate.unline = (char *)((void *)0);
#line 1518
  intermediate.first_offset = 0UL;
#line 1518
  intermediate.min_context = 0UL;
#line 1518
  intermediate.head = (struct lines *)((void *)0);
#line 1518
  intermediate.tail = (struct lines *)((void *)0);
#line 1519
  offsets = (struct offset *)((void *)0);
#line 1520
  offset_alloc = 100UL;
#line 1521
  num_offsets = 0UL;
#line 1522
  this_offset = 0L;
#line 1523
  first_linenum = 0UL;
#line 1526
  clash = 0;
#line 1530
  header1[1] = (char *)((void *)0);
#line 1530
  header1[0] = header1[1];
#line 1531
  linelen = (size_t )0;
  {
#line 1532
  getline((char **/* __restrict  */)(& header1[0]), (size_t */* __restrict  */)(& linelen),
          (FILE */* __restrict  */)p1);
  }
#line 1533
  linelen = (size_t )0;
  {
#line 1534
  getline((char **/* __restrict  */)(& header1[1]), (size_t */* __restrict  */)(& linelen),
          (FILE */* __restrict  */)p1);
  }
#line 1536
  header2[1] = (char *)((void *)0);
#line 1536
  header2[0] = header2[1];
#line 1537
  linelen = (size_t )0;
  {
#line 1538
  getline((char **/* __restrict  */)(& header2[0]), (size_t */* __restrict  */)(& linelen),
          (FILE */* __restrict  */)p2);
  }
#line 1539
  linelen = (size_t )0;
  {
#line 1540
  getline((char **/* __restrict  */)(& header2[1]), (size_t */* __restrict  */)(& linelen),
          (FILE */* __restrict  */)p2);
  }
#line 1541
  linelen = (size_t )0;
  {
#line 1543
  fgetpos((FILE */* __restrict  */)p1, (fpos_t */* __restrict  */)(& at1));
  }
  {
#line 1544
  fgetpos((FILE */* __restrict  */)p2, (fpos_t */* __restrict  */)(& at2));
  }
  }
#line 1547
  if (! tmpdir) {
#line 1548
    tmpdir = (char *)"/tmp";
  }
  {
  {
#line 1550
  tmplen = strlen((char const   *)tmpdir);
  }
  {
#line 1551
  tmp___0 = __builtin_alloca((unsigned long )tmplen + sizeof(tail1));
  }
#line 1551
  tmpp1 = (char *)tmp___0;
  {
#line 1552
  memcpy((void */* __restrict  */)tmpp1, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 1553
  memcpy((void */* __restrict  */)(tmpp1 + tmplen), (void const   */* __restrict  */)(tail1),
         (size_t )sizeof(tail1));
  }
  {
#line 1555
  tmp___1 = __builtin_alloca((unsigned long )tmplen + sizeof(tail2));
  }
#line 1555
  tmpp2 = (char *)tmp___1;
  {
#line 1556
  memcpy((void */* __restrict  */)tmpp2, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 1557
  memcpy((void */* __restrict  */)(tmpp2 + tmplen), (void const   */* __restrict  */)(tail2),
         (size_t )sizeof(tail2));
  }
  {
#line 1559
  tmp___2 = __builtin_alloca((unsigned long )tmplen + sizeof(tail3));
  }
#line 1559
  tmpp3 = (char *)tmp___2;
  {
#line 1560
  memcpy((void */* __restrict  */)tmpp3, (void const   */* __restrict  */)tmpdir,
         tmplen);
  }
  {
#line 1561
  memcpy((void */* __restrict  */)(tmpp3 + tmplen), (void const   */* __restrict  */)(tail3),
         (size_t )sizeof(tail3));
  }
  {
#line 1564
  create_orig___0(p1, & intermediate, 1, (int *)((void *)0));
  }
  {
#line 1567
  create_orig___0(p2, & intermediate, 0, & clash);
  }
  }
#line 1571
  if (clash) {
#line 1572
    if (clash == 1) {
#line 1572
      tmp___3 = "";
    } else {
#line 1572
      tmp___3 = "s";
    }
    {
    {
#line 1572
    error(1, 0, "patches clashed in %d place%s - re-generate them first", clash, tmp___3);
    }
    }
  }
  {
  {
#line 1579
  tmpfd = xmkstemp(tmpp1);
  }
  {
#line 1580
  write_file___0(& intermediate, tmpfd);
  }
  {
#line 1581
  fsetpos(p1, (fpos_t const   *)(& at1));
  }
  {
#line 1582
  tmp___4 = apply_patch___0(p1, (char const   *)tmpp1, 1);
  }
  }
#line 1582
  if (tmp___4) {
    {
    {
#line 1583
    error(1, 0, "Error reconstructing original file");
    }
    }
  }
  {
  {
#line 1588
  tmpfd = xmkstemp(tmpp3);
  }
  {
#line 1589
  write_file___0(& intermediate, tmpfd);
  }
  {
#line 1590
  fsetpos(p2, (fpos_t const   *)(& at2));
  }
  {
#line 1591
  tmp___5 = apply_patch___0(p2, (char const   *)tmpp3, 0);
  }
  }
#line 1591
  if (tmp___5) {
    {
    {
#line 1592
    error(1, 0, "Error reconstructing final file");
    }
    }
  }
  {
  {
#line 1596
  fsetpos(p2, (fpos_t const   *)(& at2));
  }
  {
#line 1597
  tmp___6 = xmalloc((size_t )(offset_alloc * sizeof(struct offset )));
  }
#line 1597
  offsets = (struct offset *)tmp___6;
#line 1598
  new_lines = 0UL;
#line 1598
  orig_lines = new_lines;
  }
  {
  {
#line 1599
  while (1) {
    while_continue___2: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1600
    tmp___7 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p2);
    }
    }
#line 1600
    if (tmp___7 == -1) {
#line 1601
      if (this_offset) {
        {
        {
#line 1602
        offsets = add_offset___0(first_linenum, this_offset, offsets, & offset_alloc,
                                 & num_offsets);
        }
#line 1607
        this_offset = 0L;
        }
      }
#line 1609
      goto while_break;
    }
#line 1612
    if (! orig_lines) {
#line 1612
      if (! new_lines) {
#line 1612
        if (this_offset) {
          {
          {
#line 1613
          offsets = add_offset___0(first_linenum, this_offset, offsets, & offset_alloc,
                                   & num_offsets);
          }
#line 1618
          this_offset = 0L;
          }
        }
      }
    }
#line 1621
    if (! orig_lines) {
#line 1621
      if (! new_lines) {
        {
        {
#line 1621
        tmp___8 = strncmp((char const   *)line, "@@ ", (size_t )3);
        }
        }
#line 1621
        if (tmp___8) {
#line 1622
          goto while_break;
        }
      }
    }
    {
    {
#line 1624
    tmp___10 = strncmp((char const   *)line, "@@ ", (size_t )3);
    }
    }
#line 1624
    if (! tmp___10) {
      {
      {
#line 1625
      tmp___9 = read_atatline((char const   *)line, & linenum___1, & orig_lines, (unsigned long *)((void *)0),
                              & new_lines);
      }
      }
#line 1625
      if (tmp___9) {
        {
        {
#line 1627
        error(1, 0, "line not understood: %s", line);
        }
        }
      }
#line 1630
      goto __Cont;
    }
#line 1633
    if (orig_lines) {
#line 1633
      if ((int )*(line + 0) != 43) {
#line 1634
        orig_lines --;
      }
    }
#line 1635
    if (new_lines) {
#line 1635
      if ((int )*(line + 0) != 45) {
#line 1636
        new_lines --;
      }
    }
    {
#line 1639
    if ((int )*(line + 0) == 32) {
#line 1639
      goto case_32;
    }
#line 1650
    if ((int )*(line + 0) == 45) {
#line 1650
      goto case_45;
    }
#line 1664
    if ((int )*(line + 0) == 43) {
#line 1664
      goto case_43;
    }
#line 1638
    goto switch_break;
    case_32: /* CIL Label */ 
#line 1640
    if (this_offset) {
      {
      {
#line 1641
      offsets = add_offset___0(first_linenum, this_offset, offsets, & offset_alloc,
                               & num_offsets);
      }
#line 1646
      this_offset = 0L;
      }
    }
#line 1648
    goto switch_break;
    case_45: /* CIL Label */ 
#line 1651
    if (this_offset > 0L) {
      {
      {
#line 1652
      offsets = add_offset___0(first_linenum, this_offset, offsets, & offset_alloc,
                               & num_offsets);
      }
#line 1657
      this_offset = 0L;
      }
    }
#line 1659
    if (this_offset == 0L) {
#line 1660
      first_linenum = linenum___1;
    }
#line 1661
    this_offset --;
#line 1662
    goto switch_break;
    case_43: /* CIL Label */ 
#line 1665
    if (this_offset < 0L) {
      {
      {
#line 1666
      offsets = add_offset___0(first_linenum, this_offset, offsets, & offset_alloc,
                               & num_offsets);
      }
#line 1671
      this_offset = 0L;
      }
    }
#line 1673
    if (this_offset == 0L) {
#line 1674
      first_linenum = linenum___1;
    }
#line 1675
    this_offset ++;
#line 1676
    goto switch_break;
    switch_break: /* CIL Label */ ;
    }
#line 1679
    if ((int )*(line + 0) != 43) {
#line 1680
      linenum___1 ++;
    }
    __Cont: /* CIL Label */ ;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
  {
  {
#line 1686
  free_lines___0(intermediate.head);
  }
#line 1687
  intermediate.tail = (struct lines *)((void *)0);
#line 1687
  intermediate.head = intermediate.tail;
  {
#line 1688
  f = fopen((char const   */* __restrict  */)tmpp3, (char const   */* __restrict  */)"r");
  }
#line 1689
  linenum___1 = 0UL;
#line 1690
  saw_first_offset = 0;
  }
  {
  {
#line 1691
  while (1) {
    while_continue___3: /* CIL Label */ ;
    while_continue___0: /* CIL Label */ ;
    {
    {
#line 1691
    tmp___12 = feof(f);
    }
    }
#line 1691
    if (tmp___12) {
#line 1691
      goto while_break___0;
    }
    {
#line 1693
    linenum___1 ++;
    {
#line 1694
    got = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                  (FILE */* __restrict  */)f);
    }
    }
#line 1695
    if (got == -1) {
#line 1696
      goto while_break___0;
    }
    {
    {
#line 1697
    tmp___11 = strcmp((char const   *)line, (char const   *)intermediate.unline);
    }
    }
#line 1697
    if (! tmp___11) {
#line 1698
      if (! saw_first_offset) {
#line 1699
        intermediate.first_offset = linenum___1 + 1UL;
      }
#line 1700
      goto while_continue___0;
    }
#line 1703
    if (! saw_first_offset) {
#line 1704
      saw_first_offset = 1;
#line 1705
      intermediate.first_offset = linenum___1;
    }
    {
    {
#line 1708
    add_line___0(& intermediate, (char const   *)line, (size_t )got, linenum___1);
    }
    }
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
  {
#line 1713
  fsetpos(p1, (fpos_t const   *)(& at1));
  }
#line 1714
  this_offset = 0L;
#line 1715
  new_lines = 0UL;
#line 1715
  orig_lines = new_lines;
  }
  {
  {
#line 1716
  while (1) {
    while_continue___4: /* CIL Label */ ;
    while_continue___1: /* CIL Label */ ;
    {
    {
#line 1718
    fgetpos((FILE */* __restrict  */)p1, (fpos_t */* __restrict  */)(& at1));
    }
    {
#line 1719
    got___0 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p1);
    }
    }
#line 1720
    if (got___0 == -1) {
#line 1721
      goto while_break___1;
    }
#line 1723
    if (! orig_lines) {
#line 1723
      if (! new_lines) {
        {
        {
#line 1723
        tmp___13 = strncmp((char const   *)line, "@@ ", (size_t )3);
        }
        }
#line 1723
        if (tmp___13) {
          {
          {
#line 1724
          fsetpos(p1, (fpos_t const   *)(& at1));
          }
          }
#line 1725
          goto while_break___1;
        }
      }
    }
#line 1728
    if (! orig_lines) {
#line 1728
      if (! new_lines) {
        {
        {
#line 1729
        tmp___14 = read_atatline((char const   *)line, (unsigned long *)((void *)0),
                                 & orig_lines, & linenum___1, & new_lines);
        }
        }
#line 1729
        if (tmp___14) {
          {
          {
#line 1731
          error(1, 0, "line not understood: %s", line);
          }
          }
        }
#line 1734
        goto __Cont___0;
      }
    }
#line 1740
    if (orig_lines) {
#line 1740
      if ((int )*(line + 0) != 43) {
#line 1741
        orig_lines --;
      }
    }
#line 1742
    if (new_lines) {
#line 1742
      if ((int )*(line + 0) != 45) {
#line 1743
        new_lines --;
      }
    }
#line 1745
    if ((int )*(line + 0) == 43) {
      {
      {
#line 1746
      tmp___16 = patch2_removes_line___0(linenum___1, offsets, num_offsets);
      }
      }
#line 1746
      if (! tmp___16) {
        {
#line 1748
        at = linenum___1;
        {
#line 1749
        tmp___15 = offset_at_line___0(linenum___1, offsets, num_offsets);
        }
#line 1749
        at += (unsigned long )tmp___15;
#line 1751
        at += (unsigned long )this_offset;
        {
#line 1752
        remove_line___0(& intermediate, (char const   *)(line + 1), at);
        }
#line 1753
        this_offset --;
        }
      }
    } else
#line 1755
    if ((int )*(line + 0) == 45) {
      {
      {
#line 1756
      tmp___18 = patch2_removes_line___0(linenum___1, offsets, num_offsets);
      }
      }
#line 1756
      if (! tmp___18) {
        {
#line 1758
        at___0 = linenum___1;
        {
#line 1759
        tmp___17 = offset_at_line___0(linenum___1, offsets, num_offsets);
        }
#line 1759
        at___0 += (unsigned long )tmp___17;
#line 1761
        at___0 += (unsigned long )this_offset;
        {
#line 1762
        insert_line___0(& intermediate, (char const   *)(line + 1), (size_t )got___0 - 1U,
                        at___0);
        }
        }
      }
#line 1765
      this_offset ++;
    }
#line 1768
    if ((int )*(line + 0) != 45) {
#line 1769
      linenum___1 ++;
    }
    __Cont___0: /* CIL Label */ ;
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break___1: /* CIL Label */ ;
  }
  {
  {
#line 1772
  tmpfd = xmkstemp(tmpp2);
  }
  {
#line 1773
  write_file___0(& intermediate, tmpfd);
  }
  {
#line 1778
  take_diff___0((char const   *)tmpp1, (char const   *)tmpp2, (char **)(header2),
                (char const   *)intermediate.unline, flip1);
  }
  {
#line 1779
  take_diff___0((char const   *)tmpp2, (char const   *)tmpp3, (char **)(header1),
                (char const   *)intermediate.unline, flip2);
  }
  }
#line 1781
  if (line) {
    {
    {
#line 1782
    free((void *)line);
    }
    }
  }
#line 1783
  if (debug___0) {
    {
    {
#line 1784
    printf((char const   */* __restrict  */)"flipped\n");
    }
    }
  } else {
    {
    {
#line 1786
    unlink((char const   *)tmpp1);
    }
    {
#line 1787
    unlink((char const   *)tmpp2);
    }
    {
#line 1788
    unlink((char const   *)tmpp3);
    }
    }
  }
#line 1791
  return (0);
}
}
#line 1794 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int copy___0(FILE *from , FILE *to ) 
{ 
  int ch ;
  int tmp ;
  int tmp___0 ;

  {
  {
  {
#line 1797
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1797
    tmp___0 = feof(from);
    }
    }
#line 1797
    if (tmp___0) {
#line 1797
      goto while_break;
    }
    {
    {
#line 1798
    tmp = fgetc(from);
    }
#line 1798
    ch = tmp;
    }
#line 1799
    if (ch == -1) {
#line 1800
      goto while_break;
    }
    {
    {
#line 1801
    fputc(ch, to);
    }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1803
  return (0);
}
}
#line 1806 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int no_patch___0(char const   *f ) 
{ 
  char *__cil_tmp2 ;

  {
  {
  {
#line 1809
  error(0, 0, "%s doesn\'t contain a patch", f);
  }
  }
#line 1810
  return (0);
}
}
#line 1813 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static int interdiff___0(FILE *p1 , FILE *p2 , char const   *patch1 , char const   *patch2 ) 
{ 
  char *line ;
  size_t linelen ;
  int is_context ;
  int patch_found ;
  int file_is_empty ;
  FILE *flip1 ;
  FILE *flip2 ;
  int tmp ;
  char *names[2] ;
  char *p ;
  long pos ;
  long start_pos ;
  long tmp___0 ;
  __ssize_t tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  __ssize_t tmp___5 ;
  int tmp___6 ;
  char *tmp___7 ;
  int tmp___8 ;
  FILE *tmp___9 ;
  int tmp___10 ;
  FILE *tmp___11 ;
  FILE *p1___0 ;
  FILE *tmp___12 ;
  FILE *p2___0 ;
  FILE *tmp___13 ;
  void *__cil_tmp33 ;
  char *__cil_tmp34 ;
  char *__cil_tmp35 ;
  char *__cil_tmp36 ;
  char *__cil_tmp37 ;
  char *__cil_tmp38 ;
  char *__cil_tmp39 ;
  char *__cil_tmp40 ;

  {
#line 1816
  line = (char *)((void *)0);
#line 1817
  linelen = (size_t )0;
#line 1818
  is_context = 0;
#line 1819
  patch_found = 0;
#line 1820
  file_is_empty = 1;
#line 1821
  flip1 = (FILE *)((void *)0);
#line 1821
  flip2 = (FILE *)((void *)0);
#line 1823
  if ((unsigned int )mode___2 == 2U) {
    {
    {
#line 1824
    flip1 = xtmpfile();
    }
    {
#line 1825
    flip2 = xtmpfile();
    }
    }
  }
  {
  {
#line 1828
  tmp = index_patch2___0(p2);
  }
  }
#line 1828
  if (tmp) {
    {
    {
#line 1829
    no_patch___0(patch2);
    }
    }
  }
  {
  {
#line 1832
  while (1) {
    while_continue___0: /* CIL Label */ ;
    while_continue: /* CIL Label */ ;
    {
    {
#line 1832
    tmp___10 = feof(p1);
    }
    }
#line 1832
    if (tmp___10) {
#line 1832
      goto while_break;
    }
    {
    {
#line 1835
    tmp___0 = ftell(p1);
    }
#line 1835
    start_pos = tmp___0;
    }
#line 1837
    if (line) {
      {
      {
#line 1838
      free((void *)line);
      }
#line 1839
      line = (char *)((void *)0);
#line 1840
      linelen = (size_t )0;
      }
    }
    {
    {
#line 1843
    tmp___1 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p1);
    }
    }
#line 1843
    if (tmp___1 == -1) {
#line 1844
      goto while_break;
    }
    {
#line 1846
    file_is_empty = 0;
    {
#line 1848
    tmp___4 = strncmp((char const   *)line, "--- ", (size_t )4);
    }
    }
#line 1848
    if (tmp___4) {
      {
      {
#line 1849
      tmp___2 = strncmp((char const   *)line, "*** ", (size_t )4);
      }
      }
#line 1849
      if (tmp___2) {
#line 1849
        tmp___3 = 0;
      } else {
#line 1849
        tmp___3 = 1;
      }
#line 1849
      is_context = tmp___3;
#line 1850
      goto while_continue;
    }
#line 1853
    if (is_context) {
      {
      {
#line 1854
      error(1, 0, "I don\'t understand context diffs yet.");
      }
      }
    }
    {
    {
#line 1857
    names[0] = filename_from_header((char const   *)(line + 4));
    }
    {
#line 1859
    tmp___5 = getline((char **/* __restrict  */)(& line), (size_t */* __restrict  */)(& linelen),
                      (FILE */* __restrict  */)p1);
    }
    }
#line 1859
    if (tmp___5 == -1) {
#line 1860
      goto while_break;
    }
    {
    {
#line 1862
    tmp___6 = strncmp((char const   *)line, "+++ ", (size_t )4);
    }
    }
#line 1862
    if (tmp___6) {
#line 1863
      goto while_continue;
    }
    {
    {
#line 1865
    names[1] = filename_from_header((char const   *)(line + 4));
    }
    {
#line 1867
    tmp___7 = best_name(2, names);
    }
    {
#line 1867
    p = xstrdup((char const   *)tmp___7);
    }
    {
#line 1868
    free((void *)names[0]);
    }
    {
#line 1869
    free((void *)names[1]);
    }
#line 1870
    patch_found = 1;
    {
#line 1873
    tmp___8 = check_filename___0((char const   *)p);
    }
    }
#line 1873
    if (! tmp___8) {
      {
      {
#line 1874
      add_to_list___0(& files_done___0, (char const   *)p, 0L);
      }
      }
#line 1875
      goto while_continue;
    }
    {
    {
#line 1878
    fseek(p1, start_pos, 0);
    }
    {
#line 1879
    pos = file_in_list___0(files_in_patch2___0, (char const   *)p);
    }
    }
#line 1880
    if (pos == -1L) {
#line 1881
      if ((unsigned int )mode___2 == 2U) {
#line 1881
        tmp___9 = flip2;
      } else {
#line 1881
        tmp___9 = stdout;
      }
      {
      {
#line 1881
      output_patch1_only___0(p1, tmp___9, (unsigned int )mode___2 != 0U);
      }
      }
    } else {
      {
      {
#line 1885
      fseek(p2, pos, 0);
      }
      }
#line 1886
      if ((unsigned int )mode___2 == 2U) {
        {
        {
#line 1887
        flipdiff___0(p1, p2, flip1, flip2);
        }
        }
      } else {
        {
        {
#line 1889
        output_delta___0(p1, p2, stdout);
        }
        }
      }
    }
    {
    {
#line 1892
    add_to_list___0(& files_done___0, (char const   *)p, 0L);
    }
    }
  }
  while_break___0: /* CIL Label */ ;
  }
  while_break: /* CIL Label */ ;
  }
#line 1895
  if (! file_is_empty) {
#line 1895
    if (! patch_found) {
      {
      {
#line 1896
      no_patch___0(patch1);
      }
      }
    }
  }
#line 1898
  if ((unsigned int )mode___2 == 2U) {
#line 1898
    tmp___11 = flip1;
  } else {
#line 1898
    tmp___11 = stdout;
  }
  {
  {
#line 1898
  copy_residue___0(p2, tmp___11);
  }
  }
#line 1900
  if ((unsigned int )mode___2 == 2U) {
    {
    {
#line 1902
    rewind(flip1);
    }
    {
#line 1903
    rewind(flip2);
    }
    }
#line 1905
    if (flipdiff_inplace___0) {
      {
      {
#line 1906
      tmp___12 = xopen(patch1, "wb");
      }
#line 1906
      p1___0 = tmp___12;
      {
#line 1907
      tmp___13 = xopen(patch2, "wb");
      }
#line 1907
      p2___0 = tmp___13;
      {
#line 1909
      copy___0(flip1, p2___0);
      }
      {
#line 1910
      copy___0(flip2, p1___0);
      }
      }
    } else {
      {
      {
#line 1912
      copy___0(flip1, stdout);
      }
      {
#line 1913
      puts("\n=== 8< === cut here === 8< ===\n");
      }
      {
#line 1914
      copy___0(flip2, stdout);
      }
      }
    }
  }
#line 1918
  if (flip1) {
    {
    {
#line 1919
    fclose(flip1);
    }
    }
  }
#line 1920
  if (flip2) {
    {
    {
#line 1921
    fclose(flip2);
    }
    }
  }
  {
  {
#line 1922
  free_list___0(files_in_patch2___0);
  }
  {
#line 1923
  free_list___0(files_done___0);
  }
  }
#line 1924
  if (line) {
    {
    {
#line 1925
    free((void *)line);
    }
    }
  }
#line 1926
  return (0);
}
}
#line 1929
static  __attribute__((__noreturn__)) void syntax___4(int err ) ;
#line 1929 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void syntax___4(int err ) 
{ 
  char const   *syntax_str___2 ;
  struct _IO_FILE *tmp ;
  char *__cil_tmp4 ;

  {
#line 1932
  syntax_str___2 = "usage: %s [OPTIONS] patch1 patch2\n       %s --version|--help\nOPTIONS are:\n  -U N, --unified=N\n                  max lines of context to carry\n  -i, --ignore-case\n                  Consider upper- and lower-case to be the same\n  -w, --ignore-all-space\n                  ignore whitespace changes in patches\n  -b, --ignore-space-change\n                  ignore changes in the amount of whitespace\n  -B, --ignore-blank-lines\n                  ignore changes whose lines are all blank\n  -p N, --strip-match=N\n                  pathname components to ignore\n  -q, --quiet\n                  don\'t add rationale text\n  -d PAT, --drop-context=PAT\n                  drop context on matching files\n  -z, --decompress\n                  decompress .gz and .bz2 files\n  --interpolate   run as \'interdiff\'\n  --combine       run as \'combinediff\'\n  --flip          run as \'flipdiff\'\n  --no-revert-omitted\n                  (interdiff) When a patch from patch1 is not in patch2,\n                  don\'t revert it\n  --in-place      (flipdiff) Write the output to the original input\n                  files\n";
#line 1963
  if (err) {
#line 1963
    tmp = stderr;
  } else {
#line 1963
    tmp = stdout;
  }
  {
  {
#line 1963
  fprintf((FILE */* __restrict  */)tmp, (char const   */* __restrict  */)syntax_str___2,
          progname, progname);
  }
  {
#line 1964
  exit(err);
  }
  }
}
}
#line 1967 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void set_interdiff___0(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1971
  set_progname("interdiff");
  }
#line 1972
  mode___2 = (enum __anonenum_mode_54___0 )0;
  }
#line 1973
  return;
}
}
#line 1975 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void set_combinediff___0(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1979
  set_progname("combinediff");
  }
#line 1980
  mode___2 = (enum __anonenum_mode_54___0 )1;
  }
#line 1981
  return;
}
}
#line 1983 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void set_flipdiff___0(void) 
{ 
  char *__cil_tmp1 ;

  {
  {
  {
#line 1987
  set_progname("flipdiff");
  }
#line 1988
  mode___2 = (enum __anonenum_mode_54___0 )2;
  }
#line 1989
  return;
}
}
#line 1991 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static void get_mode_from_name___0(char const   *argv0 ) 
{ 
  char const   *p ;
  char *tmp ;
  char const   *tmp___0 ;
  char *tmp___1 ;
  char *tmp___2 ;
  char *__cil_tmp7 ;
  char *__cil_tmp8 ;

  {
  {
  {
#line 1996
  tmp = strrchr(argv0, '/');
  }
#line 1996
  p = (char const   *)tmp;
#line 1997
  tmp___0 = p;
#line 1997
  p ++;
  }
#line 1997
  if (! tmp___0) {
#line 1998
    p = argv0;
  }
  {
  {
#line 1999
  tmp___2 = strstr(p, "combine");
  }
  }
#line 1999
  if (tmp___2) {
    {
    {
#line 2000
    set_combinediff___0();
    }
    }
  } else {
    {
    {
#line 2001
    tmp___1 = strstr(p, "flip");
    }
    }
#line 2001
    if (tmp___1) {
      {
      {
#line 2002
      set_flipdiff___0();
      }
      }
    } else {
      {
      {
#line 2004
      set_interdiff___0();
      }
      }
    }
  }
#line 2005
  return;
}
}
#line 2017 "/home/wslee/benchmarks/textformat/patchutils-0.3.1/src/interdiff.c"
static struct option long_options___4[18]  = 
#line 2017
  {      {"help", 0, (int *)0, 1072}, 
        {"version", 0, (int *)0, 1086}, 
        {"interpolate", 0, (int *)0, 1073}, 
        {"combine", 0, (int *)0, 1067}, 
        {"flip", 0, (int *)0, 1070}, 
        {"no-revert-omitted", 0, (int *)0, 1082}, 
        {"in-place", 0, (int *)0, 1105}, 
        {"debug", 0, (int *)0, 1068}, 
        {"strip-match", 1, (int *)0, 'p'}, 
        {"unified", 1, (int *)0, 'U'}, 
        {"drop-context", 1, (int *)0, 'd'}, 
        {"ignore-blank-lines", 0, (int *)0, 'B'}, 
        {"ignore-space-change", 0, (int *)0, 'b'}, 
        {"ignore-case", 0, (int *)0, 'i'}, 
        {"ignore-all-space", 0, (int *)0, 'w'}, 
        {"decompress", 0, (int *)0, 'z'}, 
        {"quiet", 0, (int *)0, 'q'}, 
        {(char const   *)0, 0, (int *)0, 0}};
